(function(){var n=ol.templateMap=ol.templateMap||{};n["#categorizeMenuTemplate"]={tmpls:[],links:{},tags:{},bnds:[{fn:function(n){return[{tmpl:0,params:"data=#data ~menuType=#data.MenuType ~filterFn=#data.FilterFn ~showSelectionState=#data.ShowSelectionState",props:{data:n},ctx:{menuType:n.MenuType,filterFn:n.FilterFn,showSelectionState:n.ShowSelectionState},args:[]}]},paths:["#data"],_ctxs:"containerPickerControl"}],_is:"template",allowCode:!0,tmplName:"categorizeMenuTemplate",htmlTag:"",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+="  ",r+=u("containerPickerControl",t,this,1),r+""}}},n["#categorizeMenuPlaceHolderTemplate"]={tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,tmplName:"categorizeMenuPlaceHolderTemplate",htmlTag:"ul",fn:{fn:function(n,t,i){var i=i||jsviews;return'  <ul class="c-ContainerPicker cm_menu c_m t_hovl"><\/ul>'}}},n["#containerTemplate"]={tmpls:[{tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"span",tmplName:"containerTemplate/if",fn:{fn:function(n,t,i,r){var i=i||jsviews,e,f=i._cnvt,u="";return u+='        <span class="fadeOnHover toggleExpand" ',u+=(e=t.hlp("sutra")("ContainerItemChevron"))!=r?e:"",u+='>          <img class="',u+=f("getExcoImgClass",t,{params:"~tag.Collapsed ~tag.Expanding ~tag.Collapsing",props:{},args:[t.hlp("tag").Collapsed,t.hlp("tag").Expanding,t.hlp("tag").Collapsing]}),u+='" alt="',u+=f("attr",t,{params:"expandCollapseTooltip()",props:{},args:[n.expandCollapseTooltip()]}),u+='" title="',u+=f("attr",t,{params:"expandCollapseTooltip()",props:{},args:[n.expandCollapseTooltip()]}),u+'" src="./clear.gif"               data-link="class{getExcoImgClass: ~tag.Collapsed ~tag.Expanding ~tag.Collapsing}"/>        <\/span>        '}}},{tmpls:[],links:{},tags:{},bnds:[{fn:function(n,t){return{params:"~tag.DisplayCount",props:{},args:[t.hlp("tag").DisplayCount]}},paths:["~tag.DisplayCount"],_ctxs:":"}],_is:"template",allowCode:!0,htmlTag:"span",tmplName:"containerTemplate/if",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._cnvt,u="";return u+="          <span ",u+=(f=t.hlp("sutra")("UnreadCount"))!=r?f:"",u+=' class="count">',u+=e("",t,1),u+"<\/span>          "}}},{tmpls:[{tmpls:[],links:{},tags:{},bnds:[{fn:function(n){return[{tmpl:0,params:"~container=#data",props:{},ctx:{container:n},args:[]}]},paths:[],_ctxs:"containerControl"}],_is:"template",allowCode:!0,htmlTag:"",tmplName:"containerTemplate/if/for",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+="          ",r+=u("containerControl",t,this,1),r+"        "}}}],links:{},tags:{},bnds:[{fn:function(n){return[{tmpl:1,params:"Items",props:{},args:[n.Items]}]},paths:["Items"],_ctxs:"for"}],_is:"template",allowCode:!0,htmlTag:"li",tmplName:"containerTemplate/if",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,f=i._cnvt,r="";return r+='    <li class="',r+=f("getSubtreeClass",t,{params:"!~tag.Collapsed",props:{},args:[!t.hlp("tag").Collapsed]}),r+='" data-link="class{getSubtreeClass:!~tag.Collapsed}">      <ul class="indentedleftnavlist">        ',r+=u("for",t,this,1),r+"      <\/ul>    <\/li>  "}}}],links:{},tags:{},bnds:[{fn:function(n){return[{tmpl:1,params:"Items.length > 0 && !IsEditing && showChevron(Items.length)",props:{},args:[n.Items.length>0&&!n.IsEditing&&n.showChevron(n.Items.length)]}]},paths:["Items.length","IsEditing","showChevron","Items.length"],_ctxs:"if"},{fn:function(n,t){return[{tmpl:0,params:'~errorId=~tag.ErrorId ~errorProperty="Error" ~data=#data ~textProperty="Name" ~pendingProperty="IsPending" ~editingProperty="IsEditing" ~maxlength=~ol.vm.Container.getMaxNameLength(#data)',props:{},ctx:{errorId:t.hlp("tag").ErrorId,errorProperty:"Error",data:n,textProperty:"Name",pendingProperty:"IsPending",editingProperty:"IsEditing",maxlength:t.hlp("ol").vm.Container.getMaxNameLength(n)},args:[]}]},paths:[],_ctxs:"editableLabelControl"},{fn:function(n){return[{tmpl:2,params:"(!IsEditing)",props:{},args:[!n.IsEditing]}]},paths:["IsEditing"],_ctxs:"if"},{fn:function(n){return[{tmpl:3,params:"Items.length > 0",props:{},args:[n.Items.length>0]}]},paths:["Items.length"],_ctxs:"if"}],_is:"template",allowCode:!0,tmplName:"containerTemplate",htmlTag:"li",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._tag,o=i._cnvt,u="";return u+="  ",n.isVisibleInLeftNav()&&(u+="  ",u+='  <li tabindex="-1" ',u+=(f=t.hlp("sutraClientId")(n.Id))!=r?f:"",u+=" ",u+=(f=t.hlp("sutra")("ContainerItem"))!=r?f:"",u+=" ",u+=(f=t.hlp("sutraParameter")("d",n.Depth))!=r?f:"",u+='  title="',u+=o("attr",t,{params:"~tag.Tooltip",props:{},args:[t.hlp("tag").Tooltip]}),u+='" class="',u+=(f=t.hlp("tag").ContainerClass)!=r?f:"",u+='"      data-link="class{:~tag.ContainerClass} title{:~tag.Tooltip}">    <div id="',u+=(f=t.hlp("tag").ErrorId)!=r?f:"",u+='" ',u+=(f=t.hlp("sutra")("InlineError"))!=r?f:"",u+=' style="',u+=(f=t.hlp("tag").getPadding(n.Depth,n.Items.length,n.IsEditing))!=r?f:"",u+='" data-link="style{:~tag.getPadding(Depth, Items.length, IsEditing)}" aria-live="assertive" class="editableLabel error DisplayNone"><\/div>     <span class="spanContainer" style="',u+=(f=t.hlp("tag").getPadding(n.Depth,n.Items.length,n.IsEditing))!=r?f:"",u+='" data-link="style{:~tag.getPadding(Depth, Items.length, IsEditing)}">      <span class="ellipsis">        ',u+=e("if",t,this,1),u+='        <span class="',u+=(f=t.hlp("tag").LabelClass)!=r?f:"",u+='" data-link="class{:~tag.LabelClass}" ',u+=(f=t.hlp("sutra")("Hotmail.Link"))!=r?f:"",u+=">          <span>            ",u+=e("editableLabelControl",t,this,2),u+="          <\/span>          ",u+=e("if",t,this,3),u+="        <\/span>      <\/span>    <\/span>  <\/li>  "),u+="  ",u+=e("if",t,this,4),u+""}}},n["#containerListTemplate"]={tmpls:[{tmpls:[],links:{},tags:{},bnds:[{fn:function(n){return[{tmpl:0,params:"~container=#data ",props:{},ctx:{container:n},args:[]}]},paths:[],_ctxs:"containerControl"}],_is:"template",allowCode:!0,htmlTag:"",tmplName:"containerListTemplate/for",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+="          ",r+=u("containerControl",t,this,1),r+"          "}}}],links:{},tags:{},bnds:[{fn:function(n){return[{tmpl:1,params:"RootContainer",props:{},args:[n.RootContainer]}]},paths:["RootContainer"],_ctxs:"for"}],_is:"template",allowCode:!0,tmplName:"containerListTemplate",htmlTag:"div",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,o=i._tag,e=i._cnvt,u="";return u+="  ",u+='  <div data-link="class{getContainerListClass:~tag.ContainsVisibleItems}" class="',u+=e("getContainerListClass",t,{params:"~tag.ContainsVisibleItems",props:{},args:[t.hlp("tag").ContainsVisibleItems]}),u+='">    <div class="exco_main" exco_main="exco_main">      <div class="lnav_topItem exco_hdr exco_hot" exco_hot="exco_hot" ',u+=(f=t.hlp("sutra")("containerheader"))!=r?f:"",u+='>        <a class="expandCollapseLink" href="#" ',u+=(f=t.hlp("tabindexForRegion")("leftnav"))!=r?f:"",u+=' title="',u+=(f=n.ExpandCollapseTooltip)!=r?f:"",u+='" ',u+=(f=t.hlp("sutra")("hotmail.link"))!=r?f:"",u+='>          <span class="exco_icon fadeOnHover">            <img class="',u+=e("getExcoImgClass",t,{params:"~tag.Expanded ~tag.Expanding ~tag.Collapsing",props:{},args:[t.hlp("tag").Expanded,t.hlp("tag").Expanding,t.hlp("tag").Collapsing]}),u+='" alt="',u+=(f=n.ExpandCollapseTooltip)!=r?f:"",u+='" title="',u+=(f=n.ExpandCollapseTooltip)!=r?f:"",u+='" src="./clear.gif"                 data-link="class{getExcoImgClass:~tag.Expanded ~tag.Expanding ~tag.Collapsing}"/>          <\/span>          <h1 class="lnav_topItemLabel t_qtc">',u+=(f=n.Title)!=r?f:"",u+="<\/h1>        <\/a>        ",n.RefreshCmd&&(u+='        <div class="lnav_topItemMenuIcon" ',u+=(f=t.hlp("sutra")("folderlistrefresh"))!=r?f:"",u+='>          <a id="Refresh" href="#" ',u+=(f=t.hlp("tabindexForRegion")("leftnav"))!=r?f:"",u+=' aria-label="',u+=(f=t.hlp("ol").GetString("FolderList.Actions.Refresh"))!=r?f:"",u+='" ',u+=(f=t.hlp("sutra")("hotmail.link"))!=r?f:"",u+='>            <img src="./clear.gif" title="',u+=(f=t.hlp("ol").GetString("FolderList.Actions.Refresh"))!=r?f:"",u+='" class="i_refresh"/>          <\/a>        <\/div>        '),u+='      <\/div>      <div class="',u+=e("getSubtreeClass",t,{params:"~tag.Expanded",props:{},args:[t.hlp("tag").Expanded]}),u+='" data-link="class{getSubtreeClass:~tag.Expanded}">        <ul ',u+=(f=t.hlp("tabindexForRegion")("leftnav"))!=r?f:"",u+=' class="containerListRoot indentedleftnavlist" ',u+=(f=t.hlp("sutra")("Container"))!=r?f:"",u+=">          ",u+=o("for",t,this,1),u+='        <\/ul>        <ul class="indentedleftnavlist" ',u+=(f=t.hlp("sutra")("Container"))!=r?f:"",u+='>          <li class="lnav_item leftnavitem">            <a href="#" ',u+=(f=t.hlp("tabindexForRegion")("leftnav"))!=r?f:"",u+=' class="lnav_newContainer lnav_newLnk ContainerListLink" ',u+=(f=t.hlp("sutra")(t.hlp("tag").sutraLabel()))!=r?f:"",u+='>              <span class="Caption">',u+=(f=n.NewItemLabel)!=r?f:"",u+"<\/span>            <\/a>          <\/li>        <\/ul>      <\/div>    <\/div>  <\/div>"}}},n["#editableLabelTemplate"]={tmpls:[{tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"input",tmplName:"editableLabelTemplate/if",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,u="";return u+='        <input id="',u+=(f=t.hlp("tag").ControlNamespace)!=r?f:"",u+='" ',u+=(f=t.hlp("sutra")("Hotmail.Textbox"))!=r?f:"",u+=' class="editableLabel readwrite" type="text" maxlength="',u+=(f=t.hlp("tag").maxlength)!=r?f:"",u+'" data-link="{:~tag.Text:} disabled{:~tag.Disabled}"/>        '}}}],links:{},tags:{},bnds:[{fn:function(n,t){return{params:"~tag.Text",props:{},args:[t.hlp("tag").Text]}},paths:["~tag.Text"],_ctxs:">"},{fn:function(n,t){return[{tmpl:1,params:"~tag.Editing",props:{},args:[t.hlp("tag").Editing]}]},paths:["~tag.Editing"],_ctxs:"if"}],_is:"template",allowCode:!0,tmplName:"editableLabelTemplate",htmlTag:"span",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,o=i._tag,e=i._cnvt,u="";return u+="    <span>        <span ",u+=(f=t.hlp("sutra")("Text"))!=r?f:"",u+=' class="',u+=e("spanClass",t,{params:"~tag.Editing",props:{},args:[t.hlp("tag").Editing]}),u+='" dir="',u+=(f=t.hlp("ol").config.Ltr?"ltr":"rtl")!=r?f:"",u+='" data-link="class{spanClass:~tag.Editing}">            ',u+=e("html",t,1),u+="        <\/span>        ",u+=o("if",t,this,2),u+"    <\/span>"}}},n["#inboxTemplate"]={tmpls:[{tmpls:[],links:{},tags:{},bnds:[{fn:function(n){return[{tmpl:0,params:"traceCtx=traceCtx ",props:{traceCtx:n.traceCtx},args:[]}]},paths:["traceCtx"],_ctxs:"TraceWindowControl"}],_is:"template",allowCode:!0,htmlTag:"",tmplName:"inboxTemplate/if",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+="    ",r+=u("TraceWindowControl",t,this,1),r+"    "}}},{tmpls:[],links:{},tags:{},bnds:[{fn:function(){return[{tmpl:0,params:"",props:{},args:[]}]},paths:[],_ctxs:"readingPaneMenuControl"}],_is:"template",allowCode:!0,htmlTag:"",tmplName:"inboxTemplate/if",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+="    ",r+=u("readingPaneMenuControl",t,this,1),r+"    "}}},{tmpls:[],links:{},tags:{},bnds:[{fn:function(){return[{tmpl:0,params:"",props:{},args:[]}]},paths:[],_ctxs:"advancedSearchControl"}],_is:"template",allowCode:!0,htmlTag:"",tmplName:"inboxTemplate/if",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+="    ",r+=u("advancedSearchControl",t,this,1),r+"    "}}},{tmpls:[],links:{},tags:{},bnds:[{fn:function(){return[{tmpl:0,params:"",props:{},args:[]}]},paths:[],_ctxs:"instantActionsFloatingControl"}],_is:"template",allowCode:!0,htmlTag:"",tmplName:"inboxTemplate/if",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+="                 ",r+=u("instantActionsFloatingControl",t,this,1),r+"              "}}},{tmpls:[],links:{},tags:{},bnds:[{fn:function(n){return[{tmpl:0,params:"~key='rpRight' ~sutraLabel='ReadingpaneSplitter' ~orientation='vertical' distance=Layout.MessageListWidth firstMin=Layout.MessageListWidthMin secondMin=Layout.ReadingPaneWidthMin",props:{distance:n.Layout.MessageListWidth,firstMin:n.Layout.MessageListWidthMin,secondMin:n.Layout.ReadingPaneWidthMin},ctx:{key:"rpRight",sutraLabel:"ReadingpaneSplitter",orientation:"vertical"},args:[]}]},paths:["Layout.MessageListWidth","Layout.MessageListWidthMin","Layout.ReadingPaneWidthMin"],_ctxs:"sizerBarControl"}],_is:"template",allowCode:!0,htmlTag:"",tmplName:"inboxTemplate/if",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+="              ",r+=u("sizerBarControl",t,this,1),r+"            "}}},{tmpls:[],links:{},tags:{},bnds:[{fn:function(n){return[{tmpl:0,params:"~key='rpBottom' ~sutraLabel='ReadingpaneSplitter' ~orientation='horizontal' distance=Layout.MessageListHeight firstMin=Layout.MessageListHeightMin secondMin=Layout.ReadingPaneHeightMin",props:{distance:n.Layout.MessageListHeight,firstMin:n.Layout.MessageListHeightMin,secondMin:n.Layout.ReadingPaneHeightMin},ctx:{key:"rpBottom",sutraLabel:"ReadingpaneSplitter",orientation:"horizontal"},args:[]}]},paths:["Layout.MessageListHeight","Layout.MessageListHeightMin","Layout.ReadingPaneHeightMin"],_ctxs:"sizerBarControl"}],_is:"template",allowCode:!0,htmlTag:"",tmplName:"inboxTemplate/else",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+="              ",r+=u("sizerBarControl",t,this,1),r+"            "}}},{tmpls:[{tmpls:[],links:{},tags:{},bnds:[{fn:function(){return[{tmpl:0,params:"",props:{},args:[]}]},paths:[],_ctxs:"messageCountControl"}],_is:"template",allowCode:!0,htmlTag:"",tmplName:"inboxTemplate/if/if",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+="                ",r+=u("messageCountControl",t,this,1),r+"              "}}}],links:{},tags:{},bnds:[{fn:function(n,t){return[{tmpl:0,params:"ReadMessage.Thread lazyLink=~ol.config.appSettings.shouldUseLazyLinking",props:{lazyLink:t.hlp("ol").config.appSettings.shouldUseLazyLinking},args:[n.ReadMessage.Thread]}]},paths:["ReadMessage.Thread","~ol.config.appSettings.shouldUseLazyLinking"],_ctxs:"readMessageControl"},{fn:function(n){return[{tmpl:1,params:"Layout.isReadingPaneOn(Layout.ReadingPaneMode)",props:{},args:[n.Layout.isReadingPaneOn(n.Layout.ReadingPaneMode)]}]},paths:["Layout.isReadingPaneOn","Layout.ReadingPaneMode"],_ctxs:"if"}],_is:"template",allowCode:!0,htmlTag:"div",tmplName:"inboxTemplate/if",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._tag,u="";return u+='            <div id="',u+=(f=t.hlp("tag").ControlNamespace)!=r?f:"",u+='v-ReadMessageContainer" tabindex="-1" ',u+=(f=t.hlp("sutra")("readingpane"))!=r?f:"",u+=' class="v-ReadMessageContainer slideOnResize"                 style="',u+=(f=t.hlp("tag").readMessageContainerStyle())!=r?f:"",u+='">              ',u+=e("readMessageControl",t,this,1),u+="              ",u+=e("if",t,this,2),u+"            <\/div>            "}}},{tmpls:[],links:{},tags:{},bnds:[{fn:function(){return[{tmpl:0,params:"",props:{},args:[]}]},paths:[],_ctxs:"inboxFlowControl"}],_is:"template",allowCode:!0,htmlTag:"",tmplName:"inboxTemplate/if",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+="          ",r+=u("inboxFlowControl",t,this,1),r+"        "}}},{tmpls:[{tmpls:[],links:{},tags:{},bnds:[{fn:function(n){return[{tmpl:0,params:"~bulkactions=BulkActions ",props:{},ctx:{bulkactions:n.BulkActions},args:[]}]},paths:[],_ctxs:"bulkActionsControl"}],_is:"template",allowCode:!0,htmlTag:"",tmplName:"inboxTemplate/if/if",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+="            ",r+=u("bulkActionsControl",t,this,1),r+"          "}}}],links:{},tags:{},bnds:[{fn:function(n,t){return[{tmpl:1,params:"~tag.BulkActionsControlNeeded",props:{},args:[t.hlp("tag").BulkActionsControlNeeded]}]},paths:["~tag.BulkActionsControlNeeded"],_ctxs:"if"}],_is:"template",allowCode:!0,htmlTag:"",tmplName:"inboxTemplate/if",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+="          ",r+=u("if",t,this,1),r+"        "}}},{tmpls:[],links:{},tags:{},bnds:[{fn:function(n){return[{tmpl:0,params:"~autoRefresh=AutoRefresh ",props:{},ctx:{autoRefresh:n.AutoRefresh},args:[]}]},paths:[],_ctxs:"newMailNotificationControl"},{fn:function(n){return[{tmpl:0,params:"~serverMessages=ServerMessages ",props:{},ctx:{serverMessages:n.ServerMessages},args:[]}]},paths:[],_ctxs:"reauthenticationControl"}],_is:"template",allowCode:!0,htmlTag:"",tmplName:"inboxTemplate/if",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+="          ",r+=u("newMailNotificationControl",t,this,1),r+="          ",r+=u("reauthenticationControl",t,this,2),r+"        "}}},{tmpls:[],links:{},tags:{},bnds:[{fn:function(){return[{tmpl:0,params:"",props:{},args:[]}]},paths:[],_ctxs:"smcControl"}],_is:"template",allowCode:!0,htmlTag:"",tmplName:"inboxTemplate/if",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+="            ",r+=u("smcControl",t,this,1),r+"        "}}},{tmpls:[],links:{},tags:{},bnds:[{fn:function(n){return[{tmpl:0,params:"~archive=Archive ",props:{},ctx:{archive:n.Archive},args:[]}]},paths:[],_ctxs:"archiveControl"}],_is:"template",allowCode:!0,htmlTag:"",tmplName:"inboxTemplate/if",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+="          ",r+=u("archiveControl",t,this,1),r+"        "}}},{tmpls:[],links:{},tags:{},bnds:[{fn:function(){return[{tmpl:0,params:"",props:{},args:[]}]},paths:[],_ctxs:"editRuleControl"}],_is:"template",allowCode:!0,htmlTag:"",tmplName:"inboxTemplate/if",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+="          ",r+=u("editRuleControl",t,this,1),r+"        "}}}],links:{},tags:{},bnds:[{fn:function(n,t){return[{tmpl:1,params:"~ol.config.enableTraceWindow ",props:{},args:[t.hlp("ol").config.enableTraceWindow]}]},paths:["~ol.config.enableTraceWindow"],_ctxs:"if"},{fn:function(n,t){return[{tmpl:3,params:"~tag.CanDisplayAdvancedSearchControl ",props:{},args:[t.hlp("tag").CanDisplayAdvancedSearchControl]}]},paths:["~tag.CanDisplayAdvancedSearchControl"],_ctxs:"if"},{fn:function(n,t){return[{tmpl:0,params:"~leftNav=LeftNav contextMenu=~tag.contextMenu ",props:{contextMenu:t.hlp("tag").contextMenu},ctx:{leftNav:n.LeftNav},args:[]}]},paths:["~tag.contextMenu"],_ctxs:"leftNavControl"},{fn:function(n,t){return[{tmpl:0,params:"~sutraLabel='MasterSplitter' ~key='master' ~orientation='vertical' distance=Layout.LeftNavWidth firstMin=Layout.ContentLeftWidthMin secondMin=Layout.ContentRightWidthMin ~sizerCallback=~tag.leftSizerCallback",props:{distance:n.Layout.LeftNavWidth,firstMin:n.Layout.ContentLeftWidthMin,secondMin:n.Layout.ContentRightWidthMin},ctx:{sutraLabel:"MasterSplitter",key:"master",orientation:"vertical",sizerCallback:t.hlp("tag").leftSizerCallback},args:[]}]},paths:["Layout.LeftNavWidth","Layout.ContentLeftWidthMin","Layout.ContentRightWidthMin"],_ctxs:"sizerBarControl"},{fn:function(n,t){return[{tmpl:0,params:"messageListItems=MessageList.Items rpMode=Layout.ReadingPaneMode contextMenu=~tag.contextMenu ~skipInitAutoSelect=~tag.skipInitAutoSelect() lazyLink=~ol.config.appSettings.shouldUseLazyLinking",props:{messageListItems:n.MessageList.Items,rpMode:n.Layout.ReadingPaneMode,contextMenu:t.hlp("tag").contextMenu,lazyLink:t.hlp("ol").config.appSettings.shouldUseLazyLinking},ctx:{skipInitAutoSelect:t.hlp("tag").skipInitAutoSelect()},args:[]}]},paths:["MessageList.Items","Layout.ReadingPaneMode","~tag.contextMenu","~ol.config.appSettings.shouldUseLazyLinking"],_ctxs:"messageListControl"},{fn:function(n,t){return[{tmpl:5,params:"Layout.ReadingPaneMode === ~HM.ReadingPaneLocation.Right",props:{},args:[n.Layout.ReadingPaneMode===t.hlp("HM").ReadingPaneLocation.Right]},{tmpl:6,params:"Layout.ReadingPaneMode === ~HM.ReadingPaneLocation.Bottom",props:{},args:[n.Layout.ReadingPaneMode===t.hlp("HM").ReadingPaneLocation.Bottom]}]},paths:["Layout.ReadingPaneMode","~HM.ReadingPaneLocation.Right","Layout.ReadingPaneMode","~HM.ReadingPaneLocation.Bottom"],_ctxs:"else"},{fn:function(){return[{tmpl:0,params:"",props:{},args:[]}]},paths:[],_ctxs:"pageFooterControl"},{fn:function(){return[{tmpl:0,params:"",props:{},args:[]}]},paths:[],_ctxs:"rightRailControl"},{fn:function(n,t){return[{tmpl:10,params:"~ol.delayLoadedControls.App1",props:{},args:[t.hlp("ol").delayLoadedControls.App1]}]},paths:["~ol.delayLoadedControls.App1"],_ctxs:"if"},{fn:function(n,t){return[{tmpl:11,params:"~ol.delayLoadedControls.SmcControl",props:{},args:[t.hlp("ol").delayLoadedControls.SmcControl]}]},paths:["~ol.delayLoadedControls.SmcControl"],_ctxs:"if"},{fn:function(n,t){return[{tmpl:12,params:"~tag.ArchiveControlNeeded",props:{},args:[t.hlp("tag").ArchiveControlNeeded]}]},paths:["~tag.ArchiveControlNeeded"],_ctxs:"if"},{fn:function(n,t){return[{tmpl:13,params:"~tag.EditRuleControlNeeded",props:{},args:[t.hlp("tag").EditRuleControlNeeded]}]},paths:["~tag.EditRuleControlNeeded"],_ctxs:"if"}],_is:"template",allowCode:!0,tmplName:"inboxTemplate",htmlTag:"div",fn:{fn:function(n,t,i,r){var i=i||jsviews,e,f=i._tag,u="";return u+='  <div id="',u+=(e=t.hlp("tag").ControlNamespace)!=r?e:"",u+='">    ',u+=f("if",t,this,1),u+="    ",u+=f("if",t,this,[{tmpl:2,params:"!~ol.config.serverRenderOnly",props:{},args:[!t.hlp("ol").config.serverRenderOnly]}]),u+="    ",u+=f("if",t,this,2),u+='    <div class="containsYSizerBar">        <div class="ContentLeft Unselectable fadeOnHoverTarget" style="width:',u+=(e=n.Layout.LeftNavWidth)!=r?e:"",u+='px;" data-link="css-width{:Layout.LeftNavWidth}">          ',u+=f("leftNavControl",t,this,3),u+="        <\/div>        ",u+=f("sizerBarControl",t,this,4),u+='        <div class="',u+=(e=t.hlp("tag").contentRightClass(n.Layout.IsFullView,n.Layout.ReadingPaneMode))!=r?e:"",u+='" style="',u+=(e=t.hlp("ol").config.Ltr?"left":"right")!=r?e:"",u+=":",u+=(e=n.Layout.LeftNavWidth)!=r?e:"",u+='px" data-link="class{:~tag.contentRightClass(Layout.IsFullView, Layout.ReadingPaneMode)}">          <div class="ContentRightInner t_mbgc t_qtc t_urtc">            <div class="v-MessageListContainer Unselectable" style="',u+=(e=t.hlp("tag").messageListContainerStyle())!=r?e:"",u+='">              ',u+=f("messageListControl",t,this,5),u+="              ",u+=f("if",t,this,[{tmpl:4,params:"!~ol.config.serverRenderOnly && ~ol.config.appSettings.IsInstantActionsEnabled && ~ol.config.instantActionsSettings && ~ol.config.appSettings.ShouldUseFloatingInstantActions ",props:{},args:[!t.hlp("ol").config.serverRenderOnly&&t.hlp("ol").config.appSettings.IsInstantActionsEnabled&&t.hlp("ol").config.instantActionsSettings&&t.hlp("ol").config.appSettings.ShouldUseFloatingInstantActions]}]),u+="            <\/div>            ",u+=f("if",t,this,6),u+="            ",u+=f("if",t,this,[{tmpl:7,params:"!~ol.config.serverRenderOnly",props:{},args:[!t.hlp("ol").config.serverRenderOnly]}]),u+='          <\/div>          <div class="v-InboxFooterContainer">            ',u+=f("pageFooterControl",t,this,7),u+="          <\/div>        <\/div>        ",u+=f("if",t,this,[{tmpl:8,params:"~ol.config.inboxFlow",props:{},args:[t.hlp("ol").config.inboxFlow]}]),u+="        ",u+=f("rightRailControl",t,this,8),u+="        ",u+=f("if",t,this,[{tmpl:9,params:"!~ol.config.serverRenderOnly && ~ol.config.appSettings.IsBulkActionsEnabled",props:{},args:[!t.hlp("ol").config.serverRenderOnly&&t.hlp("ol").config.appSettings.IsBulkActionsEnabled]}]),u+="        ",u+="        ",u+=f("if",t,this,9),u+="        ",u+="        ",u+=f("if",t,this,10),u+="        ",u+="        ",u+=f("if",t,this,11),u+="        ",u+=f("if",t,this,12),u+"    <\/div>  <\/div>"}}},n["#instantActionsTemplate"]={tmpls:[{tmpls:[],links:{},tags:{},bnds:[{fn:function(n){return[{tmpl:0,params:"item=#data link=false",props:{item:n,link:!1},args:[]}]},paths:["#data"],_ctxs:"instantActionItemControl"}],_is:"template",allowCode:!0,htmlTag:"",tmplName:"instantActionsTemplate/for",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+="            ",r+=u("instantActionItemControl",t,this,1),r+"          "}}},{tmpls:[],links:{},tags:{},bnds:[{fn:function(n){return[{tmpl:0,params:"item=#data link=false",props:{item:n,link:!1},args:[]}]},paths:["#data"],_ctxs:"instantActionItemControl"}],_is:"template",allowCode:!0,htmlTag:"",tmplName:"instantActionsTemplate/for",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+="            ",r+=u("instantActionItemControl",t,this,1),r+"          "}}}],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,tmplName:"instantActionsTemplate",htmlTag:"span",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._tag,o=i._cnvt,u="";return u+="",u+='  <span class="ia_c" ',u+=(f=t.hlp("sutra")("InstantActions"))!=r?f:"",u+=' id="',u+=(f=t.hlp("tag").ControlNamespace)!=r?f:"",u+='">        ',n.hoverItems.length>0&&(u+='        <div class="',u+=o("getHoverClasses",t,{params:"",props:{},args:[]}),u+='">          ',u+=e("for",t,this,[{tmpl:1,params:"hoverItems",props:{},args:[n.hoverItems]}]),u+="        <\/div>        "),u+="        ",n.fixedItems.length>0&&(u+='        <div class="ia_f">          ',u+=e("for",t,this,[{tmpl:2,params:"fixedItems",props:{},args:[n.fixedItems]}]),u+="        <\/div>        "),u+"    <\/span>"}}},n["#instantActionsBurntTemplate"]={tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,tmplName:"instantActionsBurntTemplate",htmlTag:"span",fn:{fn:function(n,t,i){var i=i||jsviews;return'  <span class="Ia BurntIa">    <span class="ia_c">      <div class="ia_f">        <span class="ia_iw">          <img src="./clear.gif" class="ia_i_p_0" />          <img src="./clear.gif" class="ia_i_p_1" />        <\/span>      <\/div>    <\/span>  <\/span>'}}},n["#instantActionItemTemplate"]={tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,tmplName:"instantActionItemTemplate",htmlTag:"a",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,u="";return u+="  ",u+="  ",t.hlp("instantActionLink")?(u+='    <a href="#" ',u+=(f=t.hlp("tag").getNamespaceAttr())!=r?f:"",u+=' id="',u+=(f=t.hlp("tag").ControlNamespace)!=r?f:"",u+='" aria-label="',u+=(f=n.ImageTitle)!=r?f:"",u+='">      <img src="./clear.gif" class="',u+=(f=n.ImageClassname)!=r?f:"",u+='" title="',u+=(f=n.ImageTitle)!=r?f:"",u+='" ',u+=(f=t.hlp("sutra")("InstantAction"))!=r?f:"",u+=" ",u+=(f=t.hlp("tag").getNamespaceAttr())!=r?f:"",u+="/>    <\/a>  "):(u+='    <span class="ia_iw" ',u+=(f=t.hlp("tag").getNamespaceAttr())!=r?f:"",u+=' id="',u+=(f=t.hlp("tag").ControlNamespace)!=r?f:"",u+='">        <img src="./clear.gif" class="',u+=(f=n.ImageClassname)!=r?f:"",u+='" title="',u+=(f=n.ImageTitle)!=r?f:"",u+='" ',u+=(f=t.hlp("sutra")("InstantAction"))!=r?f:"",u+=" ",u+=(f=t.hlp("tag").getNamespaceAttr())!=r?f:"",u+="/>    <\/span>  "),u+" "}}},n["#leftNavTemplate"]={tmpls:[{tmpls:[],links:{},tags:{},bnds:[{fn:function(n){return[{tmpl:0,params:"~containerList=#data",props:{},ctx:{containerList:n},args:[]}]},paths:[],_ctxs:"containerListControl"},{fn:function(n){return[{tmpl:0,params:"~containerList=#data",props:{},ctx:{containerList:n},args:[]}]},paths:[],_ctxs:"containerListControl"}],_is:"template",allowCode:!0,htmlTag:"div",tmplName:"leftNavTemplate/for",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._tag,u="";return u+="            ",u+="            ",t.index===0?(u+="                <div ",u+=(f=t.hlp("sutra")("folderlist"))!=r?f:"",u+=">                  ",u+=e("containerListControl",t,this,1),u+="                <\/div>            "):ol.config.appSettings.IsQuickViewsEnabled&&(u+="                <div ",u+=(f=t.hlp("sutra")("quickview"))!=r?f:"",u+=' class="notFirstContainerList">                  ',u+=e("containerListControl",t,this,2),u+="                <\/div>            "),u+"        "}}}],links:{},tags:{},bnds:[{fn:function(n,t){return[{tmpl:0,params:"~sutraLabel='WebImSplitter' ~key='webim' ~orientation='horizontal' ~dockToBottom=true distance=~tag.SizerBarInitSize firstMin=~tag.layout.WebImMinModuleHeight ~sizerCallback=~tag.webIMModuleSizerCallback",props:{distance:t.hlp("tag").SizerBarInitSize,firstMin:t.hlp("tag").layout.WebImMinModuleHeight},ctx:{sutraLabel:"WebImSplitter",key:"webim",orientation:"horizontal",dockToBottom:!0,sizerCallback:t.hlp("tag").webIMModuleSizerCallback},args:[]}]},paths:["~tag.SizerBarInitSize","~tag.layout.WebImMinModuleHeight"],_ctxs:"sizerBarControl"},{fn:function(){return[{tmpl:0,params:"",props:{},args:[]}]},paths:[],_ctxs:"searchBoxControl"},{fn:function(n){return[{tmpl:1,params:"ContainerLists",props:{},args:[n.ContainerLists]}]},paths:["ContainerLists"],_ctxs:"for"},{fn:function(n,t){return[{tmpl:0,params:"inboxContextMenu=~tag.inboxContextMenu",props:{inboxContextMenu:t.hlp("tag").inboxContextMenu},args:[]}]},paths:["~tag.inboxContextMenu"],_ctxs:"leftNavContextMenuControl"}],_is:"template",allowCode:!0,tmplName:"leftNavTemplate",htmlTag:"div",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._tag,o=i._cnvt,u="";return u+="  ",ol.config.appSettings.isWebIMLeftNavModuleEnabled&&(u+='    <div class="webIMMessagingContainer t_sbgc"         style="height: ',u+=o("getWebIMModuleSize",t,{params:"~tag.Expanded ~tag.layout.WebImModuleHeight ~tag.layout.WebImHiddenModuleHeight",props:{},args:[t.hlp("tag").Expanded,t.hlp("tag").layout.WebImModuleHeight,t.hlp("tag").layout.WebImHiddenModuleHeight]}),u+='px;">      <a class="expandCollapseLink" href="#" ',u+=(f=t.hlp("tabindexForRegion")("leftnav",2))!=r?f:"",u+='>        <span class="exco_icon fadeOnHover">          <img class="',u+=o("getExcoImgClass",t,{params:"~tag.Expanded ~tag.Expanding ~tag.Collapsing",props:{},args:[t.hlp("tag").Expanded,t.hlp("tag").Expanding,t.hlp("tag").Collapsing]}),u+='" src="./clear.gif"               data-link="class{getExcoImgClass:~tag.Expanded ~tag.Expanding ~tag.Collapsing}"/>        <\/span>        <h1 class="Title t_qtc">',u+=(f=t.hlp("ol").GetString("Live.WebIM.Strings.MessagingTitle"))!=r?f:"",u+='<\/h1>      <\/a>      <div class="',u+=o("getSubClass",t,{params:"~tag.Expanded",props:{},args:[t.hlp("tag").Expanded]}),u+='" data-link="class{getSubClass:~tag.Expanded}">      <div class="Status">',u+=(f=t.hlp("ol").GetString("Live.WebIM.Strings.MessagingPaneSignIn"))!=r?f:"",u+="<\/div>     <\/div>    <\/div>    ",u+=e("sizerBarControl",t,this,1),u+="  "),u+='  <div class="leftnav LeftNav t_sbgc" ',u+=(f=t.hlp("sutra")("generalleftnavmenu"))!=r?f:"",u+='       style="bottom: ',u+=o("getWebIMModuleSize",t,{params:"~tag.Expanded ~tag.layout.WebImModuleHeight ~tag.layout.WebImHiddenModuleHeight",props:{},args:[t.hlp("tag").Expanded,t.hlp("tag").layout.WebImModuleHeight,t.hlp("tag").layout.WebImHiddenModuleHeight]}),u+='px;">    ',u+=e("searchBoxControl",t,this,2),u+='    <div class="foldersQuickViews">    ',ol.config.renderAscxLeftNav?(u+="        ",u+=(f=t.hlp("ol").config.LeftNavGlass)!=r?f:"",u+="    "):(u+="        ",u+=e("for",t,this,3),u+="    "),u+="    <\/div>    ",ol.config.serverRenderOnly||(u+="      ",u+=e("leftNavContextMenuControl",t,this,4),u+="    "),u+"  <\/div>"}}},n["#menuTemplate"]={tmpls:[{tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"img",tmplName:"menuTemplate/if",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,u="";return u+='    <img src="./clear.gif" class="',u+=(f=n.MenuChevClass)!=r?f:"",u+'"/>    '}}},{tmpls:[{tmpls:[],links:{},tags:{},bnds:[{fn:function(n){return[{tmpl:0,params:"#data tmpl=Template",props:{tmpl:n.Template},args:[n]}]},paths:["#data","Template"],_ctxs:"for"}],_is:"template",allowCode:!0,htmlTag:"",tmplName:"menuTemplate/if/for",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+="      ",r+=u("for",t,this,1),r+"    "}}}],links:{},tags:{},bnds:[{fn:function(n){return[{tmpl:1,params:"Items",props:{},args:[n.Items]}]},paths:["Items"],_ctxs:"for"}],_is:"template",allowCode:!0,htmlTag:"",tmplName:"menuTemplate/if",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+="    ",r+=u("for",t,this,1),r+"    "}}}],links:{},tags:{},bnds:[{fn:function(n){return{params:"Title",props:{},args:[n.Title]}},paths:["Title"],_ctxs:">"},{fn:function(n,t){return[{tmpl:2,params:"~tag.MenuCreated",props:{},args:[t.hlp("tag").MenuCreated]}]},paths:["~tag.MenuCreated"],_ctxs:"if"}],_is:"template",allowCode:!0,tmplName:"menuTemplate",htmlTag:"a",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._tag,o=i._cnvt,s=i.converters.html,u="";return u+='  <a href="#" ',u+=(f=t.hlp("tabindexTag")(t.hlp("tag").tabindex))!=r?f:"",u+=' class="c_ml ',u+=(f=n.MenuAnchorClass)!=r?f:"",u+='" ',u+=(f=t.hlp("sutra")("Hotmail.Link"))!=r?f:"",u+='>    <span class="',u+=(f=n.TitleClass)!=r?f:"",u+='" title="',u+=s(n.ToolTip),u+='">',u+=o("html",t,1),u+="<\/span>    ",u+=e("if",t,this,[{tmpl:1,params:"Items.length",props:{},args:[n.Items.length]}]),u+='  <\/a>  <ul class="c_m t_hovl" ',u+=(f=t.hlp("sutra")(n.SutraTag))!=r?f:"",u+=">    ",u+=e("if",t,this,2),u+"  <\/ul>"}}},n["#menuSeparatorTemplate"]={tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,tmplName:"menuSeparatorTemplate",htmlTag:"li",fn:{fn:function(n,t,i){var i=i||jsviews;return'  <li><div class="c_ms"><\/div><\/li>'}}},n["#menuItemTemplate"]={tmpls:[{tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"img",tmplName:"menuItemTemplate/if",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i.converters.html,u="";return u+='        <img src="./clear.gif" class="',u+=(f=n.ItemImageClass)!=r?f:"",u+='" alt="',u+=e(n.ItemAltText),u+'"/>      '}}},{tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"",tmplName:"menuItemTemplate/if",fn:{fn:function(n,t,i){var i=i||jsviews,u=i.converters.html,r="";return r+="          ",r+=u(n.Text),r+"        "}}},{tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"",tmplName:"menuItemTemplate/else",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,u="";return u+="          ",u+=(f=n.Text)!=r?f:"",u+"        "}}}],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,tmplName:"menuItemTemplate",htmlTag:"li",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._tag,o=i.converters.html,u="";return u+='  <li class="',u+=(f=n.CssClass)!=r?f:"",u+='" data-link="class{:CssClass}" ',u+=(f=t.hlp("sutra")(n.SutraTag))!=r?f:"",u+=">    <a ",u+=(f=t.hlp("tabindexTag")(t.hlp("tag").tabindex))!=r?f:"",u+=" ",u+=(f=t.hlp("idTag")(n.Id))!=r?f:"",u+=" ",u+=(f=t.hlp("sutra")("Hotmail.Link"))!=r?f:"",u+=' href="#" class="menuLinkItem" title="',u+=o(n.Tooltip),u+='">      ',u+=e("if",t,this,[{tmpl:1,params:"ItemImageClass ",props:{},args:[n.ItemImageClass]}]),u+="      <span>        ",u+=e("if",t,this,[{tmpl:2,params:"EncodeHtml ",props:{},args:[n.EncodeHtml]},{tmpl:3,params:"",props:{},args:[]}]),u+"      <\/span>    <\/a>  <\/li>"}}},n["#messageGroupTemplate"]={tmpls:[{tmpls:[],links:{},tags:{},bnds:[{fn:function(n,t){return[{tmpl:0,params:"~rowIndex=#index thread=#data ~sortBy=~sortKey.SortBy ~groupConfig=~tag.data.QueryConfig ",props:{thread:n},ctx:{rowIndex:t.index,sortBy:t.hlp("sortKey").SortBy,groupConfig:t.hlp("tag").data.QueryConfig},args:[]}]},paths:["#data"],_ctxs:"messageRowControl"}],_is:"template",allowCode:!0,htmlTag:"",tmplName:"messageGroupTemplate/for",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+="          ",r+=u("messageRowControl",t,this,1),r+"      "}}},{tmpls:[],links:{},tags:{},bnds:[{fn:function(n,t){return{params:"~tag.Container ? ~tag.Container.TotalCount : 0",props:{},args:[t.hlp("tag").Container?t.hlp("tag").Container.TotalCount:0]}},paths:["~tag.Container","~tag.Container.TotalCount"],_ctxs:":"},{fn:function(n,t){return{params:"(~tag.getTrayToggleText(~tag.IsSectionExpanded))",props:{},args:[t.hlp("tag").getTrayToggleText(t.hlp("tag").IsSectionExpanded)]}},paths:["~tag.getTrayToggleText","~tag.IsSectionExpanded"],_ctxs:":"}],_is:"template",allowCode:!0,htmlTag:"div",tmplName:"messageGroupTemplate/if",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._cnvt,u="";return u+="    <div ",u+=(f=t.hlp("sutra")("pinboard"))!=r?f:"",u+=' class="',u+=(f="staticItem mgFooter animatable "+(t.hlp("tag").IsSectionExpanded?"ShowH":"HideH"))!=r?f:"",u+='"        data-link="class{:\'staticItem mgFooter animatable \' + ((~tag.IsSectionExpanded) ? \'ShowH\' : \'HideH\')}">        <span>          <div class="mgTray">            <div class="mgTrayMessage">              <a ',u+=(f=t.hlp("tabindexForRegion")("msgGroupFooter"))!=r?f:"",u+=" ",u+=(f=t.hlp("sutra")("Flagged"))!=r?f:"",u+=' class="mgFooterLink" href="#">',u+=(f=t.hlp("tag").getTrayFooterLinkText())!=r?f:"",u+=' <span class="count">',u+=e("",t,1),u+='<\/span><\/a>              <span class="ToolbarPipe">|<\/span>              <a ',u+=(f=t.hlp("tabindexForRegion")("msgGroupFooter"))!=r?f:"",u+=" ",u+=(f=t.hlp("sutra")("Toggle"))!=r?f:"",u+=' class="toggleSection" href="#" title="',u+=(f=t.hlp("tag").getTrayToggleTitle(t.hlp("tag").IsSectionExpanded))!=r?f:"",u+='" data-link="title{:(~tag.getTrayToggleTitle(~tag.IsSectionExpanded))}">',u+=e("",t,2),u+='<\/a>            <\/div>            <span class="mgTrayCBTD">              <div class="mgTrayCB" ',u+=(f=t.hlp("sutra")("Close"))!=r?f:"",u+='>                <a href="#" title="',u+=(f=t.hlp("tag").getTrayCBTitle())!=r?f:"",u+='" alt="',u+=(f=t.hlp("tag").getTrayCBTitle())!=r?f:"",u+='"><div class="',u+=(f=t.hlp("tag").getTrayCloseIconClass())!=r?f:"",u+'"><\/div><\/a>              <\/div>            <\/span>          <\/div>          <div class="mgRule"><\/div>        <\/span>     <\/div>     '}}}],links:{},tags:{},bnds:[{fn:function(n){return[{tmpl:1,params:"Items",props:{},args:[n.Items]}]},paths:["Items"],_ctxs:"for"},{fn:function(n){return[{tmpl:2,params:"ShowFooter",props:{},args:[n.ShowFooter]}]},paths:["ShowFooter"],_ctxs:"if"}],_is:"template",allowCode:!0,tmplName:"messageGroupTemplate",htmlTag:"div",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._tag,u="";return u+='  <div class="',u+=(f=t.hlp("tag").getNarrowClass("c-MessageGroup ",t.hlp("layout").ReadingPaneMode,"mailListPane InboxTable"))!=r?f:"",u+='">    <ul class="',u+=(f=t.hlp("tag").getMainCssClass("mailList InboxTableBody ",t.hlp("tag").IsSectionExpanded||!n.ShowFooter))!=r?f:"",u+='" data-link="class{:(~tag.getMainCssClass(\'mailList InboxTableBody \', (~tag.IsSectionExpanded || !ShowFooter)))}">      ',u+=e("for",t,this,1),u+="    <\/ul>    ",u+=e("if",t,this,2),u+"  <\/div>"}}},n["#messageListTemplate"]={tmpls:[{tmpls:[{tmpls:[],links:{},tags:{},bnds:[{fn:function(n,t){return[{tmpl:0,params:"~groupIndex=#index messageGroup=#data ~sortKey=~tag.data.sortKey",props:{messageGroup:n},ctx:{groupIndex:t.index,sortKey:t.hlp("tag").data.sortKey},args:[]}]},paths:["#data"],_ctxs:"messageGroupControl"}],_is:"template",allowCode:!0,htmlTag:"",tmplName:"messageListTemplate/if/for",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+="            ",r+=u("messageGroupControl",t,this,1),r+"          "}}}],links:{},tags:{},bnds:[{fn:function(n){return[{tmpl:1,params:"Items",props:{},args:[n.Items]}]},paths:["Items"],_ctxs:"for"}],_is:"template",allowCode:!0,htmlTag:"div",tmplName:"messageListTemplate/if",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._tag,u="";return u+="        <div ",u+=(f=t.hlp("sutra")("hotmail.messages"))!=r?f:"",u+=">          ",u+=e("for",t,this,1),u+"        <\/div>        "}}},{tmpls:[],links:{},tags:{},bnds:[{fn:function(n,t){return{params:"QueryContainer FilterId ~tag.categoryList",props:{},args:[n.QueryContainer,n.FilterId,t.hlp("tag").categoryList]}},paths:["QueryContainer","FilterId","~tag.categoryList"],_ctxs:"emptyMessageListMessage:"}],_is:"template",allowCode:!0,htmlTag:"div",tmplName:"messageListTemplate/else",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._cnvt,u="";return u+='        <div id="NoMsgs" class="NoMsgsPane" ',u+=(f=t.hlp("sutra")("nomessagespane"))!=r?f:"",u+='">          ',u+=e("emptyMessageListMessage",t,1),u+"        <\/div>        "}}},{tmpls:[{tmpls:[],links:{},tags:{},bnds:[{fn:function(n,t){return{params:"~tag.BottomMsg",props:{},args:[t.hlp("tag").BottomMsg]}},paths:["~tag.BottomMsg"],_ctxs:":"}],_is:"template",allowCode:!0,htmlTag:"div",tmplName:"messageListTemplate/if/if",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._cnvt,u="";return u+='          <div class="MessageListBottomTextInner BorderTop t_mbgc"  ',u+=(f=t.hlp("sutra")("bottommessage"))!=r?f:"",u+=">            ",u+=e("",t,1),u+"          <\/div>        "}}}],links:{},tags:{},bnds:[{fn:function(){return[{tmpl:0,params:"",props:{},args:[]}]},paths:[],_ctxs:"messageListNavigationControl"}],_is:"template",allowCode:!0,htmlTag:"div",tmplName:"messageListTemplate/if",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+="        ",r+=u("if",t,this,[{tmpl:1,params:"~tag.BottomMsg",props:{},args:[t.hlp("tag").BottomMsg]}]),r+="      ",r+=u("messageListNavigationControl",t,this,1),r+"      "}}},{tmpls:[{tmpls:[],links:{},tags:{},bnds:[{fn:function(n,t){return{params:"~tag.BottomMsg",props:{},args:[t.hlp("tag").BottomMsg]}},paths:["~tag.BottomMsg"],_ctxs:":"}],_is:"template",allowCode:!0,htmlTag:"div",tmplName:"messageListTemplate/if/if",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._cnvt,u="";return u+='        <div class="MessageListBottomTextOuter BorderTop t_mbgc" ',u+=(f=t.hlp("sutra")("bottommessage"))!=r?f:"",u+=">          ",u+=e("",t,1),u+"        <\/div>      "}}}],links:{},tags:{},bnds:[{fn:function(){return[{tmpl:0,params:"",props:{},args:[]}]},paths:[],_ctxs:"messageListNavigationControl"}],_is:"template",allowCode:!0,htmlTag:"div",tmplName:"messageListTemplate/if",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+="      ",r+=u("if",t,this,[{tmpl:1,params:"~tag.BottomMsg",props:{},args:[t.hlp("tag").BottomMsg]}]),r+="      ",r+=u("messageListNavigationControl",t,this,1),r+"    "}}},{tmpls:[],links:{},tags:{},bnds:[{fn:function(n,t){return[{tmpl:0,params:"~tag.ContextMenu inboxContextMenu=~tag.inboxContextMenu",props:{inboxContextMenu:t.hlp("tag").inboxContextMenu},args:[t.hlp("tag").ContextMenu]}]},paths:["~tag.ContextMenu","~tag.inboxContextMenu"],_ctxs:"messageListContextMenuControl"}],_is:"template",allowCode:!0,htmlTag:"",tmplName:"messageListTemplate/if",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+="    ",r+=u("messageListContextMenuControl",t,this,1),r+"    "}}}],links:{},tags:{},bnds:[{fn:function(){return[{tmpl:0,params:"",props:{},args:[]}]},paths:[],_ctxs:"messageListHeaderControl"},{fn:function(n){return[{tmpl:1,params:"!isEmptyMessageList(Items, NumThreads)",props:{},args:[!n.isEmptyMessageList(n.Items,n.NumThreads)]},{tmpl:2,params:"",props:{},args:[]}]},paths:["isEmptyMessageList","Items","NumThreads"],_ctxs:"else"},{fn:function(n,t){return[{tmpl:3,params:"~tag.layout.ReadingPaneMode === ~HM.ReadingPaneLocation.Off ",props:{},args:[t.hlp("tag").layout.ReadingPaneMode===t.hlp("HM").ReadingPaneLocation.Off]}]},paths:["~tag.layout.ReadingPaneMode","~HM.ReadingPaneLocation.Off"],_ctxs:"if"},{fn:function(){return[{tmpl:0,params:"",props:{},args:[]}]},paths:[],_ctxs:"pageFooterControl"},{fn:function(n,t){return[{tmpl:4,params:"~tag.layout.ReadingPaneMode !== ~HM.ReadingPaneLocation.Off ",props:{},args:[t.hlp("tag").layout.ReadingPaneMode!==t.hlp("HM").ReadingPaneLocation.Off]}]},paths:["~tag.layout.ReadingPaneMode","~HM.ReadingPaneLocation.Off"],_ctxs:"if"}],_is:"template",allowCode:!0,tmplName:"messageListTemplate",htmlTag:"div",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._tag,o=i._cnvt,u="";return u+='  <div id="',u+=(f=t.hlp("tag").ControlNamespace)!=r?f:"",u+='" class="',u+=(f=t.hlp("tag").cssClasses(t.hlp("layout").ReadingPaneMode,t.hlp("folderList")))!=r?f:"",u+='" data-link="class{:~tag.cssClasses(~layout.ReadingPaneMode, ~folderList)}" ',u+=(f=t.hlp("sutra")("messagelist"))!=r?f:"",u+=">    ",u+=e("messageListHeaderControl",t,this,1),u+='    <div class="messageListContainer" id="',u+=(f=t.hlp("tag").ControlNamespace)!=r?f:"",u+='messageListContainer">      <div id="',u+=(f=t.hlp("tag").ControlNamespace)!=r?f:"",u+='messageListInnerContainer" class="messageListInnerContainer ',u+=(f=t.hlp("tag").cssInnerContainer(t.hlp("layout").ReadingPaneMode))!=r?f:"",u+='">        ',u+=e("if",t,this,2),u+="      <\/div>      ",u+=e("if",t,this,3),u+='      <div class="',u+=o("footerClass",t,{params:"~layout ~layout.ReadingPaneMode",props:{},args:[t.hlp("layout"),t.hlp("layout").ReadingPaneMode]}),u+='" data-link="class{footerClass:~layout ~layout.ReadingPaneMode}">        ',u+=e("pageFooterControl",t,this,4),u+="      <\/div>    <\/div>    ",u+=e("if",t,this,5),u+="    ",u+=e("if",t,this,[{tmpl:5,params:"!~ol.config.serverRenderOnly",props:{},args:[!t.hlp("ol").config.serverRenderOnly]}]),u+="    ",u+=e("include",t,this,[{tmpl:0,params:'tmpl="#categorizeMenuPlaceHolderTemplate"',props:{tmpl:"#categorizeMenuPlaceHolderTemplate"},args:[]}]),u+"  <\/div>"}}},n["#messageListHeaderTemplate"]={tmpls:[{tmpls:[{tmpls:[{tmpls:[],links:{},tags:{},bnds:[{fn:function(){return[{tmpl:0,params:"",props:{},args:[]}]},paths:[],_ctxs:"searchFiltersControl"}],_is:"template",allowCode:!0,htmlTag:"",tmplName:"messageListHeaderTemplate/if/if/if",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+="              ",r+=u("searchFiltersControl",t,this,1),r+"            "}}}],links:{},tags:{},bnds:[{fn:function(n,t){return[{tmpl:1,params:"~ol.delayLoadedControls.SearchFiltersControl && !~tag.isMessageCountOverlappingFilters(Layout.ReadingPaneMode, ShowMessageCount) ",props:{},args:[t.hlp("ol").delayLoadedControls.SearchFiltersControl&&!t.hlp("tag").isMessageCountOverlappingFilters(n.Layout.ReadingPaneMode,n.ShowMessageCount)]}]},paths:["~ol.delayLoadedControls.SearchFiltersControl","~tag.isMessageCountOverlappingFilters","Layout.ReadingPaneMode","ShowMessageCount"],_ctxs:"if"}],_is:"template",allowCode:!0,htmlTag:"",tmplName:"messageListHeaderTemplate/if/if",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+="            ",r+=u("if",t,this,1),r+"          "}}}],links:{},tags:{},bnds:[{fn:function(n){return[{tmpl:0,params:'#data tmpl="#messageListHeaderCheckAllTemplate"',props:{tmpl:"#messageListHeaderCheckAllTemplate"},args:[n]}]},paths:["#data"],_ctxs:"for"}],_is:"template",allowCode:!0,htmlTag:"",tmplName:"messageListHeaderTemplate/if",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+="          ",r+=u("for",t,this,1),r+="          ",r+=u("if",t,this,[{tmpl:1,params:"!~ol.config.serverRenderOnly",props:{},args:[!t.hlp("ol").config.serverRenderOnly]}]),r+"        "}}},{tmpls:[{tmpls:[{tmpls:[],links:{},tags:{},bnds:[{fn:function(n,t){return[{tmpl:0,params:'~tag.CategoryFiltersMenu ~tabindex=~ol.getTabIndex("msgListHeader", 1) ',props:{},ctx:{tabindex:t.hlp("ol").getTabIndex("msgListHeader",1)},args:[t.hlp("tag").CategoryFiltersMenu]}]},paths:["~tag.CategoryFiltersMenu"],_ctxs:"menuControl"}],_is:"template",allowCode:!0,htmlTag:"li",tmplName:"messageListHeaderTemplate/else/if/if",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._tag,u="";return u+='              <li class="FilterSelector c_mcp ToolbarItemFirst">                <span class="filtersContainer" ',u+=(f=t.hlp("sutra")("FilterViews"))!=r?f:"",u+='>                  <span class="c_mcp">                    ',u+=e("menuControl",t,this,1),u+"                  <\/span>                <\/span>              <\/li>            "}}}],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"li",tmplName:"messageListHeaderTemplate/else/if",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+="            ",r+=u("if",t,this,[{tmpl:1,params:"~ol.config.features.filters ",props:{},args:[t.hlp("ol").config.features.filters]}]),r+"          "}}}],links:{},tags:{},bnds:[{fn:function(n,t){return[{tmpl:0,params:'~tag.ArrangeByMenu ~tabindex=~ol.getTabIndex("msgListHeader", 2) ',props:{},ctx:{tabindex:t.hlp("ol").getTabIndex("msgListHeader",2)},args:[t.hlp("tag").ArrangeByMenu]}]},paths:["~tag.ArrangeByMenu"],_ctxs:"menuControl"},{fn:function(n){return[{tmpl:0,params:'#data tmpl="#messageListHeaderCheckAllTemplate"',props:{tmpl:"#messageListHeaderCheckAllTemplate"},args:[n]}]},paths:["#data"],_ctxs:"for"},{fn:function(n,t){return[{tmpl:1,params:"!~tag.isMessageCountOverlappingFilters(Layout.ReadingPaneMode, ShowMessageCount)",props:{},args:[!t.hlp("tag").isMessageCountOverlappingFilters(n.Layout.ReadingPaneMode,n.ShowMessageCount)]}]},paths:["~tag.isMessageCountOverlappingFilters","Layout.ReadingPaneMode","ShowMessageCount"],_ctxs:"if"}],_is:"template",allowCode:!0,htmlTag:"li",tmplName:"messageListHeaderTemplate/else",fn:{fn:function(n,t,i,r){var i=i||jsviews,e,f=i._tag,u="";return u+="          ",u+="          <li ",u+=(e=t.hlp("sutra")("ArrangeBy"))!=r?e:"",u+=' class="ToolbarItem c_mcp FloatRight" id="sortMenu">            ',u+=f("menuControl",t,this,1),u+="          <\/li>          ",u+=f("for",t,this,2),u+="          ",u+=f("if",t,this,3),u+"        "}}}],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,tmplName:"messageListHeaderTemplate",htmlTag:"span",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+='  <span class="c-MessageListHeader SortFilterContainer t_mbgc">    <div>      <ul class="SortFilterItems">        ',r+=u("if",t,this,[{tmpl:1,params:"isSearchResult() ",props:{},args:[n.isSearchResult()]},{tmpl:2,params:"",props:{},args:[]}]),r+'      <\/ul>    <\/div>    <div class="mlRule"><\/div>  <\/span>'}}},n["#messageListHeaderCheckAllTemplate"]={tmpls:[{tmpls:[],links:{},tags:{},bnds:[{fn:function(){return[{tmpl:0,params:"",props:{},args:[]}]},paths:[],_ctxs:"messageCountControl"}],_is:"template",allowCode:!0,htmlTag:"",tmplName:"messageListHeaderCheckAllTemplate/if",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+="      ",r+=u("messageCountControl",t,this,1),r+"    "}}}],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,tmplName:"messageListHeaderCheckAllTemplate",htmlTag:"li",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._tag,o=i._cnvt,u="";return u+='  <li class="ToolbarItemCheckbox">    <input ',u+=(f=t.hlp("tabindexForRegion")("msgListHeader"))!=r?f:"",u+=" ",u+=(f=t.hlp("sutra")("CheckAll"))!=r?f:"",u+=' type="checkbox" id="msgChkAll" data-link="{:CheckAllChecked:}" title="',u+=o("attr",t,{params:'~ol.GetShortcutString("Accessibility.ListHeader.CheckboxLabel", "selectAll")',props:{},args:[t.hlp("ol").GetShortcutString("Accessibility.ListHeader.CheckboxLabel","selectAll")]}),u+='">      <label for="msgChkAll"><\/label>    <\/input>    ',u+=e("if",t,this,[{tmpl:1,params:"!~ol.config.serverRenderOnly && !Layout.isReadingPaneOn(Layout.ReadingPaneMode)",props:{},args:[!t.hlp("ol").config.serverRenderOnly&&!n.Layout.isReadingPaneOn(n.Layout.ReadingPaneMode)]}]),u+"  <\/li>"}}},n["#messageListGotoPickerTemplate"]={tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,tmplName:"messageListGotoPickerTemplate",htmlTag:"a",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,u="";return u+="    <a ",u+=(f=t.hlp("tabindexForRegion")("msgListNavigation"))!=r?f:"",u+=' href="#" class="c_ml" id="gotoLink" data-link="type{:~tag.CurrentPickerMode}">',u+=(f=t.hlp("ol").GetString("PaginationControl.GoToLinkText"))!=r?f:"",u+"<\/a>"}}},n["#messageListNavigationTemplate"]={tmpls:[{tmpls:[],links:{},tags:{},bnds:[{fn:function(){return[{tmpl:0,params:"",props:{},args:[]}]},paths:[],_ctxs:"messageListGotoPickerControl"}],_is:"template",allowCode:!0,htmlTag:"li",tmplName:"messageListNavigationTemplate/if",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._tag,u="";return u+="        <li ",u+=(f=t.hlp("sutra")("GotoLink"))!=r?f:"",u+=">          ",u+=e("messageListGotoPickerControl",t,this,1),u+"        <\/li>        "}}}],links:{},tags:{},bnds:[{fn:function(n,t){return{params:"~messageList.QueryContainer ~messageList.QueryContainer.TotalCount ~layout.ReadingPaneMode ~messageList.FilterId ~messageList.IsSearchResult",props:{},args:[t.hlp("messageList").QueryContainer,t.hlp("messageList").QueryContainer.TotalCount,t.hlp("layout").ReadingPaneMode,t.hlp("messageList").FilterId,t.hlp("messageList").IsSearchResult]}},paths:["~messageList.QueryContainer","~messageList.QueryContainer.TotalCount","~layout.ReadingPaneMode","~messageList.FilterId","~messageList.IsSearchResult"],_ctxs:"messageCount:"},{fn:function(n,t){return{params:"~tag.generatePageNumber(~messageList.PageNumber, ~messageList.TotalPageCount) ",props:{},args:[t.hlp("tag").generatePageNumber(t.hlp("messageList").PageNumber,t.hlp("messageList").TotalPageCount)]}},paths:["~tag.generatePageNumber","~messageList.PageNumber","~messageList.TotalPageCount"],_ctxs:":"}],_is:"template",allowCode:!0,tmplName:"messageListNavigationTemplate",htmlTag:"div",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,o=i._tag,e=i._cnvt,u="";return u+="  ",u+='  <div class="c-MessageListNavigation ',u+=(f=t.hlp("tag").dockClass())!=r?f:"",u+=' PaginationContainer BorderTop TextSizeSmall t_tborder t_mbgc">    ',u+="    <div ",u+=(f=t.hlp("sutra")("MessageListCount"))!=r?f:"",u+=' id="mlRange" class="PageNavigationMsgRange">',u+=e("messageCount",t,1),u+="<\/div>    <div ",u+=(f=t.hlp("sutra")("PaginationControl"))!=r?f:"",u+=' id="mlPageNav" class="',u+=(f=t.hlp("tag").getBeginEndClass(t.hlp("messageList").activeGroup()&&t.hlp("messageList").activeGroup().Bof,t.hlp("messageList").activeGroup()&&t.hlp("messageList").activeGroup().Eof,t.hlp("messageList").activeGroup()&&t.hlp("messageList").activeGroup().items().length))!=r?f:"",u+='"           data-link="class{:~tag.getBeginEndClass((~messageList.activeGroup() && ~messageList.activeGroup().Bof), (~messageList.activeGroup() && ~messageList.activeGroup().Eof), (~messageList.activeGroup() && ~messageList.activeGroup().items().length))}">      <ul>        <li ',u+=(f=t.hlp("sutra")("PageNumber"))!=r?f:"",u+=">",u+=e("",t,2),u+="<\/li>        ",u+=o("if",t,this,[{tmpl:1,params:"~tag.shouldRenderGotoLink(~messageList.sortKey.SortBy) ",props:{},args:[t.hlp("tag").shouldRenderGotoLink(t.hlp("messageList").sortKey.SortBy)]}]),u+='        <li>          <div class="FirstPageEnabled firstPageLink" id="firstPageLink">            <a ',u+=(f=t.hlp("tabindexForRegion")("msgListNavigation"))!=r?f:"",u+=' href="#" title="',u+=(f=t.hlp("ol").GetString("MessageList.FirstPage"))!=r?f:"",u+='">              <img ',u+=(f=t.hlp("sutra")("FirstPage"))!=r?f:"",u+=' class="PageNavigationFirst i_pn_f" src="./clear.gif" alt="',u+=(f=t.hlp("ol").GetString("MessageList.FirstPage"))!=r?f:"",u+='"/>            <\/a>          <\/div>          <div class="FirstPageDisabled">            <img ',u+=(f=t.hlp("sutra")("FirstPage"))!=r?f:"",u+=' class="PageNavigationFirst i_pn_f_d" src="./clear.gif" alt="',u+=(f=t.hlp("ol").GetString("MessageList.FirstPage"))!=r?f:"",u+='"/>          <\/div>        <\/li>        <li>          <div class="PrevPageEnabled prevPageLink" id="prevPageLink">            <a ',u+=(f=t.hlp("tabindexForRegion")("msgListNavigation"))!=r?f:"",u+=' href="#" title="',u+=(f=t.hlp("ol").GetString("MessageList.PreviousPage"))!=r?f:"",u+='">              <img ',u+=(f=t.hlp("sutra")("PreviousPage"))!=r?f:"",u+=' class="PageNavigationPrev i_pn_p" src="./clear.gif" alt="',u+=(f=t.hlp("ol").GetString("MessageList.PreviousPage"))!=r?f:"",u+='"/>            <\/a>          <\/div>          <div class="PrevPageDisabled">            <img ',u+=(f=t.hlp("sutra")("PreviousPage"))!=r?f:"",u+=' class="PageNavigationPrev i_pn_p_d" src="./clear.gif" alt="',u+=(f=t.hlp("ol").GetString("MessageList.PreviousPage"))!=r?f:"",u+='">              <\/div>        <\/li>        <li>          <div class="NextPageEnabled nextPageLink" id="nextPageLink">            <a ',u+=(f=t.hlp("tabindexForRegion")("msgListNavigation"))!=r?f:"",u+=' href="#" title="',u+=(f=t.hlp("ol").GetString("MessageList.NextPage"))!=r?f:"",u+='">              <img ',u+=(f=t.hlp("sutra")("NextPage"))!=r?f:"",u+=' class="PageNavigationNext i_pn_n" src="./clear.gif" alt="',u+=(f=t.hlp("ol").GetString("MessageList.NextPage"))!=r?f:"",u+='"/>            <\/a>          <\/div>          <div class="NextPageDisabled">            <img ',u+=(f=t.hlp("sutra")("NextPage"))!=r?f:"",u+=' class="PageNavigationNext i_pn_n_d" src="./clear.gif" alt="',u+=(f=t.hlp("ol").GetString("MessageList.NextPage"))!=r?f:"",u+='"/>          <\/div>        <\/li>        <li>          <div class="LastPageEnabled lastPageLink" id="lastPageLink">            <a ',u+=(f=t.hlp("tabindexForRegion")("msgListNavigation"))!=r?f:"",u+=' href="#" title="',u+=(f=t.hlp("ol").GetString("MessageList.LastPage"))!=r?f:"",u+='">              <img ',u+=(f=t.hlp("sutra")("LastPage"))!=r?f:"",u+=' class="PageNavigationLast i_pn_l" src="./clear.gif" alt="',u+=(f=t.hlp("ol").GetString("MessageList.LastPage"))!=r?f:"",u+='"/>            <\/a>          <\/div>          <div class="LastPageDisabled">            <img ',u+=(f=t.hlp("sutra")("LastPage"))!=r?f:"",u+=' class="PageNavigationLast i_pn_l_d" src="./clear.gif" alt="',u+=(f=t.hlp("ol").GetString("MessageList.LastPage"))!=r?f:"",u+'"/>          <\/div>        <\/li>      <\/ul>    <\/div>  <\/div>'}}},n["#messageRowTemplate"]={tmpls:[{tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"span",tmplName:"messageRowTemplate/if",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,u="";return u+='            <span class="Io">              <img src="./clear.gif" class="',u+=(f=t.hlp("tag").StatusImageClass)!=r?f:"",u+='" alt="',u+=(f=t.hlp("tag").StatusImageAltText)!=r?f:"",u+='" ',u+=(f=t.hlp("sutra")("Status"))!=r?f:"",u+'                   data-link="class{:~tag.StatusImageClass} alt{:~tag.StatusImageAltText}"/>            <\/span>          '}}},{tmpls:[],links:{},tags:{},bnds:[{fn:function(n){return{params:"Count",props:{},args:[n.Count]}},paths:["Count"],_ctxs:":"}],_is:"template",allowCode:!0,htmlTag:"span",tmplName:"messageRowTemplate/if",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._cnvt,u="";return u+="            (<span ",u+=(f=t.hlp("sutra")("ConversationCount"))!=r?f:"",u+=">",u+=e("",t,1),u+"<\/span>)            "}}},{tmpls:[],links:{},tags:{},bnds:[{fn:function(n){return{params:"Count",props:{},args:[n.Count]}},paths:["Count"],_ctxs:":"}],_is:"template",allowCode:!0,htmlTag:"span",tmplName:"messageRowTemplate/if",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._cnvt,u="";return u+="        (<span ",u+=(f=t.hlp("sutra")("ConversationCount"))!=r?f:"",u+=">",u+=e("",t,1),u+"<\/span>)        "}}}],links:{},tags:{},bnds:[{fn:function(n){return{params:"DateReceivedLocal",props:{},args:[n.DateReceivedLocal]}},paths:["DateReceivedLocal"],_ctxs:":"},{fn:function(n){return{params:"SenderInfos",props:{},args:[n.SenderInfos]}},paths:["SenderInfos"],_ctxs:":"},{fn:function(n){return[{tmpl:0,params:"~thread=#data ~instantActionLink=false link=false",props:{link:!1},ctx:{thread:n,instantActionLink:!1},args:[]}]},paths:[],_ctxs:"instantActionsControl"},{fn:function(){return[{tmpl:0,params:"",props:{},args:[]}]},paths:[],_ctxs:"instantActionsBurntControl"},{fn:function(n,t){return[{tmpl:1,params:"~tag.StatusImageClass",props:{},args:[t.hlp("tag").StatusImageClass]}]},paths:["~tag.StatusImageClass"],_ctxs:"if"},{fn:function(n){return[{tmpl:2,params:"Count > 1",props:{},args:[n.Count>1]}]},paths:["Count"],_ctxs:"if"},{fn:function(n){return{params:"SubjectWithHtml",props:{},args:[n.SubjectWithHtml]}},paths:["SubjectWithHtml"],_ctxs:":"},{fn:function(n){return{params:"SenderInfos",props:{},args:[n.SenderInfos]}},paths:["SenderInfos"],_ctxs:":"},{fn:function(n){return[{tmpl:3,params:"Count > 1",props:{},args:[n.Count>1]}]},paths:["Count"],_ctxs:"if"},{fn:function(n){return[{tmpl:0,params:"~thread=#data ~instantActionLink=false link=false",props:{link:!1},ctx:{thread:n,instantActionLink:!1},args:[]}]},paths:[],_ctxs:"instantActionsControl"},{fn:function(){return[{tmpl:0,params:"",props:{},args:[]}]},paths:[],_ctxs:"instantActionsBurntControl"},{fn:function(n,t){return{params:"~tag.CategoriesForLabel",props:{},args:[t.hlp("tag").CategoriesForLabel]}},paths:["~tag.CategoriesForLabel"],_ctxs:">"},{fn:function(n,t){return{params:"~tag.FolderName",props:{},args:[t.hlp("tag").FolderName]}},paths:["~tag.FolderName"],_ctxs:">"},{fn:function(n){return{params:"DateReceivedLocal",props:{},args:[n.DateReceivedLocal]}},paths:["DateReceivedLocal"],_ctxs:":"},{fn:function(n){return{params:"SubjectWithHtml",props:{},args:[n.SubjectWithHtml]}},paths:["SubjectWithHtml"],_ctxs:":"}],_is:"template",allowCode:!0,tmplName:"messageRowTemplate",htmlTag:"li",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,o=i._tag,e=i._cnvt,u="";return u+="  ",u+='  <li id="',u+=(f=t.hlp("tag").ControlNamespace)!=r?f:"",u+='" class="',u+=(f=t.hlp("tag").MessageRowClass)!=r?f:"",u+='" data-link="class{:~tag.MessageRowClass}" ',u+=(f=t.hlp("sutra")("Hotmail.Message"))!=r?f:"",u+=">    ",u+="    ",t.hlp("tag").layout.ReadingPaneMode===HM.ReadingPaneLocation.Right&&(u+='    <span class="Ck" name="mCC">      <div class="CkWrapper">        <input tabindex="',u+=e("getTabIndex",t,{params:"~tag.Focused",props:{},args:[t.hlp("tag").Focused]}),u+='" type="checkbox" name="mCk" class="mlCheckbox" ',u+=(f=t.hlp("sutra")("Checkbox"))!=r?f:"",u+=' data-link="{:~tag.Checked} tabindex{getTabIndex:~tag.Focused} aria-label{:~tag.AriaLabel}"/><label><\/label>      <\/div>    <\/span>    <span class="Hd">      <div class="Fm">        ',t.hlp("sortBy")!==HM.SortBy.Size?(u+="        <div ",u+=(f=t.hlp("sutra")("Date"))!=r?f:"",u+=' class="DtB">          <a class="t_qtc">',u+=e("",t,1),u+="<\/a>        <\/div>        "):(u+="        <div ",u+=(f=t.hlp("sutra")("Size"))!=r?f:"",u+=' class="SzB">          <a>',u+=(f=n.MessageSizeString)!=r?f:"",u+="<\/a>        <\/div>        "),u+="        <div ",u+=(f=t.hlp("sutra")("Senders"))!=r?f:"",u+=' class="FmB">          <span class="FmS">            ',n.IsTrustedSender&&(u+="            <img ",u+=(f=t.hlp("sutra")("TrustedSenderIcon"))!=r?f:"",u+=' class="i_ts" src="./clear.gif" alt="',u+=(f=t.hlp("ol").GetString("MessageList.Icons.TrustedSender.AltText"))!=r?f:"",u+='" title="',u+=(f=t.hlp("ol").GetString("MessageList.Icons.TrustedSender.AltText"))!=r?f:"",u+='"/>            '),u+='            <span class="',u+=e("getClassesForSenderInfos",t,{params:"IsRead",props:{},args:[n.IsRead]}),u+='" data-link="class{getClassesForSenderInfos:IsRead}">',u+=e("",t,2),u+='<\/span>          <\/span>        <\/div>      <\/div>      <div class="Sb">        <div class="FgB">          ',ol.config.appSettings.IsInstantActionsEnabled&&ol.config.instantActionsSettings&&(u+="            ",ol.config.appSettings.ShouldUseFloatingInstantActions?(u+="                ",u+=o("instantActionsBurntControl",t,this,4),u+="            "):(u+='              <span class="Ia">                ',u+=o("instantActionsControl",t,this,3),u+="              <\/span>            "),u+="          "),u+="          ",u+=o("if",t,this,5),u+="          ",(t.hlp("tag").evalHasAttachments(n.ExtendedType,n.HasAttachments)||n.Count==1&&n.IsVoicemailOnPhone)&&(u+='          <span class="At">            ',t.hlp("tag").evalHasAttachments(n.ExtendedType,n.HasAttachments)&&(u+='            <img src="./clear.gif" class="i_att_s" alt="',u+=(f=t.hlp("ol").GetString("MessageList.Icons.Attachment.AltText"))!=r?f:"",u+='" ',u+=(f=t.hlp("sutra")("AttachmentIcon"))!=r?f:"",u+=" />            "),u+="            ",n.Count==1&&n.IsVoicemailOnPhone&&(u+='            <img src="./clear.gif" class="i_voicemail_s" alt="',u+=(f=t.hlp("ol").GetString("MessageList.Icons.VoicemailOnPhone.AltText"))!=r?f:"",u+='" />            '),u+="          <\/span>          "),u+="          ",(n.Importance===HM.ImportanceType.HIGH||n.Importance===HM.ImportanceType.LOW)&&(u+='          <div class="Im">            ',n.Importance===HM.ImportanceType.HIGH&&(u+='            <img src="./clear.gif" class="i_imp_hi_s" alt="',u+=(f=t.hlp("ol").GetString("MessageList.Icons.HighPri.AltText"))!=r?f:"",u+='" ',u+=(f=t.hlp("sutra")("HighImportanceIcon"))!=r?f:"",u+=" />            "),u+="            ",n.Importance===HM.ImportanceType.LOW&&(u+='            <img src="./clear.gif" class="i_imp_lo_s" alt="',u+=(f=t.hlp("ol").GetString("MessageList.Icons.LowPri.AltText"))!=r?f:"",u+='" ',u+=(f=t.hlp("sutra")("LowImportanceIcon"))!=r?f:"",u+=" />            "),u+="          <\/div>          "),u+="          ",ol.GetUserConfig("ConversationThreading")&&(u+='          <span class="Ct">            ',u+=o("if",t,this,6),u+="          <\/span>          "),u+="        <\/div>        <div ",u+=(f=t.hlp("sutra")("Subject"))!=r?f:"",u+=' class="SbB">          <a href="#" tabindex="-1" class="',u+=e("getClassesForSubject",t,{params:"IsRead",props:{},args:[n.IsRead]}),u+='" data-link="class{getClassesForSubject:IsRead}">            ',u+=e("",t,7),u+=(f=t.hlp("ol").GetAppConfig("BiDiEntityMark"))!=r?f:"",u+="          <\/a>        <\/div>      <\/div>    <\/span>    "),u+="    ",u+="    ",t.hlp("tag").layout.ReadingPaneMode!==HM.ReadingPaneLocation.Right&&(u+='    <span class="Ck" name="mCC">      <input tabindex="',u+=e("getTabIndex",t,{params:"~tag.Focused",props:{},args:[t.hlp("tag").Focused]}),u+='" ',u+=(f=t.hlp("sutra")("Checkbox"))!=r?f:"",u+=' class="mlCheckbox" type="checkbox" name="mCk" data-link="{:~tag.Checked} tabindex{getTabIndex:~tag.Focused} aria-label{:~tag.AriaLabel}"/><label><\/label>    <\/span>    <span class="Lt">      <span ',u+=(f=t.hlp("sutra")("Senders"))!=r?f:"",u+=' class="Fm">        <div class="FmD">          ',n.IsTrustedSender&&(u+="          <img ",u+=(f=t.hlp("sutra")("TrustedSenderIcon"))!=r?f:"",u+=' class="i_ts" src="./clear.gif" alt="',u+=(f=t.hlp("ol").GetString("MessageList.Icons.TrustedSender.AltText"))!=r?f:"",u+='" title="',u+=(f=t.hlp("ol").GetString("MessageList.Icons.TrustedSender.AltText"))!=r?f:"",u+='"/>          '),u+='          <span class="',u+=e("getClassesForSenderInfos",t,{params:"IsRead",props:{},args:[n.IsRead]}),u+='" data-link="class{getClassesForSenderInfos:IsRead}">',u+=e("",t,8),u+="<\/span>        <\/div>      <\/span>      ",u+="      ",t.hlp("tag").isSearchResults(n.QueryContainerId)||(u+='      <span class="Ct">        ',u+=o("if",t,this,9),u+="      <\/span>      "),u+='      <span class="Io">        <img src="./clear.gif" class="',u+=(f=t.hlp("tag").StatusImageClass)!=r?f:"",u+='" alt="',u+=(f=t.hlp("tag").StatusImageAltText)!=r?f:"",u+='" ',u+=(f=t.hlp("sutra")("Status"))!=r?f:"",u+='             data-link="class{:~tag.StatusImageClass} alt{:~tag.StatusImageAltText}"/>      <\/span>      ',ol.config.appSettings.IsInstantActionsEnabled&&ol.config.instantActionsSettings&&(u+="        ",ol.config.appSettings.ShouldUseFloatingInstantActions?(u+="            ",u+=o("instantActionsBurntControl",t,this,11),u+="        "):(u+='          <span class="Ia">            ',u+=o("instantActionsControl",t,this,10),u+="          <\/span>        "),u+="      "),u+='    <\/span>    <span class="Rt">      ',ol.GetUserConfig("IsCategoryColumnEnabled")&&(u+='      <span class="Cg">        <span aid="tCg" class="',u+=(f=t.hlp("tag").CategoryClass)!=r?f:"",u+='" title="',u+=e("attr",t,{params:"~tag.CategoriesForTooltip",props:{},args:[t.hlp("tag").CategoriesForTooltip]}),u+='"           data-link="class{:~tag.CategoryClass} title{:~tag.CategoriesForTooltip}" ',u+=(f=t.hlp("sutra")("MessageCategories"))!=r?f:"",u+=">          ",u+=e("html",t,12),u+="        <\/span>      <\/span>      "),u+="      ",t.hlp("tag").isSearchResults(n.QueryContainerId)&&(u+="      <span ",u+=(f=t.hlp("sutra")("FolderName"))!=r?f:"",u+=' class="Fol">          ',u+=e("html",t,13),u+="      <\/span>      "),u+='      <span class="At">        ',n.Importance===HM.ImportanceType.HIGH&&(u+='        <img src="./clear.gif" class="i_imp_hi_s" alt="',u+=(f=t.hlp("ol").GetString("MessageList.Icons.HighPri.AltText"))!=r?f:"",u+='" ',u+=(f=t.hlp("sutra")("HighImportanceIcon"))!=r?f:"",u+=" />        "),u+="        ",n.Importance===HM.ImportanceType.LOW&&(u+='        <img src="./clear.gif" class="i_imp_lo_s" alt="',u+=(f=t.hlp("ol").GetString("MessageList.Icons.LowPri.AltText"))!=r?f:"",u+='" ',u+=(f=t.hlp("sutra")("LowImportanceIcon"))!=r?f:"",u+=" />        "),u+="        ",t.hlp("tag").evalHasAttachments(n.ExtendedType,n.HasAttachments)&&(u+='        <img src="./clear.gif" class="i_att_s" alt="',u+=(f=t.hlp("ol").GetString("MessageList.Icons.Attachment.AltText"))!=r?f:"",u+='" ',u+=(f=t.hlp("sutra")("AttachmentIcon"))!=r?f:"",u+=" />        "),u+="        ",n.Count==1&&n.IsVoicemailOnPhone&&(u+='        <img src="./clear.gif" class="i_voicemail_s" alt="',u+=(f=t.hlp("ol").GetString("MessageList.Icons.VoicemailOnPhone.AltText"))!=r?f:"",u+='" />        '),u+="      <\/span>      ",t.hlp("sortBy")!==HM.SortBy.Size?(u+="      <span ",u+=(f=t.hlp("sutra")("Date"))!=r?f:"",u+=' class="Dt">        ',u+=e("",t,14),u+="      <\/span>      "):(u+="      <span ",u+=(f=t.hlp("sutra")("Size"))!=r?f:"",u+=' class="Sz">        ',u+=(f=n.MessageSizeString)!=r?f:"",u+="      <\/span>      "),u+='    <\/span>    <span class="Sb">      <a href="#" tabindex="-1" ',u+=(f=t.hlp("sutra")("Subject"))!=r?f:"",u+=' class="',u+=e("getClassesForSubject",t,{params:"IsRead",props:{},args:[n.IsRead]}),u+='" data-link="class{getClassesForSubject:IsRead}">        ',u+=e("",t,15),u+=(f=t.hlp("ol").GetAppConfig("BiDiEntityMark"))!=r?f:"",u+="      <\/a>    <\/span>    "),u+"  <\/li>"}}},n["#pageFooterTemplate"]={tmpls:[{tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"li",tmplName:"pageFooterTemplate/if",fn:{fn:function(n,t,i,r){var i=i||jsviews,e,f=i._cnvt,u="";return u+="            <li>                <a ",u+=(e=t.hlp("tabindexForRegion")("pageFooter"))!=r?e:"",u+=' target="_top" href="',u+=f("attr",t,{params:"~ol.config.pageFooter.CobrandLinkUrl",props:{},args:[t.hlp("ol").config.pageFooter.CobrandLinkUrl]}),u+='">                  <img src="',u+=f("attr",t,{params:"~ol.config.pageFooter.CobrandImageUrl",props:{},args:[t.hlp("ol").config.pageFooter.CobrandImageUrl]}),u+='" alt="',u+=f("attr",t,{params:"~ol.config.pageFooter.CobrandImageAltText",props:{},args:[t.hlp("ol").config.pageFooter.CobrandImageAltText]}),u+'"/>                <\/a>              <\/li>              '}}},{tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"li",tmplName:"pageFooterTemplate/if",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._cnvt,u="";return u+="              <li>                <a ",u+=(f=t.hlp("tabindexForRegion")("pageFooter"))!=r?f:"",u+=' id="uxp_ftr_link_intl1" target="',u+=e("attr",t,{params:"~ol.config.pageFooter.LinksTarget",props:{},args:[t.hlp("ol").config.pageFooter.LinksTarget]}),u+='" href="',u+=e("attr",t,{params:"~ol.config.pageFooter.Intl1Url",props:{},args:[t.hlp("ol").config.pageFooter.Intl1Url]}),u+='">                  ',u+=(f=t.hlp("ol").GetString("Live.Shared.MarketInfo.Footer.Links.Intl1.Label"))!=r?f:"",u+"                <\/a>              <\/li>              "}}},{tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"li",tmplName:"pageFooterTemplate/if",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._cnvt,u="";return u+="              <li>                <a ",u+=(f=t.hlp("tabindexForRegion")("pageFooter"))!=r?f:"",u+=' id="uxp_ftr_link_developers" target="',u+=e("attr",t,{params:"~ol.config.pageFooter.LinksTarget",props:{},args:[t.hlp("ol").config.pageFooter.LinksTarget]}),u+='" href="',u+=e("attr",t,{params:"~ol.config.pageFooter.DevUrl",props:{},args:[t.hlp("ol").config.pageFooter.DevUrl]}),u+='">                  ',u+=(f=t.hlp("ol").GetString("Live.Shared.Strings.Footer.Links.Developers.Label"))!=r?f:"",u+"                <\/a>              <\/li>              "}}},{tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"li",tmplName:"pageFooterTemplate/if",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._cnvt,o=i.converters.html,u="";return u+="              <li>                <a ",u+=(f=t.hlp("tabindexForRegion")("pageFooter"))!=r?f:"",u+=' id="uxp_ftr_link_custom3" target="',u+=e("attr",t,{params:"~ol.config.pageFooter.LinksTarget",props:{},args:[t.hlp("ol").config.pageFooter.LinksTarget]}),u+='" href="',u+=e("attr",t,{params:"~ol.config.pageFooter.CobrandLink1Url",props:{},args:[t.hlp("ol").config.pageFooter.CobrandLink1Url]}),u+='">                  ',u+=o(t.hlp("ol").config.pageFooter.CoBrandLink1),u+"                <\/a>              <\/li>              "}}},{tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"li",tmplName:"pageFooterTemplate/if",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._cnvt,o=i.converters.html,u="";return u+="              <li>                <a ",u+=(f=t.hlp("tabindexForRegion")("pageFooter"))!=r?f:"",u+=' id="uxp_ftr_link_custom4" target="',u+=e("attr",t,{params:"~ol.config.pageFooter.LinksTarget",props:{},args:[t.hlp("ol").config.pageFooter.LinksTarget]}),u+='" href="',u+=e("attr",t,{params:"~ol.config.pageFooter.CobrandLink2Url",props:{},args:[t.hlp("ol").config.pageFooter.CobrandLink2Url]}),u+='">                  ',u+=o(t.hlp("ol").config.pageFooter.CobrandLink2),u+"                <\/a>              <\/li>              "}}},{tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"li",tmplName:"pageFooterTemplate/if",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._cnvt,o=i.converters.html,u="";return u+="              <li>                <a ",u+=(f=t.hlp("tabindexForRegion")("pageFooter"))!=r?f:"",u+=' id="uxp_ftr_link_abuse" target="',u+=e("attr",t,{params:"~ol.config.pageFooter.LinksTarget",props:{},args:[t.hlp("ol").config.pageFooter.LinksTarget]}),u+='" href="',u+=e("attr",t,{params:"~ol.config.pageFooter.ReportAbuseUrl",props:{},args:[t.hlp("ol").config.pageFooter.ReportAbuseUrl]}),u+='">                  ',u+=o(t.hlp("ol").GetString("Live.Shared.Strings.Footer.Links.ReportAbuse.Label")),u+"                <\/a>              <\/li>              "}}},{tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"li",tmplName:"pageFooterTemplate/if",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._cnvt,o=i.converters.html,u="";return u+="              <li>                <a ",u+=(f=t.hlp("tabindexForRegion")("pageFooter"))!=r?f:"",u+=' id="uxp_ftr_link_mobile" href="',u+=e("attr",t,{params:"~ol.config.pageFooter.MobileSiteLink",props:{},args:[t.hlp("ol").config.pageFooter.MobileSiteLink]}),u+='" onclick="',u+=e("attr",t,{params:"~ol.config.pageFooter.MobileAttr",props:{},args:[t.hlp("ol").config.pageFooter.MobileAttr]}),u+='">                  ',u+=o(t.hlp("ol").GetString("Live.Shared.Strings.Footer.Links.MobileView.Label")),u+"                <\/a>              <\/li>              "}}},{tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"li",tmplName:"pageFooterTemplate/if",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._cnvt,o=i.converters.html,u="";return u+="              <li>                ",u+="                <a ",u+=(f=t.hlp("tabindexForRegion")("pageFooter"))!=r?f:"",u+=' target="',u+=e("attr",t,{params:"~ol.config.pageFooter.LinksTarget",props:{},args:[t.hlp("ol").config.pageFooter.LinksTarget]}),u+='" href="',u+=e("attr",t,{params:"~ol.config.pageFooter.LanguageLinkUrl",props:{},args:[t.hlp("ol").config.pageFooter.LanguageLinkUrl]}),u+='">                  ',u+=o(t.hlp("ol").config.pageFooter.LanguageLinkText),u+"                <\/a>              <\/li>              "}}},{tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"li",tmplName:"pageFooterTemplate/if",fn:{fn:function(n,t,i){var i=i||jsviews,u=i.converters.html,r="";return r+='              <li>                <span class="TextBold" id="uxp_ftr_link_msc">                  ',r+=u(t.hlp("ol").config.pageFooter.MSConfidentialLinkText),r+"                <\/span>              <\/li>              "}}},{tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"li",tmplName:"pageFooterTemplate/if",fn:{fn:function(n,t,i,r){var i=i||jsviews,e,f=i._cnvt,o=i.converters.html,u="";return u+='              <li class="right">                <a ',u+=(e=t.hlp("tabindexForRegion")("pageFooter"))!=r?e:"",u+=' id="uxp_ftr_link_custom_link_1" target="',u+=f("attr",t,{params:"~ol.config.pageFooter.LinksTarget",props:{},args:[t.hlp("ol").config.pageFooter.LinksTarget]}),u+='" onclick="',u+=f("attr",t,{params:"~tag.generateCustomLinkOnClick()",props:{},args:[t.hlp("tag").generateCustomLinkOnClick()]}),u+='" href="',u+=f("attr",t,{params:"~ol.config.pageFooter.CustomLink1Url",props:{},args:[t.hlp("ol").config.pageFooter.CustomLink1Url]}),u+='">                  ',u+=o(t.hlp("ol").config.pageFooter.CustomLink1Label),u+"                <\/a>              <\/li>              "}}}],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,tmplName:"pageFooterTemplate",htmlTag:"div",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._tag,o=i._cnvt,u="";return u+='  <div class="c-PageFooter Unselectable" ',u+=(f=t.hlp("sutra")("Hotmail.FooterContainer"))!=r?f:"",u+='>    <table cellpadding="0" cellspacing="0" class="uxp_ftr_control t_fbgc">      <tbody>        <tr>          <td class="uxp_ftr_left t_lnksi">            <ul>              ',u+=e("if",t,this,[{tmpl:1,params:"(~ol.config.pageFooter.CobrandImageUrl && ~ol.config.pageFooter.CobrandImageUrl.length > 0) ",props:{},args:[t.hlp("ol").config.pageFooter.CobrandImageUrl&&t.hlp("ol").config.pageFooter.CobrandImageUrl.length>0]}]),u+='              <li>                <span id="uxp_ftr_link_trademark">                  ',u+=(f=t.hlp("tag").generateTrademark())!=r?f:"",u+="                <\/span>              <\/li>              <li>                <a ",u+=(f=t.hlp("tabindexForRegion")("pageFooter"))!=r?f:"",u+=' id="uxp_ftr_link_legal" target="',u+=o("attr",t,{params:"~ol.config.pageFooter.LinksTarget",props:{},args:[t.hlp("ol").config.pageFooter.LinksTarget]}),u+='" href="',u+=o("attr",t,{params:"~ol.config.pageFooter.LegalLinkUrl",props:{},args:[t.hlp("ol").config.pageFooter.LegalLinkUrl]}),u+='">                  ',u+=(f=t.hlp("ol").GetString("Live.Shared.Strings.Footer.Links.Legal.Label"))!=r?f:"",u+="                <\/a>              <\/li>              <li>                <a ",u+=(f=t.hlp("tabindexForRegion")("pageFooter"))!=r?f:"",u+=' id="uxp_ftr_link_privacy" target="',u+=o("attr",t,{params:"~ol.config.pageFooter.LinksTarget",props:{},args:[t.hlp("ol").config.pageFooter.LinksTarget]}),u+='" href="',u+=o("attr",t,{params:"~ol.config.pageFooter.PrivacyUrl",props:{},args:[t.hlp("ol").config.pageFooter.PrivacyUrl]}),u+='">                  ',u+=(f=t.hlp("ol").config.pageFooter.PrivacyLink)!=r?f:"",u+="                <\/a>              <\/li>              ",u+=e("if",t,this,[{tmpl:2,params:"~ol.config.pageFooter.ShowIntlLink1 ",props:{},args:[t.hlp("ol").config.pageFooter.ShowIntlLink1]}]),u+="              ",u+=e("if",t,this,[{tmpl:3,params:"~ol.config.pageFooter.ShowDevelopersLink ",props:{},args:[t.hlp("ol").config.pageFooter.ShowDevelopersLink]}]),u+="              ",u+=e("if",t,this,[{tmpl:4,params:"~ol.config.pageFooter.CobrandLink1Display ",props:{},args:[t.hlp("ol").config.pageFooter.CobrandLink1Display]}]),u+="              ",u+=e("if",t,this,[{tmpl:5,params:"~ol.config.pageFooter.CobrandLink2Display ",props:{},args:[t.hlp("ol").config.pageFooter.CobrandLink2Display]}]),u+="              ",u+=e("if",t,this,[{tmpl:6,params:"~ol.config.pageFooter.ShowReportAbuseLink ",props:{},args:[t.hlp("ol").config.pageFooter.ShowReportAbuseLink]}]),u+="              ",u+=e("if",t,this,[{tmpl:7,params:"~ol.config.pageFooter.IsMobileDevice ",props:{},args:[t.hlp("ol").config.pageFooter.IsMobileDevice]}]),u+="              ",u+=e("if",t,this,[{tmpl:8,params:"~ol.config.pageFooter.ShowLanguageLink ",props:{},args:[t.hlp("ol").config.pageFooter.ShowLanguageLink]}]),u+="              ",u+=e("if",t,this,[{tmpl:9,params:"~ol.config.pageFooter.MSConfidentialLinkText ",props:{},args:[t.hlp("ol").config.pageFooter.MSConfidentialLinkText]}]),u+="              ",u+=e("if",t,this,[{tmpl:10,params:"~ol.config.pageFooter.CustomLink1Display ",props:{},args:[t.hlp("ol").config.pageFooter.CustomLink1Display]}]),u+"            <\/ul>          <\/td>        <\/tr>      <\/tbody>    <\/table>  <\/div>"}}},n["#rightRailTemplate"]={tmpls:[{tmpls:[{tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"div",tmplName:"rightRailTemplate/if/if",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,u="";return u+='    <div id="RadAd_Skyscraper" ',u+=(f=t.hlp("sutra")("Adbar"))!=r?f:"",u+=' class="',u+=(f=t.hlp("tag").getAdClass())!=r?f:"",u+' RightRailContent">      <div id="adbarContainer">      <\/div>    <\/div>    '}}},{tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"div",tmplName:"rightRailTemplate/if/if",fn:{fn:function(n,t,i){var i=i||jsviews;return'    <div id="PeoplePaneContainer" class="RightRailContent">    <\/div>    '}}}],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"div",tmplName:"rightRailTemplate/if",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._tag,u="";return u+='  <div id="RightRailContainer" ',u+=(f=t.hlp("sutra")("RightRailContainer"))!=r?f:"",u+=' class="',u+=(f=t.hlp("tag").getRightRailContainerClass())!=r?f:"",u+='">    ',u+=e("if",t,this,[{tmpl:1,params:"~ol.config.adbar.renderAd ",props:{},args:[t.hlp("ol").config.adbar.renderAd]}]),u+="    ",u+=e("if",t,this,[{tmpl:2,params:"~ol.config.socialInbox.enabled ",props:{},args:[t.hlp("ol").config.socialInbox.enabled]}]),u+"  <\/div>  "}}}],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,tmplName:"rightRailTemplate",htmlTag:"div",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+="  ",r+=u("if",t,this,[{tmpl:1,params:"~ol.config.adbar.renderAd || ~ol.config.socialInbox.enabled ",props:{},args:[t.hlp("ol").config.adbar.renderAd||t.hlp("ol").config.socialInbox.enabled]}]),r+""}}},n["#searchBoxTemplate"]={tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,tmplName:"searchBoxTemplate",htmlTag:"div",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,u="";return u+='  <div class="contentSearchBox"><span class="SearchBox" ',u+=(f=t.hlp("sutra")("searchbox"))!=r?f:"",u+=">",u+=(f=t.hlp("ol").config.search.searchBox)!=r?f:"",u+"<\/span><\/div>"}}},n["#sizerBarTemplate"]={tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,tmplName:"sizerBarTemplate",htmlTag:"div",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._cnvt,u="";return u+='    <div class="',u+=e("getSizerBarClass",t,{params:"~tag.isVertical 'c-SizerBar' ~tag.key ~tag.layout.IsFullView",props:{},args:[t.hlp("tag").isVertical,"c-SizerBar",t.hlp("tag").key,t.hlp("tag").layout.IsFullView]}),u+='" ',u+=(f=t.hlp("sutra")(t.hlp("tag").sutra))!=r?f:"",u+='         style="',u+=(f=t.hlp("tag").getSizerBarStyle(t.hlp("tag").isVertical,t.hlp("tag").isDockingReversed,t.hlp("tag").tagCtx.props.distance))!=r?f:"",u+'"         data-link="class{getSizerBarClass:~tag.isVertical \'c-SizerBar\' ~tag.key ~tag.layout.IsFullView}"><\/div>'}}},n["#inboxPageTemplate"]={tmpls:[],links:{},tags:{},bnds:[{fn:function(n){return[{tmpl:0,params:"inbox=#data ~layout=Layout ~categoryList=CategoryList ~folderList=FolderList ~search=Search ~readMessage=ReadMessage ~rightRail=RightRail ~messageList=MessageList",props:{inbox:n},ctx:{layout:n.Layout,categoryList:n.CategoryList,folderList:n.FolderList,search:n.Search,readMessage:n.ReadMessage,rightRail:n.RightRail,messageList:n.MessageList},args:[]}]},paths:["#data"],_ctxs:"inboxControl"}],_is:"template",allowCode:!0,tmplName:"inboxPageTemplate",htmlTag:"",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+="    ",r+=u("inboxControl",t,this,1),r+""}}},n["#containerPickerTemplate"]={tmpls:[{tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"ul",tmplName:"containerPickerTemplate/if",fn:{fn:function(n,t,i){var i=i||jsviews,r="";return r+='      <ul class="c_m">        <li>          <span class="c_ld cp_hint t_m_bor">            <span>              ',r+"            <\/span>          <\/span>        <\/li>      <\/ul>    "}}},{tmpls:[],links:{},tags:{},bnds:[{fn:function(n){return[{tmpl:0,params:"data=#data",props:{data:n},args:[]}]},paths:["#data"],_ctxs:"containerPickerItemControl"}],_is:"template",allowCode:!0,htmlTag:"",tmplName:"containerPickerTemplate/for",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+="          ",r+=u("containerPickerItemControl",t,this,1),r+"        "}}},{tmpls:[],links:{},tags:{},bnds:[{fn:function(n){return[{tmpl:0,params:"data=EditingContainer",props:{data:n.EditingContainer},args:[]}]},paths:["EditingContainer"],_ctxs:"containerPickerItemControl"}],_is:"template",allowCode:!0,htmlTag:"",tmplName:"containerPickerTemplate/if",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+="        ",r+=u("containerPickerItemControl",t,this,1),r+"      "}}},{tmpls:[{tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"li",tmplName:"containerPickerTemplate/if/if",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,u="";return u+='          <li><a href="#" class="cp_addNew" ',u+=(f=t.hlp("sutra")("NewCategory"))!=r?f:"",u+=">",u+=(f=n.ContainerList.NewItemLabel)!=r?f:"",u+"<\/a><\/li>        "}}},{tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"li",tmplName:"containerPickerTemplate/if/else",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,u="";return u+='          <li><a href="#" class="cp_addNew" ',u+=(f=t.hlp("sutra")("FolderListNewFolder"))!=r?f:"",u+=">",u+=(f=n.ContainerList.NewItemLabel)!=r?f:"",u+"<\/a><\/li>        "}}}],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"li",tmplName:"containerPickerTemplate/if",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+="        ",r+=u("if",t,this,[{tmpl:1,params:"ContainerList.Type === ~HM.ContainerType.Categories",props:{},args:[n.ContainerList.Type===t.hlp("HM").ContainerType.Categories]},{tmpl:2,params:"ContainerList.Type === ~HM.ContainerType.Folders",props:{},args:[n.ContainerList.Type===t.hlp("HM").ContainerType.Folders]}]),r+"      "}}},{tmpls:[],links:{},tags:{},bnds:[{fn:function(n){return[{tmpl:0,params:"#data tmpl=Template",props:{tmpl:n.Template},args:[n]}]},paths:["#data","Template"],_ctxs:"for"}],_is:"template",allowCode:!0,htmlTag:"",tmplName:"containerPickerTemplate/for",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+="        ",r+=u("for",t,this,1),r+"      "}}}],links:{},tags:{},bnds:[{fn:function(n){return[{tmpl:1,params:"CPTitle",props:{},args:[n.CPTitle]}]},paths:["CPTitle"],_ctxs:"if"},{fn:function(n){return[{tmpl:2,params:"ContainerList.RootContainer.Items",props:{},args:[n.ContainerList.RootContainer.Items]}]},paths:["ContainerList.RootContainer.Items"],_ctxs:"for"},{fn:function(n){return[{tmpl:3,params:"EditingContainer",props:{},args:[n.EditingContainer]}]},paths:["EditingContainer"],_ctxs:"if"},{fn:function(n){return[{tmpl:5,params:"Actions",props:{},args:[n.Actions]}]},paths:["Actions"],_ctxs:"for"}],_is:"template",allowCode:!0,tmplName:"containerPickerTemplate",htmlTag:"li",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._tag,u="";return u+='  <li class="t_mbgc t_atc" ',u+=(f=t.hlp("sutra")(n.MenuTag))!=r?f:"",u+=">    ",u+=e("if",t,this,1),u+='    <div class="cp_list sc" ',u+=(f=t.hlp("sutra")("MenuList"))!=r?f:"",u+='>      <ul class="t_hovl c_m" ',u+=(f=t.hlp("sutra")(n.ItemsTag))!=r?f:"",u+=">        ",u+=e("for",t,this,[{tmpl:0,params:"#data tmpl=ClearSelectionItemTemplate",props:{tmpl:n.ClearSelectionItemTemplate},args:[n]}]),u+="        ",u+=e("for",t,this,2),u+='      <\/ul>    <\/div>    <ul class="',u+=(f=t.hlp("tag").getEditingContainerClass(n.EditingContainer,n.Actions))!=r?f:"",u+='" data-link="class{:~tag.getEditingContainerClass(EditingContainer, Actions)}" ',u+=(f=t.hlp("sutra")("Actions"))!=r?f:"",u+=">      ",u+=e("if",t,this,3),u+="      ",u+=e("if",t,this,[{tmpl:4,params:"ContainerList.NewItemLabel",props:{},args:[n.ContainerList.NewItemLabel]}]),u+="      ",u+=e("for",t,this,4),u+"    <\/ul>  <\/li>"}}},n["#containerPickerActionLinkTemplate"]={tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,tmplName:"containerPickerActionLinkTemplate",htmlTag:"li",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,u="";return u+='  <li class="',u+=(f=n.CssClass)!=r?f:"",u+='" data-link="class{:CssClass}">    <a ',u+=(f=t.hlp("idTag")(n.Id))!=r?f:"",u+=" ",u+=(f=t.hlp("sutra")(n.SutraTag))!=r?f:"",u+=' href="#" class="LinkColor" title="',u+=(f=n.Title)!=r?f:"",u+='">      <span>',u+=(f=n.Text)!=r?f:"",u+"<\/span>    <\/a>  <\/li>"}}},n["#containerPickerActionButtonTemplate"]={tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,tmplName:"containerPickerActionButtonTemplate",htmlTag:"li",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,u="";return u+='  <li class="',u+=(f=n.CssClass)!=r?f:"",u+='" data-link="class{:CssClass}">    <input ',u+=(f=t.hlp("idTag")(n.Id))!=r?f:"",u+=" ",u+=(f=t.hlp("sutra")(n.SutraTag))!=r?f:"",u+=' type="button" class="default" value="',u+=(f=n.Text)!=r?f:"",u+'"><\/input>  <\/li>'}}},n["#containerPickerItemTemplate"]={tmpls:[{tmpls:[{tmpls:[{tmpls:[],links:{},tags:{},bnds:[{fn:function(n,t){return{params:"SelectionState ~tag.menuType IsEditing",props:{},args:[n.SelectionState,t.hlp("tag").menuType,n.IsEditing]}},paths:["SelectionState","~tag.menuType","IsEditing"],_ctxs:"getCheckHtml:"}],_is:"template",allowCode:!0,htmlTag:"",tmplName:"containerPickerItemTemplate/if/if/if",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._cnvt,r="";return r+="          ",r+=u("getCheckHtml",t,1),r+"          "}}},{tmpls:[],links:{},tags:{},bnds:[{fn:function(n){return{params:"Name",props:{},args:[n.Name]}},paths:["Name"],_ctxs:">"}],_is:"template",allowCode:!0,htmlTag:"",tmplName:"containerPickerItemTemplate/if/if/if",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._cnvt,r="";return r+="            ",r+=u("html",t,1),r+"          "}}},{tmpls:[],links:{},tags:{},bnds:[{fn:function(n,t){return[{tmpl:0,params:'~errorId=~tag.ErrorId ~errorProperty="Error" ~data=#data ~textProperty="Name" ~pendingProperty="IsPending" ~editingProperty="IsEditing" ~handleFocusOut=false ~maxlength=~ol.vm.Container.getMaxNameLength(#data)',props:{},ctx:{errorId:t.hlp("tag").ErrorId,errorProperty:"Error",data:n,textProperty:"Name",pendingProperty:"IsPending",editingProperty:"IsEditing",handleFocusOut:!1,maxlength:t.hlp("ol").vm.Container.getMaxNameLength(n)},args:[]}]},paths:[],_ctxs:"editableLabelControl"}],_is:"template",allowCode:!0,htmlTag:"",tmplName:"containerPickerItemTemplate/if/if/else",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+="            ",r+=u("editableLabelControl",t,this,1),r+"          "}}}],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"li",tmplName:"containerPickerItemTemplate/if/if",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,o=i._tag,e=i._cnvt,s=i.converters.html,u="";return u+="      <li ",u+=(f=t.hlp("sutra")(t.hlp("tag").itemTag()))!=r?f:"",u+=' class="',u+=e("getClasses",t,{params:"SelectionState",props:{},args:[n.SelectionState]}),u+='" data-link="class{getClasses:SelectionState}">        <div id="',u+=(f=t.hlp("tag").ErrorId)!=r?f:"",u+='" ',u+=(f=t.hlp("sutra")("InlineError"))!=r?f:"",u+=' aria-live="assertive" class="editableLabel error DisplayNone"><\/div>        <a ',u+=(f=t.hlp("sutra")("Hotmail.Link"))!=r?f:"",u+=' href="#" class="',u+=e("getMenuItemClasses",t,{params:"IsEditing",props:{},args:[n.IsEditing]}),u+='" title="',u+=s(n.Name),u+='" style="',u+=e("getPadding",t,{params:"Depth",props:{},args:[n.Depth]}),u+='" data-link="class{getMenuItemClasses:IsEditing} style{getPadding:Depth}">          ',u+=o("if",t,this,[{tmpl:1,params:"~tag.showSelectionState",props:{},args:[t.hlp("tag").showSelectionState]}]),u+="          ",u+=o("if",t,this,[{tmpl:2,params:"!IsEditing",props:{},args:[!n.IsEditing]},{tmpl:3,params:"",props:{},args:[]}]),u+"        <\/a>      <\/li>    "}}},{tmpls:[{tmpls:[],links:{},tags:{},bnds:[{fn:function(n){return[{tmpl:0,params:"data=#data",props:{data:n},args:[]}]},paths:["#data"],_ctxs:"containerPickerItemControl"}],_is:"template",allowCode:!0,htmlTag:"",tmplName:"containerPickerItemTemplate/if/if/for",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+="        ",r+=u("containerPickerItemControl",t,this,1),r+"      "}}}],links:{},tags:{},bnds:[{fn:function(n){return[{tmpl:1,params:"Items",props:{},args:[n.Items]}]},paths:["Items"],_ctxs:"for"}],_is:"template",allowCode:!0,htmlTag:"",tmplName:"containerPickerItemTemplate/if/if",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+="      ",r+=u("for",t,this,1),r+"    "}}}],links:{},tags:{},bnds:[{fn:function(n){return[{tmpl:1,params:"Depth > 0",props:{},args:[n.Depth>0]}]},paths:["Depth"],_ctxs:"if"},{fn:function(n){return[{tmpl:2,params:"Items.length > 0",props:{},args:[n.Items.length>0]}]},paths:["Items.length"],_ctxs:"if"}],_is:"template",allowCode:!0,htmlTag:"li",tmplName:"containerPickerItemTemplate/if",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+="    ",r+=u("if",t,this,1),r+="    ",r+=u("if",t,this,2),r+"  "}}}],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,tmplName:"containerPickerItemTemplate",htmlTag:"li",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+="  ",r+=u("if",t,this,[{tmpl:1,params:"~tag.shouldShowItem(#data) ",props:{},args:[t.hlp("tag").shouldShowItem(n)]}]),r+""}}},n["#containerSelectorTemplate"]={tmpls:[],links:{},tags:{},bnds:[{fn:function(n){return{params:"Title",props:{},args:[n.Title]}},paths:["Title"],_ctxs:">"},{fn:function(n){return[{tmpl:0,params:"data=#data ~filterFn=#data.FilterFn ~menuType=#data.MenuType ~showSelectionState=#data.ShowSelectionState",props:{data:n},ctx:{filterFn:n.FilterFn,menuType:n.MenuType,showSelectionState:n.ShowSelectionState},args:[]}]},paths:["#data"],_ctxs:"containerPickerControl"}],_is:"template",allowCode:!0,tmplName:"containerSelectorTemplate",htmlTag:"a",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._tag,o=i._cnvt,u="";return u+='  <a href="#" class="c_ml ',u+=(f=n.MenuAnchorClass)!=r?f:"",u+='" ',u+=(f=t.hlp("sutra")("Hotmail.Link"))!=r?f:"",u+='>    <span class="',u+=(f=n.TitleClass)!=r?f:"",u+='" title="',u+=(f=n.ToolTip)!=r?f:"",u+='">',u+=o("html",t,1),u+='<\/span>    <img src="./clear.gif" class="',u+=(f=n.MenuChevClass)!=r?f:"",u+='"/>  <\/a>  <ul class="c-ContainerPicker c_m t_hovl">    ',u+=e("containerPickerControl",t,this,2),u+"  <\/ul>"}}},n["#containerSelectorClearSelectionItemTemplate"]={tmpls:[],links:{},tags:{},bnds:[{fn:function(n){return{params:"SelectionIsEmpty",props:{},args:[n.SelectionIsEmpty]}},paths:["SelectionIsEmpty"],_ctxs:"getClearSelectionCheckHtml:"}],_is:"template",allowCode:!0,tmplName:"containerSelectorClearSelectionItemTemplate",htmlTag:"li",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._cnvt,u="";return u+="  ",u+='  <li class="',u+=e("getClearSelectionClasses",t,{params:"SelectionIsEmpty",props:{},args:[n.SelectionIsEmpty]}),u+='" data-link="class{getClearSelectionClasses:SelectionIsEmpty}">    <a href="#">      ',u+=e("getClearSelectionCheckHtml",t,1),u+="      <span>",u+=(f=n.ClearSelectionItemText)!=r?f:"",u+="<\/span>    <\/a>  <\/li>  ",u+'  <li>    <span class="c_ms"><\/span>  <\/li>'}}},n["#moveToMenuTemplate"]={tmpls:[],links:{},tags:{},bnds:[{fn:function(n){return[{tmpl:0,params:"data=#data ~menuType=#data.MenuType ~filterFn=#data.FilterFn ~showSelectionState=#data.ShowSelectionState",props:{data:n},ctx:{menuType:n.MenuType,filterFn:n.FilterFn,showSelectionState:n.ShowSelectionState},args:[]}]},paths:["#data"],_ctxs:"containerPickerControl"}],_is:"template",allowCode:!0,tmplName:"moveToMenuTemplate",htmlTag:"",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+="  ",r+=u("containerPickerControl",t,this,1),r+""}}},n["#draftMessageBarTemplate"]={tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,tmplName:"draftMessageBarTemplate",htmlTag:"div",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i.converters.html,u="";return u+='    <div class="c-DraftMessageBar t_sbgc" ',u+=(f=t.hlp("sutra")("toolbaritems"))!=r?f:"",u+='>        <ul>            <li class="ToolbarItem t_lnk" aId="draftMessage"><a href="#" class="draftMessage" title="',u+=e(t.hlp("ol").GetString("EditMessage.ContinueComposeDraft")),u+='" ',u+=(f=t.hlp("sutra")("toolbaritem"))!=r?f:"",u+='><span class="LinkColor">',u+=(f=t.hlp("ol").GetString("EditMessage.ContinueComposeDraft"))!=r?f:"",u+='<\/span><\/a><\/li>            <li class="ToolbarItem"><span class="ToolbarPipe">|<\/span><\/li>            <li class="ToolbarItem t_lnk" aId="deleteMessage"><a href="#" class="delete" title="',u+=e(t.hlp("ol").GetString("ReadMessage.Delete")),u+='" ',u+=(f=t.hlp("sutra")("toolbaritem"))!=r?f:"",u+='><span class="LinkColor">',u+=e(t.hlp("ol").GetString("ReadMessage.Delete")),u+"<\/span><\/a><\/li>        <\/ul>    <\/div>"}}},n["#hmLiveViewWrapperTemplate"]={tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,tmplName:"hmLiveViewWrapperTemplate",htmlTag:"",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,u="";return u+="    ",u+=(f=n.LiveViewsHtml)!=r?f:"",u+""}}},n["#leftNavContextMenuTemplate"]={tmpls:[{tmpls:[],links:{},tags:{},bnds:[{fn:function(n){return{params:"Title",props:{},args:[n.Title]}},paths:["Title"],_ctxs:":"}],_is:"template",allowCode:!0,htmlTag:"div",tmplName:"leftNavContextMenuTemplate/if",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._cnvt,r="";return r+='          <div class="MenuItemGroupTitle">            <span class="MenuTitle">',r+=u("",t,1),r+"<\/span>          <\/div>        "}}},{tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"",tmplName:"leftNavContextMenuTemplate/for",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+="                        ",r+=u("for",t,this,[{tmpl:0,params:"#data tmpl=Template",props:{tmpl:n.Template},args:[n]}]),r+"                    "}}}],links:{},tags:{},bnds:[{fn:function(n){return[{tmpl:1,params:"Title",props:{},args:[n.Title]}]},paths:["Title"],_ctxs:"if"},{fn:function(n){return[{tmpl:2,params:"MenuItems",props:{},args:[n.MenuItems]}]},paths:["MenuItems"],_ctxs:"for"}],_is:"template",allowCode:!0,tmplName:"leftNavContextMenuTemplate",htmlTag:"div",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._tag,u="";return u+="  ",u+='  <div id="lncm" tabindex="-1" class="cm c_mcp">    <ul class="MenuTop c_m" ',u+=(f=t.hlp("sutra")("HeaderListContextMenuRoot"))!=r?f:"",u+='>        <a href="#" onclick="return false;" class="cm_focus">&nbsp;<\/a>        ',u+=e("if",t,this,1),u+='        <div id="lncm_container" class="MenuItemGroup" ',u+=(f=t.hlp("sutra")("MenuItemsGroupRoot"))!=r?f:"",u+='>            <div class="MenuItems t_hovl" ',u+=(f=t.hlp("sutra")("ContextMenuItems"))!=r?f:"",u+=">                <ul>                    ",u+=e("for",t,this,2),u+"                <\/ul>            <\/div>        <\/div>    <\/ul>  <\/div>"}}},n["#leftNavMenuItemTemplate"]={tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,tmplName:"leftNavMenuItemTemplate",htmlTag:"li",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,u="";return u+='  <li class="',u+=(f="ContextMenuItem "+n.CssClass)!=r?f:"",u+='" data-link="class{:\'ContextMenuItem \' + CssClass}" ',u+=(f=t.hlp("sutra")("ContextMenuItem"))!=r?f:"",u+=" ",u+=(f=t.hlp("sutrakey")(n.Key))!=r?f:"",u+='>    <a href="#" ',u+=(f=t.hlp("sutra")("Hotmail.Link"))!=r?f:"",u+=' title="',u+=(f=n.Tooltip)!=r?f:"",u+='">      ',u+=(f=n.Text)!=r?f:"",u+"    <\/a>  <\/li>"}}},n["#meetingRequestBarTemplate"]={tmpls:[{tmpls:[{tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"div",tmplName:"meetingRequestBarTemplate/if/if",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,u="";return u+='            <div class="calendarActionReqBar" ',u+=(f=t.hlp("sutra")("ResponseButtonBar"))!=r?f:"",u+='>                <a class="iibBttn FloatLeft BorderRight" href="#" aId="accept">                    <img class="mr_tb_a" src="./clear.gif" />                    <span ',u+=(f=t.hlp("sutra")("AcceptButton"))!=r?f:"",u+=">",u+=(f=t.hlp("ol").GetString("MeetingRequest.Accept"))!=r?f:"",u+='<\/span>                <\/a>                <a class="iibBttn FloatLeft BorderRight" href="#" aId="tentative">                    <img class="mr_tb_t" src="./clear.gif" />                    <span ',u+=(f=t.hlp("sutra")("TentativeButton"))!=r?f:"",u+=">",u+=(f=t.hlp("ol").GetString("MeetingRequest.Tentative"))!=r?f:"",u+='<\/span>                <\/a>                <a class="iibBttn FloatLeft BorderRight" href="#" aId="decline">                    <img class="mr_tb_d" src="./clear.gif" />                    <span ',u+=(f=t.hlp("sutra")("DeclineButton"))!=r?f:"",u+=">",u+=(f=t.hlp("ol").GetString("MeetingRequest.Decline"))!=r?f:"",u+='<\/span>                <\/a>                <a class="iibBttn FloatLeft" href="',u+=(f=n.MeetingRequestInfo.calendarDayUrl)!=r?f:"",u+='" data-link="href{:MeetingRequestInfo.calendarDayUrl}">                    <img class="mr_tb_c" src="./clear.gif" />                    <span ',u+=(f=t.hlp("sutra")("CalendarButton"))!=r?f:"",u+=">",u+=(f=t.hlp("ol").GetString("MeetingRequest.Calendar"))!=r?f:"",u+"<\/span>                <\/a>            <\/div>        "}}},{tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"div",tmplName:"meetingRequestBarTemplate/if/else",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,u="";return u+='            <div class="calendarActionReqBar">                <a class="iibBttn FloatLeft" href="#" aId="cancel">                    <img class="i_cancel" src="./clear.gif" />                    <span ',u+=(f=t.hlp("sutra")("RemoveFromCalendarButton"))!=r?f:"",u+=">",u+=(f=t.hlp("ol").GetString("MeetingRequest.RemoveFromCalendar"))!=r?f:"",u+"<\/span>                <\/a>            <\/div>        "}}},{tmpls:[],links:{},tags:{},bnds:[{fn:function(n){return{params:"MeetingRequestInfo.title",props:{},args:[n.MeetingRequestInfo.title]}},paths:["MeetingRequestInfo.title"],_ctxs:">"}],_is:"template",allowCode:!0,htmlTag:"table",tmplName:"meetingRequestBarTemplate/if/if",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._cnvt,u="";return u+='                <table><tbody><tr><td><span class="iibHeader iibTitle" ',u+=(f=t.hlp("sutra")("Hotmail.Title"))!=r?f:"",u+=">",u+=e("html",t,1),u+"<\/span><\/td><\/tr><\/tbody><\/table>            "}}},{tmpls:[],links:{},tags:{},bnds:[{fn:function(n){return{params:"MeetingRequestInfo.location",props:{},args:[n.MeetingRequestInfo.location]}},paths:["MeetingRequestInfo.location"],_ctxs:">"}],_is:"template",allowCode:!0,htmlTag:"tr",tmplName:"meetingRequestBarTemplate/if/if",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._cnvt,u="";return u+='                    <tr>                        <td><span class="iibHeader iibTag">',u+=(f=t.hlp("ol").GetString("MeetingRequest.Location"))!=r?f:"",u+=' &nbsp;<\/span><\/td>                        <td><span class="iibHeader iibTagContent" ',u+=(f=t.hlp("sutra")("Hotmail.Location"))!=r?f:"",u+=">",u+=e("html",t,1),u+"<\/span><\/td>                    <\/tr>                "}}}],links:{},tags:{},bnds:[{fn:function(n,t){return[{tmpl:1,params:"(MeetingRequestInfo.action === ~HM.MeetingRequestAction.Request || MeetingRequestInfo.action === ~HM.MeetingRequestAction.Update)",props:{},args:[n.MeetingRequestInfo.action===t.hlp("HM").MeetingRequestAction.Request||n.MeetingRequestInfo.action===t.hlp("HM").MeetingRequestAction.Update]},{tmpl:2,params:"MeetingRequestInfo.action === ~HM.MeetingRequestAction.Cancel",props:{},args:[n.MeetingRequestInfo.action===t.hlp("HM").MeetingRequestAction.Cancel]}]},paths:["MeetingRequestInfo.action","~HM.MeetingRequestAction.Request","MeetingRequestInfo.action","~HM.MeetingRequestAction.Update","MeetingRequestInfo.action","~HM.MeetingRequestAction.Cancel"],_ctxs:"else"},{fn:function(n){return[{tmpl:3,params:"MeetingRequestInfo.title",props:{},args:[n.MeetingRequestInfo.title]}]},paths:["MeetingRequestInfo.title"],_ctxs:"if"},{fn:function(n){return{params:"MeetingRequestInfo.time",props:{},args:[n.MeetingRequestInfo.time]}},paths:["MeetingRequestInfo.time"],_ctxs:">"},{fn:function(n){return[{tmpl:4,params:"MeetingRequestInfo.location",props:{},args:[n.MeetingRequestInfo.location]}]},paths:["MeetingRequestInfo.location"],_ctxs:"if"}],_is:"template",allowCode:!0,htmlTag:"div",tmplName:"meetingRequestBarTemplate/if",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._tag,o=i._cnvt,u="";return u+='        <div class="c-MeetingRequestBar" ',u+=(f=t.hlp("sutra")("InvitationInfoBlock"))!=r?f:"",u+=">        ",u+=e("if",t,this,1),u+='        <div class="calendarActionReqBar iibHorizRule"><\/div>            <div class="calendarActionReqBar iibHeaders">            ',u+=e("if",t,this,2),u+='            <table>              <tbody>                <tr>                    <td><span class="iibHeader iibTag">',u+=(f=t.hlp("ol").GetString("MeetingRequest.When"))!=r?f:"",u+=' &nbsp;<\/span><\/td>                    <td><span class="iibHeader iibTagContent" ',u+=(f=t.hlp("sutra")("When"))!=r?f:"",u+=">",u+=o("html",t,3),u+="<\/span><\/td>                <\/tr>                ",u+=e("if",t,this,4),u+"              <\/tbody>            <\/table>        <\/div>    <\/div>    "}}}],links:{},tags:{},bnds:[{fn:function(n,t){return[{tmpl:1,params:"(MeetingRequestInfo.action === ~HM.MeetingRequestAction.Request || MeetingRequestInfo.action === ~HM.MeetingRequestAction.Update || MeetingRequestInfo.action === ~HM.MeetingRequestAction.Cancel)",props:{},args:[n.MeetingRequestInfo.action===t.hlp("HM").MeetingRequestAction.Request||n.MeetingRequestInfo.action===t.hlp("HM").MeetingRequestAction.Update||n.MeetingRequestInfo.action===t.hlp("HM").MeetingRequestAction.Cancel]}]},paths:["MeetingRequestInfo.action","~HM.MeetingRequestAction.Request","MeetingRequestInfo.action","~HM.MeetingRequestAction.Update","MeetingRequestInfo.action","~HM.MeetingRequestAction.Cancel"],_ctxs:"if"}],_is:"template",allowCode:!0,tmplName:"meetingRequestBarTemplate",htmlTag:"div",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+="    ",r+=u("if",t,this,1),r+""}}},n["#messageCountTemplate"]={tmpls:[{tmpls:[{tmpls:[{tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"p",tmplName:"messageCountTemplate/if/if/if",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,u="";return u+="                        <p>",u+=(f=t.hlp("ol").GetString("ReadingPane.NotAutoSelectMessage.Hint.Paragraph1"))!=r?f:"",u+"<\/p>                    "}}}],links:{},tags:{},bnds:[{fn:function(n,t){return{params:"~tag.numItemsSelectedString(SelectedMessageCount, BulkSelected)",props:{},args:[t.hlp("tag").numItemsSelectedString(n.SelectedMessageCount,n.BulkSelected)]}},paths:["~tag.numItemsSelectedString","SelectedMessageCount","BulkSelected"],_ctxs:":"}],_is:"template",allowCode:!0,htmlTag:"div",tmplName:"messageCountTemplate/if/if",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,o=i._tag,e=i._cnvt,u="";return u+='                <div class="emptySel" ',u+=(f=t.hlp("sutra")("EmptySelection"))!=r?f:"",u+=">                    <h3>",u+=(f=t.hlp("ol").GetString("ReadingPane.NotAutoSelectMessage.Hint.Title"))!=r?f:"",u+="<\/h3>                    ",u+=o("if",t,this,[{tmpl:1,params:'~ol.GetString("ReadingPane.NotAutoSelectMessage.Hint.Paragraph1")',props:{},args:[t.hlp("ol").GetString("ReadingPane.NotAutoSelectMessage.Hint.Paragraph1")]}]),u+="                    <p>                        ",u+=(f=t.hlp("ol").GetString("ReadingPane.NotAutoSelectMessage.Hint.Paragraph2"))!=r?f:"",u+="                        <a ",u+=(f=t.hlp("tabindexTag")(t.hlp("tag").linksTabIndex))!=r?f:"",u+=' href="',u+=e("readingOptionsUrl",t,{params:"",props:{},args:[]}),u+='">                          ',u+=(f=t.hlp("ol").GetString("ReadingPane.NotAutoSelectMessage.Hint.Paragraph3"))!=r?f:"",u+='                        <\/a>                    <\/p>                <\/div>                <h3 class="selCount" ',u+=(f=t.hlp("sutra")("SelectionCount"))!=r?f:"",u+=">",u+=e("",t,1),u+"<\/h3>                "}}},{tmpls:[],links:{},tags:{},bnds:[{fn:function(n,t){return{params:"~tag.numItemsSelectedString(SelectedMessageCount, BulkSelected)",props:{},args:[t.hlp("tag").numItemsSelectedString(n.SelectedMessageCount,n.BulkSelected)]}},paths:["~tag.numItemsSelectedString","SelectedMessageCount","BulkSelected"],_ctxs:":"}],_is:"template",allowCode:!0,htmlTag:"div",tmplName:"messageCountTemplate/if/else",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._cnvt,u="";return u+='                <div class="selCount inlineBlock" ',u+=(f=t.hlp("sutra")("SelectionCount"))!=r?f:"",u+=">",u+=e("",t,1),u+"<\/div>                "}}}],links:{},tags:{},bnds:[{fn:function(n,t){return{params:"~tag.getSelAllPrompt(CheckAllChecked, BulkSelected)",props:{},args:[t.hlp("tag").getSelAllPrompt(n.CheckAllChecked,n.BulkSelected)]}},paths:["~tag.getSelAllPrompt","CheckAllChecked","BulkSelected"],_ctxs:":"}],_is:"template",allowCode:!0,htmlTag:"div",tmplName:"messageCountTemplate/if",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._tag,o=i._cnvt,u="";return u+='        <div class="SelMsgPaneInner">            <div ',u+=(f=t.hlp("sutra")("SelectionControl"))!=r?f:"",u+=' id="selection">                ',u+=e("if",t,this,[{tmpl:1,params:"~layout.isReadingPaneOn()",props:{},args:[t.hlp("layout").isReadingPaneOn()]},{tmpl:2,params:"",props:{},args:[]}]),u+='                <div class="selAll inlineBlock">                  ',u+=o("",t,1),u+='                <\/div>                <div class="clearAllCk inlineBlock">                    <a ',u+=(f=t.hlp("tabindexTag")(t.hlp("tag").linksTabIndex))!=r?f:"",u+=" ",u+=(f=t.hlp("sutra")("ClearSelection"))!=r?f:"",u+=' href="#">                        ',u+=(f=t.hlp("ol").GetString("MessageList.ClearSelection"))!=r?f:"",u+"                    <\/a>                <\/div>            <\/div>        <\/div>      "}}}],links:{},tags:{},bnds:[{fn:function(n){return[{tmpl:1,params:"ShowMessageCount",props:{},args:[n.ShowMessageCount]}]},paths:["ShowMessageCount"],_ctxs:"if"}],_is:"template",allowCode:!0,tmplName:"messageCountTemplate",htmlTag:"div",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._tag,u="";return u+='    <div class="',u+=(f=t.hlp("tag").MessageCountClass)!=r?f:"",u+='" data-link="class{:~tag.MessageCountClass}">      ',u+=e("if",t,this,1),u+"    <\/div>"}}},n["#messageListContextMenuTemplate"]={tmpls:[{tmpls:[{tmpls:[],links:{},tags:{},bnds:[{fn:function(n){return[{tmpl:0,params:"#data tmpl=Template",props:{tmpl:n.Template},args:[n]}]},paths:["#data","Template"],_ctxs:"for"}],_is:"template",allowCode:!0,htmlTag:"",tmplName:"messageListContextMenuTemplate/if/for",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+="                        ",r+=u("for",t,this,1),r+"                    "}}},{tmpls:[],links:{},tags:{},bnds:[{fn:function(n){return[{tmpl:0,params:"#data tmpl=Template",props:{tmpl:n.Template},args:[n]}]},paths:["#data","Template"],_ctxs:"for"}],_is:"template",allowCode:!0,htmlTag:"",tmplName:"messageListContextMenuTemplate/if/for",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+="                        ",r+=u("for",t,this,1),r+"                    "}}}],links:{},tags:{},bnds:[{fn:function(n){return[{tmpl:1,params:"SendMenuItems",props:{},args:[n.SendMenuItems]}]},paths:["SendMenuItems"],_ctxs:"for"},{fn:function(n){return[{tmpl:2,params:"MessageMenuItems",props:{},args:[n.MessageMenuItems]}]},paths:["MessageMenuItems"],_ctxs:"for"}],_is:"template",allowCode:!0,htmlTag:"ul",tmplName:"messageListContextMenuTemplate/if",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._tag,u="";return u+="                <ul ",u+=(f=t.hlp("sutra")("SendContextMenuItems"))!=r?f:"",u+=">                    ",u+=e("for",t,this,1),u+='                <\/ul>                <div class="c_ms" id="mlcm_sep"><\/div>                <ul ',u+=(f=t.hlp("sutra")("ContextMenuItems"))!=r?f:"",u+=">                    ",u+=e("for",t,this,2),u+"                <\/ul>                "}}},{tmpls:[{tmpls:[{tmpls:[],links:{},tags:{},bnds:[{fn:function(n){return[{tmpl:0,params:"#data tmpl=Template",props:{tmpl:n.Template},args:[n]}]},paths:["#data","Template"],_ctxs:"for"}],_is:"template",allowCode:!0,htmlTag:"",tmplName:"messageListContextMenuTemplate/if/if/for",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+="                        ",r+=u("for",t,this,1),r+"                    "}}}],links:{},tags:{},bnds:[{fn:function(n){return[{tmpl:1,params:"SenderMenuItems",props:{},args:[n.SenderMenuItems]}]},paths:["SenderMenuItems"],_ctxs:"for"}],_is:"template",allowCode:!0,htmlTag:"ul",tmplName:"messageListContextMenuTemplate/if/if",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._tag,u="";return u+="                <ul ",u+=(f=t.hlp("sutra")("ContextMenuItems"))!=r?f:"",u+=">                    ",u+=e("for",t,this,1),u+"                <\/ul>              "}}}],links:{},tags:{},bnds:[{fn:function(n){return{params:"SenderMenuTitle",props:{},args:[n.SenderMenuTitle]}},paths:["SenderMenuTitle"],_ctxs:":"},{fn:function(n){return{params:"SenderMenuTitle",props:{},args:[n.SenderMenuTitle]}},paths:["SenderMenuTitle"],_ctxs:":"},{fn:function(n,t){return[{tmpl:1,params:"~tag.MenusCreated",props:{},args:[t.hlp("tag").MenusCreated]}]},paths:["~tag.MenusCreated"],_ctxs:"if"}],_is:"template",allowCode:!0,htmlTag:"div",tmplName:"messageListContextMenuTemplate/if",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,o=i._tag,e=i._cnvt,u="";return u+="        <div ",u+=(f=t.hlp("sutra")("SenderMenuItemsSection"))!=r?f:"",u+=' id="mlcm_sender" class="MenuItemGroup">            <div class="c_ms"><\/div>            <div ',u+=(f=t.hlp("sutra")("SenderSectionTitle"))!=r?f:"",u+=' class="MenuItemGroupTitle">                ',u+='                <div class="Enabled"><span ',u+=(f=t.hlp("sutra")("SenderSectionTitleEnabledText"))!=r?f:"",u+=' class="SenderTitle">',u+=e("",t,1),u+='<\/span><\/div>                <div class="Disabled t_lnki"><a ',u+=(f=t.hlp("sutra")("SenderSectionTitleDisabledLink"))!=r?f:"",u+=' href="#"><span ',u+=(f=t.hlp("sutra")("SenderSectionTitleDisabledText"))!=r?f:"",u+=' class="SenderTitle">',u+=e("",t,2),u+="<\/span><\/a><\/div>            <\/div>            <div ",u+=(f=t.hlp("sutra")("SenderMenuItemsGroup"))!=r?f:"",u+=' class="MenuItems t_hovl">              ',u+=o("if",t,this,3),u+"            <\/div>        <\/div>      "}}}],links:{},tags:{},bnds:[{fn:function(n){return{params:"SenderName",props:{},args:[n.SenderName]}},paths:["SenderName"],_ctxs:">"},{fn:function(n){return{params:"SenderEmail",props:{},args:[n.SenderEmail]}},paths:["SenderEmail"],_ctxs:">"},{fn:function(n){return{params:"MessageMenuTitle",props:{},args:[n.MessageMenuTitle]}},paths:["MessageMenuTitle"],_ctxs:":"},{fn:function(n,t){return[{tmpl:1,params:"~tag.MenusCreated",props:{},args:[t.hlp("tag").MenusCreated]}]},paths:["~tag.MenusCreated"],_ctxs:"if"}],_is:"template",allowCode:!0,tmplName:"messageListContextMenuTemplate",htmlTag:"div",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,o=i._tag,e=i._cnvt,u="";return u+='  <div id="mlcm" tabindex="-1" class="cm c_mcp">    <ul ',u+=(f=t.hlp("sutra")("ContextMenu"))!=r?f:"",u+=' class="MenuTop c_m">        <a href="#" onclick="return false;" class="cm_focus">&nbsp;<\/a>        <div ',u+=(f=t.hlp("sutra")("ContextMenuHeading"))!=r?f:"",u+=' id="mlcm_heading" class="MenuHeading">            <div><span ',u+=(f=t.hlp("sutra")("ContextMenuHeadingTitle"))!=r?f:"",u+=' class="SenderName TextSizeLargeLoc">',u+=e("html",t,1),u+="<\/span><\/div>            <div><span ",u+=(f=t.hlp("sutra")("ContextMenuHeadingSubTitle"))!=r?f:"",u+=' class="SenderEmail">',u+=e("html",t,2),u+="<\/span><\/div>        <\/div>        <div ",u+=(f=t.hlp("sutra")("MessageMenuItemsSection"))!=r?f:"",u+=' id="mlcm_message" class="MenuItemGroup">            <div ',u+=(f=t.hlp("sutra")("MessageSectionTitle"))!=r?f:"",u+=' class="MenuItemGroupTitle">                <span ',u+=(f=t.hlp("sutra")("MessageSectionTitleText"))!=r?f:"",u+=' class="MenuTitle">',u+=e("",t,3),u+="<\/span>            <\/div>            <div ",u+=(f=t.hlp("sutra")("MessageMenuItemsGroup"))!=r?f:"",u+=' class="MenuItems t_hovl">                ',u+=o("if",t,this,4),u+="            <\/div>        <\/div>        ",u+=o("if",t,this,[{tmpl:2,params:'~ol.GetAppConfig("EnableCtxMenuSenderActions")',props:{},args:[t.hlp("ol").GetAppConfig("EnableCtxMenuSenderActions")]}]),u+"    <\/ul>  <\/div>"}}},n["#contextMenuItemTemplate"]={tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,tmplName:"contextMenuItemTemplate",htmlTag:"li",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,u="";return u+='  <li class="',u+=(f="ContextMenuItem "+n.CssClass)!=r?f:"",u+='" data-link="class{:\'ContextMenuItem \' + CssClass}" ',u+=(f=t.hlp("sutra")(n.SutraTag))!=r?f:"",u+=" ",u+=(f=t.hlp("sutrakey")(n.Key))!=r?f:"",u+='>    <a href="#" title="',u+=(f=n.Tooltip)!=r?f:"",u+='" ',u+=(f=t.hlp("sutra")("hotmail.link"))!=r?f:"",u+=">      ",u+=(f=n.Text)!=r?f:"",u+"    <\/a>  <\/li>"}}},n["#instantActionsFloatingTemplate"]={tmpls:[],links:{},tags:{},bnds:[{fn:function(n){return[{tmpl:0,params:"~thread=#data ~instantActionLink=false link=false",props:{link:!1},ctx:{thread:n,instantActionLink:!1},args:[]}]},paths:[],_ctxs:"instantActionsControl"}],_is:"template",allowCode:!0,tmplName:"instantActionsFloatingTemplate",htmlTag:"div",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._tag,u="";return u+='  <div class="',u+=(f=t.hlp("tag").getContainerCssClasses(t.hlp("messageList").Items))!=r?f:"",u+='" data-link="class{:~tag.getContainerCssClasses(~messageList.Items)}">  <div class="floatingIA NoDisplay" id="',u+=(f=t.hlp("tag").ControlNamespace)!=r?f:"",u+='" ',u+=(f=t.hlp("sutra")("floatingInstantActions"))!=r?f:"",u+='>    <div class="iaRightAnchor">      <span class="Ia">        ',u+=e("instantActionsControl",t,this,1),u+"      <\/span>    <\/div>  <\/div>  <\/div>"}}},n["#readingPaneMenuTemplate"]={tmpls:[{tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"li",tmplName:"readingPaneMenuTemplate/for",fn:{fn:function(n,t,i,r){var i=i||jsviews,u,f="";return f+="<li data-link=\"class{:~tag.data.ReadingPaneMode === Key ? 'Selected' : ''}\" ",f+=(u=t.hlp("sutra")(n.SutraTag))!=r?u:"",f+='>\t<a class="rp" href="#" ',f+=(u=t.hlp("sutra")("Hotmail.Link"))!=r?u:"",f+=' tabindex="1">',f+=(u=t.hlp("tag").chevronHtml())!=r?u:"",f+=(u=n.Text)!=r?u:"",f+"<\/a><\/li>"}}}],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,tmplName:"readingPaneMenuTemplate",htmlTag:"li",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._tag,u="";return u+='<li class="GroupHeading">',u+=(f=t.hlp("ol").GetString("Options.MailAndJunk.ReadingPaneSetting.Title"))!=r?f:"",u+="<\/li>",u+=e("for",t,this,[{tmpl:1,params:"Items",props:{},args:[n.Items]}]),u+'<li><span class="c_ms"><\/span><\/li>'}}},n["#readMessageTemplate"]={tmpls:[{tmpls:[{tmpls:[{tmpls:[],links:{},tags:{},bnds:[{fn:function(n,t){return[{tmpl:0,params:'~sutraTag="subjectfield"                     ~autocomplete="off"                     ~spellCheck="true"                     ~name="fSubject"                     ~className=~tag.composeControl.SubjectClassName                     ~maxLength=~ol.config.compose.maxSubjectLength                     ~ariaLabel=~ol.GetString("Accessibility.MessageSubjectLabel")                     ~placeholder=~ol.GetString("EditMessage.Subject")                     ~data=~tag.composeControl.thread                     ~propertyName="Subject"                   ',props:{},ctx:{sutraTag:"subjectfield",autocomplete:"off",spellCheck:"true",name:"fSubject",className:t.hlp("tag").composeControl.SubjectClassName,maxLength:t.hlp("ol").config.compose.maxSubjectLength,ariaLabel:t.hlp("ol").GetString("Accessibility.MessageSubjectLabel"),placeholder:t.hlp("ol").GetString("EditMessage.Subject"),data:t.hlp("tag").composeControl.thread,propertyName:"Subject"},args:[]}]},paths:[],_ctxs:"watermarkedInputControl"}],_is:"template",allowCode:!0,htmlTag:"div",tmplName:"readMessageTemplate/if/for/if",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+='                <div class="SubjectArea TextLightI">                  ',r+=u("watermarkedInputControl",t,this,1),r+"                <\/div>          "}}},{tmpls:[],links:{},tags:{},bnds:[{fn:function(n){return{params:"SubjectWithHtml",props:{},args:[n.SubjectWithHtml]}},paths:["SubjectWithHtml"],_ctxs:":"}],_is:"template",allowCode:!0,htmlTag:"h2",tmplName:"readMessageTemplate/if/for/else",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._cnvt,u="";return u+='          <h2 class="rmSubject containsCompose" ',u+=(f=t.hlp("sutra")("headersubject"))!=r?f:"",u+=" title='",u+=e("attr",t,{params:'~ol.GetString("EditMessage.EditSubject")',props:{},args:[t.hlp("ol").GetString("EditMessage.EditSubject")]}),u+='\' role="button">            ',u+=e("",t,1),u+=(f=t.hlp("ol").config.Ltr?"&#x200f;":"&#x200e;")!=r?f:"",u+"          <\/h2>          "}}},{tmpls:[],links:{},tags:{},bnds:[{fn:function(n){return{params:"SubjectWithHtml",props:{},args:[n.SubjectWithHtml]}},paths:["SubjectWithHtml"],_ctxs:":"}],_is:"template",allowCode:!0,htmlTag:"h2",tmplName:"readMessageTemplate/if/for/else",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._cnvt,u="";return u+='          <h2 class="rmSubject" ',u+=(f=t.hlp("sutra")("headersubject"))!=r?f:"",u+=">              ",u+=e("",t,1),u+=(f=t.hlp("ol").config.Ltr?"&#x200f;":"&#x200e;")!=r?f:"",u+"            <\/h2>          "}}},{tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"h2",tmplName:"readMessageTemplate/if/for/if",fn:{fn:function(n,t,i){var i=i||jsviews;return'              <h2 class="rmSubject" >&nbsp;<\/h2>            '}}},{tmpls:[],links:{},tags:{},bnds:[{fn:function(n){return{params:"SubjectWithHtml",props:{},args:[n.SubjectWithHtml]}},paths:["SubjectWithHtml"],_ctxs:":"}],_is:"template",allowCode:!0,htmlTag:"div",tmplName:"readMessageTemplate/if/for/else",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._cnvt,r="";return r+='              <div class="rmButtons">                <span class="rmPrev"                  ><img src="./clear.gif" class="',r+=u("prevImgClass",t,{params:"~tag.HasPrevious",props:{},args:[t.hlp("tag").HasPrevious]}),r+='" data-link="class{prevImgClass:~tag.HasPrevious}"                /><\/span                ><span class="rmNext"                  ><img src="./clear.gif" class="',r+=u("nextImgClass",t,{params:"~tag.HasNext",props:{},args:[t.hlp("tag").HasNext]}),r+='" data-link="class{nextImgClass:~tag.HasNext}"                /><\/span                ><span class="',r+=u("fullViewBtnClass",t,{params:"~tag.layout.IsFullView",props:{},args:[t.hlp("tag").layout.IsFullView]}),r+='"                  ><img src="./clear.gif" class="i_r_fv"                /><\/span                ><span class="',r+=u("closeBtnClass",t,{params:"~tag.layout.IsFullView",props:{},args:[t.hlp("tag").layout.IsFullView]}),r+='" data-link="class{closeBtnClass:~tag.layout.IsFullView}"                  ><img src="./clear.gif" class="g_close"                /><\/span>                <\/div>                <h2 class="rmSubject" >',r+=u("",t,1),r+"<\/h2>            "}}},{tmpls:[{tmpls:[{tmpls:[],links:{},tags:{},bnds:[{fn:function(n){return[{tmpl:0,params:"thread=#data ",props:{thread:n},args:[]}]},paths:["#data"],_ctxs:"readMessagePartControl"}],_is:"template",allowCode:!0,htmlTag:"",tmplName:"readMessageTemplate/if/for/if/for/if",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+="              ",r+=u("readMessagePartControl",t,this,1),r+"            "}}},{tmpls:[],links:{},tags:{},bnds:[{fn:function(n,t){return[{tmpl:0,params:'thread=#data ~composeVm=~ol.compose.composeVm ~containerSelector=".rmMessages"',props:{thread:n},ctx:{composeVm:t.hlp("ol").compose.composeVm,containerSelector:".rmMessages"},args:[]}]},paths:["#data"],_ctxs:"composeControl"}],_is:"template",allowCode:!0,htmlTag:"",tmplName:"readMessageTemplate/if/for/if/for/else",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+="              ",r+=u("composeControl",t,this,1),r+"            "}}}],links:{},tags:{},bnds:[{fn:function(n,t){return[{tmpl:1,params:"!IsComposeSession || (!IsComposeReady && ComposeActionType === ~HM.MessageActionType.ResumeDraft)",props:{},args:[!n.IsComposeSession||!n.IsComposeReady&&n.ComposeActionType===t.hlp("HM").MessageActionType.ResumeDraft]},{tmpl:2,params:"~ol.compose && ~ol.compose.composeVm.IsRespondingInline && IsComposeReady",props:{},args:[t.hlp("ol").compose&&t.hlp("ol").compose.composeVm.IsRespondingInline&&n.IsComposeReady]}]},paths:["IsComposeSession","IsComposeReady","ComposeActionType","~HM.MessageActionType.ResumeDraft","~ol.compose","~ol.compose.composeVm.IsRespondingInline","IsComposeReady"],_ctxs:"else"}],_is:"template",allowCode:!0,htmlTag:"",tmplName:"readMessageTemplate/if/for/if/for",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+="            ",r+="            ",r+=u("if",t,this,1),r+"          "}}}],links:{},tags:{},bnds:[{fn:function(n){return[{tmpl:1,params:"Items",props:{},args:[n.Items]}]},paths:["Items"],_ctxs:"for"}],_is:"template",allowCode:!0,htmlTag:"",tmplName:"readMessageTemplate/if/for/if",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+="          ",r+=u("for",t,this,1),r+"          "}}},{tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"div",tmplName:"readMessageTemplate/if/for/if",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,u="";return u+='          <div class="rmMaxMessagesBar BorderBox" ',u+=(f=t.hlp("sutra")("maxmessagesbar"))!=r?f:"",u+=">            ",u+=(f=t.hlp("ol").GetString("ReadMessage.MaxMessagesLimitHit"))!=r?f:"",u+"          <\/div>          "}}}],links:{},tags:{},bnds:[{fn:function(n,t){return[{tmpl:1,params:"~tag.ShowEditableSubject",props:{},args:[t.hlp("tag").ShowEditableSubject]},{tmpl:2,params:"~tag.ContainsCompose",props:{},args:[t.hlp("tag").ContainsCompose]},{tmpl:3,params:"",props:{},args:[]}]},paths:["~tag.ShowEditableSubject","~tag.ContainsCompose"],_ctxs:"else"},{fn:function(n,t){return[{tmpl:4,params:"~tag.ShowEditableSubject",props:{},args:[t.hlp("tag").ShowEditableSubject]},{tmpl:5,params:"",props:{},args:[]}]},paths:["~tag.ShowEditableSubject"],_ctxs:"else"},{fn:function(n){return[{tmpl:6,params:"Items",props:{},args:[n.Items]}]},paths:["Items"],_ctxs:"if"},{fn:function(n){return[{tmpl:7,params:"ShowMaxMessagesLimitHitNotification",props:{},args:[n.ShowMaxMessagesLimitHitNotification]}]},paths:["ShowMaxMessagesLimitHitNotification"],_ctxs:"if"}],_is:"template",allowCode:!0,htmlTag:"div",tmplName:"readMessageTemplate/if/for",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._tag,o=i._cnvt,u="";return u+="        ",u+='        <div class="rmTop t_mbgc" ',u+=(f=t.hlp("sutra")("readmessageviewheader"))!=r?f:"",u+='>            <div class="rmButtons" ',u+=(f=t.hlp("sutra")("messageheader"))!=r?f:"",u+='                ><a class="rmPrev" href="#" ',u+=(f=t.hlp("tabindexForRegion")("readingPaneHeader"))!=r?f:"",u+=' title="',u+=(f=t.hlp("ol").GetShortcutString("ReadMessage.PreviousMessage","prevMsg"))!=r?f:"",u+='" ',u+=(f=t.hlp("sutra")("previousmessage"))!=r?f:"",u+='                   ><img src="./clear.gif" class="',u+=o("prevImgClass",t,{params:"~tag.HasPrevious",props:{},args:[t.hlp("tag").HasPrevious]}),u+='" alt="',u+=(f=t.hlp("ol").GetString("ReadMessage.PreviousMessage"))!=r?f:"",u+='"                         data-link="class{prevImgClass:~tag.HasPrevious}" ',u+=(f=t.hlp("sutra")("previousmessageimg"))!=r?f:"",u+='                /><\/a                ><a class="rmNext" href="#" ',u+=(f=t.hlp("tabindexForRegion")("readingPaneHeader"))!=r?f:"",u+=' title="',u+=(f=t.hlp("ol").GetShortcutString("ReadMessage.NextMessage","nextMsg"))!=r?f:"",u+='" ',u+=(f=t.hlp("sutra")("nextmessage"))!=r?f:"",u+='                   ><img src="./clear.gif" class="',u+=o("nextImgClass",t,{params:"~tag.HasNext",props:{},args:[t.hlp("tag").HasNext]}),u+='" alt="',u+=(f=t.hlp("ol").GetString("ReadMessage.NextMessage"))!=r?f:"",u+='"                        data-link="class{nextImgClass:~tag.HasNext}" ',u+=(f=t.hlp("sutra")("nextmessageimg"))!=r?f:"",u+='                /><\/a                ><a class="',u+=o("fullViewBtnClass",t,{params:"~tag.layout.IsFullView",props:{},args:[t.hlp("tag").layout.IsFullView]}),u+='" href="#" ',u+=(f=t.hlp("tabindexForRegion")("readingPaneHeader"))!=r?f:"",u+=' title="',u+=(f=t.hlp("ol").GetString("ReadMessage.FullMessageViewLink.Text"))!=r?f:"",u+='"                    data-link="class{fullViewBtnClass:~tag.layout.IsFullView}" ',u+=(f=t.hlp("sutra")("fullview"))!=r?f:"",u+='                    ><img src="./clear.gif" class="i_r_fv" alt="',u+=(f=t.hlp("ol").GetString("ReadMessage.FullMessageViewLink.Text"))!=r?f:"",u+='"                /><\/a                ><a class="',u+=o("closeBtnClass",t,{params:"~tag.layout.IsFullView",props:{},args:[t.hlp("tag").layout.IsFullView]}),u+='" href="#" ',u+=(f=t.hlp("tabindexForRegion")("readingPaneHeader"))!=r?f:"",u+=' title="',u+=(f=t.hlp("tag").getCloseViewTitle())!=r?f:"",u+='"                   data-link="class{closeBtnClass:~tag.layout.IsFullView}" ',u+=(f=t.hlp("sutra")("closeview"))!=r?f:"",u+='                    ><img src="./clear.gif" class="g_close" alt="',u+=(f=t.hlp("ol").GetString("ReadMessage.BackToMessages"))!=r?f:"",u+='"                /><\/a            ><\/div>            ',u+=e("if",t,this,1),u+='            <div class="rmRule"><\/div>        <\/div>        <div class="rmMessages ClearBoth" ',u+=(f=t.hlp("sutra")("messageparts"))!=r?f:"",u+=">          ",u+='          <div class="rmTopSpacer rmTop">            ',u+=e("if",t,this,2),u+="          <\/div>          ",u+=e("if",t,this,3),u+="          ",u+=e("if",t,this,4),u+='        <\/div>        <iframe class="attachmentDownloadIframe" scrolling="no" marginheight="0" marginwidth="0" frameborder="0" framespacing="0" src="javascript:\'\';" ',u+=(f=t.hlp("sutra")("attachmentframe"))!=r?f:"",u+"><\/iframe>      "}}}],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"div",tmplName:"readMessageTemplate/if",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+="      ",r+=u("for",t,this,[{tmpl:1,params:"Thread",props:{},args:[n.Thread]}]),r+"    "}}}],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,tmplName:"readMessageTemplate",htmlTag:"div",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._tag,o=i._cnvt,u="";return u+='    <div class="',u+=o("readMessageClass",t,{params:"~tag.Show",props:{},args:[t.hlp("tag").Show]}),u+='" ',u+=(f=t.hlp("sutra")("readmessageview"))!=r?f:"",u+=' data-link="class{readMessageClass: ~tag.Show}">    ',u+=e("if",t,this,[{tmpl:1,params:"Thread",props:{},args:[n.Thread]}]),u+="    ",u+=e("include",t,this,[{tmpl:0,params:'tmpl="#categorizeMenuPlaceHolderTemplate"',props:{tmpl:"#categorizeMenuPlaceHolderTemplate"},args:[]}]),u+"    <\/div>"}}},n["#readMessagePartTemplate"]={tmpls:[],links:{},tags:{},bnds:[{fn:function(n){return[{tmpl:0,params:"thread=#data SenderDetails ",props:{thread:n},args:[n.SenderDetails]}]},paths:["#data","SenderDetails"],_ctxs:"readMessagePartHeaderControl"},{fn:function(n){return[{tmpl:0,params:"thread=#data",props:{thread:n},args:[]}]},paths:["#data"],_ctxs:"readMessagePartBodyControl"}],_is:"template",allowCode:!0,tmplName:"readMessagePartTemplate",htmlTag:"div",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._tag,u="";return u+='    <div id="',u+=(f=t.hlp("tag").ControlNamespace)!=r?f:"",u+='" ',u+=(f=t.hlp("sutraClientMid")(n.Id))!=r?f:"",u+=' class="',u+=(f=t.hlp("tag").getHeaderCssClass(n.IsConversationPart,n.IsRead,n.IsDraft,n.IsTrustedSender,n.Items.length))!=r?f:"",u+='" data-link="class{:~tag.getHeaderCssClass(IsConversationPart, IsRead, IsDraft, IsTrustedSender, Items.length)}" ',u+=(f=t.hlp("sutra")("messagepart"))!=r?f:"",u+='>      <div class="paddingtop paddingbottom">        ',u+=e("readMessagePartHeaderControl",t,this,1),u+="      <\/div>      ",u+=e("readMessagePartBodyControl",t,this,2),u+"    <\/div>"}}},n["#readMessagePartBodyTemplate"]={tmpls:[{tmpls:[],links:{},tags:{},bnds:[{fn:function(n){return{params:"SafetyBarHtml",props:{},args:[n.SafetyBarHtml]}},paths:["SafetyBarHtml"],_ctxs:":"}],_is:"template",allowCode:!0,htmlTag:"",tmplName:"readMessagePartBodyTemplate/if",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._cnvt,r="";return r+="          ",r+=u("",t,1),r+"      "}}},{tmpls:[],links:{},tags:{},bnds:[{fn:function(n){return{params:"ServerMessage",props:{},args:[n.ServerMessage]}},paths:["ServerMessage"],_ctxs:">"}],_is:"template",allowCode:!0,htmlTag:"div",tmplName:"readMessagePartBodyTemplate/if",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._cnvt,r="";return r+='          <div class="ServerMessagePane">            <div class="ServerMessagePaneInner">              <span>',r+=u("html",t,1),r+"<\/span>            <\/div>          <\/div>        "}}},{tmpls:[],links:{},tags:{},bnds:[{fn:function(n){return[{tmpl:0,params:"thread=#data LiveViewsHtml",props:{thread:n},args:[n.LiveViewsHtml]}]},paths:["#data","LiveViewsHtml"],_ctxs:"hmLiveViewWrapperControl"}],_is:"template",allowCode:!0,htmlTag:"",tmplName:"readMessagePartBodyTemplate/if",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+="              ",r+=u("hmLiveViewWrapperControl",t,this,1),r+"          "}}},{tmpls:[],links:{},tags:{},bnds:[{fn:function(n){return{params:"UnsubscribeBarHtml",props:{},args:[n.UnsubscribeBarHtml]}},paths:["UnsubscribeBarHtml"],_ctxs:":"}],_is:"template",allowCode:!0,htmlTag:"",tmplName:"readMessagePartBodyTemplate/if",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._cnvt,r="";return r+="        ",r+=u("",t,1),r+"      "}}}],links:{},tags:{},bnds:[{fn:function(n){return[{tmpl:0,params:"thread=#data",props:{thread:n},args:[]}]},paths:["#data"],_ctxs:"draftMessageBarControl"},{fn:function(n){return[{tmpl:1,params:"SafetyBarHtml && !IsPrint",props:{},args:[n.SafetyBarHtml&&!n.IsPrint]}]},paths:["SafetyBarHtml","IsPrint"],_ctxs:"if"},{fn:function(n){return[{tmpl:2,params:"ServerMessage",props:{},args:[n.ServerMessage]}]},paths:["ServerMessage"],_ctxs:"if"},{fn:function(n){return[{tmpl:0,params:"thread=#data",props:{thread:n},args:[]}]},paths:["#data"],_ctxs:"meetingRequestBarControl"},{fn:function(n){return[{tmpl:3,params:"LiveViewsHtml",props:{},args:[n.LiveViewsHtml]}]},paths:["LiveViewsHtml"],_ctxs:"if"},{fn:function(n){return[{tmpl:4,params:"UnsubscribeBarHtml && !IsPrint",props:{},args:[n.UnsubscribeBarHtml&&!n.IsPrint]}]},paths:["UnsubscribeBarHtml","IsPrint"],_ctxs:"if"}],_is:"template",allowCode:!0,tmplName:"readMessagePartBodyTemplate",htmlTag:"div",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._tag,o=i._cnvt,u="";return u+='    <div class="',u+=o("getClass",t,{params:"IsBodyExpanded",props:{},args:[n.IsBodyExpanded]}),u+='" data-link="class{getClass:IsBodyExpanded}" ',u+=(f=t.hlp("sutra")("messagepartbody"))!=r?f:"",u+=">      ",n.IsDraft&&n.FolderId!==ol.config.sysFldrs.trashFid&&(u+="        ",u+=e("draftMessageBarControl",t,this,1),u+="      "),u+="      ",u+=e("if",t,this,2),u+="      ",n.IsPrint||(u+='        <div class="ClearBoth">        ',u+=e("if",t,this,3),u+="        ",n.MeetingRequestInfo&&(u+="            ",u+=e("meetingRequestBarControl",t,this,4),u+="        "),u+='        <\/div>        <div class="ClearBoth">          ',u+=e("if",t,this,5),u+="        <\/div>      "),u+='        <div class="readMsgBody" ',u+=(f=t.hlp("sutra")("messagebody"))!=r?f:"",u+='>          <div id="',u+=(f=t.hlp("tag").BodyId)!=r?f:"",u+='" class="',u+=(f=t.hlp("tag").cssClasses(n.PlainText,n.IsContentFiltered))!=r?f:"",u+='" data-link="class{:~tag.cssClasses(PlainText, IsContentFiltered)}">            ',n.Body&&n.IsPrint&&(u+="              ",u+=(f=n.Body)!=r?f:"",u+="            "),u+="          <\/div>        <\/div>      ",u+=e("if",t,this,6),u+"    <\/div>"}}},n["#readMessagePartHeaderTemplate"]={tmpls:[{tmpls:[],links:{},tags:{},bnds:[{fn:function(n,t){return[{tmpl:0,params:"~tag.ActionsMenu ",props:{},args:[t.hlp("tag").ActionsMenu]}]},paths:["~tag.ActionsMenu"],_ctxs:"menuControl"}],_is:"template",allowCode:!0,htmlTag:"",tmplName:"readMessagePartHeaderTemplate/if",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+="                        ",r+=u("menuControl",t,this,1),r+"                      "}}},{tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"span",tmplName:"readMessagePartHeaderTemplate/if",fn:{fn:function(n,t,i,r){var i=i||jsviews,u,f="";return f+='                    <span class="DraftLabel">[',f+=(u=t.hlp("ol").GetString("Compose.DraftHeaderLabel"))!=r?u:"",f+=(u=t.hlp("ol").GetAppConfig("BiDiEntityMark"))!=r?u:"",f+"]<\/span>                "}}},{tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"a",tmplName:"readMessagePartHeaderTemplate/if",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,u="";return u+='                  <a class="AddContact TextSizeSmall" href="#" ',u+=(f=t.hlp("sutra")("AddContactLink"))!=r?f:"",u+=">",u+=(f=t.hlp("ol").GetString("Contact.EditContact"))!=r?f:"",u+"<\/a>                  "}}},{tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"a",tmplName:"readMessagePartHeaderTemplate/else",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,u="";return u+='                  <a class="AddContact TextSizeSmall" href="#" ',u+=(f=t.hlp("sutra")("AddContactLink"))!=r?f:"",u+=">",u+=(f=t.hlp("ol").GetString("ReadMessage.AddContact"))!=r?f:"",u+"<\/a>                  "}}},{tmpls:[],links:{},tags:{},bnds:[{fn:function(n,t){return{params:"~tag.getCategories(Categories)",props:{},args:[t.hlp("tag").getCategories(n.Categories)]}},paths:["~tag.getCategories","Categories"],_ctxs:">"}],_is:"template",allowCode:!0,htmlTag:"span",tmplName:"readMessagePartHeaderTemplate/if",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._cnvt,u="";return u+='                <span class="MessageHeaderItem Categories TextSizeSmall" ',u+=(f=t.hlp("sutra")("MessageCategories"))!=r?f:"",u+='>                  <a href="#" title="',u+=e("attr",t,{params:"~tag.getCategories(Categories, ~tag.categoryList)",props:{},args:[t.hlp("tag").getCategories(n.Categories,t.hlp("tag").categoryList)]}),u+='"                     data-link="title{:~tag.getCategories(Categories, ~tag.categoryList)}" ',u+=(f=t.hlp("sutra")("MessageCategory"))!=r?f:"",u+=">                    ",u+=e("html",t,1),u+"                  <\/a>                <\/span>                "}}},{tmpls:[{tmpls:[],links:{},tags:{},bnds:[{fn:function(n){return{params:"ToDisplayText",props:{},args:[n.ToDisplayText]}},paths:["ToDisplayText"],_ctxs:">"}],_is:"template",allowCode:!0,htmlTag:"div",tmplName:"readMessagePartHeaderTemplate/if/if",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._cnvt,u="";return u+='                <div class="',u+=(f="recip_to "+(n.Cc||n.Bcc?"":"FloatLeft"))!=r?f:"",u+="\" data-link=\"class{:'recip_to ' + ((Cc || Bcc) ? '' : 'FloatLeft')}\" ",u+=(f=t.hlp("sutra")("To"))!=r?f:"",u+=">                  ",u+=(f=t.hlp("ol").GetString("MessageHeader.To"))!=r?f:"",u+=" ",u+=e("html",t,1),u+"                <\/div>                "}}},{tmpls:[],links:{},tags:{},bnds:[{fn:function(n,t){return{params:"~tag.data.getCcAndBccDisplayText(CcDisplayText, BccDisplayText)",props:{},args:[t.hlp("tag").data.getCcAndBccDisplayText(n.CcDisplayText,n.BccDisplayText)]}},paths:["~tag.data.getCcAndBccDisplayText","CcDisplayText","BccDisplayText"],_ctxs:">"}],_is:"template",allowCode:!0,htmlTag:"div",tmplName:"readMessagePartHeaderTemplate/if/if",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._cnvt,u="";return u+='                <div class="',u+=(f="recip_cc "+(n.Body?"FloatLeft":""))!=r?f:"",u+="\" data-link=\"class{: 'recip_cc ' + ((Body) ? 'FloatLeft' : '')}\" ",u+=(f=t.hlp("sutra")("Cc"))!=r?f:"",u+=">                    ",u+=e("html",t,1),u+"                <\/div>                "}}}],links:{},tags:{},bnds:[{fn:function(n){return[{tmpl:1,params:"ToDisplayText ",props:{},args:[n.ToDisplayText]}]},paths:["ToDisplayText"],_ctxs:"if"},{fn:function(n){return[{tmpl:2,params:"Cc || Bcc ",props:{},args:[n.Cc||n.Bcc]}]},paths:["Cc","Bcc"],_ctxs:"if"}],_is:"template",allowCode:!0,htmlTag:"div",tmplName:"readMessagePartHeaderTemplate/if",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._tag,u="";return u+='              <div class="',u+=(f="recip_c "+(n.Cc||n.Bcc?"HasCc":""))!=r?f:"",u+="\" data-link=\"class{:'recip_c ' + ((Cc || Bcc) ? 'HasCc' : '')}\">                ",u+=e("if",t,this,1),u+="                ",u+=e("if",t,this,2),u+='                <a class="',u+=(f="DetailToggle FloatLeft toggleExpandHeader "+(t.hlp("tag").Expanded?"ShowH":"HideH"))!=r?f:"",u+='"                     title="',u+=(f=t.hlp("tag").Expanded?t.hlp("ol").GetString("ReadMessage.HideSenderDetails"):t.hlp("ol").GetString("ReadMessage.ShowSenderDetails"))!=r?f:"",u+="\"                     data-link=\"title{:(~tag.Expanded ? ~ol.GetString('ReadMessage.HideSenderDetails') : ~ol.GetString('ReadMessage.ShowSenderDetails'))} class{:'DetailToggle FloatLeft toggleExpandHeader ' + ((~tag.Expanded) ? 'ShowH' : 'HideH')}\" ",u+=(f=t.hlp("sutra")("ShowDetails"))!=r?f:"",u+'                     href="#">                  <div class="FBA"><\/div>                <\/a>              <\/div>              '}}},{tmpls:[],links:{},tags:{},bnds:[{fn:function(n){return{params:"TaggingDescription",props:{},args:[n.TaggingDescription]}},paths:["TaggingDescription"],_ctxs:":"}],_is:"template",allowCode:!0,htmlTag:"span",tmplName:"readMessagePartHeaderTemplate/if",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._cnvt,u="";return u+='                <span class="TaggingText" ',u+=(f=t.hlp("sutra")("TaggingText"))!=r?f:"",u+=">                  ",u+=e("",t,1),u+"                <\/span>                "}}},{tmpls:[],links:{},tags:{},bnds:[{fn:function(n){return{params:"To",props:{},args:[n.To]}},paths:["To"],_ctxs:">"}],_is:"template",allowCode:!0,htmlTag:"",tmplName:"readMessagePartHeaderTemplate/if",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._cnvt,r="";return r+="                ",r+=u("html",t,1),r+"                "}}},{tmpls:[],links:{},tags:{},bnds:[{fn:function(n){return{params:"Cc",props:{},args:[n.Cc]}},paths:["Cc"],_ctxs:">"}],_is:"template",allowCode:!0,htmlTag:"tr",tmplName:"readMessagePartHeaderTemplate/if",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._cnvt,u="";return u+='            <tr class="Header">              <td class="ReadMsgHeaderCol1">                ',u+=(f=t.hlp("ol").GetString("MessageHeader.Cc"))!=r?f:"",u+="              <\/td>              <td ",u+=(f=t.hlp("sutra")("Cc"))!=r?f:"",u+=">                ",u+=e("html",t,1),u+"              <\/td>            <\/tr>            "}}},{tmpls:[],links:{},tags:{},bnds:[{fn:function(n){return{params:"Bcc",props:{},args:[n.Bcc]}},paths:["Bcc"],_ctxs:">"}],_is:"template",allowCode:!0,htmlTag:"tr",tmplName:"readMessagePartHeaderTemplate/if",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._cnvt,u="";return u+='            <tr class="Header">              <td class="ReadMsgHeaderCol1">                ',u+=(f=t.hlp("ol").GetString("MessageHeader.Bcc"))!=r?f:"",u+="              <\/td>              <td ",u+=(f=t.hlp("sutra")("Bcc"))!=r?f:"",u+=">                ",u+=e("html",t,1),u+"              <\/td>            <\/tr>            "}}},{tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"option",tmplName:"readMessagePartHeaderTemplate/for",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._cnvt,u="";return u+="                    ",n.separator?u+='                      <option disabled="disabled">-----------------<\/option>                    ':(u+='                      <option value="',u+=(f=n.codePage)!=r?f:"",u+='" ',u+=e("selectedAttr",t,{params:"~tag.isCurrentCodePage(codePage)",props:{},args:[t.hlp("tag").isCurrentCodePage(n.codePage)]}),u+=">",u+=(f=n.name)!=r?f:"",u+="<\/option>                    "),u+"                  "}}},{tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"tr",tmplName:"readMessagePartHeaderTemplate/if",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,u="";return u+="            <tr>              <td><\/td>              <td>                ",u+=(f=n.AttachmentsHtml)!=r?f:"",u+"              <\/td>            <\/tr>            "}}}],links:{},tags:{},bnds:[{fn:function(n,t){return[{tmpl:1,params:"~tag.ActionsMenu",props:{},args:[t.hlp("tag").ActionsMenu]}]},paths:["~tag.ActionsMenu"],_ctxs:"if"},{fn:function(n){return{params:"SenderDetails",props:{},args:[n.SenderDetails]}},paths:["SenderDetails"],_ctxs:"getIcFullName:"},{fn:function(n){return{params:"SenderDetails",props:{},args:[n.SenderDetails]}},paths:["SenderDetails"],_ctxs:"getFromAddress:"},{fn:function(n){return[{tmpl:3,params:"EditContactUrl",props:{},args:[n.EditContactUrl]},{tmpl:4,params:"ShowAddContactLink",props:{},args:[n.ShowAddContactLink]}]},paths:["EditContactUrl","ShowAddContactLink"],_ctxs:"else"},{fn:function(n){return[{tmpl:0,params:"~thread=#data ~instantActionLink=true ~isMessagePart=true link=false",props:{link:!1},ctx:{thread:n,instantActionLink:!0,isMessagePart:!0},args:[]}]},paths:[],_ctxs:"instantActionsControl"},{fn:function(n){return[{tmpl:5,params:"Categories",props:{},args:[n.Categories]}]},paths:["Categories"],_ctxs:"if"},{fn:function(n){return[{tmpl:6,params:"IsBodyExpanded",props:{},args:[n.IsBodyExpanded]}]},paths:["IsBodyExpanded"],_ctxs:"if"},{fn:function(n){return{params:"Snippet",props:{},args:[n.Snippet]}},paths:["Snippet"],_ctxs:">"},{fn:function(n){return{params:"SenderDetails IsContentFiltered",props:{},args:[n.SenderDetails,n.IsContentFiltered]}},paths:["SenderDetails","IsContentFiltered"],_ctxs:"renderICControl:"},{fn:function(n){return[{tmpl:7,params:"TaggingDescription && !IsPrint",props:{},args:[n.TaggingDescription&&!n.IsPrint]}]},paths:["TaggingDescription","IsPrint"],_ctxs:"if"},{fn:function(n){return[{tmpl:8,params:"To ",props:{},args:[n.To]}]},paths:["To"],_ctxs:"if"},{fn:function(n){return[{tmpl:9,params:"Cc ",props:{},args:[n.Cc]}]},paths:["Cc"],_ctxs:"if"},{fn:function(n){return[{tmpl:10,params:"Bcc ",props:{},args:[n.Bcc]}]},paths:["Bcc"],_ctxs:"if"},{fn:function(n,t){return[{tmpl:12,params:"AttachmentsHtml && SafetyType !== ~HM.BodySafetyType.Unsafe",props:{},args:[n.AttachmentsHtml&&n.SafetyType!==t.hlp("HM").BodySafetyType.Unsafe]}]},paths:["AttachmentsHtml","SafetyType","~HM.BodySafetyType.Unsafe"],_ctxs:"if"}],_is:"template",allowCode:!0,tmplName:"readMessagePartHeaderTemplate",htmlTag:"div",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._tag,o=i._cnvt,u="";return u+='  <div class="c-ReadMessagePartHeader" ',u+=(f=t.hlp("sutra")("MessagePartHeader"))!=r?f:"",u+=">    ",u+="    ",n.IsPrint||(u+='    <div class="',u+=o("fromContainerClass",t,{params:"IsBodyExpanded Collapsible",props:{},args:[n.IsBodyExpanded,n.Collapsible]}),u+='" data-link="class{fromContainerClass:IsBodyExpanded Collapsible}">      <div class="ReadMsgFrom FloatLeft" ',u+=(f=t.hlp("sutra")("Hotmail.Title"))!=r?f:"",u+='>        <div class="MsgPropertiesWrapper">          <div class="MsgProperties">            <div class="SenderLine FloatLeft">              <div class="FloatRight ClearRight NoWrap">                <div class="',u+=(f=t.hlp("tag").showActionsMenuCss(n.IsBodyExpanded,t.hlp("readMessage").ShowActionMenu))!=r?f:"",u+='" data-link="class{:~tag.showActionsMenuCss(IsBodyExpanded, ~readMessage.ShowActionMenu)}">                  <span class="mp0_act">                    <div class="',u+=o("menuContainerClass",t,{params:"HistoryType ~tag.Expanded",props:{},args:[n.HistoryType,t.hlp("tag").Expanded]}),u+='" data-link="class{menuContainerClass:HistoryType ~tag.Expanded}" ',u+=(f=t.hlp("sutra")("messagepartactions"))!=r?f:"",u+=">                      ",u+=e("if",t,this,1),u+='                    <\/div>                  <\/span>                <\/div>              <\/div>              <div class="SenderLineLeft">                ',u+=e("if",t,this,[{tmpl:2,params:"IsDraft",props:{},args:[n.IsDraft]}]),u+='                <div class="MessageHeaderItem">                  ',n.SenderDetails&&(u+='                  <a class="t_atc ICName" ',u+=(f=t.hlp("sutra")("From"))!=r?f:"",u+=">                    ",u+=(f=t.hlp("ol").config.LrmEntityMarkIfRtl)!=r?f:"",u+=" ",u+=o("getIcFullName",t,2),u+=" ",u+=(f=t.hlp("ol").config.LrmEntityMarkIfRtl)!=r?f:"",u+="                  <\/a>                  "),u+="                  ",!n.SenderDetails||n.SenderDetails.isSenderInContactList||n.SenderDetails.isSenderSelf||n.SenderDetails.isSenderInWhiteList||(u+='                  <span class="UnsafeSenderEmail" ',u+=(f=t.hlp("sutra")("Hotmail.Email"))!=r?f:"",u+=">                    ",u+=o("getFromAddress",t,3),u+="                  <\/span>                  "),u+="                <\/div>                ",n.SenderDetails&&n.SenderDetails.isTrustedSender&&(u+='                <div class="TrustedSenderIcon MessageHeaderItem" ',u+=(f=t.hlp("sutra")("TrustedSenderMessageIcon"))!=r?f:"",u+=' title="',u+=(f=t.hlp("ol").GetString("ReadMessage.TrustedSender.Popup.Text"))!=r?f:"",u+='">                  <img class="i_ts" src="./clear.gif" alt="" />                <\/div>                '),u+='                <div class="MessageHeaderItem">                  ',u+=e("if",t,this,4),u+="                <\/div>                ",n.Importance===HM.ImportanceType.HIGH?(u+='                <div class="MessageHeaderItem ImportanceIcon">                  <img class="i_imp_hi_s" alt="',u+=(f=t.hlp("ol").GetString("MessageList.Icons.HighPri.AltText"))!=r?f:"",u+='" src="./clear.gif" ',u+=(f=t.hlp("sutra")("HighImportanceIcon"))!=r?f:"",u+="/>                <\/div>                "):n.Importance===HM.ImportanceType.LOW&&(u+='                <div class="MessageHeaderItem ImportanceIcon">                  <img class="i_imp_lo_s" alt="',u+=(f=t.hlp("ol").GetString("MessageList.Icons.LowPri.AltText"))!=r?f:"",u+='" src="./clear.gif" ',u+=(f=t.hlp("sutra")("LowImportanceIcon"))!=r?f:"",u+="/>                <\/div>                "),u+="                ",n.HasAttachments&&(u+='                <div class="MessageHeaderItem AttachmentIcon">                  <img class="i_att_s" alt="',u+=(f=t.hlp("ol").GetString("MessageList.Icons.Attachment.AltText"))!=r?f:"",u+='" src="./clear.gif" ',u+=(f=t.hlp("sutra")("AttachmentIcon"))!=r?f:"",u+="/>                <\/div>                "),u+='                <div class="MessageHeaderItem">                  <span class="Date TextSizeSmall" ',u+=(f=t.hlp("sutra")("Date"))!=r?f:"",u+=">                    ",n.HasElv&&n.displayElv?(u+="                    ",u+=(f=t.hlp("ol").GetString("LiveViews.External.Updating"))!=r?f:"",u+="                    "):(u+="                    ",u+=(f=n.DateReceivedLocal)!=r?f:"",u+="                    "),u+="                  <\/span>                <\/div>                ",t.hlp("tag").shouldShowFlag()&&(u+='                <div class="MessageHeaderItem InstantActions">                  ',u+=e("instantActionsControl",t,this,5),u+="                <\/div>                "),u+="                ",u+=e("if",t,this,6),u+='              <\/div>            <\/div>            <div class="ReadMsgTo TextSizeSmall ClearLeft">              ',u+=e("if",t,this,7),u+='            <\/div>            <div class="',u+=o("snippetClass",t,{params:"IsBodyExpanded HasFakeSnippet",props:{},args:[n.IsBodyExpanded,n.HasFakeSnippet]}),u+='" data-link="class{snippetClass:IsBodyExpanded HasFakeSnippet}" ',u+=(f=t.hlp("sutra")("Snippet"))!=r?f:"",u+=">              ",u+=o("html",t,8),u+="            <\/div>          <\/div>        <\/div>        ",u+=o("renderICControl",t,9),u+="      <\/div>    <\/div>    "),u+='    <div class="',u+=o("getClass",t,{params:"((~tag.Expanded && IsBodyExpanded) || IsPrint) 'ReadMsgHeaderDetail'",props:{},args:[t.hlp("tag").Expanded&&n.IsBodyExpanded||n.IsPrint,"ReadMsgHeaderDetail"]}),u+='" data-link="class{getClass:((~tag.Expanded && IsBodyExpanded) || IsPrint) \'ReadMsgHeaderDetail\'}">      <div id="" class="ReadMsgHeaderContainer ClearBoth" ',u+=(f=t.hlp("sutra")("ReadMsgHeader"))!=r?f:"",u+='>        <div class="Gap"><\/div>        <div class="ReadMsgHeader TextSizeSmall t_mbgc t_atc">          <table cellpadding="0" cellspacing="0">            <tbody>            <tr class="Header">              <td class="ReadMsgHeaderCol1">                ',u+=(f=t.hlp("ol").GetString("MessageHeader.From"))!=r?f:"",u+="              <\/td>              <td>                ",n.SenderDetails&&(u+="                <span ",u+=(f=t.hlp("sutra")("From"))!=r?f:"",u+=">&nbsp;",u+=o("getDisplayName",t,{params:"SenderDetails",props:{},args:[n.SenderDetails]}),u+="<\/span>                "),u+="                ",u+=e("if",t,this,10),u+='              <\/td>            <\/tr>            <tr class="Header">              <td class="ReadMsgHeaderCol1">                ',u+=o("getDraftStr",t,{params:"IsDraft",props:{},args:[n.IsDraft]}),u+="              <\/td>              <td ",u+=(f=t.hlp("sutra")("Sent"))!=r?f:"",u+=">                ",u+=(f=n.DateReceivedLocalFull)!=r?f:"",u+='              <\/td>            <\/tr>            <tr class="Header">              <td class="ReadMsgHeaderCol1">                ',u+=(f=t.hlp("ol").GetString("MessageHeader.To"))!=r?f:"",u+="              <\/td>              <td ",u+=(f=t.hlp("sutra")("To"))!=r?f:"",u+=">                ",u+=e("if",t,this,11),u+="              <\/td>            <\/tr>            ",u+=e("if",t,this,12),u+="            ",u+=e("if",t,this,13),u+="            ",n.DetectedCodePages&&n.DetectedCodePages.length>0&&(u+='            <tr>              <td class="ReadMsgHeaderCol1">                ',u+=(f=t.hlp("ol").GetString("ReadMessage.Encoding"))!=r?f:"",u+='              <\/td>              <td>                <select class="codePageMenu">                  ',u+=e("for",t,this,[{tmpl:11,params:"~tag.getCodePages()",props:{},args:[t.hlp("tag").getCodePages()]}]),u+="                <\/select>              <\/td>            <\/tr>            "),u+="            ",u+=e("if",t,this,14),u+="            ",u+"            <\/tbody>          <\/table>        <\/div>      <\/div>    <\/div>  <\/div>"}}},n["#printMessageTemplate"]={tmpls:[{tmpls:[{tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"",tmplName:"printMessageTemplate/if/for",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+="        ",r+=u("readMessagePartControl",t,this,[{tmpl:0,params:"thread=#data",props:{thread:n},args:[]}]),r+"      "}}}],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"",tmplName:"printMessageTemplate/if",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+="      ",r+=u("for",t,this,[{tmpl:1,params:"Items",props:{},args:[n.Items]}]),r+"    "}}},{tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"",tmplName:"printMessageTemplate/if",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+="      ",r+=u("readMessagePartControl",t,this,[{tmpl:0,params:"thread=#data",props:{thread:n},args:[]}]),r+"    "}}}],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,tmplName:"printMessageTemplate",htmlTag:"div",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._tag,u="";return u+='  <div class="c-PrintMessage">    <h2 class="ReadMsgSubject TextSizeLarge">',u+=(f=n.SubjectWithHtml)!=r?f:"",u+="<\/h2>    ",u+="    ",u+=e("if",t,this,[{tmpl:1,params:"Items",props:{},args:[n.Items]}]),u+="    ",u+="    ",u+=e("if",t,this,[{tmpl:2,params:"Items.length == 0",props:{},args:[n.Items.length==0]}]),u+"  <\/div>"}}},n["#reauthenticationTemplate"]={tmpls:[{tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"img",tmplName:"reauthenticationTemplate/if",fn:{fn:function(n,t,i){var i=i||jsviews;return'      <img data-link="src{:SilentReauthUrl}" style="display:none;width:0px;height:0px;" onerror="jQuery(this).view().ctx.tag.onImageLoadError()"><\/img>      '}}}],links:{},tags:{},bnds:[{fn:function(n){return[{tmpl:1,params:"SilentReauthUrl",props:{},args:[n.SilentReauthUrl]}]},paths:["SilentReauthUrl"],_ctxs:"if"}],_is:"template",allowCode:!0,tmplName:"reauthenticationTemplate",htmlTag:"div",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+='  <div class="reauthenticationDiv">      ',r+=u("if",t,this,1),r+'      <iframe id="bounceIfr" scrolling="no" marginheight="0" marginwidth="0" frameborder="0" framespacing="0" style="display:none;width:0px;height:0px;border-style:none;" src="javascript:\'\';"><\/iframe>  <\/div>'}}},n["#junkSenderDialogTmpl"]={tmpls:[{tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"div",tmplName:"junkSenderDialogTmpl/if",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i.converters.html,u="";return u+='            <div class="Checkboxes">                <input type="checkbox" id="cmpCbx" ',u+=(f=t.hlp("sutra")("Checkbox"))!=r?f:"",u+='>                <label for="cmpCbx" ',u+=(f=t.hlp("sutra")("CheckboxText"))!=r?f:"",u+=">",u+=e(n.checkbox),u+"<\/label>            <\/div>        "}}}],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,tmplName:"junkSenderDialogTmpl",htmlTag:"div",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._tag,o=i.converters.html,u="";return u+="    <div>        <div ",u+=(f=t.hlp("contentSutra")("title"))!=r?f:"",u+=">",u+=o(n.message),u+="<\/div>        ",u+=e("if",t,this,[{tmpl:1,params:"checkbox ",props:{},args:[n.checkbox]}]),u+"    <\/div>"}}},n["#linkTmpl"]={tmpls:[{tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"",tmplName:"linkTmpl/if",fn:{fn:function(n,t,i){var i=i||jsviews,u=i.converters.html,r="";return r+='      target="',r+=u(n.Target),r+'"    '}}},{tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"",tmplName:"linkTmpl/if",fn:{fn:function(n,t,i){var i=i||jsviews,u=i.converters.html,r="";return r+='        class="',r+=u(n.ClassName),r+'"    '}}},{tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"",tmplName:"linkTmpl/if",fn:{fn:function(n,t,i){var i=i||jsviews,u=i.converters.html,r="";return r+='      onclick="',r+=u(n.OnclickAction),r+'"    '}}},{tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"",tmplName:"linkTmpl/if",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,u="";return u+="      ",u+=(f=n.OtherAttributes)!=r?f:"",u+"    "}}}],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,tmplName:"linkTmpl",htmlTag:"a",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,f=i.converters.html,r="";return r+='  <a href="',r+=f(n.Url),r+='"    ',r+=u("if",t,this,[{tmpl:1,params:"Target",props:{},args:[n.Target]}]),r+="    ",r+=u("if",t,this,[{tmpl:2,params:"ClassName",props:{},args:[n.ClassName]}]),r+="    ",r+=u("if",t,this,[{tmpl:3,params:"OnclickAction",props:{},args:[n.OnclickAction]}]),r+="    ",r+=u("if",t,this,[{tmpl:4,params:"OtherAttributes",props:{},args:[n.OtherAttributes]}]),r+="  >  ",r+=f(n.LinkText),r+"  <\/a>"}}},n["#archiveDialogTmpl"]={tmpls:[{tmpls:[{tmpls:[],links:{},tags:{},bnds:[{fn:function(n,t){return[{tmpl:0,params:"~tag.FolderSelector ",props:{},args:[t.hlp("tag").FolderSelector]}]},paths:["~tag.FolderSelector"],_ctxs:"containerSelectorControl"}],_is:"template",allowCode:!0,htmlTag:"input",tmplName:"archiveDialogTmpl/if/if",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._tag,u="";return u+='          <input type="radio" id="archiveDialogUpdateFolderId" name="archiveFolderSelection" checked="checked" ',u+=(f=t.hlp("sutra")("archivefreexistingfolderoption"))!=r?f:"",u+=' />          <label for="archiveDialogUpdateFolderId">',u+=(f=n.optionUpdate)!=r?f:"",u+="<\/label>          ",u+=e("containerSelectorControl",t,this,1),u+"        "}}},{tmpls:[],links:{},tags:{},bnds:[{fn:function(n,t){return[{tmpl:0,params:"~tag.FolderSelector ",props:{},args:[t.hlp("tag").FolderSelector]}]},paths:["~tag.FolderSelector"],_ctxs:"containerSelectorControl"}],_is:"template",allowCode:!0,htmlTag:"input",tmplName:"archiveDialogTmpl/if/else",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._tag,u="";return u+='          <input type="hidden" id="archiveDialogUpdateFolderId" value="do" />          <label for="archiveDialogUpdateFolderId">',u+=(f=n.optionUpdate)!=r?f:"",u+="<\/label>          ",u+=e("containerSelectorControl",t,this,1),u+"        "}}}],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"div",tmplName:"archiveDialogTmpl/if",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+='        <div class="inlineModalError" aria-live="assertive"><\/div>        ',r+=u("if",t,this,[{tmpl:1,params:"showCreateNew",props:{},args:[n.showCreateNew]},{tmpl:2,params:"",props:{},args:[]}]),r+"      "}}},{tmpls:[{tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"input",tmplName:"archiveDialogTmpl/if/if",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,u="";return u+='          <input type="radio" id="archiveDialogAddFolderId" name="archiveFolderSelection" ',u+=(f=t.hlp("sutra")("archivefrenewfolderoption"))!=r?f:"",u+=' />          <label for="archiveDialogAddFolderId">',u+=(f=n.optionAdd)!=r?f:"",u+"<\/label>        "}}},{tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"input",tmplName:"archiveDialogTmpl/if/else",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,u="";return u+='          <input type="hidden" id="archiveDialogAddFolderId" value="do" />          <label for="archiveDialogAddFolderId">',u+=(f=n.optionAdd)!=r?f:"",u+"<\/label>        "}}}],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"div",tmplName:"archiveDialogTmpl/if",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+='      <div class="archiveDialog_Item">        ',r+=u("if",t,this,[{tmpl:1,params:"showUseExisting",props:{},args:[n.showUseExisting]},{tmpl:2,params:"",props:{},args:[]}]),r+"      <\/div>    "}}}],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,tmplName:"archiveDialogTmpl",htmlTag:"div",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._tag,u="";return u+='  <div class="archiveDialog">    <div class="archiveDialog_Item archiveDialog_ItemPadding">',u+=(f=n.desc)!=r?f:"",u+='<\/div>    <div class="archiveDialog_Item archiveDialog_ItemPadding">      ',u+=e("if",t,this,[{tmpl:1,params:"showUseExisting",props:{},args:[n.showUseExisting]}]),u+="    <\/div>    ",u+=e("if",t,this,[{tmpl:2,params:"showCreateNew",props:{},args:[n.showCreateNew]}]),u+"  <\/div>"}}},n["#categorizeAllTemplate"]={tmpls:[{tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"div",tmplName:"categorizeAllTemplate/if",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i.converters.html,u="";return u+='    <div class="categoriesUpdates" ',u+=(f=t.hlp("sutra")("CategorizeAllFlyoutAddCategories"))!=r?f:"",u+=" >        ",u+=e(n.addedCategories),u+"    <\/div>    "}}},{tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"div",tmplName:"categorizeAllTemplate/if",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i.converters.html,u="";return u+='    <div class="categoriesUpdates" ',u+=(f=t.hlp("sutra")("CategorizeAllFlyoutRemoveCategories"))!=r?f:"",u+=" >        ",u+=e(n.removedCategories),u+"    <\/div>    "}}}],links:{},tags:{},bnds:[{fn:function(n){return[{tmpl:0,params:'#data tmpl="#bulkActionsSenderTemplate" ',props:{tmpl:"#bulkActionsSenderTemplate"},args:[n]}]},paths:["#data"],_ctxs:"for"}],_is:"template",allowCode:!0,tmplName:"categorizeAllTemplate",htmlTag:"div",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._tag,u="";return u+="    <div>        ",u+=e("for",t,this,1),u+="    <\/div>    ",u+=e("if",t,this,[{tmpl:1,params:"isAddingCategories",props:{},args:[n.isAddingCategories]}]),u+="    ",u+=e("if",t,this,[{tmpl:2,params:"isRemovingCategories",props:{},args:[n.isRemovingCategories]}]),u+='    <div>        <input type="checkbox" name="futureMessages" id="categorizeAllOption_futureMessages" checked="checked" ',u+=(f=t.hlp("sutra")("Checkbox"))!=r?f:"",u+=' />        <label for="categorizeAllOption_futureMessages">',u+=(f=t.hlp("ol").GetString("EnhancedRules.CategorizeAll.OptionDialog.Checkbox.Label"))!=r?f:"",u+"<\/label>    <\/div>"}}},n["#bulkActionsSenderTemplate"]={tmpls:[{tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"div",tmplName:"bulkActionsSenderTemplate/if",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,u="";return u+='    <div class="singleSenderDesc" ',u+=(f=t.hlp("sutra")("singlesender"))!=r?f:"",u+=">",u+=(f=n.singleSenderDesc)!=r?f:"",u+"<\/div>    "}}},{tmpls:[{tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"li",tmplName:"bulkActionsSenderTemplate/else/for",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,u="";return u+="          <li ",u+=(f=t.hlp("sutra")("multisender"))!=r?f:"",u+=">",u+=(f=n)!=r?f:"",u+"<\/li>        "}}}],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"div",tmplName:"bulkActionsSenderTemplate/else",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._tag,u="";return u+='    <div class="multiSenderDesc">',u+=(f=n.multiSenderDesc)!=r?f:"",u+='<\/div>    <div class="sendersListContainer">      <ul ',u+=(f=t.hlp("sutra")("multisenders"))!=r?f:"",u+=">        ",u+=e("for",t,this,[{tmpl:1,params:"FriendlySenders",props:{},args:[n.FriendlySenders]}]),u+"      <\/ul>    <\/div>    "}}}],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,tmplName:"bulkActionsSenderTemplate",htmlTag:"div",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+="    ",r+=u("if",t,this,[{tmpl:1,params:"isSingleSender",props:{},args:[n.isSingleSender]},{tmpl:2,params:"",props:{},args:[]}]),r+""}}},n["#moveAllFromTemplate"]={tmpls:[],links:{},tags:{},bnds:[{fn:function(n){return[{tmpl:0,params:'#data tmpl="#bulkActionsSenderTemplate" ',props:{tmpl:"#bulkActionsSenderTemplate"},args:[n]}]},paths:["#data"],_ctxs:"for"},{fn:function(n,t){return[{tmpl:0,params:"~tag.FolderSelector ",props:{},args:[t.hlp("tag").FolderSelector]}]},paths:["~tag.FolderSelector"],_ctxs:"containerSelectorControl"}],_is:"template",allowCode:!0,tmplName:"moveAllFromTemplate",htmlTag:"div",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._tag,u="";return u+="    <div>        ",u+=e("for",t,this,1),u+='        <div>            <div class="moveOption">                <input type="radio" id="moveAllOption_move" name="moveAction" checked="" ',u+=(f=t.hlp("sutra")("moveOption"))!=r?f:"",u+=' />                <label for="moveAllOption_move">',u+=(f=n.optionMoveAll)!=r?f:"",u+='<\/label>            <\/div>            <div class="moveOption">                <input type="radio" id="moveAllOption_moveAndCreateRule" name="moveAction" ',u+=(f=t.hlp("sutra")("moveCreateRuleOption"))!=r?f:"",u+=' />                <label for="moveAllOption_moveAndCreateRule">',u+=(f=n.optionMoveAllCreateRule)!=r?f:"",u+='<\/label>            <\/div>            <div class="moveOption">                <input type="radio" id="moveAllOption_keepLatest" name="moveAction" ',u+=(f=t.hlp("sutra")("moveKeepLatestOption"))!=r?f:"",u+=' />                <label for="moveAllOption_keepLatest">',u+=(f=t.hlp("ol").GetString("BulkAction.MoveAllFromSender.Flyout.Option.MoveAllExceptMostRecent"))!=r?f:"",u+='<\/label>            <\/div>            <div class="moveOption LastRow">                <input type="radio" id="moveAllOption_keepLatest10Days" name="moveAction" ',u+=(f=t.hlp("sutra")("moveKeepLast10Option"))!=r?f:"",u+=' />                <label for="moveAllOption_keepLatest10Days">',u+=(f=t.hlp("ol").GetString("BulkAction.MoveAllFromSender.Flyout.Option.MoveAllOlderThan10Days"))!=r?f:"",u+='<\/label>            <\/div>        <\/div>        <div class="folderPicker" ',u+=(f=t.hlp("sutra")("InboxToolbarMoveToItem"))!=r?f:"",u+='>            <label for="moveAllFolderPicker">',u+=(f=t.hlp("ol").GetString("BulkAction.MoveAllFromSender.Flyout.FolderPickerLabel"))!=r?f:"",u+='<\/label>            <span id="moveAllFolderPicker" class="c_mcp">',u+=e("containerSelectorControl",t,this,2),u+"<\/span>        <\/div>    <\/div>"}}},n["#sweepTemplate"]={tmpls:[],links:{},tags:{},bnds:[{fn:function(n){return[{tmpl:0,params:'#data tmpl="#bulkActionsSenderTemplate"',props:{tmpl:"#bulkActionsSenderTemplate"},args:[n]}]},paths:["#data"],_ctxs:"for"}],_is:"template",allowCode:!0,tmplName:"sweepTemplate",htmlTag:"div",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._tag,u="";return u+="  <div>      ",u+=e("for",t,this,1),u+='      <div>      <div class="sweepOption" ',u+=(f=t.hlp("sutra")("sweepOption"))!=r?f:"",u+='>        <input type="radio" id="sweepOption_all" name="sweepAction" checked ',u+=(f=t.hlp("sutra")("Radiobutton"))!=r?f:"",u+=' />        <label for="sweepOption_all">          <span class="sweepOptionText">',u+=(f=n.optionSweepAll)!=r?f:"",u+='<\/span>        <\/label>      <\/div>      <div class="sweepOption" ',u+=(f=t.hlp("sutra")("sweepCreateRuleOption"))!=r?f:"",u+=' >        <input type="radio" id="sweepOption_allAndCreateRule" name="sweepAction" ',u+=(f=t.hlp("sutra")("Radiobutton"))!=r?f:"",u+=' />        <label for="sweepOption_allAndCreateRule">          <span class="sweepOptionText">',u+=(f=n.optionSweepAllCreateRule)!=r?f:"",u+='<\/span>        <\/label>      <\/div>      <div class="sweepOption" ',u+=(f=t.hlp("sutra")("sweepKeepLatestOption"))!=r?f:"",u+=' >        <input type="radio" id="sweepOption_keepLatest" name="sweepAction" ',u+=(f=t.hlp("sutra")("Radiobutton"))!=r?f:"",u+=' />        <label for="sweepOption_keepLatest">          <span class="sweepOptionText">',u+=(f=n.optionSweepKeepLatest)!=r?f:"",u+='<\/span>        <\/label>      <\/div>      <div class="sweepOption LastRow" ',u+=(f=t.hlp("sutra")("sweepKeepLast10DaysOption"))!=r?f:"",u+=' >        <input type="radio" id="sweepOption_keepLatest10Days" name="sweepAction" ',u+=(f=t.hlp("sutra")("Radiobutton"))!=r?f:"",u+=' />        <label for="sweepOption_keepLatest10Days">          <span class="sweepOptionText">',u+=(f=n.optionSweepKeepLatest10Days)!=r?f:"",u+"<\/span>        <\/label>      <\/div>    <\/div>  <\/div>"}}},n["#watermarkedInputTemplate"]={tmpls:[{tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"input",tmplName:"watermarkedInputTemplate/if",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,e=i._cnvt,u="";return u+="        <input ",u+=(f=t.hlp("sutra")(t.hlp("sutraTag")))!=r?f:"",u+='                 type="text"                 autocomplete="',u+=(f=t.hlp("autocomplete"))!=r?f:"",u+='"                 spellcheck="',u+=(f=t.hlp("spellCheck"))!=r?f:"",u+='"                 name="',u+=(f=t.hlp("name"))!=r?f:"",u+='"                 class="',u+=(f=t.hlp("tag").ClassName)!=r?f:"",u+='"                 maxlength="',u+=(f=t.hlp("maxLength"))!=r?f:"",u+='"                 data-link="value{:',u+=(f=t.hlp("tag").PropertyName)!=r?f:"",u+=':}"                 aria-label="',u+=(f=t.hlp("ariaLabel"))!=r?f:"",u+='"                 placeholder="',u+=e("attr",t,{params:"~placeholder",props:{},args:[t.hlp("placeholder")]}),u+='"                 id="',u+=(f=t.hlp("tag").ControlNamespace)!=r?f:"",u+'"/>    '}}},{tmpls:[],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,htmlTag:"div",tmplName:"watermarkedInputTemplate/else",fn:{fn:function(n,t,i,r){var i=i||jsviews,f,u="";return u+='        <div class="WatermarkedInputContainer">            <input ',u+=(f=t.hlp("sutra")(t.hlp("sutraTag")))!=r?f:"",u+='                     type="text"                     autocomplete="',u+=(f=t.hlp("autocomplete"))!=r?f:"",u+='"                     spellcheck="',u+=(f=t.hlp("spellCheck"))!=r?f:"",u+='"                     name="',u+=(f=t.hlp("name"))!=r?f:"",u+='"                     class="',u+=(f=t.hlp("tag").ClassName)!=r?f:"",u+='"                     maxlength="',u+=(f=t.hlp("maxLength"))!=r?f:"",u+='"                     data-link="value{:',u+=(f=t.hlp("tag").PropertyName)!=r?f:"",u+=':}"                     aria-label="',u+=(f=t.hlp("ariaLabel"))!=r?f:"",u+='"                     id="',u+=(f=t.hlp("tag").ControlNamespace)!=r?f:"",u+='"/>            <div class="Watermark">                ',u+=(f=t.hlp("placeholder"))!=r?f:"",u+"            <\/div>        <\/div>    "}}}],links:{},tags:{},bnds:[],_is:"template",allowCode:!0,tmplName:"watermarkedInputTemplate",htmlTag:"input",fn:{fn:function(n,t,i){var i=i||jsviews,u=i._tag,r="";return r+="    ",r+=u("if",t,this,[{tmpl:1,params:"~ol.BrowserCapabilities.placeholder",props:{},args:[t.hlp("ol").BrowserCapabilities.placeholder]},{tmpl:2,params:"",props:{},args:[]}]),r+""}}}})(),function(n){"use strict";var r=window,t=r.$Event=function(){},i;t.prototype={dispose:function(){},attach:function(t){n(this).bind("evt",t)},detach:function(t){n(this).unbind("evt",t)},fire:function(t){n(this).trigger("evt",t)}},t.Manager=r.$Event.Manager=function(t,i){var u=t.attach,r,f,e;this.events=[];for(r in i)u?t[r].attach(i[r]):(f=r.replace(/^on/,""),e=i[r],this.events[r]=function(n){return e(n.originalEvent)},n(t).bind(f,this.events[r]));this.s=t,this.e=i,this.t=u},t.Manager.prototype={dispose:function(){var i=this.s,t,r;for(t in this.e)this.t?i[t].detach(this.e[t]):(r=t.replace(/^on/,""),n(i).unbind(r,this.events[t]));this.s=this.e=null}},i=r.$Memory=function(){var n=i;this.Nodes=new n.Nodes,this.Events=new n.Events,this.Properties=new n.Properties},new function(){var n=i,r="__0";n.prototype={dispose:function(){this.Events.dispose(),this.Nodes.dispose(),this.Properties.dispose()}},n.Groups=function(){this.groups={}},n.Groups.prototype={create:function(n){return this.groups[n||(n=r)]||(this.groups[n]=new i),this.groups[n]},disposeGroup:function(n){this.groups[n||(n=r)]&&this.groups[n].dispose()},dispose:function(){for(var n in this.groups)this.groups[n].dispose();this.groups={}}},n.Events=function(){this.events=new n.Properties},n.Events.prototype={register:function(n,i){this.add(new t.Manager(n,i))},add:function(n){this.events.register(n)},dispose:function(){this.events.dispose(),this.events=new n.Properties}},n.Nodes=function(){this.nodes=[]},n.Nodes.prototype={register:function(n){return this.nodes.push(n),n},create:function(n,t,i,r){var f=_ce(n),u;for(u in t)f[u]=t[u];for(u in i)f.style[u]=i[u];return r&&r.appendChild(f),this.register(f)},dispose:function(){for(var n;n=this.nodes.pop();)n.removeNode&&n.removeNode(!0);this.nodes=[]}},n.Properties=function(){this.properties=[]},n.Properties.prototype={register:function(n){n.initialize&&n.initialize(),this.properties.push(n)},dispose:function(){for(var n;n=this.properties.pop();)n.dispose&&n.dispose();this.properties=[]}}}}(window.originaljQuery||window.jQuery),function(n){"use strict";function s(t){var e=[],o=[],u,s,f;if(i.length===0&&r.length===0)return n.Deferred().resolve();for(u=0;u<r.length;u++)s=r[u],f=s(t),f&&e.push(f);return n.when.apply(n,e).pipe(function(){for(var f,u,r=0;r<i.length;r++)f=i[r],u=f(t),u&&o.push(u);return n.when.apply(n,o)},function(n){t.deferred&&t.deferred.reject(n)})}var t=window.ol=window.ol||{},o={},f=[],h=1,c=n.Deferred().reject(),i=[],r=[],e=n.extend({},{samplecommand:{responseRequired:!1,args:[]}}),u=t.Cmd=function(i){function v(n){if(t.config.enableTraceWindow)for(var i=0;i<f.length;i++)if(f[i].id===n.id){f.splice(i,1);break}}function y(i,r,u){var e={id:h++,name:i,settings:r};return r.responseRequired?(e.deferred=n.Deferred(),r.csiPerfRequired&&(e.csiPerfDeferred=n.Deferred(),e.deferred.then(e.csiPerfDeferred.resolve,e.csiPerfDeferred.reject)),t.config.enableTraceWindow&&f.push(e),e.deferred.then(function(){v(e)},function(){v(e)})):e.deferred=c,e.args=u,e}var r,u,l,a;return r=i.toLowerCase(),u=e[r],l=o[r],l||(a=n.simpleCallbacks(),l={fire:function(n){var t=y(r,u,n);return s(t).then(function(){a.fire.call(t,n)},t.deferred.reject),u.responseRequired||(t.deferred=null),t},bubble:function(i,f){var o=null,h=null,e;return i&&t.dom&&(t.dom.isElement(i)||t.dom.isNode(i))?o=i:i._is==="tag"&&(h=i),e=y(r,u,f),s(e).then(function(){for(var t=h||n.view(o).ctx&&n.view(o).ctx.tag,u=t,i=!0,r=[t,e,f];t&&i;)typeof t.onCmdBubble=="function"&&(i=t.onCmdBubble.apply(t,r),typeof i=="undefined"&&(i=!0)),t=t.parent||t._.parentTag},e.deferred.reject),e},subscribe:a.add,unsubscribe:a.remove,unsubscribeAll:a.empty},u&&(o[r]=l)),l};u.register=function(t){n.extend(e,t)},u.unsubscribeAllCommands=function(){for(var n in e)u(n).unsubscribeAll()},u.registerExecutionStrategy=function(t,u){u&&n.inArray(t,r)===-1?r.push(t):u||n.inArray(t,i)!==-1||i.push(t)},u.unregisterExecutionStrategy=function(t,u){var f=u?r:i,e=n.inArray(t,f);e!==-1&&f.splice(e,1)},t.Cmd.registerExecutionStrategy(function(n){if(n.settings.resourceSet&&t.init)return t.init.Load(n.settings.resourceSet,!0)}),u.exists=function(n){return e[n]!=null}}(window.originaljQuery||window.jQuery),function(n){"use strict";function i(){return[HM.QueryType.ContainerQuery]}function t(){return[HM.QueryType.ItemListQuery,HM.QueryType.MessageGroupQuery,HM.QueryType.ContainerQuery]}function e(){return[HM.QueryType.ItemListQuery]}function r(){return[HM.QueryType.RulesQuery]}function u(){return[HM.QueryType.RulesQuery,HM.QueryType.ContainerQuery]}var o=ol.CommandRegistry||{},f={get:{responseRequired:!0,doesNotModifyCache:!0,args:[{name:"queries",type:Object},{name:"progressCallback",type:Function}],keepInlineCompose:!0},refresh:{responseRequired:!0,isBlocking:!0,args:[{name:"queries",type:Object},{name:"progressCallback",type:Function},{name:"isRefreshMessageList",type:Boolean,optional:!0}],meter:{delay:200,groupName:"refresh",ignoreFirst:!0}},getandmarkasread:{responseRequired:!0,affectedQueryTypes:t,throttle:{filters:[{cmdArg:"shouldThrottle",equals:!0}]},args:[{name:"items",type:Array},{name:"asRead",type:Boolean},{name:"getAffectedHeaders",type:Boolean,defaultValue:!1},{name:"queries",type:Object},{name:"progressCallback",type:Function},{name:"shouldThrottle",type:Boolean,optional:!0},{name:"throttleActionTime",type:Number,optional:!0},{name:"maxThrottleActions",type:Number,optional:!0},{name:"allowUnknownItems",type:Boolean,optional:!0},{name:"isImplicit",type:Boolean,optional:!0}]},bulkactions:{responseRequired:!0,isBlocking:!0,args:[{name:"actions",type:Array},{name:"msgs",type:Array},{name:"mads",type:Array},{name:"suppressListTransition",type:Boolean},{name:"restrictActionToView",type:Boolean},{name:"batchInfo",type:Object},{name:"isBulk",type:Boolean},{name:"getAffectedHeaders",type:Boolean,defaultValue:!1},{name:"queries",type:Object}]},setconversationmode:{responseRequired:!0,isBlocking:!0,args:[{name:"conversationSetting",type:Boolean},{name:"queries",type:Object},{name:"progressCallback",type:Function}]},autorefresh:{responseRequired:!0,isBlocking:!0,args:[{name:"queries",type:Object},{name:"progressCallback",type:Function}],meter:{delay:200,groupName:"refresh",ignoreFirst:!0}},undomoveitems:{responseRequired:!0,affectedQueryTypes:t,isBlocking:!0,args:[{name:"undoId",type:Object},{name:"queries",type:Object},{name:"progressCallback",type:Function}]},moveitems:{responseRequired:!0,affectedQueryTypes:t,args:[{name:"items",type:Array},{name:"includeDuplicates",type:Boolean},{name:"destId",type:String},{name:"unFlag",type:Boolean},{name:"markRead",type:Boolean},{name:"blockIfDelete",type:Boolean},{name:"skipFocus",type:Boolean,optional:!0},{name:"getAffectedHeaders",type:Boolean,defaultValue:!1},{name:"queries",type:Object},{name:"progressCallback",type:Function}]},batchmoveitems:{responseRequired:!0,blockingWhiteList:["setbulkactioncountupdate"],isBlocking:!0,args:[{name:"destId",type:String},{name:"unFlag",type:Boolean},{name:"markRead",type:Boolean},{name:"blockIfDelete",type:Boolean},{name:"getAffectedHeaders",type:Boolean,defaultValue:!1},{name:"queries",type:Object},{name:"progressCallback",type:Function}]},svmfeedback:{responseRequired:!0,isBlocking:!0,args:[{name:"svmUrl",type:String},{name:"folderId",type:String},{name:"svmMsgId",type:String},{name:"queries",type:Object},{name:"progressCallback",type:Function}]},undomarkitems:{responseRequired:!0,affectedQueryTypes:t,args:[{name:"undoId",type:Object},{name:"queries",type:Object},{name:"progressCallback",type:Function}]},markitems:{responseRequired:!0,affectedQueryTypes:t,throttle:{filters:[{cmdArg:"shouldThrottle",equals:!0}]},args:[{name:"items",type:Array},{name:"includeDuplicates",type:Boolean},{name:"asRead",type:Boolean},{name:"getAffectedHeaders",type:Boolean,defaultValue:!1},{name:"isImplicit",type:Boolean,optional:!0},{name:"queries",type:Object},{name:"progressCallback",type:Function},{name:"shouldThrottle",type:Boolean,optional:!0},{name:"throttleActionTime",type:Number,optional:!0},{name:"maxThrottleActions",type:Number,optional:!0}]},clearundo:{responseRequired:!0,doesNotModifyCache:!0,args:[]},batchmarkitems:{responseRequired:!0,blockingWhiteList:["setbulkactioncountupdate"],isBlocking:!0,args:[{name:"readState",type:Boolean},{name:"getAffectedHeaders",type:Boolean,defaultValue:!1},{name:"queries",type:Object},{name:"progressCallback",type:Function}]},flagitems:{responseRequired:!0,affectedQueryTypes:t,args:[{name:"items",type:Array},{name:"includeDuplicates",type:Boolean},{name:"asFlagged",type:Boolean},{name:"getAffectedHeaders",type:Boolean,defaultValue:!1},{name:"queries",type:Object},{name:"progressCallback",type:Function}]},undoflagitems:{responseRequired:!0,affectedQueryTypes:t,isBlocking:!0,args:[{name:"undoId",type:Object},{name:"queries",type:Object},{name:"progressCallback",type:Function}]},batchflagitems:{responseRequired:!0,blockingWhiteList:["setbulkactioncountupdate"],isBlocking:!0,args:[{name:"flagState",type:Boolean},{name:"getAffectedHeaders",type:Boolean,defaultValue:!1},{name:"queries",type:Object},{name:"progressCallback",type:Function}]},undocategorizeitems:{responseRequired:!0,affectedQueryTypes:t,isBlocking:!0,args:[{name:"undoId",type:Object},{name:"queries",type:Object},{name:"progressCallback",type:Function}]},categorizeitems:{responseRequired:!0,affectedQueryTypes:t,args:[{name:"items",type:Array},{name:"includeDuplicates",type:Boolean},{name:"apply",type:Array},{name:"remove",type:Array},{name:"context",type:Object,optional:!0},{name:"getAffectedHeaders",type:Boolean,defaultValue:!1},{name:"queries",type:Object},{name:"progressCallback",type:Function}]},undojunkandunjunkitems:{responseRequired:!0,affectedQueryTypes:t,isBlocking:!0,args:[{name:"undoId",type:Object},{name:"queries",type:Object},{name:"progressCallback",type:Function}]},junkitems:{responseRequired:!0,affectedQueryTypes:t,args:[{name:"fid",type:String},{name:"items",type:Array},{name:"atLeastOneMessageFromSelf",type:Boolean},{name:"enableJmrReporting",type:Boolean},{name:"getAffectedHeaders",type:Boolean,defaultValue:!1},{name:"queries",type:Object},{name:"progressCallback",type:Function}]},batchjunkitems:{responseRequired:!0,blockingWhiteList:["setbulkactioncountupdate"],isBlocking:!0,args:[{name:"fid",type:String},{name:"enableJmrReporting",type:Boolean},{name:"getAffectedHeaders",type:Boolean,defaultValue:!1},{name:"queries",type:Object},{name:"progressCallback",type:Function}]},unjunkitems:{responseRequired:!0,affectedQueryTypes:t,args:[{name:"fid",type:String},{name:"items",type:Array},{name:"getAffectedHeaders",type:Boolean,defaultValue:!1},{name:"queries",type:Object},{name:"progressCallback",type:Function}]},markassafe:{responseRequired:!0,affectedQueryTypes:e,args:[{name:"fid",type:String},{name:"item",type:Object},{name:"getAffectedHeaders",type:Boolean,defaultValue:!1},{name:"queries",type:Object},{name:"progressCallback",type:Function}]},batchunjunkitems:{responseRequired:!0,blockingWhiteList:["setbulkactioncountupdate"],isBlocking:!0,args:[{name:"fid",type:String},{name:"markSenderAsSafe",type:Boolean,optional:!0},{name:"getAffectedHeaders",type:Boolean,defaultValue:!1},{name:"queries",type:Object},{name:"progressCallback",type:Function}]},compromiseitems:{responseRequired:!0,affectedQueryTypes:t,args:[{name:"fid",type:String},{name:"items",type:Array},{name:"getAffectedHeaders",type:Boolean,defaultValue:!1},{name:"queries",type:Object},{name:"progressCallback",type:Function}]},phishitems:{responseRequired:!0,affectedQueryTypes:t,args:[{name:"fid",type:String},{name:"items",type:Array},{name:"getAffectedHeaders",type:Boolean,defaultValue:!1},{name:"queries",type:Object},{name:"progressCallback",type:Function}]},unsubscribeitems:{responseRequired:!0,affectedQueryTypes:t,args:[{name:"fid",type:String},{name:"items",type:Array},{name:"getAffectedHeaders",type:Boolean,defaultValue:!1},{name:"queries",type:Object},{name:"progressCallback",type:Function}]},addcontacts:{responseRequired:!0,isBlocking:!0,args:[{name:"contactsToAdd",type:Array},{name:"messageQueriesToFetch",type:Array,optional:!0},{name:"progressCallback",type:Function},{name:"queryAddingContactFrom",type:Object,optional:!0}]},blocksenders:{responseRequired:!0,isBlocking:!0,args:[{name:"senders",type:Array},{name:"queries",type:Object},{name:"progressCallback",type:Function}]},emptyfolder:{responseRequired:!0,isBlocking:!0,args:[{name:"folderId",type:String},{name:"queries",type:Object},{name:"progressCallback",type:Function}]},addfolder:{responseRequired:!0,affectedQueryTypes:i,args:[{name:"folderName",type:String},{name:"parentFolderId",type:String},{name:"isArchive",type:Boolean},{name:"queries",type:Object},{name:"progressCallback",type:Function}]},deletefolder:{responseRequired:!0,isBlocking:!0,args:[{name:"folderId",type:String},{name:"folderType",type:Number},{name:"queries",type:Object},{name:"progressCallback",type:Function}]},updatefolder:{responseRequired:!0,affectedQueryTypes:i,args:[{name:"folderId",type:String},{name:"newFolderName",type:String},{name:"isArchive",type:Boolean},{name:"queries",type:Object},{name:"progressCallback",type:Function}]},movefolder:{responseRequired:!0,affectedQueryTypes:i,args:[{name:"folderId",type:String},{name:"newParentFolderId",type:String},{name:"queries",type:Object},{name:"progressCallback",type:Function}]},expandfolder:{responseRequired:!0,affectedQueryTypes:i,args:[{name:"folderId",type:String},{name:"queries",type:Object},{name:"progressCallback",type:Function}]},collapsefolder:{responseRequired:!0,affectedQueryTypes:i,args:[{name:"folderId",type:String},{name:"queries",type:Object},{name:"progressCallback",type:Function}]},restorehiddentrash:{responseRequired:!0,isBlocking:!0,args:[{name:"queries",type:Object},{name:"progressCallback",type:Function}]},resetsearchcache:{responseRequired:!0,args:[{name:"queries",type:Object},{name:"progressCallback",type:Function}]},addupdatedeletecategories:{responseRequired:!0,affectedQueryTypes:u,args:[{name:"categoriesToDelete",type:Array},{name:"categoriesToAdd",type:Array},{name:"categoriesToUpdate",type:Array},{name:"categorySettings",type:Object,optional:!0},{name:"queries",type:Object},{name:"progressCallback",type:Function}]},addupdatedeleterules:{responseRequired:!0,affectedQueryTypes:r,args:[{name:"rulesToAdd",type:Array},{name:"rulesToEdit",type:Array},{name:"ruleIdsToDelete",type:Array}]},reorderrules:{responseRequired:!0,affectedQueryTypes:r,args:[{name:"ruleIds",type:Array}]},createrecipientmoverule:{responseRequired:!0,affectedQueryTypes:u,args:[{name:"recipientEmail",type:String},{name:"folderId",type:String,optional:!0},{name:"folderName",type:String,optional:!0},{name:"queries",type:Object},{name:"progressCallback",type:Function}]},refreshfolders:{responseRequired:!0,affectedQueryTypes:i,args:[{name:"queries",type:Object},{name:"progressCallback",type:Function}]},initiatecompose:{responseRequired:!0,isBlocking:!0,args:[{name:"actionType",type:Number},{name:"respondingItemId",type:String,optional:!0},{name:"temporaryId",type:String},{name:"detectNeedToShowSafetyWarning",type:Boolean},{name:"isInline",type:Boolean},{name:"query",type:Object,optional:!0},{name:"viewId",type:Object}],keepInlineCompose:!0},savedraft:{responseRequired:!0,isBlocking:!0,ignoreOnSave:!0,args:[{name:"to",type:String},{name:"from",type:String},{name:"fromName",type:String},{name:"cc",type:String},{name:"bcc",type:String},{name:"priority",type:Number},{name:"subject",type:String},{name:"message",type:String},{name:"attachmentList",type:String},{name:"inlineAttList",type:String},{name:"rfc822MsgId",type:String},{name:"rfc822References",type:String},{name:"rfc822InReplyTo",type:String},{name:"draftId",type:String},{name:"originalMessageId",type:String},{name:"replyState",type:Number},{name:"isAutoSave",type:Boolean},{name:"meetingICalId",type:String},{name:"saveAsPlainText",type:Boolean},{name:"isInlineReply",type:Boolean},{name:"messageLength",type:Number},{name:"fromName",type:String},{name:"senderDetails",type:String}],keepInlineCompose:!0},savedraftm2:{responseRequired:!0,isBlocking:!0,ignoreOnSave:!0,args:[{name:"to",type:String},{name:"from",type:String},{name:"fromName",type:String},{name:"cc",type:String},{name:"bcc",type:String},{name:"priority",type:Number},{name:"subject",type:String},{name:"message",type:String},{name:"attachmentList",type:String},{name:"inlineAttList",type:String},{name:"rfc822MsgId",type:String},{name:"rfc822References",type:String},{name:"rfc822InReplyTo",type:String},{name:"draftId",type:String},{name:"originalMessageId",type:String},{name:"replyState",type:Number},{name:"isAutoSave",type:Boolean},{name:"meetingICalId",type:String},{name:"saveAsPlainText",type:Boolean},{name:"fromName",type:String},{name:"senderDetails",type:String}],keepInlineCompose:!0},sendmessage:{responseRequired:!0,isBlocking:!0,args:[{name:"to",type:String},{name:"from",type:String},{name:"cc",type:Object},{name:"bcc",type:Object},{name:"priority",type:Number},{name:"subject",type:String},{name:"message",type:String},{name:"attachmentIds",type:Array},{name:"draftId",type:String},{name:"draftFolderId",type:String},{name:"originalMessageId",type:String},{name:"rfc822MessageId",type:String},{name:"rfc822InReplyTo",type:String},{name:"rfc822References",type:String},{name:"sentState",type:Number},{name:"sendByPlainTextFormat",type:Boolean},{name:"meetingICalId",type:String},{name:"shareSkyDriveNumFiles",type:Number},{name:"computeFriendshipCacheAndMeInformation",type:Boolean},{name:"checkForgottenAttachment",type:Boolean}],keepInlineCompose:!0,ignoreOnSend:!0},endcomposesession:{responseRequired:!0,isBlocking:!0,args:[{name:"mid",type:String},{name:"messageSent",type:Boolean},{name:"messageDeleted",type:Boolean},{name:"potentialContacts",type:Object},{name:"potentialSocialNetworkUpsellData",type:Object},{name:"isFullCompose",type:Boolean}],keepInlineCompose:!0},setfpperrormessage:{responseRequired:!0,args:[{name:"fppErrorUi",type:Object}]},hbigetcongratsdialogmanifest:{responseRequired:!0,isBlocking:!0,args:[]},hbigetswitchstatus:{responseRequired:!0,isBlocking:!0,args:[]},dismissaliasupsellsuperbar:{responseRequired:!0,args:[]},dismissinlinereplybubble:{responseRequired:!0,args:[],keepInlineCompose:!0},setservererrormessage:{responseRequired:!0,args:[{name:"serverErrorMessage",type:Object}]},setbulkactioncountupdate:{responseRequired:!0,args:[{name:"progressCount",type:Number},{name:"completed",type:Boolean}]},dismissservermessage:{responseRequired:!0,args:[{name:"dismissalTypes",type:Array}]},instrumentthis:{responseRequired:!0,doesNotModifyCache:!0,args:[{name:"cmd",type:Object},{name:"instrumentation",type:Object},{name:"checkConvCache",type:String,optional:!0}],keepInlineCompose:!0,ignoreOnSave:!0,ignoreOnSend:!0},setoptions:{responseRequired:!0,args:[{name:"partialPreferences",type:Object},{name:"dirtyFields",type:Array},{name:"queries",type:Object},{name:"progressCallback",type:Function}]}};n.extend(o,f),ol.Cmd.register(f)}(window.originaljQuery||window.jQuery),function(n){"use strict";function i(){return[HM.QueryType.MessageGroupQuery,HM.QueryType.ContainerQuery]}var r=ol.CommandRegistry||{},t={windowresize:{responseRequired:!1,args:[{name:"dimensions",type:Object}],keepInlineCompose:!0},bulkactionbysender:{responseRequired:!1,args:[{name:"action",type:String},{name:"categoryChanges",type:Object,optional:!0}]},bulkactionbycontainer:{responseRequired:!1,args:[{name:"action",type:String}]},"rm.unsafelinkclick":{responseRequired:!1,args:[{name:"srcElement",type:Object}]},undomovesendertoblocklist:{responseRequired:!0,getCommandQueueKeys:function(n){return[n.senderAddress]},affectedQueryTypes:i,args:[{name:"senders",type:Array},{name:"queries",type:Object},{name:"progressCallback",type:Function}]},tryemptycontainer:{responseRequired:!0,args:[{name:"senderElement",type:Object},{name:"container",type:Object,optional:!0}]},"rp.precommit":{responseRequired:!1,args:[],keepInlineCompose:!0,ignoreOnSave:!0,ignoreOnSend:!0},"ml.precommit":{responseRequired:!1,args:[],keepInlineCompose:!0,ignoreOnSave:!0,ignoreOnSend:!0},"ml.postcommit":{responseRequired:!1,args:[],keepInlineCompose:!0,ignoreOnSave:!0,ignoreOnSend:!0},clickmsg:{responseRequired:!1,subscriberRequired:!1,args:[]},checkmsgclick:{responseRequired:!1,subscriberRequired:!1,args:[]},"sel.selectedcontrols":{responseRequired:!1,args:[{name:"selectedControls",type:Array},{name:"selectArgs",type:Object,optional:!0}],keepInlineCompose:!0},"sel.pinboardselcleared":{responseRequired:!1,args:[]},"sel.clearall":{responseRequired:!1,args:[]},"sel.bulk":{responseRequired:!1,args:[]},"sel.select":{responseRequired:!0,args:[]},"sel.unselect":{responseRequired:!0,args:[]},"sel.clear":{responseRequired:!0,args:[]},"sel.next":{responseRequired:!0,args:[]},"sel.prev":{responseRequired:!0,args:[]},selectionchange:{responseRequired:!0,args:[]},selectcontainer:{responseRequired:!1,args:[]},"ml.change":{responseRequired:!1,args:[{name:"changeAction",type:Number,optional:!0},{name:"entryPoint",type:Number},{name:"payload",type:Number,optional:!0}]},"nav.container":{responseRequired:!0,csiPerfRequired:!0,navigatesTo:ol.config.pageManager.manifests.Inbox.name,args:[{name:"selectedContainer",type:Object}],setCsd:function(n){var t=n.args.selectedContainer,i;t&&(i=t.folderType()===HM.FolderType.SYSTEM?n.args.selectedContainer.id():"flcustom",$CSIPerf.addCsd("fid",i))},isLazyLinkedAction:!0},fullview:{responseRequired:!1,args:[{name:"thread",type:Object},{name:"dontInstrument",type:Boolean,optional:!0},{name:"forceCloseRightRail",type:Boolean,optional:!0}]},switchreadingpanemode:{responseRequired:!0,args:[{name:"value",type:Number}]},"sel.focuscontainer":{responseRequired:!0,args:[{name:"focusId",type:String}]},"sel.keyboardshortcut":{responseRequired:!0,args:[{name:"name",type:String},{name:"srcElement",type:Object}]},"accessibility.focus":{responseRequired:!0,args:[{name:"focusTo",type:String,optional:!0}],keepInlineCompose:!0},"accessibility.suppressrestorefocus":{responseRequired:!0,args:[]},shiftclickmsg:{responseRequired:!1,args:[]},"sel.scopeexceeded":{responseRequired:!1,args:[{name:"control",type:Object},{name:"direction",type:String},{name:"name",type:String}]},"rm.markassafe":{responseRequired:!1,args:[{name:"activeMessageThread",type:Object}]},"rm.unsubscribe":{responseRequired:!1,args:[{name:"activeMessageThread",type:Object},{name:"enableJmrReporting",type:Boolean},{name:"sweep",type:Boolean}]},"rm.messageloaded":{responseRequired:!1,subscriberRequired:!1,args:[]},"nav.nextpage":{responseRequired:!0,csiPerfRequired:!0,navigatesTo:ol.config.pageManager.manifests.Inbox.name,args:[],isLazyLinkedAction:!0},"nav.prevpage":{responseRequired:!0,csiPerfRequired:!0,navigatesTo:ol.config.pageManager.manifests.Inbox.name,args:[],isLazyLinkedAction:!0},"nav.firstpage":{responseRequired:!0,csiPerfRequired:!0,navigatesTo:ol.config.pageManager.manifests.Inbox.name,args:[],isLazyLinkedAction:!0},"nav.lastpage":{responseRequired:!0,csiPerfRequired:!0,navigatesTo:ol.config.pageManager.manifests.Inbox.name,args:[],isLazyLinkedAction:!0},"nav.filter":{responseRequired:!0,csiPerfRequired:!0,navigatesTo:ol.config.pageManager.manifests.Inbox.name,args:[],isLazyLinkedAction:!0},"nav.arrangeby":{responseRequired:!0,csiPerfRequired:!0,navigatesTo:ol.config.pageManager.manifests.Inbox.name,args:[],isLazyLinkedAction:!0},undoaction:{responseRequired:!0,args:[]},enableundoaction:{responseRequired:!1,args:[{name:"enabled",type:Boolean}],keepInlineCompose:!0},messagepartclicked:{responseRequired:!1,args:[],keepInlineCompose:!0},showunsafebody:{responseRequired:!1,args:[],keepInlineCompose:!0},updatepeoplepane:{responseRequired:!1,args:[],keepInlineCompose:!0},gotopickerinitiatejump:{responseRequired:!1,args:[]},"ml.toggleselectallmessages":{responseRequired:!1,args:[]},"ml.showmessagemenu":{responseRequired:!1,args:[]},"el.started":{responseRequired:!1,args:[]},"el.canceled":{responseRequired:!1,args:[]},"el.completed":{responseRequired:!1,args:[{name:"text",type:String}]},search:{responseRequired:!0,resourceSet:"SearchFilters",args:[{name:"entryPoint",type:Number},{name:"searchOrigin",type:Number},{name:"searchContext",type:Number},{name:"searchIncludesDeleted",type:Boolean,optional:!0}]},commitsearchbox:{responseRequired:!0,args:[]},openadvancedsearch:{responseRequired:!0,resourceSet:"AdvancedSearch",args:[]},commitadvancedsearch:{responseRequired:!0,args:[]},editadvancedsearch:{responseRequired:!0,args:[]},"menu.opening":{responseRequired:!1,args:[],keepInlineCompose:!0},"menu.open":{responseRequired:!1,args:[],keepInlineCompose:!0},"menu.click":{responseRequired:!1,args:[]},"ml.menu.click":{responseRequired:!1,args:[]},"cp.menu.click":{responseRequired:!1,args:[]},"cp.menu.newcontainer":{responseRequired:!1,args:[{name:"newContainer",type:Object}]},"cs.select":{responseRequired:!1,args:[{name:"key",type:String},{name:"selection",type:Object}]},"searchdatepicker.select":{responseRequired:!1,args:[{name:"key",type:String},{name:"date",type:String},{name:"dateRange",type:Number}]},"ln.menu.click":{responseRequired:!1,args:[]},"ln.showcontextmenu":{responseRequired:!1,args:[]},"ln.webimresize":{responseRequired:!1,args:[]},downloadattachment:{responseRequired:!1,throttle:{keys:[{cmdArg:"mid"},{cmdArg:"aIdx"},{cmdArg:"aDepth"},{cmdArg:"aBlob"}]},args:[{name:"url",type:String},{name:"newWindow",type:Boolean},{name:"mid",type:String},{name:"aIdx",type:String},{name:"aDepth",type:String},{name:"aBlob",type:String}]},clickattachment:{responseRequired:!1,args:[]},viewofficepreview:{responseRequired:!1,throttle:{keys:[{cmdArg:"mid"},{cmdArg:"aIdx"},{cmdArg:"aDepth"},{cmdArg:"aBlob"}]},args:[{name:"url",type:String},{name:"newWindow",type:Boolean},{name:"mid",type:String},{name:"aIdx",type:String},{name:"aDepth",type:String},{name:"aBlob",type:String}]},bulkinstantaction:{responseRequired:!1,args:[{name:"action",type:String}]},addcontact:{responseRequired:!1,args:[]},editcontact:{responseRequired:!1,args:[]},"ln.refresh":{responseRequired:!1,args:[]},begincomposesession:{responseRequired:!0,resourceSet:"Compose0",throttle:{keys:[{cmdArg:"thread"}],filters:[{cmdArg:"action",notEquals:"newmessage"}]},args:[{name:"action",type:String},{name:"thread",type:Object,optional:!0},{name:"canRespondInline",type:Boolean,optional:!0},{name:"composeData",type:Object,optional:!0},{name:"entryPoint",type:Number,optional:!0},{name:"numParticipants",type:Number,optional:!0},{name:"priority",type:Number,optional:!0}]},deletedraft:{responseRequired:!0,resourceSet:"Compose0",args:[{name:"thread",type:Object}]},"compose.hiding":{responseRequired:!1,args:[],keepInlineCompose:!0},"compose.updatingthread":{responseRequired:!1,args:[],keepInlineCompose:!0},"compose.controldisposed":{responseRequired:!1,args:[],keepInlineCompose:!0},"compose.controlready":{responseRequired:!1,args:[],keepInlineCompose:!0},"compose.switchtofull":{responseRequired:!1,ignoreOnSave:!0,ignoreOnSend:!0,args:[{name:"thread",type:Object},{name:"initialState",type:Object}],keepInlineCompose:!0},"compose.resize":{responseRequired:!1,ignoreOnSave:!0,ignoreOnSend:!0,args:[],keepInlineCompose:!0},"compose.clickaway":{responseRequired:!1,ignoreOnSave:!0,ignoreOnSend:!0,args:[],keepInlineCompose:!0},"compose.action":{responseRequired:!1,args:[{name:"action",type:String}],keepInlineCompose:!0},"compose.skydriverehydrated":{responseRequired:!1,args:[],keepInlineCompose:!0},"compose.updateusercomposedata":{responseRequired:!1,args:[{name:"userComposeData",type:Object}],keepInlineCompose:!0},"carousel.heightchange":{responseRequired:!1,args:[],keepInlineCompose:!0},"carousel.itemclick":{responseRequired:!1,args:[{name:"event",type:Object},{name:"file",type:Object}],keepInlineCompose:!0},"rte.toolbaraction":{responseRequired:!1,args:[{name:"action",type:String}],keepInlineCompose:!0},"rte.insertcontent":{responseRequired:!1,args:[{name:"content",type:String}],keepInlineCompose:!0},"rte.focus":{responseRequired:!1,args:[{name:"event",type:Object}],keepInlineCompose:!0},"rte.blur":{responseRequired:!1,args:[{name:"event",type:Object}],keepInlineCompose:!0},"rte.click":{responseRequired:!1,args:[{name:"event",type:Object}],keepInlineCompose:!0},"rte.dragover":{responseRequired:!1,args:[{name:"event",type:Object}],keepInlineCompose:!0},"rte.keyup":{responseRequired:!1,args:[{name:"event",type:Object}],keepInlineCompose:!0},"rte.keydown":{responseRequired:!1,args:[{name:"event",type:Object}],keepInlineCompose:!0},"rte.keypress":{responseRequired:!1,args:[{name:"event",type:Object}],keepInlineCompose:!0},"rte.drop":{responseRequired:!1,args:[{name:"event",type:Object}],keepInlineCompose:!0},"rte.paste":{responseRequired:!1,args:[{name:"event",type:Object}],keepInlineCompose:!0},"rte.showcontextmenu":{responseRequired:!1,args:[{name:"event",type:Object},{name:"position",type:Object}],keepInlineCompose:!0},"rte.scroll":{responseRequired:!1,args:[{name:"event",type:Object}],keepInlineCompose:!0},"rte.givefocus":{responseRequired:!1,args:[],keepInlineCompose:!0},"rte.legacyevent":{responseRequired:!1,args:[{name:"event",type:Object},{name:"name",type:String}],keepInlineCompose:!0},"rte.ready":{responseRequired:!1,args:[],keepInlineCompose:!0},"rte.contenteditable":{responseRequired:!1,args:[{name:"value",type:Boolean}],keepInlineCompose:!0},"rte.setbody":{responseRequired:!1,args:[{name:"value",type:Object}],keepInlineCompose:!0},"rte.compositionstart":{responseRequired:!1,args:[],keepInlineCompose:!0},"rte.compositionend":{responseRequired:!1,args:[],keepInlineCompose:!0},"rte.selectionchange":{responseRequired:!1,args:[],keepInlineCompose:!0,ignoreOnSave:!0,ignoreOnSend:!0},"rte.cleanupinlineimages":{responseRequired:!1,args:[],keepInlineCompose:!0},"rte.inlineimageresize":{responseRequired:!1,args:[],keepInlineCompose:!0},"smc.show":{responseRequired:!1,args:[],keepInlineCompose:!0},"skydrive.contextmenu":{responseRequired:!1,args:[{name:"key",type:String},{name:"target",type:Object}],keepInlineCompose:!0},"composecommandbar.update":{responseRequired:!1,args:[{name:"thread",type:Object}],keepInlineCompose:!0},"composecommandbar.redraw":{responseRequired:!1,args:[],keepInlineCompose:!0},"composecommandbar.show":{responseRequired:!1,args:[],keepInlineCompose:!0},"composecommandbar.hide":{responseRequired:!1,args:[],keepInlineCompose:!0},"composecommandbar.sendingstate":{responseRequired:!1,ignoreOnSend:!0,args:[{name:"value",type:Boolean}],keepInlineCompose:!0},"inboxcommandbar.show":{responseRequired:!1,args:[],keepInlineCompose:!0},"inboxcommandbar.hide":{responseRequired:!1,args:[],keepInlineCompose:!0},"sl.event":{responseRequired:!1,args:[{name:"file",type:Object},{name:"event",type:String}],keepInlineCompose:!0},"emojipicker.insert":{responseRequired:!1,args:[],keepInlineCompose:!0},"nav.compose":{responseRequired:!0,csiPerfRequired:!0,navigatesTo:ol.config.pageManager.manifests.Compose.name,onlyNavigates:!0,args:[{name:"thread",type:Object},{name:"initialState",type:Object,optional:!0}],renderDelay:50},"nav.inbox":{responseRequired:!0,csiPerfRequired:!0,navigatesTo:ol.config.pageManager.manifests.Inbox.name,onlyNavigates:!0,args:[]},"nav.managecategories":{responseRequired:!0,csiPerfRequired:!0,navigatesTo:ol.config.pageManager.manifests.ManageCategories.name,onlyNavigates:!0,args:[]},"nav.options":{responseRequired:!0,csiPerfRequired:!0,navigatesTo:ol.config.pageManager.manifests.Options.name,args:[{name:"selectedOption",type:String,optional:!0}]},"nav.managerules":{responseRequired:!0,navigatesTo:ol.config.pageManager.manifests.ManageRules.name,onlyNavigates:!0,args:[{name:"entryPoint",type:Number}]},"nav.managerulesold":{responseRequired:!1,csiPerfRequired:!0,args:[]},"nav.message":{responseRequired:!0,csiPerfRequired:!0,navigatesTo:ol.config.pageManager.manifests.Inbox.name,args:[{name:"threadId",type:String,optional:!0},{name:"viewId",type:Object,optional:!0},{name:"isFullView",type:Boolean,optional:!0},{name:"rpState",type:Boolean,optional:!0},{name:"type",type:String,optional:!0},{name:"prefetchState",type:Boolean,optional:!0},{name:"msgInst",type:Object,optional:!0}],setCsd:function(n){if(typeof n.args.rpState!="undefined"&&$CSIPerf.addCsd("rp",n.args.rpState?"1":"0"),typeof n.args.type!="undefined"&&$CSIPerf.addCsd("type",n.args.type),typeof n.args.prefetchState!="undefined"&&$CSIPerf.addCsd("pf",n.args.prefetchState?"1":"0"),n._csdData)for(var t in n._csdData)$CSIPerf.addCsd(t,n._csdData[t])},storeCsdForLater:function(n,t){n._csdData=t},meter:{delay:200},isLazyLinkedAction:!0},"nav.cancelpendingcsiperfscenario":{responseRequired:!1,args:[],keepInlineCompose:!0},"nav.complete":{responseRequired:!1,args:[{name:"view",type:String}]},rrutocompose:{responseRequired:!0,resourceSet:"Compose0",args:[]},loadpeoplepaneresources:{responseRequired:!0,resourceSet:"PeoplePane",args:[],keepInlineCompose:!0},newmessage:{responseRequired:!1,args:[{name:"entryPoint",type:Number}]},deletemsg:{responseRequired:!1,args:[]},refreshads:{responseRequired:!1,args:[]},accept:{responseRequired:!1,args:[{name:"action",type:String},{name:"thread",type:Object}]},decline:{responseRequired:!1,args:[{name:"action",type:String},{name:"thread",type:Object}]},tentative:{responseRequired:!1,args:[{name:"action",type:String},{name:"thread",type:Object}]},reply:{responseRequired:!1,args:[{name:"action",type:String},{name:"thread",type:Object}]},replyall:{responseRequired:!1,args:[{name:"action",type:String},{name:"thread",type:Object}]},forward:{responseRequired:!1,args:[{name:"action",type:String},{name:"thread",type:Object}]},sendemailtosender:{responseRequired:!1,args:[{name:"action",type:String},{name:"senderEmail",type:String},{name:"entryPoint",type:Number}]},viewallfromsender:{responseRequired:!1,args:[{name:"action",type:String},{name:"senderEmail",type:String}]},viewallincontainer:{responseRequired:!1,args:[{name:"containerId",type:Object}]},resumedraft:{responseRequired:!1,args:[{name:"action",type:String},{name:"thread",type:Object}]},archive:{responseRequired:!1,args:[]},createrule:{responseRequired:!1,resourceSet:"ManageRules",args:[{name:"threads",type:Object,optional:!0},{name:"entryPoint",type:Number}]},editrule:{responseRequired:!1,resourceSet:"ManageRules",args:[{name:"rule",type:Object}]},"editrule.rulesaved":{responseRequired:!1,subscriberRequired:!1,args:[]},"rules.reordercomplete":{responseRequired:!1,subscriberRequired:!1,args:[]},"rule.conditiontypechange":{responseRequired:!1,args:[{name:"type",type:Number}]},"rule.actiontypechange":{responseRequired:!1,args:[{name:"type",type:Number}]},"rule.deletecondition":{responseRequired:!1,args:[{name:"rule",type:Object},{name:"type",type:Number}]},"rule.deleteaction":{responseRequired:!1,args:[{name:"rule",type:Object},{name:"type",type:Number}]},"rule.addnextcondition":{responseRequired:!1,args:[{name:"rule",type:Object}]},"rule.addnextaction":{responseRequired:!1,args:[{name:"rule",type:Object}]},print:{responseRequired:!1,args:[]},togglethreadexpandcollapsestate:{responseRequired:!1,args:[]},markasread:{responseRequired:!1,args:[]},markasunread:{responseRequired:!1,args:[]},markasflagged:{responseRequired:!1,args:[]},markasunflagged:{responseRequired:!1,args:[]},viewsource:{responseRequired:!1,args:[]},showcategorize:{responseRequired:!1,args:[]},"ml.showcategorize":{responseRequired:!1,args:[]},"rm.showcategorize":{responseRequired:!1,args:[]},showmoveto:{responseRequired:!1,args:[]},junk:{responseRequired:!1,args:[]},notjunk:{responseRequired:!1,args:[]},phish:{responseRequired:!1,args:[]},phishnotjunk:{responseRequired:!1,args:[]},compromised:{responseRequired:!1,args:[]},compromisednotjunk:{responseRequired:!1,args:[]},closeview:{responseRequired:!1,args:[{name:"thread",type:Object,optional:!0}]},setexpandedmessagequeries:{responseRequired:!0,args:[]},expandall:{responseRequired:!1,args:[]},collapseall:{responseRequired:!1,args:[]},unsubscribe:{responseRequired:!1,args:[]},"log.aliasupsell":{responseRequired:!1,args:[{name:"UpsellType",type:Number},{name:"UpsellEvent",type:Number},{name:"UpsellDomain",type:String}]},"log.upsellautoforward":{responseRequired:!1,args:[{name:"UpsellEvent",type:Number},{name:"UpsellDomain",type:String}]},"log.importaccount":{responseRequired:!1,args:[{name:"SwEvent",type:Number},{name:"SwEnterInfo",type:Number,optional:!0},{name:"SwSelectInfo",type:Number,optional:!0},{name:"SwExitInfo",type:Number,optional:!0},{name:"SwState",type:Number},{name:"SwPrevState",type:Number,optional:!0},{name:"SwEntryID",type:Number,optional:!0}]},openoauthimportdialog:{responseRequired:!1,args:[]},openyahooimportdialog:{responseRequired:!1,args:[]},openimapimportdialog:{responseRequired:!1,args:[]},openadvancedimapimportdialog:{responseRequired:!1,args:[]},navigatetommt:{responseRequired:!1,args:[]},openinboxflowfolderoptions:{responseRequired:!1,args:[]},openinboxflowanotheraccountoptions:{responseRequired:!1,args:[]},removecurrentconnection:{responseRequired:!1,args:[]},openemailonlydialog:{responseRequired:!1,args:[]},startoauthimport:{responseRequired:!1,args:[]},opengmailpage:{responseRequired:!1,args:[]},openyahoopage:{responseRequired:!1,args:[]},openhelppage:{responseRequired:!1,args:[]},openhelppagefromlink:{responseRequired:!1,args:[]},"sb.setsizerbarcookie":{responseRequired:!1,args:[],keepInlineCompose:!0},"dragdrop.move":{responseRequired:!1,args:[]},"dragdrop.up":{responseRequired:!1,args:[]},"instrument.managerulesaction":{args:[{name:"userAction",type:Number}]},"instrument.editrule":{args:[{name:"exitAction",type:Number},{name:"conditionCount",type:Number},{name:"actionCount",type:Number}]},"instrument.canteditrule":{args:[]},"instrument.escapecancelcomposesession":{args:[{name:"messageSent",type:Boolean},{name:"cancelAction",type:Number},{name:"entryPoint",type:Number}],keepInlineCompose:!0},"instrument.changepriority":{args:[{name:"newPriority",type:Number},{name:"entryPoint",type:Number}],keepInlineCompose:!0},"instrument.formattext":{args:[{name:"formatAction",type:Number},{name:"entryPoint",type:Number}],keepInlineCompose:!0},"instrument.insertattachments":{args:[{name:"files",type:Object},{name:"numSelected",type:Number},{name:"entryPoint",type:Number}],keepInlineCompose:!0},"instrument.insertfromskydrive":{args:[{name:"files",type:Object},{name:"numSelected",type:Number},{name:"entryPoint",type:Number}],keepInlineCompose:!0},"instrument.insertinlineimages":{args:[{name:"files",type:Object},{name:"numSelected",type:Number},{name:"entryPoint",type:Number}],keepInlineCompose:!0},"instrument.spellcheck":{args:[],keepInlineCompose:!0},"instrument.print":{args:[{name:"msgInst",type:Object},{name:"entryPoint",type:Number}],keepInlineCompose:!0},"instrument.viewsource":{args:[{name:"msgInst",type:Object},{name:"entryPoint",type:Number}],keepInlineCompose:!0},"instrument.filter":{args:[{name:"fId",type:Number},{name:"entryPoint",type:Number}],keepInlineCompose:!0},"instrument.webimexpandcollapse":{args:[{name:"expanded",type:Boolean},{name:"entryPoint",type:Number}]},"instrument.readmessage":{args:[{name:"msgInst",type:Object},{name:"entryPoint",type:Number}],keepInlineCompose:!0},"instrument.readmessagebici":{args:[{name:"bici",type:Object}],keepInlineCompose:!0},"instrument.aliasdefaultfrom":{args:[{name:"defaultFrom",type:Boolean}],keepInlineCompose:!0},curtaindown:{responseRequired:!1,subscriberRequired:!1,args:[{name:"state",type:Number}]},glassdown:{responseRequired:!1,subscriberRequired:!1,args:[]},"keyboardhandler.enable":{responseRequired:!1,args:[{name:"value",type:Boolean},{name:"page",type:String,optional:!0}],keepInlineCompose:!0},"keyboardhandler.register":{responseRequired:!1,args:[{name:"handler",type:Object},{name:"page",type:String}],keepInlineCompose:!0}};n.extend(r,t),ol.Cmd.register(t)}(window.originaljQuery||window.jQuery),function(){"use strict";var n=window.ol=window.ol||{},t=n.data=n.data||{};t.dataCommands=["get","refresh","autorefresh","undomoveitems","moveitems","batchmoveitems","undomarkitems","markitems","getandmarkasread","batchmarkitems","clearundo","undoflagitems","flagitems","batchflagitems","undocategorizeitems","categorizeitems","emptyfolder","addfolder","expandfolder","collapsefolder","deletefolder","updatefolder","movefolder","addupdatedeletecategories","addupdatedeleterules","dismissservermessage","setfpperrormessage","setservererrormessage","addcontacts","initiatecompose","endcomposesession","savedraft","savedraftm2","sendmessage","svmfeedback","setconversationmode","bulkactions","blocksenders","createrecipientmoverule","restorehiddentrash","resetsearchcache","refreshfolders","reorderrules","undojunkandunjunkitems","junkitems","batchjunkitems","unjunkitems","markassafe","batchunjunkitems","phishitems","compromiseitems","unsubscribeitems","hbigetswitchstatus","hbigetcongratsdialogmanifest","instrumentthis","setoptions","dismissaliasupsellsuperbar","dismissinlinereplybubble"]}(),function(){"use strict";function n(n,t,i,r){var u,f;try{u=n.__lookupGetter__&&n.__lookupGetter__(t)!==undefined,f=n.__lookupSetter__&&n.__lookupSetter__(t)!==undefined,u||n.__defineGetter__(t,i),!f&&r&&n.__defineSetter__(t,r)}catch(e){}}function f(n,t,i,r){e(n,t,i,r)}function e(n,t,i,r){(r||!n[t])&&(n[t]=i)}var r=window,u=[],i=[],t=r.$Browser={_Private:{getNonTextNode:function(n){try{while(n&&n.nodeType!=1)n=n.parentNode}catch(t){n=null}return n}},attachEventCompatibility:function(i){function u(n){for(var t={x:0,y:0};n;)t.x+=n.offsetLeft,t.y+=n.offsetTop,n=n.offsetParent;return t}var e=i.HTMLElement.prototype,r=i.Event.prototype;r.__proto__={__proto__:r.__proto__},f(e,"fireEvent",function(n){var t=i.document.createEvent("Event"),r=i.event;t.initEvent(n.substring(2),!0,!1),(!$B.IE||$B.V<11)&&(i.event=t),this.dispatchEvent(t),(!$B.IE||$B.V<11)&&(i.event=r)}),n(r,"srcElt",function(){var n=this._FixOffset;return n?n:t._Private.getNonTextNode(this.target)}),n(r,"srcElement",function(){return this.srcElt}),n(r,"cancelBubble",function(){return this._bubblingCanceled||!1},function(n){n&&(this._bubblingCanceled=!0,this.stopPropagation())}),n(r,"offsetX",function(){return i.pageXOffset+this.clientX-u(this.srcElt).x}),n(r,"offsetY",function(){return i.pageYOffset+this.clientY-u(this.srcElt).y}),n(r,"x",function(){return this.offsetX}),n(r,"y",function(){return this.offsetY}),n(r,"returnValue",function(){return this.cancelDefault},function(n){return n||this.preventDefault(),this.cancelDefault=n,n}),n(r,"button",function(){return this.which==1?1:this.which==3?2:0}),n(r,"fromElement",function(){var n;return this.type=="mouseover"?n=this.relatedTarget:this.type=="mouseout"?n=this.target:this.type=="focusin"&&(n=t._lastElt),t._Private.getNonTextNode(n)}),n(r,"toElement",function(){var n=null;try{this.type=="mouseout"?n=this.relatedTarget:this.type=="mouseover"?n=this.target:this.type=="focusout"&&(n=t._lastElt)}catch(i){}return t._Private.getNonTextNode(n)})},attachCompatabilities:function(n){t.attachEventCompatibility(n);for(var r=0,u=i.length;r<u;r++)try{i[r](n)}catch(f){}},addExtension:function(n){for(var t=0,r=u.length;t<r;t++)try{n(u[t])}catch(f){}i.push(n)}};t.attachCompatabilities(r)}(),function(){"use strict";function n(n){function f(t){if($Browser._lastElt!=t.srcElement){i("beforedeactivate",$Browser._lastElt);var r=t.srcElement;n.setTimeout(function(){i("focus",r)},0)}}function e(n){n.keyCode==9&&i("beforedeactivate",$Browser._lastElt)}function o(){t!=0&&(n.clearTimeout(t),t=0),r&&(i("focusin",$Browser._lastElt),r=!1)}function s(){t==0&&(t=n.setTimeout(h,200))}function h(){r=!0,n.clearTimeout(t),t=0,i("focusout",$Browser._lastElt)}function c(n){if($Browser._lastElt){var t=$Browser._lastElt;$Browser._lastElt=n.srcElement,i("focusout",t),$Browser._lastElt=t}i("focusin",n.srcElement),$Browser._lastElt=n.srcElement}function i(t,i){if(i){var r=n.document.createEvent("Event"),u=n.event;r.initEvent(t,!0,!1),(!$B.IE||$B.V<11)&&(n.event=r),r._parentWindow=n,i.dispatchEvent(r),(!$B.IE||$B.V<11)&&(n.event=u)}}$Browser._lastElt=n.document;var r,t=0,u=n.document.documentElement;u.addEventListener("focus",c,!0),u.addEventListener("mousedown",f,!0),u.addEventListener("keydown",e,!0),n.addEventListener("focus",o,!0),n.addEventListener("blur",s,!0)}$Browser.addExtension(n)}(),$Network.Type=new $Enum("XMLPost","XMLGet"),$Network.Verbs=new $Enum("GET","POST"),$Network._fppReady=!1,$Network._fppProxies=[],$Network.registerFpp=function(n,t){$Network._fppReady?$Network.FppProxy.create(n,t):$Network._fppProxies.push({type:n,classType:t})},$Network.Events={onprecallback:new $Event,onpostcallback:new $Event,onaftercallback:new $Event,onfinished:new $Event,onerror:new $Event,onprofile:new $Event},function(n){window.$Network.Fpp=function(n,t){function u(proxy,obj){var responseText,pkg,msg,strUrl,oFppPkg,arrArgs;$Network.Events.onfinished.fire({context:obj,proxy:proxy});try{responseText=proxy.responseText}catch(e){}pkg={ErrorCode:0,Status:0,Context:obj.context,Proxy:proxy,Error:null,FppMethod:obj,HttpResponseText:responseText},obj.bRetry=!1;try{proxy==null||proxy.statusText==="timedout"?pkg.ErrorCode=pkg.Status=-4:proxy.statusText==null||proxy.statusText==""?pkg.ErrorCode=pkg.Status=-5:proxy.status!=200&&proxy.status!=500&&(pkg.ErrorCode=pkg.Status=-7)}catch(ex){pkg.ErrorCode=pkg.Status=-5}if(pkg.ErrorCode!=0){if(window.Trace)switch(pkg.ErrorCode){case-1:msg="ERR_FPP_PROTOCOL";break;case-2:msg="ERR_SERVER_UNCAUGHT";break;case-3:msg="ERR_APP_SPECIFIC";break;case-4:msg="ERR_HTTP_TIMEOUT";break;case-5:msg="ERR_HTTP_CONNECT_FAILURE";break;case-6:msg="ERR_HTTP_PARSE_FAILURE";break;case-7:msg="ERR_HTTP_MISCONFIGURATION"}if(++obj.nRetry<=r){obj.bRetry=!0;return}obj.cbErr&&obj.cbErr(pkg.ErrorCode,pkg.Context,pkg.Proxy,pkg.Error),$Network.Events.onerror.fire(pkg)}else{try{strUrl=proxy.getResponseHeader("FPPRPURL"),strUrl!=""&&strUrl!=null&&(i.FPPRPURL=strUrl)}catch(ex){}try{t.CommandType==0?oFppPkg=eval(proxy.responseText):t.CommandType==1&&(oFppPkg=eval("("+proxy.responseText+")")),$Network.Events.onprofile.fire(oFppPkg.ProfilingInfo),oFppPkg.Status==0?(window.Trace,arrArgs=oFppPkg.OutRefParams,arrArgs.unshift(obj.context),arrArgs.unshift(oFppPkg.Value),obj.callback.apply(null,arrArgs),$Network.Events.onpostcallback.fire()):(pkg.ErrorCode=pkg.Status=oFppPkg.Status,pkg.Error=oFppPkg.Error,window.Trace,obj.cbErr&&obj.cbErr(pkg.ErrorCode,pkg.Context,pkg.Proxy,pkg.Error),$Network.Events.onerror.fire(pkg))}catch(ex){if(window.Trace,pkg.ErrorCode=pkg.Status=-6,pkg.Error=ex,++obj.nRetry<=r){obj.bRetry=!0;return}if($Debug.enabled)throw ex;obj.cbErr&&obj.cbErr(pkg.ErrorCode,pkg.Context,pkg.Proxy,pkg.Error),$Network.Events.onerror.fire(pkg)}}obj.bRetry=!1,$Network.Events.onaftercallback.fire(obj)}var r=2,i={};i["Content-Type"]="application/x-www-form-urlencoded",t=t?t:{},typeof t.ServerTunnelingUrl=="string"&&(i.FPPRPURL=t.ServerTunnelingUrl),t.CommandType=t.CommandType||0,t.Version=t.Version||0,t.PartnerId=t.PartnerId||0,t.SessionId=t.SessionId||"",Object.isNumber(t.DefaultRetry)&&(r=t.DefaultRetry),i["X-FPP-Command"]=t.CommandType,this.invoke=function(r,f,e,o,s,h,c,l,a,v){var w,d;if(f==null||e==null||s==null)throw new Error("invalid arguments for $Network.Fpp");if(typeof s!="function")throw new Error("$Network.Fpp arg list mismatch:  cb must be of type function.");var g="cn="+f+"&mn="+e+"&d="+o+"&v="+t.Version,b,p,nt=$Network.defaultTimeout,k={context:h,callback:s,cbErr:c,bRetry:!1,nRetry:0,bSave:!1,className:f,methodName:e},y,tt=n.indexOf("?")>0?"&":"?";if(t.CanaryToken&&(y={n:t.CanaryToken,v:$Network.getCookie(t.CanaryToken)||""}),r==$Network.Type.XMLPost?(b=g,y&&(i[y.n]=y.v),p="{0}{1}{2}cnmn={3}.{4}&ptid={5}&a={6}&au={7}{8}".format(v||"",n,tt,f,e,encodeURIComponent(t.PartnerId),t.SessionId,t.AuthUser,a?"&sk=CS"+a:"")):r==$Network.Type.XMLGet&&(p="{0}{1}{2}&ptid={3}&a={4}&au={5}{6}".format(n,tt,g,encodeURIComponent(t.PartnerId),t.SessionId,t.AuthUser,y?"&"+y.n+"="+y.v:"")),l&&(nt=l),$Network.Events.onprecallback.fire(k),typeof AdditionalFppHeaders!="undefined"&&AdditionalFppHeaders!==null)for(w in AdditionalFppHeaders)AdditionalFppHeaders.hasOwnProperty(w)&&(i[w]=AdditionalFppHeaders[w]);return d=$Network.fetchXML(p,u,r==$Network.Type.XMLPost?"POST":"GET",b,i,k),window.Trace,$Network.requestTimer(d,u,k,404,nt),d}},window.$Network.requestTimer=function(n,t,i,r,u){function f(){if(n&&n.readyState!==4){try{n.onreadystatechange=null}catch(u){n.onreadystatechange=function(){}}n.abort("timedout"),t({status:r},i)}}setTimeout(f,u)},window.$Network.FppProxy=function(t){function s(n,u){function f(){var s;if(this===i){function h(n){return f.apply(this,n)}return h.prototype=f.prototype,new h(arguments)}var e=this,o=u.length,c=arguments.length;if(c>o&&n!=="FppError")throw new Error("$Network.Fpp: Number of parameters differs from number of arguments for '"+n+"'. FPP proxy has "+o+" parameters while this instance of use is supplying "+c+" arguments. Are the proxies updated?");for(s=0;s<o;s++)e[u[s]]=arguments[s];return e.toString=function(i){var h=r||{CommandType:0,Version:1},s=[],f;for(h.CommandType===0&&i&&s.push(t,".",n,":"),s.push("{"),f=0;f<o;f++)h.CommandType===1&&s.push(typeof u[f].toString()=="undefined"?u[f].type:u[f].toString(),":"),s.push(u[f].escape(e[u[f]],h.Version,h.CommandType===0),",");return o>0&&s.pop(),s.push("}"),s.join("")},e.__isFppObject=!0,e.__fppTypeName=n,e}return o[n]=u,f.typeName=n,f.__isFppClass=!0,f}function h(n,t,i,u,f,o){function s(){for(var h=[],s=t.length,u=0;u<s;u++)r.CommandType==1&&h.push(typeof t[u].toString()=="undefined"?t[u].type:t[u].toString(),":"),h.push(t[u].escape(arguments[u],r.Version,r.CommandType==0),",");return s>0&&h.pop(),e.invoke(i||$Network.Type.XMLPost,f,n,h.join(""),arguments[s],arguments[s+1],arguments[s+2],arguments[s+3],arguments[s+4],o)}return s}var i=this,e,r,f={},o={},u;this.initialize=function(n,t,r,u,f){var e={Version:1,CommandType:0,PartnerId:t,SessionId:r,ServerTunnelingUrl:u,CanaryToken:f};return i.initializeEx(n,e)},this.initializeEx=function(n,t){return e=new $Network.Fpp(n,t,i),r=t,i},this.rfc=this.registerFppClass=function(n,t){this[n]=s(n,t),this[n].args=t},this.rfcd=this.registerFppClassDefaults=function(n,t){function l(t,u,f){var c=i[n],l,h,a,e,v,y,s;if(f=f||[],l=i.deepCopy(o,f,null,r),t)for(e=0;e<r.length;e++)h=r[e],t.hasOwnProperty(h)&&t[h]!==undefined&&(l[h]=t[h]);for(a=[],e=0;e<c.args.length;e++)v=c.args[e],y=v.toString(),s=l[y],s&&s.__fppTypeName==="LFADefaultValueFunction"&&(s=s.getValue()),u&&(f.push(s),s=i.deepCopy(s,f),f.pop()),a.push(s);return c.apply(i,a)}var h="create"+n,e="assert"+n,c="assertnullable"+n,s,o,r,u;s=this,f[n]=t,this[n].prototype.clone=function(){return i.deepCopy(this)},this[n].prototype.assert=function(n){return s[e](this,n)},this[e]=function(n){return n},this[c]=function(n){return n},o={},r=[];for(u in t)o[u]=t[u][0],r.push(u);this[h]=function(n,t,r){var u=l(n,t,r);return i[e](u),u}},u={undefined:!0,number:!0,string:!0,boolean:!0,"function":!0},this.tryCopy=function(n,t,r){if(n===null||(r=r||typeof n,u[r]))return n;if(n instanceof Date)return new Date(n.getTime());if(r==="object"&&n.__isFppObject===!0){var f=i["create"+n.__fppTypeName];return f.apply(i,[n,!0,t])}},this.queueUp=function(n,t,i,r){var s,h,f,e,o;if(i=i||0,n instanceof Array){if(s=null,n.length>0)for(s=new Array(n.length),f=0;f<n.length;f++)o=typeof n[f],u[o]?s[f]=n[f]:t.push({originalParent:n,item:n[f],index:f,parent:s,parentIsArray:!0,type:o,depth:i+1});else s=[];return s}if(n instanceof Object){if(h={},r)for(f=0;f<r.length;f++)e=r[f],o=typeof n[e],u[o]?h[e]=n[e]:t.push({originalParent:n,name:e,item:n[e],parent:h,parentIsArray:!1,type:o,depth:i+1});else for(e in n)o=typeof n[e],u[o]?h[e]=n[e]:t.push({originalParent:n,name:e,item:n[e],parent:h,parentIsArray:!1,type:o,depth:i+1});return h}},this.deepCopy=function(n,t,i,r){var e=this,o=e.tryCopy(n,t),u,f;if(o!==undefined)return o;var s=[],c=[],h=0;for(o=e.queueUp(n,s,0,r),t=t||[];s.length>0;)u=s.pop(),h===u.depth&&(t.pop(),h=t[t.length-1]),f=e.tryCopy(u.item,t,u.type),f===undefined&&(t.push(u.item),h=u.depth,c.push(h),f=e.queueUp(u.item,s,u.depth)),u.parentIsArray?u.parent[u.index]=f:u.parent[u.name]=f;return o},this.rfcdfec=this.registerFppClassDefaultsForExistingClass=function(t,i){var o="create"+t,s="assert"+t,h="assertnullable"+t,u,e,r;u=f[t],this[o]=null,this[s]=null,this[h]=null,f[t]=null,e={};for(r in u)newDefault=i[r],oldDefault=u[r],e[r]=typeof newDefault!="undefined"?[newDefault,oldDefault[1],oldDefault[2]]:oldDefault;this.rfcd(t,e)},this.rfcdbp=this.registerFppClassDefaultsByPosition=function(t,i){var c="create"+t,l="assert"+t,a="assertnullable"+t,e,r;this[c]=null,this[l]=null,this[a]=null,f[t]=null;var s=o[t],u=s.length,h=i.length;if(h!=u)throw new Error("$Network.Fpp: Number of parameters differs from number of arguments when registering Fpp class defaults by position for '"+t+"'. FPP proxy has "+u+" parameters while this instance of use is supplying "+h+" arguments. Are the proxies updated?");for(e={},r=0;r<u;r++)e[s[r]]=i[r];this.rfcd(t,e)},this.registerEnum=function(t){var u,f,r,i;for(u=t.name,f=t.args,r=[],i=0;i<f.length;i++)r.push(f[i]),r.push(i);this[u]={},$Flags.apply(this[u],r)},this.registerClass=function(n){var e,f,i,u,r;e=n.name,f=n.args;var t=$Network.FppProxy,s=t.__string,h=t.__primitive,c=t.__array,l=t.__custom,a=t.__enum,y=t.__date,v=t.__object,p=t.__oArray,o=[];for(i in f){u=f[i],r=null;switch(u){case"boolean":case"number":r=h(i);break;case"string":r=s(i);break;case"array":r=c(i);break;case"object":r=v(i);break;default:if(typeof u=="object")r=a(i);else if(u==="function"||typeof u=="function")r=l(u,i);else throw"Unknown class type for Fpp class Config";}o.push(r)}this.rfc(e,o)},this.rfm=this.registerFppMethod=function(n,t,i,r,u,f,e){this[n]=h(i||n,t,r||$Network.Type.XMLPost,u,f||strDefaultNamespace,e)},this.seal=function(){this.registerClass({name:"LFAFppError",args:{ErrorCode:"number",Context:"object",Proxy:"object",Error:"object",FppMethod:"object",HttpResponseText:"string"}}),this.registerFppClassDefaults("LFAFppError",{ErrorCode:[0,"number",!1],Context:[{},"object",!0],Proxy:[{},"object",!0],Error:[null,"object",!0],FppMethod:[{},"object",!0],HttpResponseText:["","string",!0]}),this.registerClass({name:"LFADefaultValueFunction",args:{getValue:"function"}}),this.registerFppClassDefaults("LFADefaultValueFunction",{getValue:[function(){},"function",!1]}),this.rfm=this.registerFppMethod=this.seal=null}},new function(){var n=$Network.FppProxy,i,t,r;for(n.TypeSystem=function(n,t){return this.toString=function(){return t},this.type=n,this},n.dateToISO8601=function(t){var i=t.getHours(),r=t.getMinutes(),u=t.getSeconds();return i<10&&(i="0"+i),r<10&&(r="0"+r),u<10&&(u="0"+u),n.escape("{0}-{1}-{2}T{3}:{4}:{5}".format(t.getFullYear(),t.getMonth()+1,t.getDate(),i,r,u))},n.arrayToString=function(t,i,r){var u,f;if(t==null)return"";if(Object.isArray(t)){for(u=[],u.push("["),f=0;f<t.length;f++)u.push(n.objToStringImpl(t[f],i,r)),u.push(",");return t.length>0&&u.pop(),u.push("]"),u.join("")}throw new Error("p_array = "+t+" is not an array");},n.escape=function(n,t){if(n==null)return n;var i="";return t==0?i=encodeURIComponent(n.toString().replace(/([\{|\}\[|\]\,\\])/g,"\\$1")):(i=n.toString().replace(/([\{|\}\[|\]\,\\:\"])/g,"\\$1"),i=encodeURIComponent('"'+i+'"')),i},n.objToStringImpl=function(t,i,r){var u=[];return t==null||typeof t=="undefined"?(r&&u.push("null:"),u.push("null")):typeof t=="string"?(r&&u.push("System.String:"),u.push(n.escape(t,i))):t.constructor._typeName=="Date"?(r&&u.push("System.DateTime:"),u.push(n.dateToISO8601(t))):Object.isArray(t)?(r&&u.push("System.Array:"),u.push(n.arrayToString(t,i,r))):typeof t=="object"?t.__isFppObject==!0?u.push(t.toString(r)):(r&&u.push("System.Collections.Hashtable:"),u.push(n.objToString(t,i,r))):(r&&u.push("System.String:"),u.push(t.toString())),u.join("")},n.objToString=function(t,i,r){var u=["{"],e=!1,f;for(f in t)t.hasOwnProperty(f)&&(u.push(n.escape(f,i),":",n.objToStringImpl(t[f],i,r),","),e=!0);return e&&u.pop(),u.push("}"),u.join("")},n.TypeSystem.prototype.escape=function(t,i,r){if(t==null||typeof t=="undefined")return"null";switch(this.type){case"__string":return n.escape(t,i);case"__date":return n.dateToISO8601(t);case"__array":return n.arrayToString(t,i,!1);case"__oArray":case"__object":return n.objToStringImpl(t,i,r);case"__primitive":case"__enum":return t;default:return t.__isFppObject==!0?t:n.objToString(t,i,r)}},n.__string=function(t){return new n.TypeSystem("__string",t)},n.__date=function(t){return new n.TypeSystem("__date",t)},n.__array=function(t){return new n.TypeSystem("__array",t)},n.__oArray=function(t){return new n.TypeSystem("__oArray",t)},n.__primitive=function(t){return new n.TypeSystem("__primitive",t)},n.__object=function(t){return new n.TypeSystem("__object",t)},n.__enum=function(t){return new n.TypeSystem("__enum",t)},n.__custom=function(t,i){return new n.TypeSystem(t,i)},n.create=function(n,t){for(var i=window,f=n.split("."),e=f.length,u,r=0;r<e-1;r++)u=f[r],i[u]||(i[u]=function(){}),i=i[u];i[f[r]]=new t},typeof Web!="undefined"&&Web.Network&&(Web.Network.Fpp=$Network.Fpp,Web.Network.FppProxy=$Network.FppProxy),i=$Network._fppProxies,t=i.length-1;t>=0;t--)r=i[t],n.create(r.type,r.classType);$Network._fppReady=!0,$Network.FppProxy.checkFPPTypeName=function(n,t){return n&&t&&n.__fppTypeName===t?!0:!1}},$Network.registerScript("FireAnt.js")}(window.originaljQuery||jQuery),function(n){"use strict";var t=window.ol=window.ol||{};t.MergeOptions=function(n,t){var r,u,i;r=n(),t=t||{},u={};for(i in r)u[i]=t.hasOwnProperty(i)?t[i]:r[i];return u},t.AddOptionsAccessorAndInitFunctions=function(n,i){var o,r,f,u,e;o=i(!0),r=n.defaultSettingsProps=[],f=[];for(u in o)e=t.GetPropName(u),t.AddAccessor(n,u,e),r.push(u),f.push(e);n.initAccessorValues=function(n){var h=i(),t,o,u,e,s;for(n=n||{},t=0,o=r.length;t<o;t++)u=r[t],e=n.hasOwnProperty(u)?n[u]:h[u],e!==undefined&&(s=f[t],this[s]=e)}},t.ComplexTypeAccessor=function(n,i,r,u,f){var e,o;return f=f||{},e=f.forceSetValue,e&&(n[i]=r===undefined?null:undefined),o=f.silentlyUpdate,o?(n[i]=r,t.Accessor(n,i,undefined,u)):r!==undefined&&(r===n[i]||n[i]===undefined||JSON.stringify(r)!==JSON.stringify(n[i]))?t.Accessor(n,i,r,u):t.Accessor(n,i,undefined,u)},t.Accessor=function(t,i,r,u){return r===undefined?r=u?u():t[i]:t.__silentlySetProperties?t[i]=r:n.observable(t).setProperty(i,r),r},t.RefreshProperty=function(n,t){n[t](n[t]())},t.SilentlyRefreshProperty=function(n,i){n[t.GetPropName(i)]=n[i]()},t.OverridePropertyGetter=function(n,i,r){var u=t.GetPropName(i),f=t.GetAccessorName(i);n[f]=function(n,i,r){return function(u){return t.Accessor(n,i,u,r)}}(n,u,r)},t.GetPropName=function(n){var t=n.substr(0,1).toUpperCase();return t+n.slice(1)},t.InitAccessorValues=function(n,t,i){var r,u;n.__silentlySetProperties=!i;for(r in t)u=t[r],u!==undefined&&n[r](u);n.__silentlySetProperties=!1},t.GetAccessorName=function(n){var t=n.substr(0,1).toLowerCase();return t+n.slice(1)},t.CreateAccessors=function(n,i){for(var r in i)t.AddAccessor(n,r)},t.CreateMissingAccessors=function(n,i){for(var r in i)n[r]||t.AddAccessor(n,r)},t.AddAccessor=function(n,i,r){r=r||t.GetPropName(i),n[i]=function(n,i){return t.AccessorWithOptions(this,r,n,i)}},t.AccessorWithOptions=function(n,i,r,u){var f=n,e,o;if(u=u||{},e=u.forceSetValue,e&&(f[i]=r===undefined?null:undefined),o=u.silentlyUpdate,o)f[i]=r;else return t.Accessor(f,i,r)},t.UpdateProperty=function(n,i,r){var u=n["get"+i]();r?n[i]=u:t.Accessor(n,i,u)}}(window.originaljQuery||window.jQuery),function(n){"use strict";function i(n,t){for(var i=0;i<n.length;i++)if(n[i]===t)return i;return-1}function r(n,t,i){typeof i=="undefined"&&(i=n.length-1);for(var r=n.length-1;r>=0;r--)if(n[r]===t)return r;return-1}var t=window.ol=window.ol||{};t.Array={each:function(n,t){for(var r=n.length,i=0;i<r;i++)if(t(n[i],i)===!1)break},find:function(n,t,i){for(var r=i||0;r<n.length;r++)if(t(n[r]))return r;return-1},indexOf:function(n,t){return Array.prototype.indexOf?n.indexOf(t):i(t)},lastIndexOf:function(n,t,i){return Array.prototype.lastIndexOf?n.indexOf(t,i):r(t,i)},areEquivalent:function(t,i){var r=!0,u;if(t||i){if(t&&!i||!t&&i)r=!1;else if(t.length!==i.length)r=!1;else for(u=0;u<t.length;u++)if(n.inArray(t[u],i)===-1){r=!1;break}}else r=!0;return r}}}(window.originaljQuery||window.jQuery),function(){"use strict";var n=window.ol=window.ol||{},t=window.$Utility;n.Cookies={get:function(i){var r,u;return n.config.serverRenderOnly?(r=n.config.permCookie.cookieSettings,t.deserialize(r,"&")):(u=$Cookie.getCookie(i,!0),t.deserialize(u,"&"))},set:function(i,r,u,f,e){if(!n.config.serverRenderOnly){f=f||n.config.cookies.cookieDomain;var o=t.serialize(r,"&");$Cookie.setCookie(i,o,f,e,u,!0)}},setPermanent:function(t,i,r,u){var f=new Date,e=new Date(f.getUTCFullYear()+1,f.getUTCMonth(),f.getUTCDay());n.Cookies.set(t,i,e,r,u)},isPlainTextCookieSet:function(){var t=n.Cookies.get(n.config.cookies.pdCookie);return t&&t.ptm==="1"}}}(),function(n){"use strict";var t=window.ol=window.ol||{};t.GetString=function(i,r){var u=t.GetNamespaceStrings(i);return!r,u&&u["."]},t.GetNamespaceStrings=function(n){var i,r;for(n=n.split("."),i=t.strings,r=0;!!i&&r<n.length;r++)i=i[n[r]];return i},t.FormatShortcutString=function(n,i){var r=t.config.keyboardShortcuts,u;return r&&r.enabled&&(u=t.GetString("KeyboardShortcuts.{0}.{1}.Description".format(r.mode,i),!0),u&&(n=t.GetString("KeyboardShortcuts.Tooltip.Format").format(n,u))),n},t.GetShortcutString=function(n,i){var r=t.GetString(n);return i&&(r=t.FormatShortcutString(r,i)),r}}(window.originaljQuery||window.jQuery),function(){"use strict";var n=window.ol=window.ol||{};n.getSutra=function(t){return n.config.requestSettings.IsSutraEnabled&&t?'sutra="'+t.toLowerCase()+'"':""},n.getSutraControlId=function(n){if(typeof n=="number")n="qv-"+n;else if(typeof n=="string"&&n.length>2){var t=n.substring(2);n="uk"+t}return n},n.getSutraClientId=function(t,i){var r="";return t&&(n.config.requestSettings.IsSutraEnabled||i)&&(r='id="'+n.getSutraControlId(t)+'"'),r},n.getSutraClientMid=function(t){var i="",r,t;return t&&n.config.requestSettings.IsSutraEnabled&&typeof t=="string"&&t.length>2&&(r=t.substring(2),t="uk"+r,i='mid="'+t+'"'),i},n.getSutraParameter=function(t,i){return n.config.requestSettings.IsSutraEnabled&&t&&i!==undefined?'{0}="{1}"'.format(t,i):""},n.getSutraKey=function(t){return n.config.requestSettings.IsSutraEnabled&&t?'key="'+t.toLowerCase()+'"':""}}(),function(n){"use strict";var t=window.ol=window.ol||{},u=window.wLive,i=u?u.Controls.Notifications:null,f,e,r;t.AddManualChild=function(n){n.parent.manualChildren.push(n)},t.SetupManualLifecycleForChildren=function(n){n.manualChildren=[]},t.DestroyChildrenManually=function(n){for(var t=n.manualChildren,i;t.length;)i=t.pop(),i.onDispose()},t.LinkChildrenManually=function(n){for(var i=n.manualChildren,t=0;t<i.length;t++)i[t].onAfterLink()},t.GetControlFromEvent=function(n,i){return t.GetControlFromDOMElement(n.target,i)},t.GetControlFromDOMElement=function(t,i){var f=n(t),r,u;if(f){if(!f.view)return HM.ReportError("jQuery(object).view returned: "+JSON.stringify(f.view),n.noop),null}else return HM.ReportError("jQuery(object) returned "+JSON.stringify(f),n.noop),null;for(r=f.view();r&&!r.tag;)r=r.parent;return u=r&&r.tag,i&&u&&u.tagName!==i&&(u=u.ctx.parentTags[i]),u},t.GetUserConfig=function(n){return t.config.userPreferences[n]},t.GetAppConfig=function(n){return t.config.appSettings[n]},t.GetInitialStateConfig=function(n){return t.config.initialStateJson[n]},t.writeOptionToServer=function(n,i){var r=t.GetAppConfig(n);r&&t.writeOption([r,i].join(""))},t.getContextObject=function(){return{ol:t,sutra:t.getSutra,sutrakey:t.getSutraKey,sutraClientId:t.getSutraClientId,sutraClientMid:t.getSutraClientMid,sutraParameter:t.getSutraParameter,tabindexForRegion:t.getTabIndexTagForRegion,tabindexTag:t.getTabIndexTag,idTag:t.getIdTag,HM:HM}},t.isHighContrast=$Utility.isHighContrast,f={messageRow:"10",leftnav:"30",msgListNavigation:"40",pageFooter:"60",msgListHeader:"70",msgGroupFooter:"80",readingPaneHeader:"90"},t.getTabIndex=function(n,t){var i=parseInt(f[n]||"-1");return t&&(i+=t),i},t.getTabIndexTagForRegion=function(n,i){return t.getTabIndexTag(t.getTabIndex(n,i))},t.getTabIndexTag=function(n){return n!==null&&n!==undefined?"tabindex='"+n+"'":""},t.getIdTag=function(n){return n?"id='"+n+"'":""},e=0,t.createControlNamespace=function(n){return n+e+++(t.config.serverRenderOnly?"g":"f")},t.baseLegacyUrl=function(n){return"/mail/"+(n||"")},t.baseMailUrl=function(n){return"/ol/mail.mvc/"+(n||"")},t.delayLoadedControls={},t.DynamicNonce=function(){return Math.floor(Math.random()*1e8)},t.removeJQueryFixup=function(){var t={props:n.event.mouseHooks.props,filter:function(n,t){var i=t.button;return n.which||i===undefined||(n.which=i&1?1:i&2?3:i&4?2:0),n}};n.event.fixHooks.click=t,n.event.fixHooks.mousedown=t,n.event.fixHooks.mouseup=t,n.event.fixHooks.mousemove=t,n.event.fixHooks.mouseover=t,n.event.fixHooks.mouseout=t},t.isOpenNewTabClick=function(n){return n.shiftKey||n.ctrlKey||n.metaKey||n.button===1},t.setFocus=function(n){return setTimeout(n,10)},t.callFocus=function(n){t.setFocus(function(){try{n.focus()}catch(t){}})},t.getLocation=function(n,t){function f(n,t){return this.left<=n&&n<=this.right&&this.top<=t&&t<=this.bottom}var r,u,i;for(t=t||{},r=t.x||0,u=t.y||0,i=n;i&&i.tagName!="BODY";i=i.offsetParent)r+=i.offsetLeft,u+=i.offsetTop;return{left:r,top:u,right:r+(n?n.offsetWidth:0),bottom:u+(n?n.offsetHeight:0),containsPoint:f}},t.getActiveElement=function(){var n=document.activeElement;return n?$B.IE&&$B.V<=9&&(t._htmlNode||(t._htmlNode=document.body.parentNode),t._htmlNode===n&&(n=document.body)):n=document.body,n},t.GenerateLinkHtml=function(n,i,r,u,f,e){var o={Url:n,LinkText:i,OnclickAction:r,OtherAttributes:e,IsExternalLink:f,SutraTag:u};return t.RenderLink(o)},t.RenderLink=function(t){var i=n.extend({},{Url:"#"},t);return n.templates("#linkTmpl").render(i)},t.IsNavigatingLink=function(t){var r=!1,i;return t&&(i=n(t).closest("a, area").attr("href"),r=i&&!$U.isLinkABookmark(i)),!!r},t.SetPerformanceId=function(n){$CSIPerf.setPerformanceId(n),$BSI.informNav()},t.decodeURIComponent=function(n){return decodeURIComponent(n)+""},t.writeOption=function(n){if(!t.config.serverRenderOnly&&!t.config.isTestPage){var i=new Image;i.onabort=i.onload=function(){},i.src=n}},window.OptionsWriter={fireOption:t.writeOption},t.findChildTag=function o(t,i,r,u){u=u||[];var f;return t._is==="view"?f=t:n.each(t.tagCtx.view.views,function(n,i){if(i.tag&&i.tag===t)return f=i,!1}),n.each(f.views,function(n,t){var f=t.tag;f&&(!i||f.tagName===i)&&u.push(f),(!t.tag||r)&&o(t,i,r,u)}),u},t.scrollIntoView=function(n,t,i){setTimeout(function(){i||(i=0);var u=parseInt(t.scrollTop),e=parseInt(t.clientHeight),o=u+e,r=Math.max(parseInt(n.offsetTop)-i,0),f=Math.min(r+parseInt(n.offsetHeight)+i*2,t.scrollHeight);f-r>o-u?t.scrollTop=r:(f>o&&(t.scrollTop=Math.max(f-e,0)),r<u&&(t.scrollTop=r))},0)},t.NotificationDismissalType=new $Enum("keyboard","navigation"),t.DismissNotifications=function(n,t){function o(t){return!t.olNoDismissOn||!t.olNoDismissOn[n]}var u,e,r,f;if(i){for(u=i.getQueue(),e=i.BarDismissalMode,r=[].concat(u.getFlyouts(o),u.getDropDowns(o)),t||(r=r.concat(u.getNotificationBars(function(n){var t=n.dismissalMode();return(t===e.Implicit||t===e.Timeout)&&o(n)}))),f=r.length-1;f>=0;f--)r[f].dismiss();return!!r.length}},t.IgnoreNotificationDismissalOnEvent=function(n,t){for(var r=n.olNoDismissOn=n.olNoDismissOn||{},i=0;i<t.length;i++)r[t[i]]=!0},window.$themewritecallback=function(n){var i=t.GetAppConfig("ThemeWriterUrl");i&&t.writeOption([i,n].join(""))},t.markControlAsLoaded=function(i){n.observable(t.delayLoadedControls).setProperty(i,!0)},t.isFocusOnTextBox=function(){var n=document.activeElement;return n&&n.nodeName==="INPUT"&&(n.type==="text"||n.type==="search")},t.isMenuOpen=function(){return $menu.current&&$menu.current.isOpen()},t.isFocusOnMenu=function(i){return i=i||t.getActiveElement(),i&&n(i).closest("ul.c_m").length>=1},t.getTextSelection=function(t){var r="",i;return window.getSelection?window.getSelection().rangeCount>0&&(i=window.getSelection().getRangeAt(0),r=n(i.commonAncestorContainer.parentNode).closest(t).length>0?i.toString():""):document.getSelection?r=document.getSelection():document.selection&&(i=document.selection.createRange(),r=n(i.parentElement()).closest(t).length>0?i.text:""),r},t.setupLazyLinkClickBlocking=function(){n(".AppContainer").on("click",'A[href="#"]',function(n){n.isDefaultPrevented()||n.preventDefault()});t.config.requestSettings.IsSutraEnabled&&(n.views.sub.onBeforeLazyLink.add(function(){n(document.body).attr("sutra-linked",!1)}),n.views.sub.onAfterLazyLink.add(function(t){n(document.body).attr("sutra-linked",!t)}))},t.extendClass=function(n,t){typeof Object.create!="function"&&(Object.create=function(n){function t(){}return t.prototype=n,new t}),t.prototype=Object.create(n.prototype),t.prototype.constructor=t},t.setupTouchDetection=function(){var t=!1,i=0,r=n(document.body);r.addClass("NoTouch"),document.body.addEventListener&&"ontouchstart"in window&&(document.body.addEventListener("touchstart",function(){i=0,t||(t=!0,r.removeClass("NoTouch"))},!0),document.body.addEventListener("mousemove",function(){t&&(i++,i>50&&(t=!1,r.addClass("NoTouch")))}))},t.isIOS=function(){if(r===undefined){var n=navigator.userAgent.toLowerCase();r=!!n.match(/iphone|ipad|ipod/)}return r}}(window.originaljQuery||window.jQuery),function(){"use strict";var n=window.ol=window.ol||{};n.Object={getName:function(n){if(n){if(n._is==="tag")return n.tagName;if(n._name)return n._name}else return"unknown";return/[^\s]\s+([\w\$]+)/.exec(n.constructor.toString())[1].replace(/\$init$/,"")},clone:function(n){return JSON.parse(JSON.stringify(n))}}}(),function(){"use strict";var n=window.HM=window.HM||{};n.RegisterClientSideFPPClasses=function(n){n.registerEnum({name:"ResultType",args:["ItemList","ItemListPage","Container","ServerMessage","Options","Rules","Queries","Invalidation","ServerInvalidation","Undo"]}),n.CommandStage=new $Flags("Queued",0,"ProcessingPreProgress",1,"ProcessingPostProgress",2),n.registerEnum({name:"Status",args:["IncompleteNone","IncompletePartial","Complete","NoChanges"]}),n.registerClass({name:"CommandResult",args:{results:"object",errors:"array"}}),n.registerEnum({name:"ErrorType",args:["Generic","FolderError"]}),n.MessageGroupQueryInvalidationType=new $Flags("ContainerRemoval",1,"AnchorChange",2,"InvalidateEverything",4),n.registerEnum({name:"FolderError",args:["DuplicateName","InvalidCharacters","TooLong","SystemName","EmptyName","CreatesCycle"]}),n.registerClass({name:"DLError",args:{type:n.ErrorType,code:"number"}}),n.registerClass({name:"MessageGroupQueryInvalidationResult",args:{type:n.ResultType,query:n.MessageGroupQuery,invalidationType:n.MessageGroupQueryInvalidationType,isQueryInvalidationChange:"boolean"}}),n.registerClass({name:"ItemListQueryInvalidationResult",args:{type:n.ResultType,query:n.ItemListQuery,isQueryInvalidationChange:"boolean"}}),n.registerClass({name:"ServerInvalidationResult",args:{type:n.ResultType,query:n.ServerMessagesQuery,dataHash:"string",status:n.Status,serverInvalidQueryType:n.ServerInvalidQueryType,errorId:"number"}}),n.registerClass({name:"ItemListResult",args:{type:n.ResultType,query:n.ItemListQuery,status:n.Status,dataHash:"string",idMapping:"object",rollup:n.Rollup,messages:"object"}}),n.registerClass({name:"MessageGroupResult",args:{type:n.ResultType,query:n.MessageGroupQuery,status:n.Status,dataHash:"string",rollup:n.Rollup,itemsTable:"object",itemIds:"array",totalPageCount:"number",timestamp:"string",bof:"boolean",eof:"boolean",view:n.ConversationView,threaded:"boolean"}}),n.registerClass({name:"ContainerResult",args:{type:n.ResultType,query:n.ContainerQuery,status:n.Status,dataHash:"string",containerIds:"array",containerTable:"object"}}),n.registerClass({name:"ServerMessageResult",args:{type:n.ResultType,query:n.ServerMessagesQuery,status:n.Status,dataHash:"string",fppErrorUi:n.FppErrorUi,serverErrorMessage:n.ServerErrorMessage,notificationInfo:n.NotificationInfo,unsatisfiedQueryError:"boolean",newMailNotification:n.NewMailNotification,bulkActionCountUpdate:n.BulkActionCountUpdate,superBar:n.SuperBar}}),n.registerClass({name:"OptionsResult",args:{type:n.ResultType,query:n.ServerMessagesQuery,status:n.Status,dataHash:"string",preferences:n.PreferencesBag}}),n.registerClass({name:"RulesResult",args:{type:n.ResultType,query:n.RulesQuery,status:n.Status,dataHash:"string",rules:"array"}}),n.registerClass({name:"UndoResult",args:{type:n.ResultType,query:n.UndoQuery,status:n.Status,dataHash:"string",undoData:"object"}}),n.registerClass({name:"UndoStackData",args:{origCmd:"object",affectedHeaders:"array"}}),n.registerClass({name:"UndoCmdItemArgs",args:{itemId:"string",viewId:"string",lastUpdatedTimestamp:"string",item:"object",toFolderId:"string",pinOnMove:"number",readOnMove:"number"}}),n.registerEnum({name:"ChangeType",args:["InvalidateConversationPool","InvalidateContainerModel","InvalidateMessageListModel","InvalidateItemListQuery","InvalidateMessageGroupQuery","InvalidateRollup","InvalidateMessage","InvalidateConversation","InvalidateMessageRollup","InvalidateMessageListFragment","InvalidateContainer","DeleteFolder","MarkConversation","MarkMessage","MoveMessage","MoveConversation","MoveConversationBetweenViews","CategorizeConversation","CategorizeMessage","MarkSafeMessage","SaveDraft","ComposeMessage","Id","Count","MessageListFragment","DeleteCategory","ArchiveFolderId"]}),n.registerClass({name:"InvalidateConversationPoolChange",args:{type:n.ChangeType,invalidateQueries:"boolean",isDataInvalidationChange:"boolean"}}),n.registerClass({name:"InvalidateMessageListModelChange",args:{type:n.ChangeType,isDataInvalidationChange:"boolean"}}),n.registerClass({name:"InvalidateContainerModelChange",args:{type:n.ChangeType,isDataInvalidationChange:"boolean"}}),n.registerClass({name:"IdChange",args:{type:n.ChangeType,oldId:"string",newId:"string"}}),n.registerClass({name:"CountChange",args:{type:n.ChangeType,id:"string"}}),n.registerClass({name:"InvalidateItemListQueryChange",args:{type:n.ChangeType,itemId:"string",invalidationType:"string",rollupView:"number",messageIds:"object"}}),n.registerClass({name:"InvalidateMessageGroupQueryChange",args:{type:n.ChangeType,queryKey:"string",invalidationType:n.MessageGroupQueryInvalidationType}}),n.registerClass({name:"InvalidateRollupChange",args:{type:n.ChangeType,itemId:"string",isDataInvalidationChange:"boolean",conversationId:"string",view:"number"}}),n.registerClass({name:"InvalidateMessageRollupChange",args:{type:n.ChangeType,itemId:"string",isDataInvalidationChange:"boolean"}}),n.registerClass({name:"InvalidateMessageChange",args:{type:n.ChangeType,itemId:"string",isDataInvalidationChange:"boolean"}}),n.registerClass({name:"InvalidateConversationChange",args:{type:n.ChangeType,itemId:"string",isDataInvalidationChange:"boolean"}}),n.registerClass({name:"InvalidateContainerChange",args:{type:n.ChangeType,folderId:"string",categoryId:"number",isDataInvalidationChange:"boolean"}}),n.registerClass({name:"DeleteFolderChange",args:{type:n.ChangeType,folderId:"string"}}),n.registerClass({name:"DeleteCategoryChange",args:{type:n.ChangeType,id:"string"}}),n.registerClass({name:"InvalidateMessageListFragmentChange",args:{type:n.ChangeType,queryKey:"string",isDataInvalidationChange:"boolean"}}),n.registerClass({name:"MarkConversationChange",args:{type:n.ChangeType,id:"string",threadedListId:"string",isRead:"boolean",conv:"object"}}),n.registerClass({name:"MarkMessageChange",args:{type:n.ChangeType,id:"string",threadedListId:"string",countChange:"number",folderId:"string",categories:"array",conv:"object"}}),n.registerClass({name:"MoveMessageChange",args:{type:n.ChangeType,id:"string",threadedListId:"string",prevFolderId:"string",newFolderId:"string",isRead:"boolean",categories:"array",changingView:"boolean",originalMoveId:"string",conv:"object"}}),n.registerClass({name:"MoveConversationChange",args:{type:n.ChangeType,id:"string",threadedListId:"string",prevFolderId:"string",newFolderId:"string",changingView:"boolean",originalMoveId:"string",conv:"object"}}),n.registerClass({name:"MoveConversationBetweenViewsChange",args:{type:n.ChangeType,id:"string",sourceViewId:"string",destViewId:"string"}}),n.registerClass({name:"CategorizeConversationChange",args:{type:n.ChangeType,id:"string",apply:"array",remove:"array",isRead:"boolean",threadedListId:"string",unreadCount:"number",count:"number",conv:"object"}}),n.registerClass({name:"CategorizeMessageChange",args:{type:n.ChangeType,id:"string",apply:"array",remove:"array",isRead:"boolean",threadedListId:"string",conv:"object"}}),n.registerClass({name:"MarkSafeMessageChange",args:{type:n.ChangeType,id:"string",fid:"string",threadedListId:"string",conv:"object"}}),n.registerClass({name:"SaveDraftChange",args:{type:n.ChangeType,id:"string",conv:"object"}}),n.registerClass({name:"ComposeMessageChange",args:{type:n.ChangeType,newMessageId:"string",respondingItemId:"string"}}),n.registerClass({name:"ArchiveFolderIdChange",args:{type:n.ChangeType,id:"string"}})}}(),$Network.registerFpp("HM",function(){var s=$Network.FppProxy,n=s.__string,i=s.__primitive,f=s.__array,u=s.__custom,r=s.__enum,o=s.__date,e=s.__object,h=s.__oArray,t=new $Network.FppProxy("HM");return t.MessageSafetyLevel=new $Flags("Trusted",0,"Safe",1,"Unknown",2,"Suspicious",3),t.MessageSuspiciousReason=new $Flags("Phishing",0,"AuthFail",1),t.FeatureVerdicts=new $Flags("None",0,"AutoReplyEnabled",1,"PopAggregationEnabled",2,"ReplyToEnabled",4,"SendAsEnabled",8,"SignatureEnabled",16,"ForwardingEnabled",32,"TrashRecoveryEnabled",64,"SmtpSendEnabled",128,"All",255),t.ServiceError=new $Flags("GenericServerError",1,"VersioningUpgradeError",2,"SessionStateError",3,"BlockedRequest_FppCanaryMismatch",4,"BlockedRequest_FppCanaryMissing",5,"BlockedRequest_FppCanaryEmpty",6,"BlockedRequest_FppAuthUserMismatch",7,"BlockedRequest_BlockedHttp",8,"BlockedRequest_BlockedIp",9,"BlockedRequest_BlockedUser",10,"BlockedRequest_PartnerAccessOnly",11,"BlockedRequest_QueryCacheLockTimeout",12,"BlockedRequest_CookiesRefused",13,"BlockedRequest_EidFailure",14,"Authentication_WrongMode",15,"Authentication_PassportFailure",16,"Authentication_NoUser",17,"Authentication_DelegatedTokenFailure",18,"Authentication_RequiresSsl",19,"Authentication_NotSignedTermsOfUse",20,"MetroOptIn_DisallowedOptInRequest",21,"MaxErrorValue",22),t.ClientMessageType=new $Flags("Info",0,"Warning",1,"Error",2),t.PresetProtectionLevelEnum=new $Flags("Low",0,"Enhanced",1,"Exclusive",2,"Custom",3),t.ReadingPaneLocation=new $Flags("None",0,"Off",1,"Right",2,"Bottom",3),t.AutoSelectMessage=new $Flags("None",0,"Yes",1,"No",2),t.KeyboardShortcutsMode=new $Flags("None",0,"Off",1,"Hotmail",2,"Yahoo",3,"Gmail",4),t.RespectPopDeleteSettingsMode=new $Flags("NotSet",0,"Respect",1,"Ignore",2),t.PopSettingsMode=new $Flags("NotSet",0,"Disabled",1,"Enabled",2),t.HmlvMode=new $Flags("None",0,"Collapsed",1,"Expanded",2),t.ElvMode=new $Flags("None",0,"Disabled",1,"Enabled",2),t.PrefetchMode=new $Flags("None",0,"Disabled",1,"Enabled",2),t.SwitchFolderMappingOption=new $Flags("Root",0,"Subfolder",1),t.SwitchTaskType=new $Flags("None",0,"Mail",1,"Contact",2),t.SwitchUserAction=new $Flags("None",0,"Starting",1,"Stopping",2),t.SwitchTaskStatus=new $Flags("NotStarted",0,"InProgress",1,"Completed",2,"StoppedByService",3,"StoppedByUser",4),t.SwitchAccountType=new $Flags("Gmail",0,"Imap",1,"Outlook",2,"Yahoo",3,"NotSet",-1),t.CategoryVisibility=new $Flags("NotVisible",0,"QuickView",1,"Filter",2),t.CategoryProperties=new $Flags("None",0,"CategoryExists",1,"IsCustomVisibility",2,"IsCategorizable",4,"IsSenderBased",8,"IsReserved",16,"IsCustomizable",32,"IsHidden",64),t.ScenarioId=new $Flags("None",0,"HotmailAttachedDocs",3,"HotmailAttachedPhotos",5,"HotmailDL",6),t.HipAction=new $Flags("None",0,"RefuseQuota",1,"Hip",2,"Block",3,"OverMaxRcpt",4,"HCHip",5),t.HippableOperation=new $Flags("Login",0,"Compose",1,"Send",2,"ExportContacts",3,"PrintContacts",4),t.microsoft_msn_hotmail_hmmessage_meetingresponseinfo_responseactiontype=new $Flags("Ok",0,"OverQuota",1,"DoesntExist",2,"Error",3,"AccountDoesntExist",4,"AccountError",5),t.microsoft_msn_hotmail_hmmessage_exchangesharingresponseinfo_responseactiontype=new $Flags("Unsupported",0,"Ok",1,"Error",2),t.microsoft_msn_hotmail_hmmessage_headersenderidstatus=new $Flags("UNKNOWN",0,"PASS",1,"SOFTFAIL",2,"HARDFAIL",3,"NEUTRAL",4),t.microsoft_msn_hotmail_hmmessage_headersenderauthresult=new $Flags("NONE",0,"PASS",1,"FAIL",2),t.JmrType=new $Flags("Junk",0,"NotJunk",1,"AV",2,"SVMOptInOptOut",3,"SVMClassification",4,"Phish",5,"Unsubscribe",6,"Compromised",7,"SystemCategoryChange",8,"Unknown",-1),t.MailMigrationOverallResult=new $Flags("NotStarted",0,"Success",1,"Failure",2,"Cancel",3,"SomeErrors",4,"Started",5),t.MailMigrationMessageUploadResult=new $Flags("NoUpload",0,"Success",1,"Partialsuccess",2,"PartialFailure",3,"Failure",4),t.MailMigrationContactUploadResult=new $Flags("NoUpload",0,"Success",1,"Failure",2,"Cancel",3,"Skipped",4),t.MailMigrationPopAggregationResult=new $Flags("NoAggregation",0,"Success",1,"Failure",2),t.StorageType=new $Flags("Legacy",0,"PAS",1),t.SetupMode=new $Flags("Add",0,"AddSendOnly",1,"Edit",2,"Upgrade",3),t.SettingsVerificationStatus=new $Flags("Invalid",0,"Success",1,"FailedPopAuthentication",2,"FailedPopConnection",3,"FailedHotmailStoreDelivery",4,"FailedSmtpConnection",5,"FailedSmtpAuthentication",6,"FailedImapConnection",7,"FailedImapAuthentication",8,"NotSet",-1),t.ImportanceType=new $Flags("NORMAL",0,"LOW",1,"HIGH",2),t.MessageSentStateType=new $Flags("NOACTION",0,"REPLIED",1,"FORWARDED",2,"RECEIVED",3,"SENT",4,"DRAFT",5,"SAVED_DRAFT",6),t.FolderType=new $Flags("SYSTEM",0,"USER_DEFINED",1,"OIM",2,"AGGREGATED",3),t.SystemFolderType=new $Flags("NONE",0,"INBOX",1,"TRASH",2,"SENT",3,"DRAFTS",4,"JUNK",5,"HIDDEN_TRASH",6,"HIDDEN_CONFIG",7,"HIDDEN_SAVED",8,"OIM",9,"SMS_OUTBOX",10,"CHAT",11,"SEARCH_RESULTS",12),t.FolderViewType=new $Flags("Default",0,"Conversation",1),t.TypeData=new $Flags("td0_NONE",0,"td1_VMONPHONE",1,"td2_VMDELETED",2,"td3_VMSAVED",3,"td4_PRIVATEVM",4,"td5_MESSENGERVM",5,"td6_INCOMMING",6,"td7_OUTGOING",7,"td8_MISSEDWITHVM",8,"td9_MISSEDWITHOUTVM",9),t.ExtendedType=new $Flags("e0_NONE",0,"e1_FAX",1,"e2_VOICEMAIL",2,"e3_ICAL_GENERIC",3,"e4_ICAL_REQUEST",4,"e5_ICAL_CANCEL",5,"e6_ICAL_ACCEPTED",6,"e7_ICAL_TENTATIVE",7,"e8_ICAL_DECLINED",8,"e9_DRAFT_MESSAGE",9,"e10_PHOTO_MAIL",10,"e11_MSNGR_TEXT_OIM",11,"e12_MSNGR_SMS_OIM",12,"e13_MSNGR_BUBBLE",13,"e14_CALLLOG",14,"e15_MSGR_OIM",15,"e16_SMS",16,"e17_NDR",17,"e18_IM_CONV",18,"e19_MMS",19),t.CategoryFilter=new $Flags("None",0,"Messenger",1,"External",2),t.ContactType=new $Flags("Regular",0,"Me",1,"Live",2,"LiveDropped",3,"LivePending",4,"LiveRejected",5),t.ContactEmailType=new $Flags("ContactEmailPersonal",0,"ContactEmailBusiness",1,"ContactEmailOther",2,"ContactEmailMessenger",3,"Messenger2",4,"Messenger3",5,"Messenger4",6,"Passport",7),t.ContactEmailPropertyType=new $Flags("Email",1,"IsMessengerEnabled",2),t.ContactDateType=new $Flags("ContactBirthday",0),t.ContactPhoneType=new $Flags("ContactPhonePersonal",0,"ContactPhoneBusiness",1,"ContactPhoneMobile",2,"ContactPhonePager",3,"ContactPhoneFax",4,"ContactPhoneOther",5,"Personal2",6,"Business2",7,"BusinessFax",8,"Company",9,"Assistant",10,"Callback",11,"Car",12,"ISDN",13,"OtherFax",14,"Primary",15,"Radio",16,"Telex",17,"TTY",18,"MSN",19),t.ContactPhonePropertyType=new $Flags("Number",1,"IsMessengerEnabled",2),t.ContactLocationType=new $Flags("ContactLocationPersonal",0,"ContactLocationBusiness",1,"Other",2),t.ContactWebSiteType=new $Flags("ContactWebSitePersonal",0,"ContactWebSiteBusiness",1),t.ContactsSortOrder=new $Flags("FirstName",0,"LastName",1),t.ContactsDisplayOrder=new $Flags("FirstNameFirst",0,"LastNameFirst",1),t.FileAsType=new $Flags("NotSet",0,"FirstSpaceLast",1,"LastSpaceFirst",2,"LastCommaFirst",3,"LastSpaceFirstCompany",4,"LastCommaFirstCompany",5,"CompanyLastSpaceFirst",6,"CompanyLastCommaFirst",7),t.ABGleamMask=new $Flags("None",0,"Space",1,"Profile",2,"ContactProfile",4,"QnA",8),t.microsoft_msn_hotmail_util_mimeheadertype=new $Flags("Unknown",0,"Received",1,"Date",2,"From",3,"Subject",4,"Sender",5,"To",6,"CC",7,"BCC",8,"MessageId",9,"InReplyTo",10,"References",11,"ReturnPath",12,"Comments",13,"Keywords",14,"Encrypted",15,"ReplyBy",16,"ReplyTo",17,"ResentDate",18,"ResentSender",19,"ResentFrom",20,"ResentBCC",21,"ResentCC",22,"ResentTo",23,"ResentReplyTo",24,"ResentMessageId",25,"ApparentlyTo",26,"Approved",27,"Control",28,"DeferredDelivery",29,"Distribution",30,"Encoding",31,"Expires",32,"ExpiryDate",33,"FollowUpTo",34,"Lines",35,"Bytes",36,"Article",37,"Importance",38,"Supercedes",39,"NewsGroups",40,"NNTPPostingHost",41,"Organization",42,"Path",43,"Precedence",44,"Priority",45,"ReturnReceiptTo",46,"DispositionNotificationTo",47,"RR",48,"Sensitivity",49,"Summary",50,"XRef",51,"AdHoc",52,"ListHelp",53,"ListSubscribe",54,"ListUnsubscribe",55,"Last822Header",56,"MimeVersion",3840,"ContentBase",3841,"ContentClass",3842,"ContentDescription",3843,"ContentDisposition",3844,"ContentId",3845,"ContentLanguage",3846,"ContentLocation",3847,"ContentMd5",3848,"ContentTransferEncoding",3849,"ContentType",3850,"LastMimeHeader",3851,"XMSEmbeddedReport",61440,"XContentIdentifier",61441,"XMailer",61442,"XNewsReader",61443,"XCSIAttachment",61444,"XMSAttachment",61445,"XMSMailPriority",61446,"XMessageFlag",61447,"XPriority",61448,"XMSHasAttach",61449,"XMSTnefCorrelator",61450,"XListHelp",61451,"XListSubscribe",61452,"XListUnsubscribe",61453,"ThreadTopic",61454,"ThreadIndex",61455,"XMessageCompleted",61456,"XMCubed",61457,"XMessageDelivery",61458,"General",65535),t.ClientView=new $Flags("Inbox",0,"Compose",1,"ManageCategories",2,"ManageRules",3,"ImportAccount",4,"Catawampus",5,"Options",6,"SHbiFppCaller",7,"AliasInterrupt",8),t.AutoSelectType=new $Flags("None",0,"First",1,"Last",2),t.MessageActionType=new $Flags("ViewMessage",0,"Reply",1,"ReplyAll",2,"Forward",3,"ResumeDraft",4,"GetAttachment",5,"MarkAsJunkOrNotJunk",6,"Accept",7,"Decline",8,"Tentative",9,"AcceptExchangeSharing",10,"DeclineExchangeSharing",11,"Prefetch",12,"None",13),t.ListNavigateDirection=new $Flags("FirstPage",0,"LastPage",1,"NextPage",2,"PreviousPage",3,"CurrentPage",4),t.SortBy=new $Flags("Sender",0,"Subject",1,"Size",2,"Type",3,"Date",4),t.SearchPaneDisplayPreferences=new $Flags("None",0),t.ContentId=new $Flags("CommonSenderAction",0,"CommonDeleteAndBlockAllFromSender",1,"DeleteAllFromSender",2,"BlockAllFromSender",3,"MoveAllFromSender",4,"MoveMessage",5,"ReadMessageAddContact",6,"MessageListContextMenu",7,"MoveToFolderListSelect",8,"AdvancedSearch",9,"SlideshowSilverlightUpsell",10,"PhotosSilverlightUpsell",11,"DocsSilverlightUpsell",12,"VideoPlaybackSilverlightUpsell",13,"JunkContactOrSafeSender",14,"GotoDatePicker",15,"GotoAlphaPicker",16,"ScheduleCleanup",17,"DeleteFolder",18,"FolderListContextMenu",19,"QuickViewListContextMenu",20,"MoveFolder",21,"CategorizeDialog",22,"ArchiveDialog",23,"UnsubscribeDialog",24,"DeleteCategory",25,"MetroOptOut",26,"LeftNavHeadersContextMenu",27,"TextMessageMoveDeleteAction",28,"KeyboardShortcutsHelp",29,"ImportProgress",30),t.MessageBodyType=new $Flags("Part",0,"Full",1),t.MailErrorExport=new $Flags("Hip_InvalidAnswer",0,"Hip_IncorrectAnswer",1,"Hip_TimedOut",2,"Hip_AudioNotAvailable",3,"Hip_ImageNotAvailable",4,"Authentication_PassportFailure",16,"Folder_TooManyCustomFolders",66,"ValidateMsgReq_SendMailNotValidated",142,"ImportAccount_EmailAddressFormat",185,"ImportAccount_InvalidStatus",186,"ImportAccount_ImportNotAllowed",187,"ValidateMsgReq_SendMailNotValidated_HighCost",188),t.CommandCodeType=new $Flags("Unknown",0,"ReportError",1,"NetworkStatus",2,"CancelInfoPane",3,"AddContact",4,"DeleteContact",5,"MergeContact",6,"AddContactMoreDetails",7,"DeleteGroup",8,"Reauth",9,"GoToInbox",10,"OpenURL",11,"AddAllContacts",12,"DeleteFolder",13,"DeleteContactsFromGroup",14,"DownloadAttachment",15,"PrintUnsafeContentTrue",16,"PrintUnsafeContentFalse",17,"ReturnToFolder",18,"ReturnToAllContacts",19),t.FilterType=new $Flags("None",0,"UnreadMessages",1,"NotFromContacts",3,"FromContacts",5,"FlaggedMessages",7,"HasAttachments",9,"ResponsesToMe",11,"Newsletters",15,"SmsMessage",17,"ChatHistory",19,"MmsMessage",21,"Photos",53,"SocialUpdates",55,"Comment",57,"Tag",59,"Video",61,"Document",63,"File",65,"MailingList",67,"ShippingNotification",69,"InteractiveLiveView",71,"DocumentPlus",73,"Important",75,"Family",77,"Bills",81,"Shopping",83,"Travel",85,"TextMessages",-3,"Other",-1),t.OfficialLetterType=new $Flags("None",0,"WelcomeLetterForNewMetroUser",1,"WelcomeLetterForOptInUser",2,"WelcomeLetterForForceMigratedUser",3,"SwitchCompletionLetter",4),t.NounEnum=new $Flags("SendersEmailAddress",97,"HasAttachments",104,"SendersName",110,"Subject",115,"ToOrCCHeader",116),t.RemoveSenderFromListOption=new $Flags("None",0,"KeepContact",1,"RemoveContact",2,"KeepSafeSender",3,"RemoveSafeSender",4),t.SwitchEvent=new $Flags("Unknown",0,"Enter",100,"Exit",200,"Error",300,"Select",400),t.SwitchEnterInfo=new $Flags("NotApplicable",0,"NotConnected",101,"ConnectedImported",102,"ConnectedNotImported",103,"GmailAutoForwarding",110,"OtherAutoForwarding",111,"NoAutoForwarding",112,"YahooAutoForwarding",113),t.SwitchSelectInfo=new $Flags("NotApplicable",0,"Close",400,"Next",401,"Options",410,"External",411,"Gmail",420,"Imap",421,"Pop",422,"Mmt",423,"Yahoo",424,"Stop",430,"StatusDropdown",431,"StatusLetter",432),t.SwitchExitInfo=new $Flags("NotApplicable",0,"ImportGmail",200,"ConnectAdd",201,"ConnectEdit",202,"PopAgg",203,"ImportImapBasic",210,"ImportImapAdvanced",211,"PopSuggestion",212,"ImportClients",220,"ImportYahoo",230,"Congrats",400,"StopConfirmation",500),t.SwitchState=new $Flags("Unknown",0,"ImportTop",100,"CapacityLimit",101,"ImportGmail",200,"ConnectAdd",201,"ConnectEdit",202,"PopAgg",203,"ImportImapBasic",210,"ImportClients",210,"ImportImapAdvanced",211,"PopSuggestion",212,"ImportYahoo",230,"ImportGmailStart",300,"CongratsPopup",400,"StopPopup",500,"StatusPopup",700,"Inbox",1e3),t.SwitchEntryPoint=new $Flags("Unknown",0,"Option",1,"FirstRunUpsell",2,"SuperbarUpsell",3,"SigninUpsell",4,"SignoutUpsell",5,"OtherUpsell",6,"HelpPage",7,"MarketingPage",8,"OtherPage",9,"WelcomeLetter",10,"MarketingLetter",11,"OtherLetter",12),t.FilterConditionType=new $Flags("Sender",0,"Recipient",1,"Subject",2,"Keywords",3,"SenderAddress",4,"HasCategory",5,"DoesNotHaveCategory",6,"HasAttachments",7,"IsUnread",8,"HasBeenRepliedTo",9,"IsFlagged",10,"Folder",11,"LegacyHeaderSearchFilter",12,"DeferredByDate",13,"DeferredByCount",14),t.HeaderSearchConditionType=new $Flags("SenderEmail",0,"SenderName",1,"Subject",2,"ToCcLines",3),t.FilterConditionPredicate=new $Flags("IsEqualTo",0,"Contains",1,"ContainsWord",2,"DoesNotContain",3,"StartsWith",4,"EndsWith",5),t.EmailType=new $Flags("Gmail",0,"Yahoo",1,"IMAP",2,"Other",3),t.ImportStartErrorType=new $Flags("NoError",0,"ImportProcessIsRunning",1,"FailedToGetPermission",2,"Other",3),t.SwitchLifeCycle=new $Flags("NotStarted",0,"Running",1,"Stopping",2,"Done",3),t.ImportLifeCycle=new $Flags("NotStarted",0,"Starting",1,"Running",2,"Stopping",3,"Done",4),t.ConnectLifeCycle=new $Flags("NotStarted",0,"Connecting",1,"Done",2),t.SwitchResult=new $Flags("NotSet",0,"Completed",1,"StoppedByUser",2),t.ImportResult=new $Flags("NotSet",0,"Success",1,"PartialSuccess",2,"Abort",3,"Failure",4),t.ConnectResult=new $Flags("NotSet",0,"Success",1,"Failure",2),t.EmailProtocol=new $Flags("Pop",0,"IMAP",1,"SMTP",2,"Other",3),t.MailActionType=new $Flags("Move",0,"Mark",1,"Flag",2,"Forward",3,"AssignCategory",4,"RemoveCategory",5),t.DeferredMailActionType=new $Flags("None",0,"Date",1,"Count",2),t.ClientTypeFlag=new $Flags("Unknown",0,"ImportProcess",1,"WindowsLiveMail",2,"WindowsMail",4,"OutlookExpress",8,"Outlook",16),t.SmtpSecureType=new $Flags("Tls",0,"Ssl",1,"Unsecure",2),t.SmtpSetupResult=new $Flags("Success",0,"Skipped",1,"Failure",2,"NotSet",3),t.MigrateAccountType=new $Flags("NotAdded",0,"SendOnly",1,"SendAndRecieve",2),t.ItemView=new $Flags("Normal",0,"Deleted",1,"Junk",2,"Delayed",3),t.PsaType=new $Flags("None",0,"Upsell",1,"Fre",2,"Auth",3),t.UpsellType=new $Flags("AliasInterrupt",0,"AliasSuperbar",1,"SwitchDialog",2,"SwitchSuperbarGmail",3,"SwitchSuperbarGeneric",4),t.UpsellEvent=new $Flags("Show",100,"ExitNext",200,"ExitDismiss",201,"CreatedAlias",300,"NotCreatedAlias",301),t.SearchDateRange=new $Flags("ExactDate",0,"AndEarlier",1,"AndLater",2,"OneDay",3,"ThreeDays",4,"OneWeek",5,"TwoWeeks",6,"OneMonth",7,"ThreeMonths",8,"SixMonths",9,"OneYear",10),t.SearchHasAttachments=new $Flags("AnyAttachments",0,"HasAttachments",1,"DoesNotHaveAttachments",2),t.MeetingRequestAction=new $Flags("Request",0,"Update",1,"Cancel",2,"Reply",3,"Attachment",4,"Unsupported",5),t.ServerErrorMessagePriority=new $Flags("Low",0,"Medium",1,"High",2),t.NotificationDismissalMode=new $Flags("Explicit",0,"Implicit",1,"Timeout",2),t.ServerInvalidQueryType=new $Flags("None",0,"ConversationNotFound",1,"MessageNotFound",2,"QueryMessagesFolderNotFound",4,"QueryMessagesAnchorMessageNotFound",8),t.ConversationView=new $Flags("Normal",0,"Deleted",1,"PermanentDeleted",2,"Junk",3),t.DLReturnType=new $Flags("MessageListData",0,"ConversationListData",1,"ComposeData",2,"ClientGuid",3,"FppMailRule",4,"ContainerPoolData",5,"ChangeCategories",6,"PrefetchMessageData",7,"SendMessageAndGetInboxDataResult",8,"InfoPaneHtmlWrapper",9,"Email",10,"BatchInfo",11,"SuccessBoolean",12,"TraceLogging",13,"BiciConfig",14,"SaveDraftData",15,"FppErrorUi",16,"ServerErrorMessage",17,"NotificationInfo",18,"NewMailNotification",19,"BulkActionCountUpdate",20,"SuperBar",21,"UserPreferences",22,"ChangeFolder",23,"RestoreHiddenTrashNumRestored",24,"FoldersHash",25,"FppError",26,"GetInboxDataSucceeded",27,"ServerInvalidQuery",28,"SearchDataWrapper",29,"AffectedHeaders",30,"Rules",31),t.LiveViewsProviderType=new $Flags("SNComment",0,"Tracking",1,"Photo",2,"Attachment",3,"Video",4),t.QueryType=new $Flags("ItemListQuery",0,"MessageGroupQuery",1,"MessageListKeyQuery",2,"ContainerQuery",3,"ServerMessageQuery",4,"OptionsQuery",5,"RulesQuery",6,"ServerInvalidationQuery",7,"UndoQuery",8),t.MessageListKeyQueryItemType=new $Flags("Conversation",0,"Message",1),t.MessageListKeyQuerySortOrder=new $Flags("Ascending",0,"Descending",1),t.BodySafetyType=new $Flags("Unspecified",0,"Safe",1,"Unsafe",2),t.BodyHistoryType=new $Flags("Unspecified",0,"NonHistory",1,"History",2),t.ItemListQueryContainerType=new $Flags("Folder",0,"Category",1,"Conversation",2,"Message",3),t.MessageGroupQueryAnchorType=new $Flags("StartTimestamp",0,"EndTimestamp",1,"StartId",2,"EndId",3,"FirstPage",4,"LastPage",5,"JumpTo",6),t.MessageGroupQueryFetchItem=new $Flags("First",0,"Last",1,"None",2),t.ContainerType=new $Flags("Folders",0,"Categories",1,"QuickViews",2,"Filters",3,"Favorites",4),t.ServerMessageType=new $Flags("FppErrorUi",0,"ServerErrorMessage",1,"NotificationInfo",2,"UnsatisfiedQueryError",3,"NewMailNotification",4,"BulkActionCountUpdate",5,"SuperBar",6,"All",7),t.ActionOnMove=new $Flags("None",0,"Set",1,"Unset",2),t.SandboxAuthenticationOption=new $Flags("None",0,"Oauth",1),t.HMLiveViewResultCode=new $Flags("Success",0,"Failure",1),t.MigrateAccountStatus=new $Flags("AutoDiscoveryFailure",0,"AuthFailure",1,"ConnectionFailure",2,"AccountAdded",3,"AccountNeedsVerification",4,"AccountAlreadyExists",5,"CantSetupSmtpAccount",6,"CantSetupPopAccount",7,"OtherError",8,"StorageFailure",9,"ValidateInputError",10),t.JmrType=new $Flags("Junk",0,"NotJunk",1,"AV",2,"SVMOptInOptOut",3,"SVMClassification",4,"Phish",5,"Unsubscribe",6,"Compromised",7,"SystemCategoriesChange",8,"Unknown",-1),t.MessagePartDataType=new $Flags("Body",0,"ToList",1,"Message",2),t.MiniCalendarUiType=new $Flags("Month",0),t.microsoft_msn_hotmail_uiservice_mailaggregation_aggregationfinishedstatus=new $Flags("Success",0,"SetupError",1,"IntermittentError",2,"AccountError",3,"ExtAuthenticationError",4,"ExtConnectionError",5,"MessageError",6,"TooManyMessagesError",7,"Timeout",8),t.StoreMailAggregationErrorStatus=new $Flags("Generic",0,"DataAlreadyExists",1),t.MigratedAccountStatus=new $Flags("Succeeded",0,"FailedToSetup",1,"FailedToAdd",2),t.MailMigrationEventType=new $Flags("SucceededToInstallActiveX",0,"FailedToInstallActiveX",1,"AttemptPhase1",2,"SucceededPhase1",3,"FailedPhase1",4,"AttemptPhase2",5,"SucceededPhase2",6,"FailedPhase2",7,"ReturnPhase2",8,"CanceledPhase2",9),t.MmResult=new $Flags("Success",0,"Skipped",1,"Stopped",2,"Failed",3,"Failed_Connection",4,"Failed_Auth",5),t.MmEvent=new $Flags("Enter",100,"Exit",200,"Error",300,"Select",400),t.MmEnterInfo=new $Flags("SupportedBrowser",100,"Installed",101,"UnsupportedOS",102,"UnsupportedBrowser",103,"UnsupportedIE",104,"Resume",110,"Basic",111,"Basic_NoApp",112,"Advanced",113,"Stopped",120,"Failed",121,"Completed",122),t.MmSelectInfo=new $Flags("Import",400,"Basic",401,"Advanced",402,"Stop",403,"ReportError",410,"AddAccount",411,"ManageAccount",412,"External_Forum",413,"External_Help",414,"External_IE",415),t.MmExitInfo=new $Flags("SessionInitialization",200,"Resume",201,"Settings",202,"UploadInitialization",210,"Upload",211,"Result",220,"FatalError",300),t.MmState=new $Flags("AxInstallation",100,"SessionInitialization",200,"Resume",201,"Settings",202,"UploadInitialization",210,"Upload",211,"Result",220,"FatalError",300),t.MmMailboxType=new $Flags("Mixed",0,"Pop3",1,"IMAP",2,"HttpMail",3,"Exchange",4,"EAS",5,"Archive",6),t.InboxFlowID=new $Flags("Unknown",0,"Normal",1,"AliasCreationSuperbar",2,"GmailImportNormalDialog",3,"YahooImportBasicDialog",4,"YahooImportAdvancedDialog",5,"AliasCreateRuleDialog",6,"ImapImportNormalDialog",7,"ImportAccountCongratsDialog",8,"ImportProgressIndicator",9,"ImportAccountThrottlingDialog",10,"BrowserSupportUpsellBar",11,"PopDeleteBar",12,"CRMUpsell",13,"AutoForwardingReminder",14),t.FppStatus=new $Flags("SUCCESS",0,"ERR_HTTP_MISCONFIGURATION",-7,"ERR_HTTP_PARSE_FAILURE",-6,"ERR_HTTP_CONNECT_FAILURE",-5,"ERR_HTTP_TIMEOUT",-4,"ERR_SERVER_UNCAUGHT",-3,"ERR_APP_SPECIFIC",-2,"ERR_FPP_PROTOCOL",-1),t.FppCommandType=new $Flags("FPP",0,"FPP_JSON",1,"FPP_RP",2,"FPP_RP_JSON",3),t.FppVersion=new $Flags("BASE",0,"ONE",1,"TWO",2,"CURRENT",2),t.FppDateType=new $Flags("Local",0,"UTC",1),t.rfc("microsoft_msn_hotmail_hmmessage_email",[n("Name"),n("Address"),n("EncodedName"),n("EncodedAddress")]),t.rfc("microsoft_msn_hotmail_fdcommon_framework_clientlink",[n("Url"),i("CommandCode"),n("Text"),n("Data")]),t.rfc("microsoft_msn_hotmail_fdcommon_framework_clientmessage",[r("MessageType"),i("InfoCode"),n("Message"),n("ExtendedMessage"),n("PSValue"),u(t.microsoft_msn_hotmail_fdcommon_framework_clientlink,"LearnMoreLink"),u(t.microsoft_msn_hotmail_fdcommon_framework_clientlink,"Link1"),u(t.microsoft_msn_hotmail_fdcommon_framework_clientlink,"Link2"),u(t.microsoft_msn_hotmail_fdcommon_framework_clientlink,"Link3"),i("IsBlocking"),i("DisplayInSuperbar"),i("IsImportant")]),t.rfc("HmSimpleMsg",[i("IsBlocking"),i("YesCode"),i("NoCode"),n("Message"),n("Link1"),n("Link2"),n("Link3")]),t.rfc("SwitchJobTaskProgress",[r("SwitchJobAccountType"),n("SwitchJobEmailAddress"),r("SwitchJobType"),n("SwitchJobStartTime"),r("MailImportStatus"),i("SwitchMailImportCurrentCount"),i("SwitchMailImportTotalCount"),n("SwitchMailImportSkippedLabel"),r("ContactSyncStatus"),r("SwitchUserAction"),i("IsSwitchTaskRunning"),r("SwitchFolderMappingOption"),i("IsImportStatusEnabled")]),t.rfc("microsoft_msn_hotmail_attachments_attachmentdownloadinfo",[i("CanDownload"),n("DownloadUrl")]),t.rfc("Category2",[i("Id"),n("Name"),r("Visibility"),i("UnreadMessagesCount"),i("TotalMessagesCount"),n("ColorCode"),r("Properties")]),t.rfc("CategorySettings",[i("ColumnEnabled"),i("ShowEverythingElseFilter")]),t.rfc("ABContact",[n("DisplayName"),n("PreferredEmail"),r("ContactType"),n("PassportName"),n("Guid"),i("IsMessengerUser"),i("IsFavorite"),n("Cid"),f("Emails"),r("GleamState"),o("LastChangedTimestamp")]),t.rfc("ABDetailedContact",[r("ContactType"),n("FirstName"),n("LastName"),n("PassportName"),n("NickName"),n("Comment"),i("IsMessengerUser"),i("IsSmtpContact"),i("IsFavorite"),f("Emails"),f("Phones"),f("Locations"),f("WebSites"),f("Dates"),n("Guid"),n("Cid"),r("PrimaryEmailType")]),t.rfc("ABEmail",[r("Type"),n("Email"),i("IsMessengerEnabled")]),t.rfc("ABPhone",[r("Type"),n("Phone"),i("IsMessengerEnabled")]),t.rfc("ABLocation",[n("Name"),n("NameYomi"),n("Street"),n("City"),n("State"),n("Country"),n("PostalCode"),r("Type")]),t.rfc("ABDate",[n("Day"),n("Month"),n("Year")]),t.rfc("ABWebSite",[n("WebURL")]),t.rfc("ABGroup",[n("Guid"),n("QuickName"),i("Count"),i("IsFavorite")]),t.rfc("ABDetailedGroup",[n("Guid"),n("QuickName"),i("Count"),i("IsFavorite"),f("Contacts")]),t.rfc("ABCircle",[n("Guid"),n("Name"),n("DisplayName"),n("Email")]),t.rfc("microsoft_msn_hotmail_contacts_hotmailaddressbookcontactsandgroups",[f("Groups"),f("Contacts"),f("Circles"),r("FileAs"),n("SelectedGuid"),u(t.ABDetailedGroup,"SelectedGroup"),u(t.ABDetailedContact,"SelectedContact"),i("HasSelectedGuid"),i("HasSelectedGroup"),i("HasSelectedContact")]),t.rfc("CreateGroupNotification",[n("Url"),n("ImageSource"),n("TextResourceId"),n("LinkTextResourceId"),n("ImageAltTextResourceId"),r("ScenarioId")]),t.rfc("microsoft_msn_hotmail_folders_folder",[n("FolderId"),n("Name"),n("Icon"),i("UnreadMessagesCount"),i("TotalMessagesCount"),n("Size"),i("IsSystem"),i("IsHidden"),r("FolderType"),r("SystemFolderType"),r("ViewType"),n("ParentFolder"),i("IsArchive")]),t.rfc("microsoft_msn_hotmail_hmmessage_mimeheader",[n("Name"),f("Values")]),t.rfc("microsoft_msn_hotmail_hmmessage_senderinfo",[r("SenderIDResult"),u(t.microsoft_msn_hotmail_hmmessage_email,"SenderEmail"),i("IsKnownSender"),n("ListUnsubscribeEmail"),i("IsSenderInContactList"),i("IsSentBySelf")]),t.rfc("microsoft_msn_hotmail_hmmessage_markasjunkmiscinfo",[i("DidSenderIDPass"),i("DidSenderIDFail"),i("IsMailingList"),i("IsSenderHeaderPresent"),i("IsListUnsubscribePresent"),i("IsListUnsubscribeInEmailFormat"),i("IsNeverAllowOrBlockDomain"),i("IsBlockSenderException"),n("BlockDomainQuestion")]),t.rfc("microsoft_msn_hotmail_hmmessage_markasnotjunkmiscinfo",[i("IsFromPRAOnBlockList"),i("HasReachedSafeListLimit"),i("HasEntriesFromSameDomainInSafeList"),i("IsDomainSafe"),i("IsSingleToAndNotRecipient"),i("IsRecipientAddressRFCCompliant"),i("HasReachedMailingListLimit"),i("IsNeverAllowOrBlockDomain"),i("IsInContacts"),n("AllowDomainQuestion")]),t.rfc("microsoft_msn_hotmail_hmmessage_meetingresponseinfo",[r("Action"),n("Reason"),n("CalendarEventUrl"),n("Subject"),n("To"),n("Where"),n("When"),f("Info")]),t.rfc("microsoft_msn_hotmail_hmmessage_exchangesharingresponseinfo",[r("Action"),n("Reason"),n("CalendarUrl"),n("Subject"),n("To"),f("Info")]),t.rfc("microsoft_msn_hotmail_hmmessage_hotmailmessageheader",[u(t.microsoft_msn_hotmail_hmmessage_senderinfo,"MailSenderInfo"),n("OriginalMessageId"),n("FolderId"),r("TypeData"),i("PopSettingIndex"),r("OriginalReplyState"),i("IsInWhiteList"),r("SafetyLevel"),r("SuspiciousReason"),i("IsMailingList"),i("IsVerifiedMail"),n("MessageSize"),i("UnsafeContentFiltered"),i("UnsafeImagesFiltered"),n("Mri"),n("InlineReplySaveDraftDate"),n("Id"),r("ExtendedType"),u(t.HAD,"AuxData"),u(t.microsoft_msn_hotmail_hmmessage_email,"Sender"),u(t.microsoft_msn_hotmail_hmmessage_email,"PraEmail"),i("IsRead"),i("IsFlagged"),r("SentState"),n("MessageSizeString"),i("HasAttachments"),i("PasswordSafetySet"),i("HasLinksAndImages"),i("HasUnsubscribeHeaders"),i("IsSendAsInRecipientsList"),i("IsPhishing"),i("PhishingValue"),i("AuthType"),i("DidSenderAuthenticationFailed"),i("IsToAddressInWhiteList"),i("PutAddressInBlockList"),r("SenderIDStatus"),r("SenderAuthResult"),u(t.microsoft_msn_hotmail_hmmessage_email,"From"),u(t.microsoft_msn_hotmail_hmmessage_subjecttype,"Subject"),o("DateReceivedUTC"),o("DateReceived"),n("DateReceivedLocal"),n("TimeStamp"),r("Importance"),i("IsConversation"),i("IsDraft"),u(t.microsoft_msn_hotmail_hmmessage_recordsetmarker,"Marker")]),t.rfc("microsoft_msn_hotmail_hmmessage_hotmailmessageattachment",[n("ContentType"),n("Name"),n("Size"),i("BodyIndex"),i("AttachmentIndex"),n("ForwardId"),i("ThumbnailIndex"),i("ImageWidth"),i("ImageHeight"),i("IsInline")]),t.rfc("microsoft_msn_hotmail_hmmessage_hotmailmessage",[u(t.microsoft_msn_hotmail_hmmessage_hotmailmessageheader,"Header"),n("Body"),f("Attachments"),n("ToLineString"),n("CCLineString"),n("BccLineString"),n("Rfc822References"),n("Rfc822MessageId"),n("Rfc822InReplyTo"),n("DateSentLocal"),n("DateReceivedLocal"),u(t.microsoft_msn_hotmail_hmmessage_meetingresponseinfo,"MeetingResponseInfo"),u(t.microsoft_msn_hotmail_hmmessage_exchangesharingresponseinfo,"ExchangeSharingResponseInfo"),n("CalendarTempFileId"),n("ReplyFromAddress"),i("IsVerifiedMail"),i("AllowUnsafeContentOverride"),f("DetectedCodePages"),i("CurrentCodePage"),n("DraftId"),i("IsOriginalMessageContentTypePlain")]),t.rfc("HAD",[n("Value")]),t.HAD.QueryArgName=decodeURIComponent("Aux"),t.rfc("microsoft_msn_hotmail_hmmessage_recordsetmarker",[i("EOF"),i("BOF")]),t.rfc("microsoft_msn_hotmail_hmmessage_subjecttype",[n("Prefix"),n("Text"),n("DisplayHtml")]),t.rfc("SendMessageData",[n("To"),n("From"),n("Cc"),n("Bcc"),i("Priority"),n("Subject"),n("Message"),f("AttachmentIds"),n("Draft"),n("DraftFolder"),n("OriginalMessageId"),n("Rfc822MessageId"),n("Rfc822InReplyTo"),n("Rfc822References"),r("SentState"),i("SendByPlainTextFormat"),f("IgnoredWordsFromSpellCheck"),n("MeetingICalID"),i("ShareSkyDriveNumFiles"),i("ComputeFriendshipCacheAndMeInformation"),i("CheckForgottenAttachment")]),t.rfc("CodePage",[i("codePage"),n("name")]),t.rfc("OptionValuePair",[n("Name"),n("Value")]),t.rfc("PreferencesBag",[n("ReplyToAddress"),r("JunkEmailLevel"),i("DeliverToTrash"),i("ReportJunk"),r("ReadingPaneConfiguration"),r("KeyboardShortcutsConfiguration"),r("RespectPopDeleteSettings"),r("HmlvModeConfiguration"),r("ElvModeConfiguration"),r("AutoSelectMessageConfiguration"),i("IsPopEnabled"),i("SaveSentMessages"),i("SkipForgottenAttachmentDetection"),i("IsPinningEnabled"),i("IsPinningSectionExpanded"),i("BlockContentFromUnknownSenders"),i("ConversationThreadingEnabled"),i("HasUserEnabledSocialInbox"),i("NextMessageEnabled"),i("ReplyAllDefaultEnabled"),i("HidePicw"),i("TrashRecoveryEnabled"),n("InstantActions"),n("Language"),f("Languages"),f("ToAddressList"),f("WhiteList"),f("WhiteToList"),f("KillList"),n("ToAddressVerificationInfo"),n("DefaultFromAddress"),r("PrefetchConfiguration"),r("EnabledFeatures"),i("ShowTierUpgrade")]),t.rfc("AliasInterruptViewInitialContext",[n("getMoreInfoLink"),n("aliasCreationLink"),n("skipForNowLink"),n("userDomain")]),t.rfc("ComposeContainer",[u(t.ComposeData,"composeData"),r("actionType"),n("rruCommand"),i("prePopulatedBody")]),t.rfc("ComposeViewInitialContext",[i("isRteToolbarEnabled"),n("fadDisableUrl"),n("uiSeenKbdUrl"),n("defaultFromAddress"),n("defaultFromName"),f("fromAddresses"),i("reloadFromAddresses"),n("userFont"),n("userFontHtml"),n("signature"),i("hasSeenKbdUi"),i("spellChkSupp"),i("isManagedUser"),i("usePicwForContactPicker"),i("hideNonContactPicw"),i("useSlUploader"),n("maxUploadBytes"),n("maxUploadFileCount"),u(t.ShareSkyDriveInitialContext,"shareSkyDrive")]),t.rfc("ShareSkyDriveInitialContext",[n("userShortName"),n("skyApiCanary")]),t.rfc("ImportAccountViewInitialContext",[n("connectedAddress"),i("isOAuthImportEnabled"),i("isYahooImportEnabled"),i("isYahooImportAutoConfigEnabled"),i("isImapImportEnabled"),i("isClientImportEnabled"),i("isImportAccountServiceEnabled"),e("oAuthImportManifest"),e("yahooImportManifest"),e("imapImportManifest"),n("clientImportUrl")]),t.rfc("AqsCondition",[n("AqsQuery"),r("Type")]),t.rfc("SenderAddressCondition",[n("SenderAddress"),r("Type")]),t.rfc("BooleanCondition",[i("Value"),r("Type")]),t.rfc("CategoryCondition",[f("CategoryIDs"),r("Type")]),t.rfc("FolderCondition",[n("FolderID"),r("Type")]),t.rfc("HeaderSearchCondition",[r("SubType"),r("Predicate"),n("Value"),r("Type")]),t.rfc("FilterConditionMarshallingContainer",[f("AqsConditions"),f("SenderAddressConditions"),f("BooleanConditions"),f("CategoryConditions"),f("FolderConditions"),f("HeaderSearchFilterConditions")]),t.rfc("MoveAction",[n("FolderID"),r("Type"),r("DeferredActionType"),i("DeferredActionAge")]),t.rfc("MarkAction",[i("ShouldMarkAsRead"),r("Type"),r("DeferredActionType"),i("DeferredActionAge")]),t.rfc("FlagAction",[i("ShouldFlag"),r("Type"),r("DeferredActionType"),i("DeferredActionAge")]),t.rfc("ForwardAction",[n("ForwardingEmailAddress"),r("Type"),r("DeferredActionType"),i("DeferredActionAge")]),t.rfc("CategorizeAction",[f("CategoryIDs"),r("Type"),r("DeferredActionType"),i("DeferredActionAge")]),t.rfc("MailActionMarshallingContainer",[f("MoveActions"),f("MarkActions"),f("FlagActions"),f("ForwardActions"),f("CategorizeActions")]),t.rfc("MailRule",[r("type"),i("Enabled"),n("Id"),u(t.MailActionMarshallingContainer,"Actions"),u(t.FilterConditionMarshallingContainer,"Conditions"),i("IsComplicated")]),t.rfc("MailMigrationAccountSetting",[n("PopUserName"),n("PopServerAddress"),i("PopServerPort"),i("IsPopOverSsl"),n("SmtpUserName"),n("SmtpServerAddress"),i("SmtpServerPort"),r("SmtpSecureType"),i("IsConnectionVerified")]),t.rfc("AccountSettingForImapAndSmtp",[f("ImapUserName"),n("ImapServerAddress"),i("ImapServerPort"),i("IsImapOverSsl"),r("SmtpDetectOrSetupResult"),f("SmtpUserName"),n("SmtpServerAddress"),i("SmtpServerPort"),r("SmtpSecureType")]),t.rfc("MigratedAccountSetting",[i("AccountID"),i("IsEnabled"),r("AccountType")]),t.rfc("ClientFolderInfo",[n("ClientFolderId"),n("ClientFolderName"),n("ParentClientFolderId"),i("SpecialFolder")]),t.rfc("FolderIdMappingEntry",[n("ClientFolderId"),n("ServerFolderId")]),t.rfc("ContainerPoolData",[r("type"),r("containerType"),e("containerMap"),h("containerList")]),t.rfc("FoldersHashWrapper",[r("type"),n("foldersHash")]),t.rfc("SenderDetails",[n("displayName"),n("fromName"),n("fromAddress"),n("fromPraAddress"),n("icFullName"),n("icContactId"),n("hexContactId"),n("senderCid"),i("hasUnsubscribeInfo"),i("isSenderSelf"),n("icUserTileUrl"),i("isTrustedSender"),i("isSenderPinned"),n("senderDetails"),n("icImageTileType"),i("isSenderInContactList"),i("isSenderInWhiteList")]),t.rfc("SocialInboxMembershipData",[e("socialInboxMemberships")]),t.rfc("Rollup",[n("itemId"),n("conversationId"),f("messageIds"),i("count"),i("unreadCount"),n("timestamp"),n("senderInfos"),f("sendersDetails"),n("toInfos"),n("subject"),n("subjectWithHtml"),i("hasAttachments"),r("importance"),i("replied"),i("forwarded"),f("categories"),n("messageSizeString"),i("isTrustedSender"),r("extendedType"),f("senders"),i("showCompromisedReporting"),i("showMaxMessagesLimitHitNotification"),i("unsubscribeLinkRendered"),i("isRead"),i("isFlagged"),i("isVoicemail"),i("isCallLog"),i("isVoicemailOnPhone"),n("dateReceivedLocal"),n("dateReceivedLocalFull"),u(t.SocialInboxMembershipData,"socialInboxMembershipData"),n("folderId"),i("isPrefetched"),n("messageBodySize"),n("inlineAttachmentsSize"),n("regularAttachmentsSize"),n("timestampInMillisecondsSinceEpoch")]),t.rfc("RollupData",[u(t.Rollup,"rollup"),n("prefetchScore"),r("conversationView"),n("lastUpdatedTimestamp"),i("flags"),n("dateReceived"),i("senderIDStatus"),i("senderAuthResult"),i("flagState"),i("phishingValue"),i("originalFolderReason"),i("authType"),n("praEmail")]),t.rfc("AdvancedSearch",[n("Keywords"),n("From"),n("To"),n("Subject"),f("Folders"),f("Categories"),n("Date"),r("DateRange"),r("HasAttachments"),e("ContactMappings")]),t.rfc("MessageGroupQuery",[n("anchor"),n("anchorDate"),r("anchorType"),i("size"),i("includeAnchor"),r("fetchItem"),n("jumpToAnchor"),r("containerType"),n("containerId"),i("categoryContainerId"),i("filterId"),i("excludeFilterId"),r("itemType"),r("sortOrder"),r("sortType"),i("supportsDelayedRemoval"),u(t.AdvancedSearch,"search"),i("queryId"),n("dataHash"),r("type")]),t.rfc("ItemListData",[r("type"),u(t.RollupData,"rollupData"),e("itemMap"),e("duplicateItemMap"),f("itemList"),u(t.MessageGroupQuery,"msgGroupQuery"),i("bof"),i("eof"),i("totalCount"),n("lastUpdatedTimestamp"),i("threaded")]),t.rfc("BiciData",[i("OptInState"),i("OfficialLetterType")]),t.rfc("ItemResponseInfo",[r("View"),i("IsDedup"),r("PsaType"),n("PsaUrl"),e("ReadInstrumentation"),u(t.ItemListData,"itemListData"),u(t.BiciData,"BiciData")]),t.rfc("NotificationInfoJsonArgs",[e("buttons"),e("options"),n("content"),n("dismissalMode")]),t.rfc("NotificationInfo",[r("type"),u(t.NotificationInfoJsonArgs,"NotificationJsonArgs"),n("CommandName"),e("CommandJsonArgs"),i("errorId")]),t.rfc("BatchInfo",[r("type"),n("AnchorDate"),n("AnchorId"),i("ProcessedCount"),i("IsLastBatch"),n("Timestamp"),n("SenderSearch"),i("FilterId"),i("QuickViewId"),n("FolderId"),r("SortKey"),u(t.AdvancedSearch,"AdvancedSearch"),i("CancelBulkAction")]),t.rfc("ServerErrorMessageLink",[n("url"),n("text"),n("onClick"),i("openInNewWindow")]),t.rfc("ServerErrorMessage",[r("type"),n("serverErrorMessageId"),n("serverErrorMessageString"),n("serverErrorExtendedMessageString"),u(t.ServerErrorMessageLink,"learnMoreLink"),u(t.ServerErrorMessageLink,"link1"),u(t.ServerErrorMessageLink,"link2"),u(t.ServerErrorMessageLink,"link3"),r("priority"),i("isSticky"),i("isBlocking"),i("isImportant"),i("errorId")]),t.rfc("InboxUiData",[u(t.ContainerPoolData,"FolderListData"),u(t.FoldersHashWrapper,"FolderListHash"),u(t.ContainerPoolData,"CategoriesData"),u(t.ItemListData,"MessageListData"),n("MessageHtml"),u(t.ItemListData,"ReadMessageData"),u(t.ItemResponseInfo,"ItemInfo"),u(t.NotificationInfo,"SuggestionNotification"),u(t.BatchInfo,"BatchInfo"),n("MltRootHtml"),n("MltSubHtml"),u(t.MessageGroupQuery,"MessageListQuery"),u(t.AdvancedSearch,"SearchData"),i("NumMessagesRestored"),u(t.ServerErrorMessage,"ServerErrorMessage"),n("RedirectUrl"),e("Content"),n("BiciJsonConfig")]),t.rfc("MiniCalendarOptions",[i("NumberOfPastObjects"),i("NumberOfFutureObjects"),i("NeedAdditionalDateStrings"),n("DateStart"),n("DateEnd")]),t.rfc("KeyboardShortcutsFpp",[i("enabled"),i("timeout"),n("inboxSequenceTree"),n("composeSequenceTree"),n("mode")]),t.rfc("MeetingRequestInfo",[r("action"),n("calendarActionUrl"),n("removeFromCalendarUrl"),n("calendarDayUrl"),n("description"),n("location"),n("time"),n("title")]),t.rfc("microsoft_msn_hotmail_uiservice_fpp_responsedata_hotmailclientmessageheader",[n("id"),n("folderId"),i("isRead"),i("isFlagged"),i("isSent"),f("categories")]),t.rfc("ComposeData",[r("type"),f("AttachmentIdHeaders"),f("InlineIdHeaders"),n("SkyDriveId"),n("MessageBody"),n("Subject"),n("To"),n("CC"),n("BCC"),n("From"),n("DraftId"),n("MeetingIcalId"),n("MessageId"),n("OriginalMessageId"),i("Priority"),r("SentState"),n("Rfc822InReplyTo"),n("Rfc822MessageId"),n("Rfc822References"),i("ShowReplyForwardWarning"),n("MeetingRequestTime"),n("MeetingRequestLocation")]),t.rfc("Message",[n("messageId"),n("conversationId"),n("folderId"),f("categories"),n("to"),n("toDisplayText"),n("cc"),n("ccDisplayText"),n("bcc"),n("bccDisplayText"),n("subject"),n("subjectDisplayHtml"),n("snippet"),u(t.SenderDetails,"senderDetails"),i("hasFakeSnippet"),i("isRead"),i("wasRead"),i("isDraft"),n("inlineReplySaveDraftDate"),n("replyFromAddress"),n("replyToRecipients"),n("replyCcRecipients"),n("replyAllToRecipients"),n("replyAllCcRecipients"),i("isUnsafe"),i("isFlagged"),i("isFlaggable"),i("plainText"),i("isPrintView"),i("isSvmMail"),i("isCallLog"),i("isVoicemail"),i("isPrivateVoicemail"),i("isVoicemailOnPhone"),i("isVoicemailOnPhoneSaved"),i("isMeetingRequest"),i("isOriginalMessageContentTypePlain"),n("dateReceivedLocal"),n("dateReceivedLocalFull"),n("timestamp"),r("importance"),i("renderAdTargetingInfo"),i("size"),r("extendedType"),i("hasAttachments"),i("hasInlineAttachments"),n("attachmentsHtml"),i("hasElv"),i("displayElv"),n("liveViewsHtml"),n("elvParameter"),n("hmlvParameter"),i("mayNotKnowSender"),n("body"),i("bodyHash"),e("bodies"),i("showUnsubscribeLink"),n("unsubscribeLink"),u(t.MeetingRequestInfo,"meetingRequestInfo"),i("showAddContactLink"),i("showExpandedHeaders"),i("showMessengerPresence"),r("safetyLevel"),n("safetyBarHtml"),n("unsubscribeBarHtml"),n("taggingDescription"),i("warnOnReplyForward"),i("passwordSafetySet"),i("allowUnsafe"),n("replyAction"),n("replyAllAction"),n("forwardAction"),n("replyForwardUrl"),n("editContactUrl"),f("detectedCodePages"),i("isComposeSession"),u(t.ComposeData,"composeData"),r("composeActionType"),n("serverMessage"),i("partIndex"),i("isContentFiltered"),n("ati"),u(t.BiciData,"biciData"),i("replyingMessageHasAttachments"),e("eeos"),n("timestampInMillisecondsSinceEpoch")]),t.rfc("ContainerQuery",[r("containerType"),i("queryId"),n("dataHash"),r("type")]),t.rfc("Container",[r("containerType"),u(t.ContainerQuery,"query"),n("name"),i("unreadCount")]),t.rfc("Folder",[n("folderId"),n("parent"),r("folderType"),i("depth"),i("totalCount"),n("size"),i("isCollapsed"),i("hasChildren"),i("isArchive"),i("sortIndex"),r("containerType"),u(t.ContainerQuery,"query"),n("name"),i("unreadCount")]),t.rfc("Category",[i("categoryId"),r("visibility"),n("color"),i("totalCount"),r("properties"),r("containerType"),u(t.ContainerQuery,"query"),n("name"),i("unreadCount")]),t.rfc("FppErrorUi",[r("type"),n("serverMessageId"),n("uncaughtOrAppSpecificException"),n("detailedMessage"),n("errorMessage"),i("isBlocking"),n("errorCode"),i("errorId")]),t.rfc("NewMailNotification",[r("type"),n("serverMessageId"),i("newMailCount"),i("errorId")]),t.rfc("BulkActionCountUpdate",[r("type"),n("serverMessageId"),i("progressCount"),i("completed"),n("sender"),i("errorId")]),t.rfc("SuperBar",[r("type"),n("serverMessageId"),n("contentsHtml"),n("buttonsJsonProperty"),n("buttonHandlerJavascript"),n("moreCss"),i("errorId")]),t.rfc("ServerInvalidQueryResult",[r("type"),r("serverInvalidQueryType"),i("errorId")]),t.rfc("BodyProperties",[i("overrideCodepage"),r("historyType"),r("safetyType"),i("isPrint")]),t.rfc("MessageData",[u(t.Message,"message"),u(t.BodyProperties,"bodyProperties"),f("searchQueries"),f("allHeaders"),i("flags"),n("dateReceived"),i("senderIDStatus"),i("senderAuthResult"),i("flagState"),i("phishingValue"),i("originalFolderReason"),i("authType"),n("praEmail")]),t.rfc("ContainerData",[e("container")]),t.rfc("InfoPaneHtmlWrapper",[r("type"),n("infoPaneHtml")]),t.rfc("SuccessBooleanWrapper",[r("type"),i("success")]),t.rfc("EmailReturnWrapper",[r("type"),n("email")]),t.rfc("ClientGuidReturnWrapper",[r("type"),n("clientGuid")]),t.rfc("BiciConfigReturnWrapper",[r("type"),n("biciConfig")]),t.rfc("UserPreferencesReturnWrapper",[r("type"),u(t.PreferencesBag,"preferences")]),t.rfc("RulesReturnWrapper",[r("type"),f("rules")]),t.rfc("SaveDraftM4ReturnWrapper",[r("type"),n("draftId"),n("savedTime"),i("isAutoSaveEnabled"),n("savedTimeFull"),n("savedTimeLong")]),t.rfc("SaveDraftReturnWrapper",[n("draftGuidId"),r("type"),n("draftId"),n("savedTime"),i("isAutoSaveEnabled"),n("savedTimeFull"),n("savedTimeLong")]),t.rfc("ChangeFolderReturnWrapper",[r("type"),n("folderId"),i("index")]),t.rfc("ChangeCategoriesReturnWrapper",[r("type"),f("newCategories")]),t.rfc("RestoreHiddenTrashNumRestoredWrapper",[r("type"),i("numMessagesRestored")]),t.rfc("FppError",[n("ErrorCode"),n("Message"),e("ErrorObj"),n("StackTrace"),n("Status")]),t.rfc("FppErrorWrapper",[r("type"),u(t.FppError,"fppError")]),t.rfc("GetInboxDataSucceeded",[r("type")]),t.rfc("SearchDataWrapper",[r("type"),u(t.AdvancedSearch,"searchData")]),t.rfc("AffectedHeadersWrapper",[r("type"),u(t.ItemListData,"affectedHeaders")]),t.rfc("LiveViewsTypeHandlerFpp",[n("bindingClassName"),n("resourceSetName"),e("WMP")]),t.rfc("MessagePrefetchData",[r("type"),f("Data")]),t.rfc("microsoft_msn_hotmail_ui_fpp_partnerapiresponse",[n("ErrorCode"),f("Folders"),f("Headers"),n("ErrorDetail")]),t.rfc("MarshalableHeaderAuxData",[i("flags"),i("extendedType"),n("dateReceived"),n("folderId"),i("senderIDStatus"),i("senderAuthResult"),i("flagState"),i("phishingValue"),i("originalFolderReason"),f("categories"),i("authType"),n("praEmail")]),t.rfc("ItemListQuery",[r("containerType"),n("containerId"),n("folderId"),u(t.BodyProperties,"bodyProperties"),u(t.MarshalableHeaderAuxData,"mad"),n("senderEmail"),i("prefetch"),i("queryId"),n("dataHash"),r("type")]),t.rfc("MessageListKeyQuery",[r("containerType"),n("containerId"),i("categoryContainerId"),i("filterId"),i("excludeFilterId"),r("itemType"),r("sortOrder"),r("sortType"),i("supportsDelayedRemoval"),u(t.AdvancedSearch,"search"),i("queryId"),n("dataHash"),r("type")]),t.rfc("OptionsQuery",[i("queryId"),n("dataHash"),r("type")]),t.rfc("RulesQuery",[i("queryId"),n("dataHash"),r("type")]),t.rfc("ServerMessagesQuery",[r("serverMessageType"),i("queryId"),n("dataHash"),r("type")]),t.rfc("UndoQuery",[i("queryId"),n("dataHash"),r("type")]),t.rfc("ServerInvalidationQuery",[i("queryId"),n("dataHash"),r("type")]),t.rfc("CompatibleQueryMarshallingContainer",[f("serverMessagesQueries"),f("containerQueries"),f("messageGroupQueries"),f("itemListQueries"),f("optionsQueries")]),t.rfc("QueryMarshallingContainer",[f("serverMessagesQueries"),f("containerQueries"),f("messageGroupQueries"),f("itemListQueries"),f("optionsQueries"),f("rulesQueries")]),t.rfc("ViewInfo",[n("timestamp"),n("folderId"),i("quickViewId")]),t.rfc("MoveMessagesToFolderInfo",[n("toFolderId"),f("messageListParam"),f("messageAuxData"),f("viewInfos"),i("blockIfDelete"),r("pinOnMove"),r("readOnMove")]),t.rfc("SocialInboxSetupFpp",[i("enabled"),i("peoplePaneEnabled"),n("preferencesUrl"),i("maxCacheRefreshTime"),f("pendingAddFriend")]),t.rfc("ParticipantDataForRecipients",[e("FriendshipCache"),e("UserConnectionStatus"),e("UserNetworkMemberIDs"),u(t.SocialInboxMembershipData,"PotentialSocialInboxUpsells")]),t.rfc("FromAddress",[n("Address"),n("Name")]),t.rfc("UserComposeData",[f("picwEmails"),f("fromAddresses"),n("defaultFromAddress")]),t.rfc("ContactToAdd",[n("FirstName"),n("LastName"),n("EmailAddress")]),t.rfc("SandboxRequest",[n("ID"),n("Uri"),n("Provider"),n("PostBody"),r("AuthOption"),n("AuthParam")]),t.rfc("SandboxResponse",[n("ID"),i("Status"),i("HttpStatusCode"),n("Body"),r("AuthOption"),n("AuthParam"),n("ExceptionMessage"),n("ErrorLog")]),t.rfc("HMLiveViewRequestObject",[n("Id"),n("Sender"),n("Type"),n("SubType"),n("Data"),n("ExtraData")]),t.rfc("HMLiveViewResponseObject",[n("Id"),r("StatusCode"),n("Html")]),t.rfc("MigrateAccountResult",[r("Status"),u(t.MigratedAccountSetting,"AccountSetting"),u(t.microsoft_msn_hotmail_fdcommon_framework_clientmessage,"LocalizedError"),n("AutoForwardingLearnMoreUrl"),n("ExceptionMessage")]),t.rfc("SendMessageAndGetInboxDataResult",[r("type"),f("PotentialContacts"),u(t.CreateGroupNotification,"CreateGroupNotification"),u(t.ParticipantDataForRecipients,"SocialInboxPotentialUpsellData")]),t.rfc("Adapter_Activity",[i("IsSocialNotification"),i("IsUnread"),n("Attribution"),n("Caption"),n("IconUrl"),n("InReplyToObjectId"),n("NotificationId"),n("ObjectId"),n("SourceId"),n("Title"),n("Type"),o("Published"),o("Updated"),u(t.Adapter_Contact,"Author"),u(t.Adapter_Contact,"InReplyToUser"),u(t.Adapter_Activity,"OriginalActivity"),u(t.Adapter_Contact,"To"),u(t.Adapter_Link,"AttributionLink"),u(t.Adapter_Link,"Link"),u(t.Adapter_LinkedText,"Message"),u(t.Adapter_LinkedText,"ResharedMessage"),u(t.Adapter_Album,"Album"),u(t.Adapter_Photo,"Photo"),u(t.Adapter_Reactions,"Reactions"),u(t.Adapter_Video,"Video")]),t.rfc("SocialInboxActivityData",[f("Activities")]),t.rfc("Adapter_Reactions",[u(t.Adapter_CommentReaction,"CommentReaction"),u(t.Adapter_FavoriteReaction,"FavoriteReaction"),u(t.Adapter_LikeReaction,"LikeReaction"),u(t.Adapter_ReplyReaction,"ReplyReaction"),u(t.Adapter_RetweetReaction,"RetweetReaction"),u(t.Adapter_ShareReaction,"ShareReaction")]),t.rfc("Adapter_CommentReaction",[i("CanReact"),f("Comments"),i("Count"),i("TextLimit"),n("ViewMoreLink")]),t.rfc("Adapter_Comment",[i("CanReply"),n("ObjectId"),n("SourceId"),o("Published"),u(t.Adapter_LinkedText,"Message"),u(t.Adapter_Contact,"Author")]),t.rfc("Adapter_FavoriteReaction",[i("CanReact"),i("HasReacted")]),t.rfc("Adapter_LikeReaction",[i("CanReact"),i("Count"),i("HasReacted"),n("ViewMoreLink"),f("Likes")]),t.rfc("Adapter_Like",[u(t.Adapter_Contact,"Author")]),t.rfc("Adapter_ReplyReaction",[i("CanReact"),i("Count"),n("Prefix"),f("Replies"),i("TextLimit"),n("ViewMoreLink")]),t.rfc("Adapter_Reaction",[]),t.rfc("Adapter_Reply",[u(t.Adapter_Contact,"Author"),u(t.Adapter_LinkedText,"Message"),n("ObjectId"),o("Published"),n("SourceId")]),t.rfc("Adapter_RetweetReaction",[i("CanReact"),i("Count"),i("HasReacted"),f("Retweets")]),t.rfc("Adapter_Retweet",[u(t.Adapter_Contact,"Author"),n("ObjectId"),o("Published"),n("SourceId")]),t.rfc("Adapter_ShareReaction",[i("CanReact"),i("Count"),n("Prefix"),f("Shares"),i("TextLimit"),n("ViewMoreLink")]),t.rfc("Adapter_Share",[u(t.Adapter_Contact,"Author"),u(t.Adapter_LinkedText,"Message"),n("ObjectId"),o("Published"),n("SourceId")]),t.rfc("Adapter_Video",[n("Length"),f("Streams")]),t.rfc("Adapter_VideoStream",[n("FlashVars"),i("Height"),n("Type"),n("Url"),i("Width")]),t.rfc("Adapter_Album",[n("ObjectId"),f("Photos"),n("SourceId")]),t.rfc("Adapter_Photo",[n("Title"),n("ObjectId"),n("SourceId"),f("Streams"),u(t.Adapter_Link,"Link")]),t.rfc("Adapter_Link",[n("SafeUrl"),n("Url")]),t.rfc("Adapter_LinkedText",[f("Entities"),n("Text")]),t.rfc("Adapter_Entity",[i("End"),u(t.Adapter_Link,"Link"),i("Start"),n("Text"),n("Type"),u(t.Adapter_Contact,"User")]),t.rfc("Adapter_Contact",[n("Name"),n("ObjectId"),n("ProfilePic"),n("ProfilePicRedirect"),n("ProfileUrl"),n("ScreenName"),n("SourceId"),f("ProfilePicStreams")]),t.rfc("Adapter_PhotoStream",[i("Height"),n("Size"),n("Url"),i("Width")]),t.rfc("SocialNetworkActivity",[n("SocialNetworkId"),n("UserId"),i("ResultCode"),i("ActionableError"),u(t.SocialInboxActivityData,"ActivityData")]),t.rfc("SocialNetworkReactionResponse",[i("Success"),i("CanTheUserTakeRemedialAction")]),t.rfc("SocialInboxData",[e("Friends"),f("Activities"),e("UserConnectionStatus"),e("UserNetworkMemberIDs")]),t.rfc("SocialNetworkUserConnectionStatus",[n("SocialNetworkId"),i("Status"),n("MemberId")]),t.rfc("SocialNetworkMemberInfo",[n("SocialNetworkId"),n("UserId")]),t.rfc("MiniCalendarUiObject",[n("HTML"),n("DateString"),o("TargetDate"),i("IsVisible"),n("PrevMonthString"),n("NextMonthString"),n("TodayString"),r("Type")]),t.rfc("ViewManagerManifest",[n("name"),n("className"),i("disposeOnNavigation"),e("initContext"),f("load")]),t.rfc("SocialInboxMembership",[e("socialNetworkMembers")]),t.rfc("SocialNetworkMember",[n("EmailAddress"),n("SocialNetwork"),n("SocialNetworkMemberID"),n("PublicID"),n("PhotoUrl"),i("PhotoIsPawn"),n("FirstName"),n("LastName")]),t.rfc("FppReturnPackage",[r("Status"),e("Value"),h("OutRefParams"),u(t.FppError,"Error"),e("ProfilingInfo")]),t.rfc("FppProxySettings",[r("Version"),r("CommandType"),n("PartnerId"),n("SessionId"),n("AuthUser"),n("ServerTunnelingUrl"),i("UseClientXmlProxy"),n("CanaryToken"),i("DefaultRetry"),i("Notify"),r("DateType")]),t.rfm("GetMiniCalendarUiObjects",[r("type"),o("targetDate"),u("miniCalendarOptions"),n("uniqueIdentifier")],"GetMiniCalendarUiObjects",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("PrefetchMessages",[u("queries")],"PrefetchMessages",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("HidePicwContact",[n("email")],"HidePicwContact",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("HbiCreateFolderMapping",[n("parentServerFolderName"),f("folders")],"HbiCreateFolderMapping",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("GetSocialInboxData",[f("senderMemberships"),i("computeMemberAndFriendInfo"),n("senderEmailAddress")],"GetSocialInboxData",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("AddSocialNetworkRelationship",[n("socialNetworkId"),n("idOfUserOnSocialNetwork")],"AddSocialNetworkRelationship",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("AddSocialNetworkReaction",[n("socialNetworkId"),n("action"),n("actionId"),i("doOrUndoReaction")],"AddSocialNetworkReaction",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("AddContacts",[f("contactsToAdd"),u("messageAddingContactFromQueries"),f("messagesToRenderQueries"),u("queries")],"AddContacts",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("GetUnconnectedAddFriendUrl",[n("networkID"),n("friendSNID"),n("friendPublicID"),n("messageThreadID")],"GetUnconnectedAddFriendUrl",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("HbiGetSwitchStatus",[u("queries")],"HbiGetSwitchStatus",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("HbiGetSwitchStatusLegacyArch",[],"HbiGetSwitchStatusLegacyArch",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("DismissAliasUpsellSuperbar",[u("queries")],"DismissAliasUpsellSuperbar",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("SHbiValidateOauthImportLegacyArch",[],"SHbiValidateOauthImportLegacyArch",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("SHbiStopSwitchJobRequestLegacyArch",[n("emailAddress")],"SHbiStopSwitchJobRequestLegacyArch",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("SHbiValidateOAuthImport",[u("queries")],"SHbiValidateOAuthImport",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("SHbiValidateImportStart",[u("queries")],"SHbiValidateImportStart",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("HbiGetCongratsDialogManifest",[u("queries")],"HbiGetCongratsDialogManifest",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("SHbiStopSwitchJobRequest",[n("emailAddress"),u("queries")],"SHbiStopSwitchJobRequest",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("SetOptions",[u("partialPreferences"),f("dirtyPreferences"),u("queries")],"SetOptions",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("SetReadingPaneLocation",[r("readingpaneLocation")],"SetReadingPaneLocation",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("UpdateDisplayName",[i("accountId"),n("displayName")],"UpdateDisplayName",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("SHbiEmptyRequest",[u("queries")],"SHbiEmptyRequest",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("SHbiStartImapImport",[n("accountAddress"),n("encryptedUserName"),n("imapUserName"),n("accountPassword"),n("serverAddress"),i("serverPort"),i("isSsl"),i("smtpResult"),u("queries")],"SHbiStartImapImport",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("SHbiStoreSmtpSettings",[n("accountAddress"),n("encryptedUserName"),n("accountPassword"),n("serverAddress"),i("serverPort"),i("secureType"),u("queries")],"SHbiStoreSmtpSettings",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("SHbiTestAndStorePopSettings",[n("address"),n("userName"),n("password"),i("editedPassword"),n("hostname"),n("port"),i("useSsl"),i("leaveMailOnServer"),r("type"),i("id"),r("mode")],"SHbiTestAndStorePopSettings",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("SHbiTestAndStorePopAndSmtpSettings",[n("address"),n("popUserName"),n("popPassword"),i("editedPopPassword"),n("popHostname"),n("popPort"),i("usePopSsl"),i("leaveMailOnServer"),n("smtpUserName"),n("smtpPassword"),i("editedSmtpPassword"),n("smtpHostname"),n("smtpPort"),i("useSmtpSecure"),r("type"),i("id"),r("mode")],"SHbiTestAndStorePopAndSmtpSettings",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("SHbiTestAndStoreSmtpSettings",[n("address"),n("displayName"),n("userName"),n("password"),i("editedPassword"),n("hostname"),n("port"),i("useSecure"),r("type"),i("id"),r("mode")],"SHbiTestAndStoreSmtpSettings",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("HbiStoreExtUiSettingsAndCheckMail",[i("id"),r("type"),n("displayName"),n("address"),n("folderId"),n("folderNameParam"),n("iconId"),i("defaultFolderNameHash"),i("isSmtpConfigured")],"HbiStoreExtUiSettingsAndCheckMail",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("HbiMigrateExtMailSettings",[],"HbiMigrateExtMailSettings",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("StampCookieForHbi",[i("entering")],"StampCookieForHbi",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("SendFromAddressVerificationMail",[n("address"),i("isAggregatedAddress")],"SendFromAddressVerificationMail",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("AddSendAs",[n("address")],"AddSendAs",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("MakeDefaultSendAs",[n("address")],"MakeDefaultSendAs",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("DeleteUploadedAttachment_ec",[n("attachmentToBeDeleted"),i("attachmentSizes")],"DeleteUploadedAttachment_ec",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("RestoreHiddenTrash",[u("queries")],"RestoreHiddenTrash",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("GetInboxData",[u("queries")],"GetInboxData",$Network.Type.XMLPost,"abortable","Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("SetConversationMode",[i("conversationSetting"),u("queries")],"SetConversationMode",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("ListCategories",[],"ListCategories",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("GetComposeData",[r("actionType"),i("detectNeedToShowSafetyWarning"),i("isInline"),u("query"),u("queries")],"GetComposeData",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("AddUpdateDeleteCategories",[f("categoriesToAdd"),f("categoriesToUpdate"),f("categoriesToDelete"),u("categorySettings"),u("queries")],"AddUpdateDeleteCategories",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("ClearFolder",[n("clearFolderId"),u("queries")],"ClearFolder",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("AddFolder",[n("folderName"),n("parentFolderId"),i("isArchive"),u("queries")],"AddFolder",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("ThrowError",[i("errorCode"),n("errorMessage")],"ThrowError",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("UpdateFolder",[n("folderId"),n("newFolderName"),i("isArchive"),u("queries")],"UpdateFolder",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("MoveFolder",[n("folderId"),n("newParentFolderId"),u("queries")],"MoveFolder",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("DeleteFolder",[n("folderId"),r("folderType"),u("queries")],"DeleteFolder",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("BulkActions",[u("actions"),f("messageListParam"),f("messageAuxData"),f("viewInfos"),i("suppressListTransition"),i("getAffectedHeaders"),i("restrictActionToView"),u("queries"),u("batchInfo")],"BulkActions",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("MultiMoveMessagesToFolder",[f("moveInfos"),u("queries")],"MultiMoveMessagesToFolder",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("MoveMessagesToFolder",[n("toFolderId"),f("messageListParam"),f("messageAuxData"),f("viewInfos"),i("blockIfDelete"),i("unpinOnMove"),i("markMessagesAsRead"),i("getAffectedHeaders"),u("queries"),u("batchInfo")],"MoveMessagesToFolder",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("MarkMessagesForJmr",[n("folderId"),f("messagesParam"),f("auxData"),r("xmrType"),i("enableJmrReporting"),r("removeFromList"),i("suppressListTransition"),i("markSenderAsSafe"),f("viewInfos"),i("getAffectedHeaders"),u("queries"),u("batchInfo")],"MarkMessagesForJmr",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("SvmFeedback",[n("svmUrl"),n("svmMsgId"),u("queries")],"SvmFeedback",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("MarkMessagesReadState",[i("readState"),f("messagesParam"),f("auxData"),f("viewInfos"),i("getAffectedHeaders"),u("queries"),u("batchInfo")],"MarkMessagesReadState",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("MarkMessagesFlagState",[i("flagState"),f("messagesParam"),f("auxData"),f("viewInfos"),i("getAffectedHeaders"),u("queries"),u("batchInfo")],"MarkMessagesFlagState",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("CreateRecipientMoveRule",[n("recipientEmail"),n("folderId"),n("folderName"),u("queries")],"CreateRecipientMoveRule",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("AddUpdateDeleteRules",[f("rulesToAdd"),f("rulesToEdit"),f("ruleIdsToDelete"),u("queries")],"AddUpdateDeleteRules",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("ReorderRules",[f("ruleIds"),u("queries")],"ReorderRules",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("DismissInlineReplyBubble",[u("queries")],"DismissInlineReplyBubble",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("BlockSenders",[f("emails"),u("queries")],"BlockSenders",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("SaveDraftM4",[n("toParam"),n("fromParam"),n("fromNameParam"),n("ccParam"),n("bccParam"),i("priority"),n("subjectParam"),n("messageParam"),n("attachmentsParam"),n("inlineAttachmentsParam"),n("rfc822MessageId"),n("rfc822References"),n("rfc822InReplyTo"),n("priorDraft"),n("originalMessage"),r("replyState"),i("isAutoSave"),n("meetingIcalId"),i("saveAsPlainTextMessage"),i("isInlineReply"),u("queries")],"SaveDraftM4",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("SaveDraftM2",[n("toParam"),n("fromParam"),n("fromNameParam"),n("ccParam"),n("bccParam"),i("priority"),n("subjectParam"),n("messageParam"),n("attachmentsParam"),n("inlineAttachmentsParam"),n("rfc822MessageId"),n("rfc822References"),n("rfc822InReplyTo"),n("priorDraft"),n("originalMessage"),r("replyState"),i("isAutoSave"),n("meetingIcalId"),i("saveAsPlainTextMessage"),u("queries")],"SaveDraftM2",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("VerifyRecipients",[f("emails")],"VerifyRecipients",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("DemandLoad",[f("demandLoadContentValues"),f("additionalInfo")],"DemandLoad",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("CopyAttachment",[n("msgID"),i("attachmentIndex"),i("currentCodePage"),n("attachmentDepth"),n("wacData")],"CopyAttachment",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("UndoSenderMoveToBlockList",[n("senderAddress"),i("isRetry"),u("queries")],"UndoSenderMoveToBlockList",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("CheckSpelling_ec",[n("sentence"),f("ignoredWords")],"CheckSpelling_ec",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("AddWordsToUserDictionary_ec",[f("words")],"AddWordsToUserDictionary_ec",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("SendMessage_ec",[n("to"),n("from"),n("cc"),n("bcc"),i("priority"),n("subject"),n("message"),f("attachmentIds"),n("draftId"),n("draftFolderId"),n("originalMessageId"),n("rfc822MessageId"),n("rfc822InReplyTo"),n("rfc822References"),r("sentState"),i("sendByPlainTextFormat"),n("meetingICalId"),i("shareSkyDriveNumFiles"),i("computeFriendshipCacheAndMeInformation"),i("checkForgottenAttachment"),u("queries")],"SendMessage_ec",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("GetUserComposeData",[i("getPicw")],"GetUserComposeData",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("ProcessPendingAlias",[i("useAsDefaultFromAddress")],"ProcessPendingAlias",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("DispatchSandboxRequests",[f("requests")],"DispatchSandboxRequests",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("DispatchSandboxTestPageRequests",[f("requests"),n("userToken"),i("useStoredValueUserToken"),n("userSecret"),i("useStoredValueUserSecret"),n("consumerSecret"),i("useStoredValueConsumerSecret"),n("consumerKey"),i("useStoredValueConsumerKey"),i("continueTransformOnError")],"DispatchSandboxTestPageRequests",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("GetHMLiveViews",[f("requests")],"GetHMLiveViews",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("ReportError",[n("errorString")],"ReportError",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("SHbiMailMigrationAddExternalAccount",[n("address"),n("popUserName"),n("popPassword"),n("popHostname"),n("popPort"),i("popUseSsl"),n("smtpUserName"),n("smtpPassword"),n("smtpServerName"),n("smtpPort"),i("smtpUseSslOrTls"),n("accountDisplayName"),f("uidlList"),i("retryMode")],"SHbiMailMigrationAddExternalAccount",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("ValidateNewFolderNames",[f("folderNames")],"ValidateNewFolderNames",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("SHbiStoreMailAggregationSettings",[n("address"),n("popUserName"),n("popPassword"),n("popHostName"),n("popPort"),i("popUseSsl"),i("leaveMailOnServer"),n("smtpUserName"),n("smtpPassword"),n("smtpServerName"),n("smtpPort"),r("smtpSecureType")],"SHbiStoreMailAggregationSettings",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("HbiUpdateUidlList",[i("accountId"),f("uidlList")],"HbiUpdateUidlList",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("HbiStoreAndEnableExtUiSettings",[i("id"),n("address"),n("displayName"),n("folderNameParam"),f("uidlList")],"HbiStoreAndEnableExtUiSettings",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("HbiEnableMailAggregation",[i("accountId")],"HbiEnableMailAggregation",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("SHbiAddContactsAndGroups",[n("contactDataJson"),n("categoryDataJson")],"SHbiAddContactsAndGroups",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("HbiSendMailMigrationCompletionLetter",[r("overallResult"),r("messageUploadResult"),r("contactUploadResult"),r("accountSetupResult"),n("importedEmailAddress"),n("deliveryFolder"),i("numberOfUploadedMessages"),i("numberOfNotUploadedMessages"),n("retryUrl"),n("helpLinkUrl"),n("upgradeBrowserUrl"),n("upgradeToMetroUrl"),n("setupPCUrl"),n("setupPhoneUrl"),n("deDupeContactsUrl"),n("mailMigrationEntryPointUrl")],"HbiSendMailMigrationCompletionLetter",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("SHbiDetectAndStoreExtMailSettings",[n("address"),n("password"),r("type"),i("id"),r("mode"),n("displayName"),n("popUserName")],"SHbiDetectAndStoreExtMailSettings",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("SHbiDetectImapAndSmtpMailSettings",[n("accountAddress"),n("accountPassword"),u("queries")],"SHbiDetectImapAndSmtpMailSettings",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("SHbiDetectImapAndSmtpMailSettingsForSwitch",[n("accountAddress"),n("accountPassword"),i("isYahoo"),u("queries")],"SHbiDetectImapAndSmtpMailSettingsForSwitch",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),t.rfm("SHbiVerifyImapSettings",[n("accountAddress"),n("accountPassword"),n("imapUserName"),n("serverAddress"),i("serverPort"),i("isSsl"),u("queries")],"SHbiVerifyImapSettings",$Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox"),typeof HM=="object"&&typeof HM.RegisterClientSideFPPClasses=="function"&&HM.RegisterClientSideFPPClasses(t),t.seal(),t}),function(n){"use strict";var t=window.ol=window.ol||{},i=function(){function f(n){for(var t,f,o,e,u=i.length-1;u>=0;u--)for(t=i[u],f=0;f<t.queries.length;f++)if(o=t.queries[f],e=o.key(),n.hasOwnProperty(e)&&n[e].isQueryInvalidationChange){r.unregister(t.callback,t.viewModel);break}}var r=this,i=[],u=n.when();r.register=function(n,t,r,u){i.push({queries:n,callback:t,viewModel:r,invalidQueryCallback:u})},r.unregister=function(n,t){for(var r=0;r<i.length;r++)if(i[r].callback===n&&i[r].viewModel===t){i.splice(r,1);break}},r.fireCmd=function(f,e){for(var h,o=[],s=0;s<i.length;s++)o.push.apply(o,HM.deepCopy(i[s].queries));e=e||{},e.queries=o,e.progressCallback=r.progress;var a=e.commandResolutionDeferred=n.Deferred(),c=!t.config.serverRenderOnly&&!e.shouldSuppressLoadingIndicator,l=null;return c&&(l=t.showLoading("cmd "+f)),h=t.Cmd(f).fire(e),h.deferred.always(function v(n){var i=u;u.always(function(){i===u?(u=r.progress(h,n),u.always(a.resolve),c&&t.hideLoading(l)):v(n)})}),h},r.progress=function(n,r){var h,c,l,a,v,d,y,e,s;r&&HM.assertCommandResult(r);var p=r&&r.results||{},w=[],g=i.slice(0);for(f(p),h=0;h<g.length;h++){var u=g[h],o={},b=!0,k=!0,nt=!1;for(c=0;c<u.queries.length;c++)if(e=u.queries[c],l=e.key(),p.hasOwnProperty(l))a=p[l],o[l]=a,a.isQueryInvalidationChange?nt=!0:(v=a.dataHash,k=k&&e.dataHash===v&&v!==""&&v!==null);else{b=!1;break}if(nt)s=t.config.serverRenderOnly?o:t.Object.clone(o),u.invalidQueryCallback&&(d=u.invalidQueryCallback(n,s),d&&w.push(d));else if(b&&!k){for(y=0;y<u.queries.length;y++)e=u.queries[y],e.dataHash=o[e.key()].dataHash;s=t.config.serverRenderOnly?o:t.Object.clone(o),w.push(u.callback(n,s))}else!b}return t.deferredUtils.whenAll(w)}};t.Dispatcher=new i}(window.originaljQuery||window.jQuery),function(n){"use strict";function i(n){return n.substring(0,2)}var t=n.data=n.data||{},r;t.saveValues=function(n,t){for(var u=[],i,r=0;r<n.length;r++)i=n[r],t[i]!==undefined&&(u.push({key:i,value:t[i]}),t[i]=undefined);return u},t.restoreValues=function(n,t){for(var r,i=0;i<n.length;i++)r=n[i],t[r.key]=r.value},t.hashResult=function(n){var f,i;if(n===null)return n;var e=t.saveValues(["query"],n),r=n.messages,u={};if(r)for(i in r)u[i]=t.saveValues(["body","bodies"],r[i]);f=JSON.stringify(n),t.restoreValues(e,n);for(i in u)t.restoreValues(u[i],r[i]);return f},t.isTemporaryId=function(n){return i(n)===i(n).toUpperCase()},t.isMessageId=function(n){return i(n).toLowerCase()==="mg"},t.isConversationId=function(n){return i(n).toLowerCase()==="cv"},t.isMessageAsConversationId=function(n){return i(n).toLowerCase()==="cm"},t.isFolderId=function(n){return typeof n=="string"&&n.length>2&&i(n).toLowerCase()==="fl"},t.isSystemFolderId=function(t){for(var i in n.config.sysFldrs)if(n.config.sysFldrs[i]===t)return!0;return!1},t.isCategoryId=function(n){return typeof n=="number"},t.isContainerId=function(n){return t.isCategoryId(n)||t.isFolderId(n)},t.isNullId=function(n){return n?n.substring(2)==="AAAAAAAAAAAAAAAAAAAAAA2":!1},t.makeMessageAsConversation=function(n){return(t.isTemporaryId(n)?"CM":"cm")+n.substring(2)},t.getMidFromMessageAsConversation=function(n){return(t.isTemporaryId(n)?"MG":"mg")+n.substring(2)},t.normalizeId=function(n){return t.isMessageAsConversationId(n)?t.getMidFromMessageAsConversation(n):n},t.getMid=function(n){return(t.isTemporaryId(n)?"MG":"mg")+n.substring(2)},r=0,t.getTemporaryId=function(n){return n.toUpperCase()+r++},t.uniqueExtend=function(n,t){if(t)for(var i in t)t.hasOwnProperty(i)&&(n.hasOwnProperty(i)||(n[i]=t[i]))},t.getMappedIdIfNecessary=function(n,i){var r=t.isMessageAsConversationId(n);return r&&(n=t.getMidFromMessageAsConversation(n)),i&&i[n]&&(n=i[n]),r&&(n=t.makeMessageAsConversation(n)),n},t.isSameThread=function(n,i,r){var u=!1;return n===i&&(u=!0),r&&(r[n]===i&&(u=!0),t.isMessageAsConversationId(n)&&t.isMessageAsConversationId(i)&&r[t.getMidFromMessageAsConversation(n)]==t.getMidFromMessageAsConversation(i)&&(u=!0)),u},t.createInvalidateItemListQueryChange=function(n,t,i,r){var u,f;if(u={},r)for(f in r)u[f]=!0;return HM.createInvalidateItemListQueryChange({itemId:n,invalidationType:t,rollupView:i,messageIds:u})},t.getViewId=function(n){var t;switch(n.containerType){case HM.ItemListQueryContainerType.Folder:t=n.containerId;break;case HM.ItemListQueryContainerType.Category:t=n.categoryContainerId;break;default:throw"Unknown container type for query: "+n.containerType;}return t},t.canonicalizeDate=function(n){return Number(n)},t.isChangeProcessedByModel=function(n,t){var i=n.processedBy,r=!0;return i&&i.indexOf(t)!==-1||(i||(n.processedBy=i=[]),i.push(t),r=!1),r}}(window.ol,window.originaljQuery||window.jQuery),define(["ol"],function(n){"use strict";function r(n,t,i){for(var r,u=0;u<n.length;u++)r=n[u],r.type===HM.QueryType.MessageGroupQuery&&(!i||i(r))&&(r.invalid=!0,r.setInvalidationType(t))}var i=n.data=n.data||{},t=i.QueryUtils={},u=0;t.getQueryId=function(){return u++},t.defaultKey=function(){var n=i.saveValues(["dataHash","queryId","invalid","invalidationType","invalidationHandled","prefetch","mad","senderEmail","forceFetch"],this),t=JSON.stringify(this);return i.restoreValues(n,this),t},t.invalidateMessageGroupQueriesByContainer=function(n,t){for(var i,r=0;r<n.length;r++)i=n[r],i.type===HM.QueryType.MessageGroupQuery&&(i.containerId===t||i.categoryContainerId===t)&&(i.invalid=!0,i.setInvalidationType(HM.MessageGroupQueryInvalidationType.ContainerRemoval))},t.invalidateAllMessageGroupQueries=function(n,t){r(n,t)},t.invalidateAllAnchoredMessageGroupQueries=function(n,t){r(n,t,function(n){return!(n.anchorType===HM.MessageGroupQueryAnchorType.FirstPage||n.anchorType===HM.MessageGroupQueryAnchorType.LastPage)})},t.invalidateMessageGroupQueriesByAnchor=function(n,t){for(var i,r=0;r<n.length;r++)i=n[r],i.type===HM.QueryType.MessageGroupQuery&&i.anchor&&i.anchor===t&&(i.invalid=!0,i.setInvalidationType(HM.MessageGroupQueryInvalidationType.AnchorChange))},t.forceFetchAllQueries=function(n){for(var t=0;t<n.length;t++)n[t].forceFetch=!0},t.invalidateAllItemListQueries=function(n){for(var i,r,t=0;t<n.length;t++)i=n[t],r=n[t].type,r===HM.QueryType.ItemListQuery&&(i.containerType===HM.ItemListQueryContainerType.Conversation||i.containerType===HM.ItemListQueryContainerType.Message)&&(i.invalid=!0)}}),function(){"use strict";var f="number",e="object",o="array",n="string",i="boolean",t=window.HM,r=jQuery.proxy(t.rfcdbp,t),u=jQuery.type;r("microsoft_msn_hotmail_hmmessage_email",[["",n,1],["",n,1],["",n,1],["",n,1]]),r("microsoft_msn_hotmail_fdcommon_framework_clientlink",[["",n,1],[0,f,0],["",n,1],["",n,1]]),r("microsoft_msn_hotmail_fdcommon_framework_clientmessage",[[t.ClientMessageType.Info,u(t.ClientMessageType.Info),0],[0,f,0],["",n,1],["",n,1],["",n,1],[null,e,1],[null,e,1],[null,e,1],[null,e,1],[!1,i,0],[!1,i,0],[!1,i,0]]),r("HmSimpleMsg",[[!1,i,0],[0,f,0],[0,f,0],["",n,1],["",n,1],["",n,1],["",n,1]]),r("SwitchJobTaskProgress",[[t.SwitchAccountType.Gmail,u(t.SwitchAccountType.Gmail),0],["",n,1],[t.SwitchTaskType.None,u(t.SwitchTaskType.None),0],["",n,1],[t.SwitchTaskStatus.NotStarted,u(t.SwitchTaskStatus.NotStarted),0],[0,f,0],[0,f,0],["",n,1],[t.SwitchTaskStatus.NotStarted,u(t.SwitchTaskStatus.NotStarted),0],[t.SwitchUserAction.None,u(t.SwitchUserAction.None),0],[!1,i,0],[t.SwitchFolderMappingOption.Root,u(t.SwitchFolderMappingOption.Root),0],[!1,i,0]]),r("microsoft_msn_hotmail_attachments_attachmentdownloadinfo",[[!1,i,0],["",n,1]]),r("Category2",[[0,f,0],["",n,1],[t.CategoryVisibility.NotVisible,u(t.CategoryVisibility.NotVisible),0],[0,f,0],[0,f,0],["",n,1],[t.CategoryProperties.None,u(t.CategoryProperties.None),0]]),r("CategorySettings",[[!1,i,1],[!1,i,1]]),r("ABContact",[["",n,1],["",n,1],[t.ContactType.Regular,u(t.ContactType.Regular),0],["",n,1],["",n,1],[!1,i,0],[!1,i,0],["0",n,0],[[],o,1],[t.ABGleamMask.None,u(t.ABGleamMask.None),0],["0",n,0]]),r("ABDetailedContact",[[t.ContactType.Regular,u(t.ContactType.Regular),0],["",n,1],["",n,1],["",n,1],["",n,1],["",n,1],[!1,i,0],[!1,i,0],[!1,i,0],[[],o,1],[[],o,1],[[],o,1],[[],o,1],[[],o,1],["",n,1],["0",n,0],[t.ContactEmailType.ContactEmailPersonal,u(t.ContactEmailType.ContactEmailPersonal),0]]),r("ABEmail",[[t.ContactEmailType.ContactEmailPersonal,u(t.ContactEmailType.ContactEmailPersonal),0],["",n,1],[!1,i,0]]),r("ABPhone",[[t.ContactPhoneType.ContactPhonePersonal,u(t.ContactPhoneType.ContactPhonePersonal),0],["",n,1],[!1,i,0]]),r("ABLocation",[["",n,1],["",n,1],["",n,1],["",n,1],["",n,1],["",n,1],["",n,1],[t.ContactLocationType.ContactLocationPersonal,u(t.ContactLocationType.ContactLocationPersonal),0]]),r("ABDate",[["",n,1],["",n,1],["",n,1]]),r("ABWebSite",[["",n,1]]),r("ABGroup",[["",n,1],["",n,1],[0,f,0],[!1,i,0]]),r("ABDetailedGroup",[["",n,1],["",n,1],[0,f,0],[!1,i,0],[[],o,1]]),r("microsoft_msn_hotmail_contacts_hotmailaddressbookcontactsandgroups",[[[],o,1],[[],o,1],[[],o,1],[t.FileAsType.NotSet,u(t.FileAsType.NotSet),0],["",n,1],[null,e,1],[null,e,1],[!1,i,0],[!1,i,0],[!1,i,0]]),r("ABCircle",[["",n,1],["",n,1],["",n,1],["",n,1]]),r("CreateGroupNotification",[["",n,1],["",n,1],["",n,1],["",n,1],["",n,1],[t.ScenarioId.None,u(t.ScenarioId.None),0]]),r("microsoft_msn_hotmail_folders_folder",[["",n,1],["",n,1],["",n,1],[0,f,0],[0,f,0],["0",n,0],[!1,i,0],[!1,i,0],[t.FolderType.SYSTEM,u(t.FolderType.SYSTEM),0],[t.SystemFolderType.NONE,u(t.SystemFolderType.NONE),0],[t.FolderViewType.Default,u(t.FolderViewType.Default),0],["",n,1],[!1,i,0]]),r("microsoft_msn_hotmail_hmmessage_mimeheader",[["",n,1],[[],o,1]]),r("microsoft_msn_hotmail_hmmessage_senderinfo",[[t.microsoft_msn_hotmail_hmmessage_headersenderidstatus.UNKNOWN,u(t.microsoft_msn_hotmail_hmmessage_headersenderidstatus.UNKNOWN),0],[null,e,1],[!1,i,0],["",n,1],[!1,i,0],[!1,i,0]]),r("microsoft_msn_hotmail_hmmessage_markasjunkmiscinfo",[[!1,i,0],[!1,i,0],[!1,i,0],[!1,i,0],[!1,i,0],[!1,i,0],[!1,i,0],[!1,i,0],["",n,1]]),r("microsoft_msn_hotmail_hmmessage_markasnotjunkmiscinfo",[[!1,i,0],[!1,i,0],[!1,i,0],[!1,i,0],[!1,i,0],[!1,i,0],[!1,i,0],[!1,i,0],[!1,i,0],["",n,1]]),r("microsoft_msn_hotmail_hmmessage_meetingresponseinfo",[[t.microsoft_msn_hotmail_hmmessage_meetingresponseinfo_responseactiontype.Ok,u(t.microsoft_msn_hotmail_hmmessage_meetingresponseinfo_responseactiontype.Ok),0],["",n,1],["",n,1],["",n,1],["",n,1],["",n,1],["",n,1],[[],o,1]]),r("microsoft_msn_hotmail_hmmessage_exchangesharingresponseinfo",[[t.microsoft_msn_hotmail_hmmessage_exchangesharingresponseinfo_responseactiontype.Unsupported,u(t.microsoft_msn_hotmail_hmmessage_exchangesharingresponseinfo_responseactiontype.Unsupported),0],["",n,1],["",n,1],["",n,1],["",n,1],[[],o,1]]),r("microsoft_msn_hotmail_hmmessage_hotmailmessage",[[null,e,1],["",n,1],[[],o,1],["",n,1],["",n,1],["",n,1],["",n,1],["",n,1],["",n,1],["",n,1],["",n,1],[null,e,1],[null,e,1],["",n,1],["",n,1],[!1,i,0],[!1,i,0],[[],o,1],[0,f,0],["",n,1],[!1,i,0]]),r("microsoft_msn_hotmail_hmmessage_hotmailmessageattachment",[["",n,1],["",n,1],["0",n,0],[0,f,0],[0,f,0],["",n,1],[0,f,0],[0,f,0],[0,f,0],[!1,i,0]]),r("HAD",[["",n,1]]),r("microsoft_msn_hotmail_hmmessage_recordsetmarker",[[!1,i,0],[!1,i,0]]),r("microsoft_msn_hotmail_hmmessage_subjecttype",[["",n,1],["",n,1],["",n,1]]),r("microsoft_msn_hotmail_hmmessage_hotmailmessageheader",[[null,e,1],["",n,1],["",n,1],[t.TypeData.td0_NONE,u(t.TypeData.td0_NONE),0],[0,f,0],[t.MessageSentStateType.NOACTION,u(t.MessageSentStateType.NOACTION),0],[!1,i,0],[t.MessageSafetyLevel.Trusted,u(t.MessageSafetyLevel.Trusted),0],[t.MessageSuspiciousReason.Phishing,u(t.MessageSuspiciousReason.Phishing),1],[!1,i,0],[!1,i,0],["0",n,0],[!1,i,0],[!1,i,0],["",n,1],["",n,1],["",n,1],[t.ExtendedType.e0_NONE,u(t.ExtendedType.e0_NONE),0],[null,e,1],[null,e,1],[null,e,1],[!1,i,0],[!1,i,0],[t.MessageSentStateType.NOACTION,u(t.MessageSentStateType.NOACTION),0],["",n,1],[!1,i,0],[!1,i,0],[!1,i,0],[!1,i,0],[!1,i,0],[!1,i,0],[0,f,0],[0,f,0],[!1,i,0],[!1,i,0],[!1,i,0],[t.microsoft_msn_hotmail_hmmessage_headersenderidstatus.UNKNOWN,u(t.microsoft_msn_hotmail_hmmessage_headersenderidstatus.UNKNOWN),0],[t.microsoft_msn_hotmail_hmmessage_headersenderauthresult.NONE,u(t.microsoft_msn_hotmail_hmmessage_headersenderauthresult.NONE),0],[null,e,1],[null,e,1],["0",n,0],["0",n,0],["",n,1],["",n,1],[t.ImportanceType.NORMAL,u(t.ImportanceType.NORMAL),0],[!1,i,0],[!1,i,0],[null,e,1]]),r("SendMessageData",[["",n,1],["",n,1],["",n,1],["",n,1],[0,f,0],["",n,1],["",n,1],[[],o,1],["",n,1],["",n,1],["",n,1],["",n,1],["",n,1],["",n,1],[t.MessageSentStateType.NOACTION,u(t.MessageSentStateType.NOACTION),0],[!1,i,0],[[],o,1],["",n,1],[0,f,0],[!1,i,0],[!1,i,0]]),r("CodePage",[[0,f,0],["",n,1]]),r("PreferencesBag",[["",n,1],[t.PresetProtectionLevelEnum.Low,u(t.PresetProtectionLevelEnum.Low),0],[!1,i,0],[!1,i,0],[t.ReadingPaneLocation.None,u(t.ReadingPaneLocation.None),0],[t.KeyboardShortcutsMode.None,u(t.KeyboardShortcutsMode.None),0],[t.RespectPopDeleteSettingsMode.NotSet,u(t.RespectPopDeleteSettingsMode.NotSet),0],[t.HmlvMode.None,u(t.HmlvMode.None),0],[t.ElvMode.None,u(t.ElvMode.None),0],[t.AutoSelectMessage.None,u(t.AutoSelectMessage.None),0],[!1,i,0],[!1,i,0],[!1,i,0],[!1,i,0],[!1,i,0],[!1,i,0],[!1,i,0],[!1,i,0],[!1,i,0],[!1,i,0],[!1,i,0],[!1,i,0],["",n,1],["",n,1],[[],o,1],[[],o,1],[[],o,1],[[],o,1],[[],o,1],["",n,1],["",n,1],[t.PrefetchMode.None,u(t.PrefetchMode.None),0],[t.FeatureVerdicts.None,u(t.FeatureVerdicts.None),1],[!1,i,0]]),r("OptionValuePair",[["",n,1],["",n,1]]),r("AliasInterruptViewInitialContext",[["",n,1],["",n,1],["",n,1],["",n,1]]),r("ComposeContainer",[[null,e,1],[t.MessageActionType.ViewMessage,u(t.MessageActionType.ViewMessage),0],["",n,1],[!1,i,0]]),r("ComposeViewInitialContext",[[!1,i,0],["",n,1],["",n,1],["",n,1],["",n,1],[[],o,1],[!1,i,0],["",n,1],["",n,1],["",n,1],[!1,i,0],[!1,i,0],[!1,i,0],[!1,i,0],[!1,i,0],[!1,i,0],["",n,1],["",n,1],[null,e,1]]),r("ShareSkyDriveInitialContext",[["",n,1],["",n,1]]),r("ImportAccountViewInitialContext",[["",n,1],[!1,i,0],[!1,i,0],[!1,i,0],[!1,i,0],[!1,i,0],[!1,i,0],[{},e,1],[{},e,1],[{},e,1],["",n,1]]),r("AqsCondition",[["",n,1],[t.FilterConditionType.Sender,u(t.FilterConditionType.Sender),0]]),r("SenderAddressCondition",[["",n,1],[t.FilterConditionType.Sender,u(t.FilterConditionType.Sender),0]]),r("BooleanCondition",[[!1,i,0],[t.FilterConditionType.Sender,u(t.FilterConditionType.Sender),0]]),r("CategoryCondition",[[[],o,1],[t.FilterConditionType.Sender,u(t.FilterConditionType.Sender),0]]),r("FolderCondition",[["",n,1],[t.FilterConditionType.Sender,u(t.FilterConditionType.Sender),0]]),r("HeaderSearchCondition",[[t.HeaderSearchConditionType.SenderEmail,u(t.HeaderSearchConditionType.SenderEmail),0],[t.FilterConditionPredicate.IsEqualTo,u(t.FilterConditionPredicate.IsEqualTo),0],["",n,1],[t.FilterConditionType.Sender,u(t.FilterConditionType.Sender),0]]),r("FilterConditionMarshallingContainer",[[[],o,1],[[],o,1],[[],o,1],[[],o,1],[[],o,1],[[],o,1]]),r("MoveAction",[["",n,1],[t.MailActionType.Move,u(t.MailActionType.Move),0],[t.DeferredMailActionType.None,u(t.DeferredMailActionType.None),0],[0,f,0]]),r("MarkAction",[[!1,i,0],[t.MailActionType.Move,u(t.MailActionType.Move),0],[t.DeferredMailActionType.None,u(t.DeferredMailActionType.None),0],[0,f,0]]),r("FlagAction",[[!1,i,0],[t.MailActionType.Move,u(t.MailActionType.Move),0],[t.DeferredMailActionType.None,u(t.DeferredMailActionType.None),0],[0,f,0]]),r("ForwardAction",[["",n,1],[t.MailActionType.Move,u(t.MailActionType.Move),0],[t.DeferredMailActionType.None,u(t.DeferredMailActionType.None),0],[0,f,0]]),r("CategorizeAction",[[[],o,1],[t.MailActionType.Move,u(t.MailActionType.Move),0],[t.DeferredMailActionType.None,u(t.DeferredMailActionType.None),0],[0,f,0]]),r("MailActionMarshallingContainer",[[[],o,1],[[],o,1],[[],o,1],[[],o,1],[[],o,1]]),r("MailRule",[[t.DLReturnType.MessageListData,u(t.DLReturnType.MessageListData),0],[!1,i,0],["",n,1],[null,e,1],[null,e,1],[!1,i,0]]),r("MailMigrationAccountSetting",[["",n,1],["",n,1],[0,f,0],[!1,i,0],["",n,1],["",n,1],[0,f,0],[t.SmtpSecureType.Tls,u(t.SmtpSecureType.Tls),0],[!1,i,0]]),r("AccountSettingForImapAndSmtp",[[[],o,1],["",n,1],[0,f,0],[!1,i,0],[t.SmtpSetupResult.Success,u(t.SmtpSetupResult.Success),0],[[],o,1],["",n,1],[0,f,0],[t.SmtpSecureType.Tls,u(t.SmtpSecureType.Tls),0]]),r("MigratedAccountSetting",[[0,f,0],[!1,i,0],[t.MigrateAccountType.NotAdded,u(t.MigrateAccountType.NotAdded),0]]),r("ClientFolderInfo",[["",n,1],["",n,1],["",n,1],[0,f,0]]),r("FolderIdMappingEntry",[["",n,1],["",n,1]]),r("InboxUiData",[[null,e,1],[null,e,1],[null,e,1],[null,e,1],["",n,1],[null,e,1],[null,e,1],[null,e,1],[null,e,1],["",n,1],["",n,1],[null,e,1],[null,e,1],[0,f,1],[null,e,1],["",n,1],[{},e,1],["",n,1]]),r("BatchInfo",[[t.DLReturnType.MessageListData,u(t.DLReturnType.MessageListData),0],["",n,1],["",n,1],[0,f,0],[!1,i,0],["",n,1],["",n,1],[0,f,1],[0,f,1],["",n,1],[t.SortBy.Sender,u(t.SortBy.Sender),0],[null,e,1],[!1,i,0]]),r("ItemResponseInfo",[[t.ItemView.Normal,u(t.ItemView.Normal),0],[!1,i,0],[t.PsaType.None,u(t.PsaType.None),0],["",n,1],[{},e,1],[null,e,1],[null,e,1]]),r("BiciData",[[0,f,0],[0,f,0]]),r("AdvancedSearch",[["",n,1],["",n,1],["",n,1],["",n,1],[[],o,1],[[],o,1],["",n,1],[t.SearchDateRange.ExactDate,u(t.SearchDateRange.ExactDate),0],[t.SearchHasAttachments.AnyAttachments,u(t.SearchHasAttachments.AnyAttachments),0],[{},e,1]]),r("MiniCalendarOptions",[[0,f,0],[0,f,0],[!1,i,0],["",n,1],["",n,1]]),r("KeyboardShortcutsFpp",[[!1,i,0],[0,f,0],["",n,1],["",n,1],["",n,1]]),r("Rollup",[["",n,1],["",n,1],[[],o,1],[0,f,0],[0,f,0],["",n,1],["",n,1],[[],o,1],["",n,1],["",n,1],["",n,1],[!1,i,0],[t.ImportanceType.NORMAL,u(t.ImportanceType.NORMAL),0],[!1,i,0],[!1,i,0],[[],o,1],["",n,1],[!1,i,0],[t.ExtendedType.e0_NONE,u(t.ExtendedType.e0_NONE),0],[[],o,1],[!1,i,0],[!1,i,0],[!1,i,0],[!1,i,0],[!1,i,0],[!1,i,0],[!1,i,0],[!1,i,0],["",n,1],["",n,1],[null,e,1],["",n,1],[!1,i,0],["0",n,0],["0",n,0],["0",n,0],["",n,1]]),r("SenderDetails",[["",n,1],["",n,1],["",n,1],["",n,1],["",n,1],["",n,1],["",n,1],["0",n,0],[!1,i,0],[!1,i,0],["",n,1],[!1,i,0],[!1,i,0],["",n,1],["",n,1],[!1,i,0],[!1,i,0]]),r("MeetingRequestInfo",[[t.MeetingRequestAction.Request,u(t.MeetingRequestAction.Request),0],["",n,1],["",n,1],["",n,1],["",n,1],["",n,1],["",n,1],["",n,1]]),r("microsoft_msn_hotmail_uiservice_fpp_responsedata_hotmailclientmessageheader",[["",n,1],["",n,1],[!1,i,0],[!1,i,0],[!1,i,0],[[],o,1]]),r("Message",[["",n,1],["",n,1],["",n,1],[[],o,1],["",n,1],["",n,1],["",n,1],["",n,1],["",n,1],["",n,1],["",n,1],["",n,1],["",n,1],[null,e,1],[!1,i,0],[!1,i,0],[!1,i,0],[!1,i,0],["",n,1],["",n,1],["",n,1],["",n,1],["",n,1],["",n,1],[!1,i,0],[!1,i,0],[!1,i,0],[!1,i,0],[!1,i,0],[!1,i,0],[!1,i,0],[!1,i,0],[!1,i,0],[!1,i,0],[!1,i,0],[!1,i,0],[!1,i,0],["",n,1],["",n,1],["",n,1],[t.ImportanceType.NORMAL,u(t.ImportanceType.NORMAL),0],[!1,i,0],[0,f,0],[t.ExtendedType.e0_NONE,u(t.ExtendedType.e0_NONE),0],[!1,i,0],[!1,i,0],["",n,1],[!1,i,0],[!1,i,0],["",n,1],["",n,1],["",n,1],[!1,i,0],["",n,1],[0,f,0],[{},e,1],[!1,i,0],["",n,1],[null,e,1],[!1,i,0],[!1,i,0],[!1,i,0],[t.MessageSafetyLevel.Trusted,u(t.MessageSafetyLevel.Trusted),0],["",n,1],["",n,1],["",n,1],[!1,i,0],[!1,i,0],[!1,i,0],["",n,1],["",n,1],["",n,1],["",n,1],["",n,1],[[],o,1],[!1,i,0],[null,e,1],[t.MessageActionType.ViewMessage,u(t.MessageActionType.ViewMessage),0],["",n,1],[0,f,0],[!1,i,0],["",n,1],[null,e,1],[!1,i,0],[{},e,1],["",n,1]]),r("Container",[[t.ContainerType.Folders,u(t.ContainerType.Folders),0],[null,e,1],["",n,1],[0,f,0]]),r("Folder",[["",n,1],["",n,1],[t.FolderType.SYSTEM,u(t.FolderType.SYSTEM),0],[0,f,0],[0,f,0],["0",n,0],[!1,i,0],[!1,i,0],[!1,i,0],[0,f,0],[t.ContainerType.Folders,u(t.ContainerType.Folders),0],[null,e,1],["",n,1],[0,f,0]]),r("Category",[[0,f,0],[t.CategoryVisibility.NotVisible,u(t.CategoryVisibility.NotVisible),0],["",n,1],[0,f,0],[t.CategoryProperties.None,u(t.CategoryProperties.None),0],[t.ContainerType.Folders,u(t.ContainerType.Folders),0],[null,e,1],["",n,1],[0,f,0]]),r("FppErrorUi",[[t.DLReturnType.MessageListData,u(t.DLReturnType.MessageListData),0],["",n,1],["",n,1],["",n,1],["",n,1],[!1,i,0],["",n,1],[0,f,0]]),r("ServerErrorMessageLink",[["",n,1],["",n,1],["",n,1],[!1,i,0]]),r("ServerErrorMessage",[[t.DLReturnType.MessageListData,u(t.DLReturnType.MessageListData),0],["",n,1],["",n,1],["",n,1],[null,e,1],[null,e,1],[null,e,1],[null,e,1],[t.ServerErrorMessagePriority.Low,u(t.ServerErrorMessagePriority.Low),0],[!1,i,0],[!1,i,0],[!1,i,0],[0,f,0]]),r("NotificationInfo",[[t.DLReturnType.MessageListData,u(t.DLReturnType.MessageListData),0],[null,e,1],["",n,1],[{},e,1],[0,f,0]]),r("NotificationInfoJsonArgs",[[{},e,1],[{},e,1],["",n,1],["",n,1]]),r("NewMailNotification",[[t.DLReturnType.MessageListData,u(t.DLReturnType.MessageListData),0],["",n,1],[0,f,0],[0,f,0]]),r("BulkActionCountUpdate",[[t.DLReturnType.MessageListData,u(t.DLReturnType.MessageListData),0],["",n,1],[0,f,0],[!1,i,0],["",n,1],[0,f,0]]),r("SuperBar",[[t.DLReturnType.MessageListData,u(t.DLReturnType.MessageListData),0],["",n,1],["",n,1],["",n,1],["",n,1],["",n,1],[0,f,0]]),r("ServerInvalidQueryResult",[[t.DLReturnType.MessageListData,u(t.DLReturnType.MessageListData),0],[t.ServerInvalidQueryType.None,u(t.ServerInvalidQueryType.None),1],[0,f,0]]),r("RollupData",[[null,e,1],["",n,1],[t.ConversationView.Normal,u(t.ConversationView.Normal),0],["",n,1],[0,f,0],["0",n,0],[0,f,0],[0,f,0],[0,f,0],[0,f,0],[0,f,1],[0,f,0],["",n,1]]),r("MessageData",[[null,e,1],[null,e,1],[[],o,1],[[],o,1],[0,f,0],["0",n,0],[0,f,0],[0,f,0],[0,f,0],[0,f,0],[0,f,1],[0,f,0],["",n,1]]),r("ContainerData",[[null,e,1]]),r("ContainerPoolData",[[t.DLReturnType.MessageListData,u(t.DLReturnType.MessageListData),0],[t.ContainerType.Folders,u(t.ContainerType.Folders),0],[{},e,1],[[],o,1]]),r("ItemListData",[[t.DLReturnType.MessageListData,u(t.DLReturnType.MessageListData),0],[null,e,1],[{},e,1],[{},e,1],[[],o,1],[null,e,1],[!1,i,0],[!1,i,0],[0,f,1],["",n,1],[!1,i,0]]),r("InfoPaneHtmlWrapper",[[t.DLReturnType.MessageListData,u(t.DLReturnType.MessageListData),0],["",n,1]]),r("SuccessBooleanWrapper",[[t.DLReturnType.MessageListData,u(t.DLReturnType.MessageListData),0],[!1,i,0]]),r("EmailReturnWrapper",[[t.DLReturnType.MessageListData,u(t.DLReturnType.MessageListData),0],["",n,1]]),r("ClientGuidReturnWrapper",[[t.DLReturnType.MessageListData,u(t.DLReturnType.MessageListData),0],["",n,1]]),r("BiciConfigReturnWrapper",[[t.DLReturnType.MessageListData,u(t.DLReturnType.MessageListData),0],["",n,1]]),r("UserPreferencesReturnWrapper",[[t.DLReturnType.MessageListData,u(t.DLReturnType.MessageListData),0],[null,e,1]]),r("RulesReturnWrapper",[[t.DLReturnType.MessageListData,u(t.DLReturnType.MessageListData),0],[[],o,1]]),r("SaveDraftM4ReturnWrapper",[[t.DLReturnType.MessageListData,u(t.DLReturnType.MessageListData),0],["",n,1],["",n,1],[!1,i,0],["",n,1],["0",n,0]]),r("SaveDraftReturnWrapper",[["",n,1],[t.DLReturnType.MessageListData,u(t.DLReturnType.MessageListData),0],["",n,1],["",n,1],[!1,i,0],["",n,1],["0",n,0]]),r("ChangeFolderReturnWrapper",[[t.DLReturnType.MessageListData,u(t.DLReturnType.MessageListData),0],["",n,1],[0,f,0]]),r("ChangeCategoriesReturnWrapper",[[t.DLReturnType.MessageListData,u(t.DLReturnType.MessageListData),0],[[],o,1]]),r("RestoreHiddenTrashNumRestoredWrapper",[[t.DLReturnType.MessageListData,u(t.DLReturnType.MessageListData),0],[0,f,0]]),r("FoldersHashWrapper",[[t.DLReturnType.MessageListData,u(t.DLReturnType.MessageListData),0],["",n,1]]),r("FppErrorWrapper",[[t.DLReturnType.MessageListData,u(t.DLReturnType.MessageListData),0],[null,e,1]]),r("GetInboxDataSucceeded",[[t.DLReturnType.MessageListData,u(t.DLReturnType.MessageListData),0]]),r("SearchDataWrapper",[[t.DLReturnType.MessageListData,u(t.DLReturnType.MessageListData),0],[null,e,1]]),r("AffectedHeadersWrapper",[[t.DLReturnType.MessageListData,u(t.DLReturnType.MessageListData),0],[null,e,1]]),r("LiveViewsTypeHandlerFpp",[["",n,1],["",n,1],[{},e,1]]),r("ComposeData",[[t.DLReturnType.MessageListData,u(t.DLReturnType.MessageListData),0],[[],o,1],[[],o,1],["",n,1],["",n,1],["",n,1],["",n,1],["",n,1],["",n,1],["",n,1],["",n,1],["",n,1],["",n,1],["",n,1],[0,f,0],[t.MessageSentStateType.NOACTION,u(t.MessageSentStateType.NOACTION),0],["",n,1],["",n,1],["",n,1],[!1,i,0],["",n,1],["",n,1]]),r("MessagePrefetchData",[[t.DLReturnType.MessageListData,u(t.DLReturnType.MessageListData),0],[[],o,1]]),r("microsoft_msn_hotmail_ui_fpp_partnerapiresponse",[["",n,1],[[],o,1],[[],o,1],["",n,1]]),r("BodyProperties",[[0,f,0],[t.BodyHistoryType.Unspecified,u(t.BodyHistoryType.Unspecified),0],[t.BodySafetyType.Unspecified,u(t.BodySafetyType.Unspecified),0],[!1,i,0]]),r("ItemListQuery",[[t.ItemListQueryContainerType.Folder,u(t.ItemListQueryContainerType.Folder),0],["",n,1],["",n,1],[null,e,1],[null,e,1],["",n,1],[!1,i,0],[0,f,0],["",n,1],[t.QueryType.ItemListQuery,u(t.QueryType.ItemListQuery),0]]),r("MessageListKeyQuery",[[t.ItemListQueryContainerType.Folder,u(t.ItemListQueryContainerType.Folder),0],["",n,1],[0,f,1],[0,f,1],[0,f,1],[t.MessageListKeyQueryItemType.Conversation,u(t.MessageListKeyQueryItemType.Conversation),0],[t.MessageListKeyQuerySortOrder.Ascending,u(t.MessageListKeyQuerySortOrder.Ascending),0],[t.SortBy.Sender,u(t.SortBy.Sender),0],[!1,i,0],[null,e,1],[0,f,0],["",n,1],[t.QueryType.ItemListQuery,u(t.QueryType.ItemListQuery),0]]),r("OptionsQuery",[[0,f,0],["",n,1],[t.QueryType.ItemListQuery,u(t.QueryType.ItemListQuery),0]]),r("RulesQuery",[[0,f,0],["",n,1],[t.QueryType.ItemListQuery,u(t.QueryType.ItemListQuery),0]]),r("MessageGroupQuery",[["",n,1],["",n,1],[t.MessageGroupQueryAnchorType.StartTimestamp,u(t.MessageGroupQueryAnchorType.StartTimestamp),0],[0,f,0],[!1,i,0],[t.MessageGroupQueryFetchItem.First,u(t.MessageGroupQueryFetchItem.First),0],["",n,1],[t.ItemListQueryContainerType.Folder,u(t.ItemListQueryContainerType.Folder),0],["",n,1],[0,f,1],[0,f,1],[0,f,1],[t.MessageListKeyQueryItemType.Conversation,u(t.MessageListKeyQueryItemType.Conversation),0],[t.MessageListKeyQuerySortOrder.Ascending,u(t.MessageListKeyQuerySortOrder.Ascending),0],[t.SortBy.Sender,u(t.SortBy.Sender),0],[!1,i,0],[null,e,1],[0,f,0],["",n,1],[t.QueryType.ItemListQuery,u(t.QueryType.ItemListQuery),0]]),r("ContainerQuery",[[t.ContainerType.Folders,u(t.ContainerType.Folders),0],[0,f,0],["",n,1],[t.QueryType.ItemListQuery,u(t.QueryType.ItemListQuery),0]]),r("ServerMessagesQuery",[[t.ServerMessageType.FppErrorUi,u(t.ServerMessageType.FppErrorUi),0],[0,f,0],["",n,1],[t.QueryType.ItemListQuery,u(t.QueryType.ItemListQuery),0]]),r("UndoQuery",[[0,f,0],["",n,1],[t.QueryType.ItemListQuery,u(t.QueryType.ItemListQuery),0]]),r("ServerInvalidationQuery",[[0,f,0],["",n,1],[t.QueryType.ItemListQuery,u(t.QueryType.ItemListQuery),0]]),r("CompatibleQueryMarshallingContainer",[[[],o,1],[[],o,1],[[],o,1],[[],o,1],[[],o,1]]),r("QueryMarshallingContainer",[[[],o,1],[[],o,1],[[],o,1],[[],o,1],[[],o,1],[[],o,1]]),r("MoveMessagesToFolderInfo",[["",n,1],[[],o,1],[[],o,1],[[],o,1],[!1,i,0],[t.ActionOnMove.None,u(t.ActionOnMove.None),0],[t.ActionOnMove.None,u(t.ActionOnMove.None),0]]),r("ViewInfo",[["",n,1],["",n,1],[0,f,1]]),r("MarshalableHeaderAuxData",[[0,f,0],[0,f,0],["0",n,0],["",n,1],[0,f,0],[0,f,0],[0,f,0],[0,f,0],[0,f,1],[[],o,1],[0,f,0],["",n,1]]),r("SocialInboxSetupFpp",[[!1,i,0],[!1,i,0],["",n,1],[0,f,0],[[],o,1]]),r("ParticipantDataForRecipients",[[{},e,1],[{},e,1],[{},e,1],[null,e,1]]),r("UserComposeData",[[[],o,1],[[],o,1],["",n,1]]),r("FromAddress",[["",n,1],["",n,1]]),r("ContactToAdd",[["",n,1],["",n,1],["",n,1]]),r("SandboxRequest",[["",n,1],["",n,1],["",n,1],["",n,1],[t.SandboxAuthenticationOption.None,u(t.SandboxAuthenticationOption.None),0],["",n,1]]),r("SandboxResponse",[["",n,1],[0,f,0],[0,f,0],["",n,1],[t.SandboxAuthenticationOption.None,u(t.SandboxAuthenticationOption.None),0],["",n,1],["",n,1],["",n,1]]),r("HMLiveViewRequestObject",[["",n,1],["",n,1],["",n,1],["",n,1],["",n,1],["",n,1]]),r("HMLiveViewResponseObject",[["",n,1],[t.HMLiveViewResultCode.Success,u(t.HMLiveViewResultCode.Success),0],["",n,1]]),r("MigrateAccountResult",[[t.MigrateAccountStatus.AutoDiscoveryFailure,u(t.MigrateAccountStatus.AutoDiscoveryFailure),0],[null,e,1],[null,e,1],["",n,1],["",n,1]]),r("SendMessageAndGetInboxDataResult",[[t.DLReturnType.MessageListData,u(t.DLReturnType.MessageListData),0],[[],o,1],[null,e,1],[null,e,1]]),r("SocialInboxActivityData",[[[],o,1]]),r("Adapter_Activity",[[!1,i,0],[!1,i,1],["",n,1],["",n,1],["",n,1],["",n,1],["",n,1],["",n,1],["",n,1],["",n,1],["",n,1],["0",n,0],["0",n,0],[null,e,1],[null,e,1],[null,e,1],[null,e,1],[null,e,1],[null,e,1],[null,e,1],[null,e,1],[null,e,1],[null,e,1],[null,e,1],[null,e,1]]),r("Adapter_Reactions",[[null,e,1],[null,e,1],[null,e,1],[null,e,1],[null,e,1],[null,e,1]]),r("Adapter_CommentReaction",[[!1,i,0],[[],o,1],[0,f,0],[0,f,0],["",n,1]]),r("Adapter_Comment",[[!1,i,0],["",n,1],["",n,1],["0",n,0],[null,e,1],[null,e,1]]),r("Adapter_FavoriteReaction",[[!1,i,0],[!1,i,0]]),r("Adapter_LikeReaction",[[!1,i,0],[0,f,0],[!1,i,0],["",n,1],[[],o,1]]),r("Adapter_Like",[[null,e,1]]),r("Adapter_ReplyReaction",[[!1,i,0],[0,f,1],["",n,1],[[],o,1],[0,f,0],["",n,1]]),r("Adapter_Reaction",[]),r("Adapter_Reply",[[null,e,1],[null,e,1],["",n,1],["0",n,0],["",n,1]]),r("Adapter_RetweetReaction",[[!1,i,0],[0,f,0],[!1,i,0],[[],o,1]]),r("Adapter_Retweet",[[null,e,1],["",n,1],["0",n,0],["",n,1]]),r("Adapter_ShareReaction",[[!1,i,0],[0,f,1],["",n,1],[[],o,1],[0,f,0],["",n,1]]),r("Adapter_Share",[[null,e,1],[null,e,1],["",n,1],["0",n,0],["",n,1]]),r("Adapter_Video",[["",n,1],[[],o,1]]),r("Adapter_VideoStream",[["",n,1],[0,f,1],["",n,1],["",n,1],[0,f,1]]),r("Adapter_Album",[["",n,1],[[],o,1],["",n,1]]),r("Adapter_Photo",[["",n,1],["",n,1],["",n,1],[[],o,1],[null,e,1]]),r("Adapter_Link",[["",n,1],["",n,1]]),r("Adapter_LinkedText",[[[],o,1],["",n,1]]),r("Adapter_Entity",[[0,f,0],[null,e,1],[0,f,0],["",n,1],["",n,1],[null,e,1]]),r("Adapter_Contact",[["",n,1],["",n,1],["",n,1],["",n,1],["",n,1],["",n,1],["",n,1],[[],o,1]]),r("Adapter_PhotoStream",[[0,f,1],["",n,1],["",n,1],[0,f,1]]),r("SocialNetworkActivity",[["",n,1],["",n,1],[!1,i,0],[!1,i,0],[null,e,1]]),r("SocialNetworkReactionResponse",[[!1,i,0],[!1,i,0]]),r("SocialInboxData",[[{},e,1],[[],o,1],[{},e,1],[{},e,1]]),r("SocialNetworkUserConnectionStatus",[["",n,1],[0,f,0],["",n,1]]),r("SocialNetworkMemberInfo",[["",n,1],["",n,1]]),r("MiniCalendarUiObject",[["",n,1],["",n,1],["0",n,0],[!1,i,0],["",n,1],["",n,1],["",n,1],[t.MiniCalendarUiType.Month,u(t.MiniCalendarUiType.Month),0]]),r("ViewManagerManifest",[["",n,1],["",n,1],[!1,i,0],[null,e,1],[[],o,1]]),r("SocialInboxMembership",[[{},e,1]]),r("SocialInboxMembershipData",[[{},e,1]]),r("SocialNetworkMember",[["",n,1],["",n,1],["",n,1],["",n,1],["",n,1],[!1,i,0],["",n,1],["",n,1]]),r("FppError",[["",n,1],["",n,1],[null,e,1],["",n,1],["",n,1]]),r("FppReturnPackage",[[t.FppStatus.SUCCESS,u(t.FppStatus.SUCCESS),0],[null,e,1],[[],o,1],[null,e,1],[null,e,1]]),r("FppProxySettings",[[t.FppVersion.BASE,u(t.FppVersion.BASE),0],[t.FppCommandType.FPP,u(t.FppCommandType.FPP),0],["",n,1],["",n,1],["",n,1],["",n,1],[!1,i,0],["",n,1],[0,f,0],[!1,i,0],[t.FppDateType.Local,u(t.FppDateType.Local),0]])}(),function(n){"use strict";HM.registerFppClassDefaultsForExistingClass("FppErrorUi",{type:HM.DLReturnType.FppErrorUi}),HM.registerFppClassDefaultsForExistingClass("FppErrorWrapper",{type:HM.DLReturnType.FppError}),HM.registerFppClassDefaultsForExistingClass("ServerErrorMessage",{type:HM.DLReturnType.ServerErrorMessage}),HM.registerFppClassDefaultsForExistingClass("NotificationInfo",{type:HM.DLReturnType.NotificationInfo}),HM.registerFppClassDefaultsForExistingClass("NewMailNotification",{type:HM.DLReturnType.NewMailNotification}),HM.registerFppClassDefaultsForExistingClass("BulkActionCountUpdate",{type:HM.DLReturnType.BulkActionCountUpdate}),HM.registerFppClassDefaultsForExistingClass("SuperBar",{type:HM.DLReturnType.SuperBar}),HM.registerFppClassDefaultsForExistingClass("BodyProperties",{overrideCodepage:-1,historyType:HM.BodyHistoryType.Unspecified,safetyType:HM.BodySafetyType.Unspecified}),HM.registerFppClassDefaultsForExistingClass("Message",{messageId:new HM.LFADefaultValueFunction(function(){return ol.data.getTemporaryId("mg")}),importance:HM.ImportanceType.NORMAL,safetyLevel:HM.MessageSafetyLevel.Safe,senderDetails:HM.createSenderDetails()}),HM.registerFppClassDefaultsForExistingClass("MessageData",{message:HM.createMessage()}),HM.registerFppClassDefaultsForExistingClass("MarshalableHeaderAuxData",{}),HM.registerFppClassDefaultsForExistingClass("OptionsQuery",{queryId:new HM.LFADefaultValueFunction(ol.data.QueryUtils.getQueryId),type:HM.QueryType.OptionsQuery}),HM.registerFppClassDefaultsForExistingClass("RulesQuery",{queryId:new HM.LFADefaultValueFunction(ol.data.QueryUtils.getQueryId),type:HM.QueryType.RulesQuery}),HM.registerFppClassDefaultsForExistingClass("UndoQuery",{queryId:new HM.LFADefaultValueFunction(ol.data.QueryUtils.getQueryId),type:HM.QueryType.UndoQuery}),HM.registerFppClassDefaultsForExistingClass("ItemListData",{type:HM.DLReturnType.ConversationListData}),HM.registerFppClassDefaultsForExistingClass("BulkActionCountUpdate",{type:HM.DLReturnType.BulkActionCountUpdate}),HM.registerFppClassDefaultsForExistingClass("RollupData",{conversationView:HM.ConversationView.Normal}),HM.registerFppClassDefaultsForExistingClass("Rollup",{itemId:new HM.LFADefaultValueFunction(function(){return ol.data.getTemporaryId("cv")}),extendedType:HM.ExtendedType.e0_NONE,importance:HM.ImportanceType.NORMAL}),HM.registerFppClassDefaultsForExistingClass("ItemListQuery",{queryId:new HM.LFADefaultValueFunction(ol.data.QueryUtils.getQueryId),type:HM.QueryType.ItemListQuery,dataHash:null,containerType:HM.ItemListQueryContainerType.Folder,containerId:null,folderId:null,bodyProperties:HM.createBodyProperties(),senderEmail:null,mad:null}),HM.registerFppClassDefaultsForExistingClass("MessageListKeyQuery",{queryId:new HM.LFADefaultValueFunction(ol.data.QueryUtils.getQueryId),type:HM.QueryType.MessageListKeyQuery,dataHash:null,containerType:HM.ItemListQueryContainerType.Folder,containerId:null,categoryContainerId:null,filterId:null,excludeFilterId:null,itemType:HM.MessageListKeyQueryItemType.Conversation,sortType:HM.SortBy.Date,sortOrder:HM.MessageListKeyQuerySortOrder.Descending,supportsDelayedRemoval:!1,search:null,bodyProperties:HM.createBodyProperties(),senderEmail:null,mad:null}),HM.registerFppClassDefaultsForExistingClass("MessageGroupQuery",{queryId:new HM.LFADefaultValueFunction(ol.data.QueryUtils.getQueryId),type:HM.QueryType.MessageGroupQuery,dataHash:null,containerType:HM.ItemListQueryContainerType.Folder,containerId:null,categoryContainerId:null,folderId:null,fetchItem:HM.MessageGroupQueryFetchItem.None,filterId:null,excludeFilterId:null,itemType:HM.MessageListKeyQueryItemType.Conversation,sortType:HM.SortBy.Date,sortOrder:HM.MessageListKeyQuerySortOrder.Descending,delayedRemoval:!1,search:null,bodyProperties:null,senderEmail:null,mad:null,anchor:null,anchorDate:null,anchorType:HM.MessageGroupQueryAnchorType.FirstPage,size:35,jumpToAnchor:null,supportsDelayedRemoval:!0}),HM.registerFppClassDefaultsForExistingClass("ContainerQuery",{queryId:new HM.LFADefaultValueFunction(ol.data.QueryUtils.getQueryId),type:HM.QueryType.ContainerQuery,containerType:HM.ContainerType.Folders}),HM.registerFppClassDefaultsForExistingClass("ServerMessagesQuery",{queryId:new HM.LFADefaultValueFunction(ol.data.QueryUtils.getQueryId),type:HM.QueryType.ServerMessageQuery,serverMessageType:HM.ServerMessageType.FppErrorUi,dataHash:null}),HM.registerFppClassDefaultsForExistingClass("ServerInvalidationQuery",{queryId:new HM.LFADefaultValueFunction(ol.data.QueryUtils.getQueryId),type:HM.QueryType.ServerInvalidationQuery}),HM.registerFppClassDefaults("CommandResult",{results:[{},"object",!1],errors:[[],"array",!0]}),HM.registerFppClassDefaults("DLError",{type:[HM.ErrorType.Generic,n.type(HM.ErrorType.Generic),!1],code:[0,"number",!1]}),HM.registerFppClassDefaults("MessageGroupQueryInvalidationResult",{query:[null,"object",!0],type:[HM.ResultType.Invalidation,n.type(HM.ResultType.Invalidation),!1],isQueryInvalidationChange:[!0,"boolean",!1],invalidationType:[HM.MessageGroupQueryInvalidationType.InvalidateEverything,n.type(HM.MessageGroupQueryInvalidationType.InvalidateEverything),!1]}),HM.registerFppClassDefaults("ItemListQueryInvalidationResult",{query:[null,"object",!0],type:[HM.ResultType.Invalidation,n.type(HM.ResultType.Invalidation),!1],isQueryInvalidationChange:[!0,"boolean",!1]}),HM.registerFppClassDefaults("ServerInvalidationResult",{query:[null,"object",!0],status:[HM.Status.IncompleteNone,n.type(HM.Status.IncompleteNone),!1],dataHash:[null,"string",!0],type:[HM.ResultType.ServerInvalidation,n.type(HM.ResultType.ServerInvalidation),!1],serverInvalidQueryType:[null,n.type(HM.ServerInvalidQueryType.ConversationNotFound),!0],errorId:[0,"number",!1]}),HM.registerFppClassDefaults("ItemListResult",{query:[HM.createItemListQuery(),"object",!0],type:[HM.ResultType.ItemList,n.type(HM.ResultType.ItemList),!1],status:[HM.Status.IncompleteNone,n.type(HM.Status.IncompleteNone),!1],dataHash:[null,"string",!0],idMapping:[{},"object",!0],rollup:[HM.createRollup(),"object",!0],messages:[{},"object",!0]}),HM.registerFppClassDefaults("MessageGroupResult",{query:[HM.createMessageGroupQuery(),"object",!0],type:[HM.ResultType.ItemListPage,n.type(HM.ResultType.ItemListPage),!1],status:[HM.Status.IncompleteNone,n.type(HM.Status.IncompleteNone),!1],dataHash:[null,"string",!0],itemsTable:[{},"object",!0],itemIds:[[],"array",!0],totalPageCount:[0,"number",!0],timestamp:[null,"string",!0],bof:[!1,"boolean",!1],eof:[!1,"boolean",!1],rollup:[HM.createRollup(),"object",!0],view:[HM.ConversationView.Normal,n.type(HM.ConversationView.Normal),!1],threaded:[!1,"boolean",!1]}),HM.registerFppClassDefaults("ContainerResult",{query:[HM.createContainerQuery(),"object",!0],type:[HM.ResultType.Container,n.type(HM.ResultType.Container),!1],status:[HM.Status.IncompleteNone,n.type(HM.Status.IncompleteNone),!1],dataHash:[null,"string",!0],containerIds:[[],"array",!0],containerTable:[{},"object",!0]}),HM.registerFppClassDefaults("ServerMessageResult",{query:[HM.createServerMessagesQuery(),"object",!0],type:[HM.ResultType.ServerMessage,n.type(HM.ResultType.ServerMessage),!1],status:[HM.Status.IncompleteNone,n.type(HM.Status.IncompleteNone),!1],dataHash:[null,"string",!0],fppErrorUi:[null,"object",!0],serverErrorMessage:[null,"object",!0],notificationInfo:[null,"object",!0],unsatisfiedQueryError:[null,"boolean",!0],newMailNotification:[null,"object",!0],bulkActionCountUpdate:[null,"object",!0],superBar:[null,"object",!0]}),HM.registerFppClassDefaults("OptionsResult",{query:[HM.createOptionsQuery(),"object",!0],type:[HM.ResultType.Options,n.type(HM.ResultType.Options),!1],status:[HM.Status.IncompleteNone,n.type(HM.Status.IncompleteNone),!1],dataHash:[null,"string",!0],preferences:[HM.createPreferencesBag(),"object",!0]}),HM.registerFppClassDefaults("RulesResult",{query:[HM.createRulesQuery(),"object",!0],type:[HM.ResultType.Rules,n.type(HM.ResultType.Rules),!1],status:[HM.Status.IncompleteNone,n.type(HM.Status.IncompleteNone),!1],dataHash:[null,"string",!0],rules:[[],"array",!0]}),HM.registerFppClassDefaults("UndoResult",{query:[null,"object",!0],status:[HM.Status.IncompleteNone,n.type(HM.Status.IncompleteNone),!1],dataHash:[null,"string",!0],type:[HM.ResultType.Undo,n.type(HM.ResultType.Undo),!1],undoData:[null,"object",!0]}),HM.registerFppClassDefaults("UndoStackData",{origCmd:[{},"object",!1],affectedHeaders:[null,"array",!0]}),HM.registerFppClassDefaults("UndoCmdItemArgs",{itemId:[null,"string",!0],viewId:[null,"string",!0],lastUpdatedTimestamp:[null,"string",!0],item:[null,"object",!0],toFolderId:[null,"string",!0],pinOnMove:[HM.ActionOnMove.None,"number",!0],readOnMove:[HM.ActionOnMove.None,"number",!0]}),HM.registerFppClassDefaults("InvalidateConversationPoolChange",{type:[HM.ChangeType.InvalidateConversationPool,n.type(HM.ChangeType.InvalidateConversationPool),!1],invalidateQueries:[!1,"boolean",!1],isDataInvalidationChange:[!0,"boolean",!1]}),HM.registerFppClassDefaults("InvalidateMessageListModelChange",{type:[HM.ChangeType.InvalidateMessageListModel,n.type(HM.ChangeType.InvalidateMessageListModel),!1],isDataInvalidationChange:[!0,"boolean",!1]}),HM.registerFppClassDefaults("InvalidateContainerModelChange",{type:[HM.ChangeType.InvalidateContainerModel,n.type(HM.ChangeType.InvalidateContainerModel),!1],isDataInvalidationChange:[!0,"boolean",!1]}),HM.registerFppClassDefaults("IdChange",{type:[HM.ChangeType.Id,n.type(HM.ChangeType.Id),!1],oldId:[null,"string",!0],newId:[null,"string",!0]}),HM.registerFppClassDefaults("CountChange",{type:[HM.ChangeType.Count,n.type(HM.ChangeType.Count),!1],id:[null,"string",!0]}),HM.registerFppClassDefaults("InvalidateItemListQueryChange",{type:[HM.ChangeType.InvalidateItemListQuery,n.type(HM.ChangeType.InvalidateItemListQuery),!1],itemId:[null,"string",!0],invalidationType:[null,"string",!0],rollupView:[null,"number",!0],messageIds:[null,"object",!0]}),HM.registerFppClassDefaults("InvalidateMessageGroupQueryChange",{type:[HM.ChangeType.InvalidateItemListQuery,n.type(HM.ChangeType.InvalidateItemListQuery),!1],queryKey:[null,"string",!0],invalidationType:[HM.MessageGroupQueryInvalidationType.InvalidateEverything,n.type(HM.MessageGroupQueryInvalidationType.InvalidateEverything),!1]}),HM.registerFppClassDefaults("InvalidateRollupChange",{type:[HM.ChangeType.InvalidateRollup,n.type(HM.ChangeType.InvalidateRollup),!1],itemId:[null,"string",!0],conversationId:[null,"string",!0],view:[null,"number",!0],isDataInvalidationChange:[!0,"boolean",!1]}),HM.registerFppClassDefaults("InvalidateMessageRollupChange",{type:[HM.ChangeType.InvalidateMessageRollup,n.type(HM.ChangeType.InvalidateMessageRollup),!1],itemId:[null,"string",!0],isDataInvalidationChange:[!0,"boolean",!1]}),HM.registerFppClassDefaults("InvalidateMessageChange",{type:[HM.ChangeType.InvalidateMessage,n.type(HM.ChangeType.InvalidateMessage),!1],itemId:[null,"string",!0],isDataInvalidationChange:[!0,"boolean",!1]}),HM.registerFppClassDefaults("InvalidateConversationChange",{type:[HM.ChangeType.InvalidateConversation,n.type(HM.ChangeType.InvalidateConversation),!1],itemId:[null,"string",!0],isDataInvalidationChange:[!0,"boolean",!1]}),HM.registerFppClassDefaults("InvalidateContainerChange",{type:[HM.ChangeType.InvalidateContainer,n.type(HM.ChangeType.InvalidateContainer),!1],folderId:[null,"string",!0],categoryId:[null,"number",!0],isDataInvalidationChange:[!0,"boolean",!1]}),HM.registerFppClassDefaults("DeleteFolderChange",{type:[HM.ChangeType.DeleteFolder,n.type(HM.ChangeType.DeleteFolder),!1],folderId:[null,"string",!0]}),HM.registerFppClassDefaults("DeleteCategoryChange",{type:[HM.ChangeType.DeleteCategory,n.type(HM.ChangeType.DeleteCategory),!1],id:[-1,"number",!1]}),HM.registerFppClassDefaults("InvalidateMessageListFragmentChange",{type:[HM.ChangeType.InvalidateMessageListFragment,n.type(HM.ChangeType.InvalidateMessageListFragment),!1],queryKey:[null,"string",!0],isDataInvalidationChange:[!0,"boolean",!1]}),HM.registerFppClassDefaults("MarkConversationChange",{type:[HM.ChangeType.MarkConversation,n.type(HM.ChangeType.MarkConversation),!1],id:[null,"string",!0],threadedListId:[null,"string",!0],isRead:[null,"boolean",!0],conv:[null,"object",!0]}),HM.registerFppClassDefaults("MarkMessageChange",{type:[HM.ChangeType.MarkMessage,n.type(HM.ChangeType.MarkMessage),!1],id:[null,"string",!0],threadedListId:[null,"string",!0],countChange:[0,"number",!1],folderId:[null,"string",!0],categories:[[],"array",!0],conv:[null,"object",!0]}),HM.registerFppClassDefaults("MoveMessageChange",{type:[HM.ChangeType.MoveMessage,n.type(HM.ChangeType.MoveMessage),!1],id:[null,"string",!0],threadedListId:[null,"string",!0],prevFolderId:[null,"string",!0],newFolderId:[null,"string",!0],isRead:[!1,"boolean",!1],categories:[[],"array",!0],changingView:[!1,"boolean",!1],originalMoveId:[null,"string",!0],conv:[null,"object",!0]}),HM.registerFppClassDefaults("MoveConversationChange",{type:[HM.ChangeType.MoveConversation,n.type(HM.ChangeType.MoveConversation),!1],id:[null,"string",!0],threadedListId:[null,"string",!0],prevFolderId:[null,"string",!0],newFolderId:[null,"string",!0],changingView:[!1,"boolean",!1],originalMoveId:[null,"string",!0],conv:[null,"object",!0]}),HM.registerFppClassDefaults("MoveConversationBetweenViewsChange",{type:[HM.ChangeType.MoveConversationBetweenViews,n.type(HM.ChangeType.MoveConversationBetweenViews),!1],id:[null,"string",!0],sourceViewId:[null,"string",!0],destViewId:[null,"string",!0]}),HM.registerFppClassDefaults("CategorizeConversationChange",{type:[HM.ChangeType.CategorizeConversation,n.type(HM.ChangeType.CategorizeConversation),!1],id:[null,"string",!0],threadedListId:[null,"string",!0],apply:[[],"array",!0],remove:[[],"array",!0],isRead:[!1,"boolean",!1],unreadCount:[null,"number",!0],count:[null,"number",!0],conv:[null,"object",!0]}),HM.registerFppClassDefaults("CategorizeMessageChange",{type:[HM.ChangeType.CategorizeMessage,n.type(HM.ChangeType.CategorizeMessage),!1],id:[null,"string",!0],threadedListId:[null,"string",!0],apply:[[],"array",!0],remove:[[],"array",!0],isRead:[!1,"boolean",!1],conv:[null,"object",!0]}),HM.registerFppClassDefaults("MarkSafeMessageChange",{type:[HM.ChangeType.MarkSafeMessage,n.type(HM.ChangeType.MarkSafeMessage),!1],id:[null,"string",!0],threadedListId:[null,"string",!0],fid:[null,"string",!0],conv:[null,"object",!0]}),HM.registerFppClassDefaults("SaveDraftChange",{type:[HM.ChangeType.SaveDraft,n.type(HM.ChangeType.SaveDraft),!1],id:[null,"string",!0],conv:[null,"object",!0]}),HM.registerFppClassDefaults("ComposeMessageChange",{type:[HM.ChangeType.ComposeMessage,n.type(HM.ChangeType.ComposeMessage),!1],newMessageId:[null,"string",!0],respondingItemId:[null,"string",!0]}),HM.registerFppClassDefaults("ArchiveFolderIdChange",{type:[HM.ChangeType.ArchiveFolderId,n.type(HM.ChangeType.ArchiveFolderId),!1],id:[null,"string",!0]}),HM.registerFppClassDefaultsForExistingClass("MailRule",{Enabled:!0}),HM.registerFppClassDefaultsForExistingClass("SenderAddressCondition",{Type:HM.FilterConditionType.SenderAddress}),HM.registerFppClassDefaultsForExistingClass("FolderCondition",{Type:HM.FilterConditionType.Folder}),HM.registerFppClassDefaultsForExistingClass("HeaderSearchCondition",{Type:HM.FilterConditionType.LegacyHeaderSearchFilter}),HM.registerFppClassDefaultsForExistingClass("MoveAction",{Type:HM.MailActionType.Move,DeferredActionType:HM.DeferredMailActionType.None,DeferredActionAge:0}),HM.registerFppClassDefaultsForExistingClass("MarkAction",{Type:HM.MailActionType.Mark,DeferredActionType:HM.DeferredMailActionType.None,DeferredActionAge:0}),HM.registerFppClassDefaultsForExistingClass("FlagAction",{Type:HM.MailActionType.Flag,DeferredActionType:HM.DeferredMailActionType.None,DeferredActionAge:0}),HM.registerFppClassDefaultsForExistingClass("ForwardAction",{Type:HM.MailActionType.Forward,DeferredActionType:HM.DeferredMailActionType.None,DeferredActionAge:0}),HM.registerFppClassDefaultsForExistingClass("CategorizeAction",{DeferredActionType:HM.DeferredMailActionType.None,DeferredActionAge:0})}(window.originaljQuery||jQuery),function(n){var e=window,i,r,o;if(e.ActionQueueTypes===undefined){var u=e.ActionQueueTypes={},s=e.ActionQueueUtils={},t=u.ActionType=new $Enum("prefetch","async","prefetchView","view","blocking","blockingView");t.isOfType=function(n){return typeof t[n]=="string"},t.isView=function(n){return n===t.view||n===t.prefetchView||n===t.blockingView},t.isBlocking=function(n){return n===t.blocking||n===t.blockingView},t.isPrefetch=function(n){return n===t.prefetch||n===t.prefetchView},i=u.QueueItemState=new $Enum("waiting","executing","done","abandoned"),i.isOfType=function(n){return typeof i[n]=="string"},i.isWaiting=function(n){return n===i.waiting},i.isCancellable=function(n){return n!==i.done},i.isExecuting=function(n){return n===i.executing},r=u.QueueItem=function(u,f,e,o,s){r.NextId===undefined?r.NextId=0:r.NextId++,this.id=r.NextId,this.friendlyName=u,this.action=null,this.clientCallback=o,this.clientErrorCallback=s,this.actionType=f,this.keys=e?n.grep(e,function(n){return!!n}):[],this.beginTime=new Date,this.state=i.waiting,this.timeoutId=null,this.isCancelled=this.success=!1,this.dependentView=null,this.dependentOn=[]},r.isDependentOn=function(i,u){var f,e;if(f=!1,t.isBlocking(i.actionType))f=!0;else for(e=i.keys.length-1;e>=0;e--)if(n.inArray(i.keys[e],u.keys)!=-1){f=!0;break}return f},r.compare=function(n,i){var u;var o=n.actionType,f=i.actionType,e=null;return n.beginTime<=i.beginTime&&(e=n,n=i,i=e),u=!1,t.isView(o)&&f!=t.blocking&&(t.isView(f)?(!t.isPrefetch(o)||t.isPrefetch(f))&&(u=!0):t.isPrefetch(f)?u=!0:r.isDependentOn(n,i)?(i.dependentView=n,n.dependentOn.push(i)):u=!0),e?!u:u},r.areDependentsDone=function(t){var r=!0;return n.each(t.dependentOn,function(n,t){if(!t.isCancelled){var u=t.state;if(i.isExecuting(u)||i.isWaiting(u))return r=!1,!1}}),r},o=u.ActionQueueToken=function(n,t,i){this.item=n,this.friendlyName=n.friendlyName,this._doneCallback=t,this._cancelCallback=i},o.prototype={_getCallback:function(n,t,i){function u(){i(n,t,arguments)}return u},getSuccessCallback:function(){return this._getCallback(this.item,!0,this._doneCallback)},getFailureCallback:function(){return this._getCallback(this.item,!1,this._doneCallback)},cancel:function(){return this._cancelCallback(this)},isCancelled:function(){return this.item.isCancelled}};var f=s.NetChecker=function(){this._image=new Image,this._image.onload=$CD(this,this._onImageLoad),this._image.onerror=$CD(this,this._onImageError),this._trialCount=0,this._fakeErrors=0,this._isConnectivityLost=!1,this._baseImageSrc=App.config.imgSvrUrl+"net_up.gif?r="+Math.random()+"&d="+(new Date).getTime()+"&t="},h=5,c=5e3;f.Events=new $Enum("onConnectivityLost","onConnectivityFound"),f.prototype={_onImageLoad:function(){this._fakeErrors>0?(this._fakeErrors--,this._onImageError()):(this._isConnectivityLost=!1,n(this).trigger(f.Events.onConnectivityFound))},_load:function(){this._image.src=this._baseImageSrc+this._trialCount.toString()},_onImageError:function(){this._trialCount==h&&(this._isConnectivityLost=!0,n(this).trigger(f.Events.onConnectivityLost)),this._trialCount++;var t=this._isConnectivityLost?c:Math.pow(2,this._trialCount)*1e3;setTimeout($CD(this,this._load),t)},startCheck:function(n){this._fakeErrors=n,this._load()}}}}(window.originaljQuery||window.jQuery),function(n){var i=window.ol=window.ol||{},t=ol.deferredUtils=ol.deferredUtils||{};t.whenAll=function(t,i){function s(){u--,u||(i&&h?e.reject(o):e.resolve(o))}var f,r;var u=0,e=n.Deferred(),o=null,h=!1;for(f=[],r=0;r<t.length;r++)t[r]&&typeof t[r].promise=="function"&&(u=f.push(t[r]));for(i&&(u++,i.then(function(n){o=n,s()},function(n){o=n,h=!0,s()})),r=0;r<f.length;r++)f[r].isResolved()?s():f[r].always(s);return u||e.resolve(),e.promise()}}(window.originaljQuery||window.jQuery),function(n){"use strict";var t=window.ol=window.ol||{},i=t.data=t.data||{},r=i.CommandEngine=function(){function rt(){for(var i=t.data.dataCommands,n=0;n<i.length;n++)t.Cmd(i[n]).subscribe(ut)}function ut(i){var u=this,v=[],c=[],k={},a={},e={queries:[]},tt=e,p=!1,b=null,o=i.queries,d=i.progressCallback;ht(u,i).always(function(){var dt,ht,it,rt,ut,wt,et,gt,ii;if(u.stage=HM.CommandStage.ProcessingPreProgress,dt=at(u,o,i),!dt){u.deferred.reject(HM.createCommandResult());return}for(u.settings.doesNotModifyCache&&s&&(e=s,b=w,p=!0),vt(u,o,i,v,c,e),nt(o,u),y(u,o,i,v,c,k,e),ht=!1,it=0;it<v.length;it++)if(v[it].isDataInvalidationChange){ht=!0;break}for(it=0;it<r.length;it++)if(rt=r[it],rt.stage>HM.CommandStage.Queued&&rt.id!==u.id){for(ut=!1,wt=rt.args.queries,et=0;et<wt.length;et++)gt=u.settings.affectedQueryTypes&&u.settings.affectedQueryTypes()||[],n.inArray(wt[et].type,gt)!==-1&&(ut=!0);ht&&(ut=!0),ut&&(rt.resultsObsolete=!0,rt.unregisterInFlightQueries&&rt.unregisterInFlightQueries())}p||c.length||!t.data.fpp.FppEngine.shouldMakeFppCall(e,u)||(s=e,w=u.deferred),ct(e),lt(e.queries,u.deferred.promise());var ni=n.Deferred(),st=n.Deferred(),ti=[ni];n.merge(ti,h),ii=t.deferredUtils.whenAll(ti),h.push(st),d(u,HM.CommandResult(k,c)).always(function(){ni.resolve()}),ii.always(function(){function w(n){var t={},r,f;if(u.deferred.state()!=="rejected"){for(u.resultsObsolete||(yt(u,o,i,n,v,c,t),y(u,o,i,v,c,t,null)),r=0;r<o.length;r++)f=o[r],t[f.key()]||delete t[f.key()];return d(u,HM.CommandResult(t,c))}}function r(n){var w,b,k,s,h,r,d,l,p;if(u.deferred.state()!=="rejected"){if(u.resultsObsolete&&(w=bt(n),b=kt(n),n=w.concat(b)),pt(u,o,i,n,v,c,a),e.queries&&e.queries.length>0&&(f=!0),k=y(u,o,i,v,c,a,null),nt(o,u),s=[],k)for(h=0;h<o.length;h++)r=o[h],a[r.key()]&&(typeof a[r.key()].status=="undefined"||a[r.key()].status===HM.Status.Complete)||r.invalid||(r.invalid=!0,s.push(r),delete a[r.key()]);if(a.unsatisfiedQueries=s,d=t.data.fpp.FppEngine.shouldReturnServerResults(u),l=d?n:null,this.state()==="rejected"||c.length)u.deferred.reject(HM.createCommandResult({results:a,errors:c}),l);else if(!s.length||u.resultsObsolete||t.data.fpp.FppErrorManager.serverResultsContainUpgradeError(n))p=a,u.resultsObsolete&&(p={},g(o,p)),u.deferred.resolve(HM.createCommandResult({results:p,errors:c}),l);else{ft(u,s,l,n,e);return}}}h.splice(n.inArray(st,h),1),u.stage=HM.CommandStage.ProcessingPostProgress,ot(u,e).always(function(){var f,i;l.length>5&&l.shift(),l.push(u),s===tt&&(s=null),f=t.data.fpp.FppEngine.shouldMakeFppCall(e,u),p||c.length||!f?(i=n.when(b),i.always(function(){t.config.serverRenderOnly?r.call(i,null):setTimeout(function(){r.call(i,null)},10)})):(u.fppProgress=w,t.data.fpp.FppEngine.fireFppCommand(u,e).always(r))}),st.resolve()})})}function ft(r,u,f,e,o){var v,h,y,s,c,a,w,p,b;for(et(r),v=HM.createServerMessagesQuery({serverMessageType:HM.ServerMessageType.UnsatisfiedQueryError}),h=HM.createServerMessageResult({query:v,status:HM.Status.Complete,unsatisfiedQueryError:!0}),h.dataHash=i.hashResult(h),y={},y[v.key()]=h,s=[],c=0;c<u.length;c++)switch(u[c].type){case HM.QueryType.ItemListQuery:s.push("ItemListQuery");break;case HM.QueryType.MessageGroupQuery:s.push("MessageGroupQuery");break;case HM.QueryType.ContainerQuery:s.push("ContainerQuery");break;case HM.QueryType.ServerMessageQuery:s.push("ServerMessageQuery");break;case HM.QueryType.OptionsQuery:s.push("OptionsQuery");break;case HM.QueryType.RulesQuery:s.push("RulesQuery")}a="unsatisfiedQueries=",w=Math.random()*1e4<t.config.invalidQueryInstrumentationPercentage,w?(p={logExtraUnsatisfiedQueriesData:!0,serverRequestQueries:o.queries,serverResults:e,unsatisfiedQueries:u,cmd:r},b=t.instrumentationUtils.filterOutCircularReferences(p),a+=escape(JSON.stringify(p)),b()):a+=s.join()+gt(l,r),n.ajax({type:"POST",url:"/mail/InstrumentError.aspx",data:a,success:null}),r.deferred.reject(HM.createCommandResult({results:y,errors:[]}),f)}function et(n){for(var i,t=0;t<r.length;t++)i=r[t],n&&n.id===i.id||i.deferred.reject(HM.createCommandResult(),null)}function ot(i,u){for(var s=[],h,o,f,c,e=0;e<u.queries.length;e++)for(h=u.queries[e].type,o=0;o<r.length;o++)f=r[o],f.stage===HM.CommandStage.ProcessingPostProgress&&i!==f&&n.inArray(f.deferred,s)===-1&&(c=f.settings.affectedQueryTypes&&f.settings.affectedQueryTypes(),n.inArray(h,c)!==-1&&s.push(f.deferred));return t.deferredUtils.whenAll(s)}function a(n){return c||n.settings.processOrder||k}function st(n,t){var f,i,r,e;for(n.isBlocking=n.settings.isBlocking,n.keys=[],f=a(n),i=0;!n.isBlocking&&i<f.length;i++)r=u[f[i]],e=r&&r["getkeysfor_"+n.name],e&&e.call(r,{command:n,parameters:t})}function ht(i,u){var a,k=t.deferredUtils.whenAll([i.deferred,u.commandResolutionDeferred]),v,o,y,d,s,g,h,f,c,w,l,b;if(st(i,u),i.isBlocking){for(p=k,v=[],f=0;f<r.length;f++)v.push(r[f].deferred);a=tt=t.deferredUtils.whenAll(v)}else{o=[p];for(y in e)for(d=e[y].query.getCommandKeys(),s=0;s<i.keys.length;s++)g=i.keys[s],n.inArray(g,d)!==-1&&o.push(e[y].promise);for(h={},f=0;f<r.length;f++)for(c=r[f],w=c.keys||[],l=0;l<w.length;l++)h[w[l]]=t.deferredUtils.whenAll([c.deferred,c.args.commandResolutionDeferred]);for(b in h)n.inArray(b,i.keys)!==-1&&o.push(h[b]);a=t.deferredUtils.whenAll(o)}return r.push(i),k.always(function(){var t=n.inArray(i,r);t!==-1&&r.splice(t,1)}),i.stage=HM.CommandStage.Queued,a}function ct(n){for(var u={},f=[],t,r,i=0;i<n.queries.length;i++)t=n.queries[i],r=t.dedupeKey?t.dedupeKey():t.key(),r in u||(u[r]=!0,f.push(t));n.queries=f}function lt(n,t){for(var r,i=0;i<n.length;i++)r=n[i].key(),e[r]={promise:t,query:n[i]},t.always(function(n){return function(){e[n]&&e[n].promise===t&&delete e[n]}}(r))}function at(n,t,i){for(var e=!0,s=a(n),f,o,r=0;e&&r<s.length;r++)f=u[s[r]],o=f&&f["validate_"+n.name],o&&(e=!!o.call(f,{command:n,parameters:i,queries:t}));return e}function vt(n,t,i,r,e,o){var c,h,s,l;for(n.settings.doesNotModifyCache||(f=!0),c=a(n),h=0;h<c.length;h++)s=u[c[h]],l=s&&(s["begin_"+n.name]||s.beginCommand),l&&l.call(s,{command:n,parameters:i,queries:t,changes:r,errors:e,serverRequest:o})}function yt(n,t,i,r,u,f,e){d(n,t,i,r,u,f,e,"middle")}function pt(n,t,i,r,u,f,e){d(n,t,i,r,u,f,e,"end")}function d(n,t,i,r,e,o,s,h){var v,c;if(r&&r.length>0)for(c=0;c<r.length;c++)r[c]&&(r[c].type!==HM.DLReturnType.BiciConfig&&(f=!0),r[c].type===HM.DLReturnType.FppError&&o.push(r[c].fppError));for(v=a(n),c=0;c<v.length;c++){var l=u[v[c]],y=l&&l[h+"_"+n.name],p=y||l&&l[h+"Command"];y&&(f=!0),p&&p.call(l,{command:n,parameters:i,queries:t,changes:e,errors:o,results:s,serverResults:r})}}function y(t,i,r,e,o,s,h){var w=wt(i),a,k,y,l,p;if(b!=w&&(f=!0,b=w),t.resultsObsolete&&(f=!1),a=!1,h=h||{queries:[]},k=g(i,s),f){for(f=!1,y=c||t.settings.formatOrder||it,l=0;l<y.length;l++)p=u[y[l]],p&&(p.formatResults({parameters:r,queries:k,changes:e,errors:o,results:s,serverRequest:h}),a=!0);v=[],n.merge(v,h.queries)}else n.merge(h.queries,v);return a}function wt(t){for(var r="",i=0;i<t.length;i++)r+=t[i].queryId,r+=t[i].key(),r+=t[i].invalid;return r}function g(n,t){for(var u=[],i,r=0;r<n.length;r++)i=n[r],i.invalid?i.type===HM.QueryType.ItemListQuery?t[i.key()]=HM.createItemListQueryInvalidationResult({query:i}):i.type===HM.QueryType.MessageGroupQuery&&(t[i.key()]=HM.createMessageGroupQueryInvalidationResult({query:i,invalidationType:i.invalidationType})):u.push(i);return u}function nt(n){for(var i,e,o,u,t,s,f=0;f<n.length;f++)if(i=n[f],i.invalid&&!i.invalidationHandled){for(e=0;e<r.length;e++)for(o=r[e],u=o.args.queries,t=0;t<u.length;t++)s=u[t],s.key()===i.key()&&(u[t].invalid=!0,u[t].invalidationHandled=!0);i.invalidationHandled=!0}}function bt(n){var r=[],i,t;if(n)for(i=0;i<n.length;i++)t=n[i],t&&(t.type===HM.DLReturnType.FppErrorUi||t.type===HM.DLReturnType.FppError||t.type===HM.DLReturnType.ServerInvalidQueryMessages||t.type===HM.DLReturnType.ServerErrorMessages)&&r.push(t);return r}function kt(n){var r=[],t,i;if(n)for(t=0;t<n.length;t++)i=n[t],i&&i.type===HM.DLReturnType.AffectedHeaders&&r.push(i);return r}function dt(n){return'"'+n.name+'" ('+n.id+")"}function gt(n,t){for(var u=[],r,i=0;i<n.length;i++)r=dt(n[i]),n[i]===t&&(r+="*"),u.push(r);return u.join(",")}var o=this,u={},c=null,p=null,tt,r=[],e={},s=null,w=null,f=!0,v=[],h=[],b=null,k=["UM","KM","VM","CP","CM","ML","SM","IN","OM","RM"],it=k.slice(0).reverse(),l=[];o.register=function(n,t){u[n]=t},o.unregister=function(n){delete u[n]},o.unregisterAll=function(){for(var n in u)o.unregister(n)},o.overrideOrder=function(n){return n!==undefined&&(c=n),c},rt()}}(window.originaljQuery||window.jQuery),define(["ol"],function(n){"use strict";var i=n.data=n.data||{},t=i.QueryUtils;HM.ItemListQuery.prototype.key=t.defaultKey,HM.ItemListQuery.prototype.dedupeKey=function(){var i=n.data.saveValues(["containerType","dataHash","queryId","invalid","invalidationType","invalidationHandled","prefetch","mad","senderEmail","forceFetch"],this),r=this.containerId,t;return this.containerId=this.containerId.substring(2),t=JSON.stringify(this),n.data.restoreValues(i,this),this.containerId=r,t},HM.ItemListQuery.prototype.getCommandKeys=function(){return[this.containerId]},HM.MessageGroupQuery.prototype.key=t.defaultKey,HM.MessageGroupQuery.prototype.getCommandKeys=function(){var n=[this.containerId||this.categoryContainerId];return this.filterId&&n.push(this.filterId),this.excludeFilterId&&n.push(this.excludeFilterId),n},HM.MessageGroupQuery.prototype.getItemListQuery=function(){return HM.createItemListQuery(this)},HM.MessageGroupQuery.prototype.getMessageListKeyQuery=function(){return HM.createMessageListKeyQuery(this)},HM.MessageGroupQuery.prototype.getMessageListKeyQueryAsString=function(){return HM.createMessageListKeyQuery(this).stringify()},HM.MessageGroupQuery.prototype.getAnchorValue=function(){return this.anchorType===HM.MessageGroupQueryAnchorType.StartTimestamp||this.anchorType===HM.MessageGroupQueryAnchorType.EndTimestamp?this.fppQuery.anchorDate:this.anchorType===HM.MessageGroupQueryAnchorType.StartId||this.anchorType===HM.MessageGroupQueryAnchorType.EndId?this.anchor:this.anchorType===HM.MessageGroupQueryAnchorType.JumpTo?this.jumpToAnchor:null},HM.MessageListKeyQuery.prototype.stringify=t.defaultKey}),define(["ol"],function(n){"use strict";var t=n.data=n.data||{},i=t.QueryUtils;HM.ContainerQuery.prototype.key=i.defaultKey,HM.ContainerQuery.prototype.getCommandKeys=function(){return[]}}),define(["ol"],function(){"use strict";var n=window.ol=window.ol||{},t=n.data=n.data||{},i=t.QueryUtils;HM.RulesQuery.prototype.key=i.defaultKey,HM.RulesQuery.prototype.getCommandKeys=function(){return[]}}),function(){"use strict";var n=window.ol=window.ol||{},t=n.data=n.data||{},i=t.fpp=t.fpp||{};n.InFlightManagerClass=function(){var t=this,n={};t.registerInFlightQueries=function(t,i,r){for(var u=0;u<i.length;u++)n[i[u].key()]=r;t.unregisterInFlightQueries=function(){for(var r=0;r<i.length;r++)delete n[i[r].key()];delete t.unregisterInFlightQueries},r.always(t.unregisterInFlightQueries)},t.getQueriesNotInFlight=function(t){for(var u={queries:[],promises:[]},r,i=0;i<t.length;i++)r=t[i],r.key()in n?u.promises.push(n[r.key()]):u.queries.push(r);return u}},t.InFlightManager=new n.InFlightManagerClass}(window.originaljQuery||window.jQuery),function(n){"use strict";var r=window.ol=window.ol||{},i=r.data=r.data||{},t=i.fpp=i.fpp||{},e=window.ActionQueue,u=i.InFlightManager,f;window.$Network.defaultTimeout=ol.config.fppConfig.DefaultTimeout,f=t.FppEngineClass=function(){var i=this,r={};i.registerFppConfig=function(n,t){r[n]=t},i.unregister=function(n){delete r[n]},i.shouldMakeFppCall=function(n,t){var r=i.getSafeFppCommandConfig(t,n);return typeof r=="undefined"?(window.console&&console.log("Not firing an Fpp call for '"+t.name+"' since no Fpp config has been registerd."),!1):r.shouldMakeFppCall?r.shouldMakeFppCall(n,t):!n.blockFpp||n.queries&&n.queries.length},i.shouldReturnServerResults=function(n){var t=i.getSafeFppCommandConfig(n);return typeof t=="undefined"?(window.console&&console.log("Assuming '"+n.name+"' should not return server results since no Fpp config has been registered."),!1):t&&t.returnServerResults},i.shouldSuppressServerErrors=function(n){var t=i.getSafeFppCommandConfig(n);return typeof t=="undefined"?(window.console&&console.log("Assuming '"+n.name+"' should not suppress errors since no Fpp config has been registered."),!1):t&&typeof t.suppressServerErrors=="function"?t.suppressServerErrors(n):t.suppressServerErrors},i.fireFppCommand=function(r,f){var s=n.Deferred(),c=i.getSafeFppCommandConfig(r,f),e=n.Deferred(),h=[],o;return r.settings.doesNotModifyCache&&(o=u.getQueriesNotInFlight(f.queries),h=o.promises,f.queries=o.queries),s=ol.deferredUtils.whenAll(h,e),f.queries.length>0&&u.registerInFlightQueries(r,f.queries,e),i.shouldMakeFppCall(f,r)?t.FppCommandExecutor.executeCommand(c,r,f.queries,e):e.resolve(),s.promise()},i.onFppError=function(n,t){var i=[];t.fppErrorUi&&i.push(t.fppErrorUi),t.fppError&&i.push(t.fppError),t.deferred.reject(i)},i.getFppConfigs=function(){return r},i.getSafeFppCommandConfig=function(n,t){return t&&t.blockFpp?r.get:r[n.name]||r.get}},t.FppEngine=new t.FppEngineClass}(window.originaljQuery||window.jQuery),function(n){var t=n.views.settings;t.tryCatch=!ol.config.serverRenderOnly&&ol.config.appSettings.isDebugBuild,t.debugMode=t.tryCatch;var i=function(n){if(n.paths){n.fn.paths=n.paths;for(var t=0;t<n.paths.length;t++)typeof n.paths[t]=="object"&&n.paths[t]._jsvOb&&(n.paths[t]._jsvOb=i(n.paths[t]._jsvOb))}return n.fn._ctxs=n._ctxs,n.fn},r=function(t,u){var f,e;for(t.render=n.fn.render,t.markup="",t.converters=u,t.fn=i(t.fn),f=0;f<t.bnds.length;f++)t.bnds[f]=i(t.bnds[f]);for(e=0;e<t.tmpls.length;e++)r(t.tmpls[e],u)},u=function(n){return n===n+""?n:n.markup},f=function(n,t){var f=u(t),i=ol.templateMap[f];return i&&!i.render&&r(i,t.converters),i};n.views.sub.onBeforeStoreItem=function(t,i,r){if(t===n.views.templates){var e=u(r);if(e in ol.templateMap&&(ol.config.serverRenderOnly||!n(e).length))return f}},n.views.converters.html=function(n){return n!=null?String(n).encodeHtml():""},n.views.converters.attr=function(n){return n!=null?String(n).encodeHtmlAttribute():""},n.views.converters.url=function(n){return n!=null?String(n).encodeUrl():""}}(window.originaljQuery||window.jQuery),function(n,t){"use strict";var i=n.data=n.data||{},r=i.modelUtils=i.modelUtils||{};r.handleEndRefresh=function(n,i){var r,f,u,e;if(r=n.serverResults,f=!1,r)for(u=0;u<r.length;u++)if(e=r[u],e&&e.type===HM.DLReturnType.GetInboxDataSucceeded){f=!0;break}f&&t.merge(n.changes,i._invalidateEverything()),i.endCommand(n)}}(window.ol,window.originaljQuery||window.jQuery),function(n,t){"use strict";var i=n.data=n.data||{},u,r;i.isDebug=!1,u=i.ConversationPool=function(){this._conversations={},this._messageMap={},this._unclaimedSingletons={}},u.viewFromContainerId=function(t){var r;switch(t){case n.config.sysFldrs.trashFid:r=HM.ConversationView.Deleted;break;case n.config.sysFldrs.permDelFid:r=HM.ConversationView.PermanentDeleted;break;case n.config.sysFldrs.junkFid:r=HM.ConversationView.Junk;break;default:r=HM.ConversationView.Normal}return r},r=u.prototype,r._getConversationByMid=function(n){var t=null,r=this._messageMap[n];return r&&(t=this._getConversationByCid(r)),t},r._getConversationByCid=function(n){return this._conversations[n]||null},r._getMessageByMid=function(n){var t=this._getConversationByMid(n);return t&&t.messages[n]||null},r._getConversationFromId=function(n){return i.isMessageId(n)||i.isMessageAsConversationId(n)?(i.isMessageAsConversationId(n)&&(n=i.getMidFromMessageAsConversation(n)),this._getConversationByMid(n)):this._getConversationByCid(n)},r.areAllMessageHeadersLoadedForItemInView=function(n,t){var i=this._getConversationFromId(n),r=i&&i.getRollupFromViewId(t);return i&&r&&i._haveMessages(r)},r._invalidateEverything=function(n){return this._messageMap={},this._conversations={},this._unclaimedSingletons={},[HM.createInvalidateConversationPoolChange({invalidateQueries:n})]},r._invalidateConversationAndQueries=function(n){var r=[],i=this._getConversationByCid(n),u,f,e;if(i){for(u in i.messages)t.merge(r,i.invalidateMessageAndQueries(u));for(f in i.rollups)e=window.parseInt(f),t.merge(r,i.invalidateRollupAndQueries(e));r.push(HM.createInvalidateConversationChange({itemId:n})),delete this._conversations[n]}return r},r._invalidateItem=function(n){var t=this._getConversationFromId(n);return t?i.isMessageId(n)||i.isMessageAsConversationId(n)?t.invalidateMessage(i.getMid(n)):this._invalidateConversationAndQueries(n):[]},r._addDuplicateIds=function(n){var t,r,o,u;var s=n.itemIds,a=n.viewIds,f=[],e=[];for(t=0;t<s.length;t++)if(r=s[t],o=a[t],i.isMessageId(r)||i.isMessageAsConversationId(r)){var h=i.getMid(r),c=this._getMessageByMid(h),l=c&&c.allHeaders||[{id:h}];for(u=0;u<l.length;u++)f.push(l[u].id),e.push(o)}else f.push(r),e.push(o);n.itemIdsWithDuplicates=f,n.viewIdsWithDuplicates=e},r._getAuxData=function(n,t){for(var r=[],i=0;i<n.length;i++){var f=n[i],e=this._getConversationFromId(f),o=u.viewFromContainerId(t[i]);r.push(e.getAuxData(f,o))}return r},r._getViewInfos=function(n,t){var u,f,e,r,s,l;if(u=[],n)for(f=0;f<n.length;f++)if(e=n[f],i.isConversationId(e))r=this._getConversationByCid(e),s=r.getViewInfo(t[f]),u.push(s);else{var h=i.getMid(e),c=this._getMessageByMid(h),o=i.makeMessageAsConversation(h);r=this._getConversationFromId(o),l=r&&r.messageRollups[o]&&r.messageRollups[o].rollup,c?u.push(HM.createViewInfo({folderId:c.message.folderId,quickViewId:null})):u.push(HM.createViewInfo({folderId:l.folderId,quickViewId:null}))}return u},r._invalidateConversationQuery=function(n,t){var i,r,f;HM.assertItemListQuery(n,{containerType:HM.ItemListQueryContainerType.Conversation}),i=t&&this._conversations[t.itemId],n&&i&&(r=u.viewFromContainerId(n.folderId),f=i.getView(r),t.invalidationType==="rollup"&&t.rollupView===r),n.invalid=!0},r._invalidateQueries=function(n,t){for(var e,h,f,s,r,c,l,o=0;o<t.length;o++)if(e=t[o],h=t[o].type,h===HM.QueryType.ItemListQuery&&(e.containerType===HM.ItemListQueryContainerType.Conversation||e.containerType===HM.ItemListQueryContainerType.Message))for(f=t[o].containerId,s=0;s<n.length;s++)if(r=n[s],r.type===HM.ChangeType.InvalidateItemListQuery)if(i.isMessageAsConversationId(f))if(c=i.getMidFromMessageAsConversation(f),f===r.itemId||r.messageIds&&c in r.messageIds){this._invalidateConversationQuery(e,r);break}else i.getMid(f)===r.itemId&&this._invalidateConversationQuery(e,r);else if(i.isConversationId(f)){if(r.itemId===f){this._invalidateConversationQuery(e,r);break}}else if(i.isMessageId(f))if(r.itemId===f&&r.invalidationType==="message"){e.invalid=!0;break}else if(r.invalidationType==="rollup"&&r.messageIds&&f in r.messageIds&&(l=u.viewFromContainerId(e.filterId),l===r.rollupView)){e.invalid=!0;break}},r._notInCacheResult=function(n){return HM.createItemListResult({query:n,type:HM.ResultType.ItemList,status:HM.Status.IncompleteNone})},r._conversationQuery=function(n,r){var e,o,s,h,f;return o=r||n.containerId,s=this._conversations[o],s?(h=u.viewFromContainerId(n.folderId),f=s.getView(h,o),e=f.status===HM.Status.Complete?HM.createItemListResult(t.extend(f.conversation,{query:n,type:HM.ResultType.ItemList,status:f.status})):HM.createItemListResult({query:n,type:HM.ResultType.ItemList,status:f.status})):e=this._notInCacheResult(n),e},r._messageQuery=function(n,r){var e,o,s,h,f;return o=i.getMappedIdIfNecessary(n.containerId,r),s=this._getConversationByMid(o),s?(h=null,n.folderId&&(h=u.viewFromContainerId(n.folderId)),f=s.getMessageBody(o,n.bodyProperties,h),e=f.status===HM.Status.Complete?HM.createItemListResult(t.extend(f.conversation,{query:n,type:HM.ResultType.ItemList,status:f.status})):HM.createItemListResult({query:n,type:HM.ResultType.ItemList,status:f.status})):e=this._notInCacheResult(n),e},r._fixupQuery=function(n){var c=this,r=n.containerId,e=c._getConversationFromId(r),f,t;if((i.isMessageAsConversationId(r)||i.isMessageId(r))&&e){f=r,i.isMessageId(f)&&(f=i.makeMessageAsConversation(f));var l=i.normalizeId(r),o=null,s=e.messageRollups[f],h=e.messages[l];(s||h)&&(n.mad=e.getAuxData(r,u.viewFromContainerId(n.folderId)),t=s&&s.rollup.sendersDetails[0],t&&(o=t.fromAddress),o||(t=h&&h.message.senderDetails,t&&(o=t.fromAddress)),n.senderEmail=o)}},r._getQueryResponse=function(n,t,r){for(var u,e,f,h,c,s={},o=0;o<n.length;o++)u=n[o],u.type===HM.QueryType.ItemListQuery&&(u.containerType===HM.ItemListQueryContainerType.Conversation||u.containerType===HM.ItemListQueryContainerType.Message)&&(e=u.containerId,f=null,i.isMessageAsConversationId(e)?(e=i.getMappedIdIfNecessary(e,r),e in this._conversations?f=this._conversationQuery(u,e):(h=i.getMappedIdIfNecessary(i.getMidFromMessageAsConversation(e),r),c=this._messageMap[h],f=this._conversationQuery(u,c))):i.isConversationId(e)?f=this._conversationQuery(u):i.isMessageId(e)&&(f=this._messageQuery(u,r)),f&&(r&&(f.idMapping=r),(f.status!==HM.Status.Complete||u.forceFetch)&&(t?(t.queries=t.queries||[],this._fixupQuery(u),t.queries.push(u)):f=null),f&&(f.dataHash=i.hashResult(f))),s[u.key()]=f);return s},r._applyServerResults=function(n,t){n&&(n.type===HM.DLReturnType.ConversationListData?this.addItem(n,t):n.type===HM.DLReturnType.MessageListData?this.addMessageList(n,t):n.type===HM.DLReturnType.ComposeData&&this.addComposeData(n,t))},r.endCommand=function(n){var r,u,t,i;if(r=n&&n.serverResults,r){for(u=[],t=0;t<r.length;t++)i=r[t],i&&i.type===HM.DLReturnType.ConversationListData?u.push(i):i&&this._applyServerResults(i,n.changes);for(t=0;t<u.length;t++)this._applyServerResults(u[t],n.changes)}},r.formatResults=function(n){if(n){var t=this._getQueryResponse(n.queries,n.serverRequest,n.results.idMapping);i.uniqueExtend(n.results,t),this._fillInMessageListResult(n.results)}},r._fillInMessageListResult=function(n){var s,r,h,o,f,u,e,c;if(n)for(s in n)if(r=n[s],r&&r.type===HM.ResultType.ItemListPage&&r.itemIds){for(h=r.itemsTable,o=0;o<r.itemIds.length;o++)if(f=r.itemIds[o],u=null,e=null,r.threaded?(u=this._getConversationFromId(f),u&&r.view in u.rollups&&(e=u.rollups[r.view])):(c=i.getMidFromMessageAsConversation(f),u=this._getConversationByMid(c),e=u.messageRollups[f]),u&&e)h[f]=e.rollup;else throw new Error("rollupData unexpectedly null in _fillInMessageListResult");r.dataHash=i.hashResult(r),r.idMapping=n.idMapping}},r._createTemporaryMessage=function(n,t){var r=HM.createMessage({messageId:n,conversationId:t});return HM.createMessageData({message:r})},r.addItem=function(n,t){if(n)n.rollupData?this.addRollupFromReadingPane(n,t):n.itemMap&&this.updateItems(n);else throw"Null itemListData passed to CP.addItem";},r.updateItems=function(n){var t,i,r;if(HM.assertItemListData(n),t=n&&n.itemMap,t)for(i in t)r=this._getConversationForMessage(t[i]),this._messageMap[i]=r.id,r.updateMessage(i,t[i])},r._getConversationForMessage=function(n){return HM.assertMessageData(n),this._findOrCreateConversation(i.makeMessageAsConversation(n.message.messageId),n.message.conversationId)},r._findOrCreateConversation=function(n,t){var r,u,s,h,c,f,e,o;if(i.isConversationId(n)?r=n:(r=i.isNullId(t)?this._messageMap[i.getMid(n)]:t,r in this._conversations||r in this._unclaimedSingletons||(r=n)),u=this._unclaimedSingletons[r],u&&n!==u.id){s=i.getMidFromMessageAsConversation(u.id),this._messageMap[s]=r;for(h in u.rollups)if(f=u.rollups[h].rollup,f.messageIds)for(e=0;e<f.messageIds.length;e++)this._messageMap[f.messageIds[e]]=r;for(c in u.messageRollups)if(f=u.messageRollups[c].rollup,f.messageIds)for(e=0;e<f.messageIds.length;e++)this._messageMap[f.messageIds[e]]=r;this._conversations[r]=u,delete this._conversations[u.id],u.id=r,delete this._unclaimedSingletons[r]}else u&&n===u.id&&(r=n);if(!r)throw new Error("CP._getConvForNewRollup: CID is null!");return o=this._conversations[r],o=o||new i.Conversation(r),this._conversations[r]=o,i.isMessageAsConversationId(r)&&t&&(this._unclaimedSingletons[t]=o),o},r._getConvForNewRollup=function(n){HM.assertRollupData(n);var t=n&&n.rollup,r=t&&t.itemId,u=t&&t.conversationId;return this._findOrCreateConversation(r,u)},r.addRollupFromReadingPane=function(n,t){var u,o,f,e;var r=n&&n.rollupData,s=r&&r.rollup,i=this._getConvForNewRollup(r);i.addRollup(r,n.itemMap,!0,t);for(u in i.messages)for((u in this._messageMap),o=i.messages[u].allHeaders,f=0;f<o.length;f++)e=o[f].id,e in this._messageMap,this._messageMap[e]=i.id},r.insertMessage=function(t,r,u,f){var h,s,e,o;HM.assertMessageData(u),h=0,i.isMessageId(f)?(h=t.getMessageIndex(HM.ConversationView.Normal,f),s=t.rollups[r]):(i.isConversationId(f)||i.isMessageAsConversationId(f))&&(s=t.rollups[r]),e=u&&u.message.messageId,s&&(o=s.rollup,!o.messageIds&&n.data.isTemporaryId(e)&&(o.messageIds=[]),o.messageIds.splice(h,0,e),o.count++),t.messages[e]=u,this._messageMap[e]=t.id},r.addMessageList=function(n,t){for(var o,r,u,f,e=0;e<n.itemList.length;e++)o=n.itemList[e],r=n.itemMap[o],r.lastUpdatedTimestamp=n.lastUpdatedTimestamp,u=this._getConvForNewRollup(r),n.threaded?(u.addRollup(r,null,!1,t),i.isMessageAsConversationId(o)&&(u.addMessageRollup(n.duplicateItemMap[o],null,!1,t),f=i.getMidFromMessageAsConversation(r.rollup.itemId),this._messageMap[f]=u.id)):(u.addMessageRollup(r,null,!1,t),f=i.getMidFromMessageAsConversation(r.rollup.itemId),this._messageMap[f]=u.id)},r.addComposeData=function(n,t){for(var u,f,e,o,s,i=null,r=0;r<t.length;r++)if(u=t[r],u.type===HM.ChangeType.ComposeMessage){i=u;break}if(!i)throw"attempt to add compose data without having the composeMessage change";f=i.newMessageId,e=this._messageMap[f],o=this._conversations[e],s=o.messages[f].message,s.composeData=n},r._updateIdForSaveDraft=function(t,r,u,f,e){var c,a,d,b,k,w,v,g,h,s;var y=i.makeMessageAsConversation(t),p=i.makeMessageAsConversation(r),l=this._messageMap[t],o;if(l)o=this._conversations[l],l===y&&(delete this._conversations[l],l=p,o.id=l,this._conversations[l]=o),this._messageMap[r]=l,delete this._messageMap[t];else throw"We should have found the conversation";if(c=o.messages[t],c){for(c.dateReceived=e,a=c&&c.message,a.id=r,a.dateReceivedLocal=u,a.dateReceivedLocalFull=f,a.folderId=n.config.sysFldrs.draftsFid,a.conversationId===y&&(a.conversationId=p),s=0;s<c.allHeaders.length;s++)c.allHeaders[s].id===t&&(c.allHeaders[s].id=r);o.messages[r]=c,delete o.messages[t],a.messageId=r}for(d in o.rollups)if(b=o.rollups[d],b){if(b.dateReceived=e,k=b.rollup,h=k.messageIds,h)for(w=0;w<h.length;w++)if(h[w]===t){h[w]=r;break}k.itemId===y&&(k.itemId=p)}v=o.messageRollups[y],v&&(o.messageRollups[p]=v,v.rollup.itemId=p,v.rollup.dateReceivedLocal=u,v.rollup.dateReceivedLocalFull=f,delete o.messageRollups[y]);for(g in o.messageRollups)if(v=o.messageRollups[g],h=v.rollup.messageIds,h)for(s=0;s<h.length;s++)h[s]===t&&(h[s]=r);return[HM.createIdChange({oldId:t,newId:r}),HM.createSaveDraftChange({id:r,conv:o})]}}(window.ol,window.originaljQuery||window.jQuery),function(n,t){"use strict";function o(n,i){var r=HM.deepCopy(n.parameters);t.extend(n.parameters,s,r,i)}function f(n,i,r,f){var s,l,a,v;var c=n.parameters.items,e=[],h=[];for(s=0;s<c.length;s++)e.push(c[s].itemId),h.push(c[s].viewId);l=i._getAuxData(e,h),a=i._getViewInfos(e,h),f!==u.noneFid&&t.merge(n.changes,i._moveItems(e,!0,h,f,n.queries)),v={jmrType:r,messagesParam:e,auxData:l,viewInfos:a},r===HM.JmrType.Unsubscribe&&t.merge(n.changes,i._invalidateEverything()),o(n,v)}var r=n.data=n.data||{},e=r.ConversationPool,i,u,s;i=e.prototype,u=n.config.sysFldrs,i.register=function(n){n.register("CP",this)},i.begin_refresh=i.begin_autorefresh=i.begin_undosendermovetoblocklist=function(t){var r=t.command,i=t.queries;n.data.QueryUtils.forceFetchAllQueries(i)},i.begin_batchmarkitems=i.begin_batchflagitems=i.begin_setconversationmode=i.begin_restorehiddentrash=function(n){t.merge(n.changes,this._invalidateEverything())},i.begin_instrumentthis=function(n){var t=n.parameters.checkConvCache;t&&(n.parameters.inCache=!!_this._getConversationFromId(t))},i._performActionOnItems=function(n,i){for(var f,e,u=[],r=0;r<n.length;r++)f=n[r],e=this._getConversationFromId(f),t.merge(u,i(e,f,r));return u},i._getIndicatedIds=function(n){var t,e,o,r;var u=[],f=[],i=n.parameters.items;for(t=0;t<i.length;t++)e=i[t].itemId,o=i[t].viewId,u.push(e),f.push(o);return r={itemIds:u,viewIds:f},this._addDuplicateIds(r),r},i._setCommonFppParameters=function(n,t,i,r){var e=this,u=n.parameters,o=!!n.parameters.includeDuplicates,f=o?r.itemIdsWithDuplicates:r.itemIds,s=o?r.viewIdsWithDuplicates:r.viewIds;u[t]=f,u[i]=e._getAuxData(f,s),u.viewInfos=e._getViewInfos(f,s)},i._setCommonFppParametersForUndo=function(n,i,r){var u;var e=n.parameters,f=e.items,o=new Array(f.length),s=new Array(f.length),h=new Array(f.length);for(u=0;u<f.length;u++)HM.assertUndoCmdItemArgs(n.parameters.items[u]),o[u]=f[u].itemId,s[u]=HM.createMarshalableHeaderAuxData(t.extend({},f[u].item,f[u].item.rollup)),h[u]=HM.createViewInfo({timestamp:f[u].lastUpdatedTimestamp,folderId:f[u].viewId,quickViewId:null});e[i]=o,e[r]=s,e.viewInfos=h},i._getMoveInfoKey=function(n){return n.pinOnMove+"-"+n.readOnMove+"-"+n.toFolderId},i._getMoveInfosForUndoMove=function(n){for(var f=[],e={},r,u,t,i=0;i<n.items.length;i++)r=n.items[i],u=this._getMoveInfoKey(r),t=e[u],t||(t=HM.createMoveMessagesToFolderInfo({toFolderId:r.toFolderId,blockIfDelete:n.blockIfDelete,pinOnMove:r.pinOnMove,readOnMove:r.readOnMove}),e[u]=t,f.push(t)),t.messageListParam.push(n.messageListParam[i]),t.messageAuxData.push(n.messageAuxData[i]),t.viewInfos.push(n.viewInfos[i]);return f},i._findSearch=function(n){for(var r=null,i,t=0;t<n.length;t++)if(i=n[t],i.type===HM.QueryType.MessageGroupQuery&&i.search){r=i.search;break}return r},i._getActionsForCategorize=function(n,t){var i=[];return n&&n.length&&i.push(HM.createCategorizeAction({Type:HM.MailActionType.AssignCategory,CategoryIDs:n})),t&&t.length&&i.push(HM.createCategorizeAction({Type:HM.MailActionType.RemoveCategory,CategoryIDs:t})),i},i.begin_getandmarkasread=function(n){var r=this,i=n.parameters;!i.allowUnknownItems||r.validate_markitems(n)?(i.isImplicit=!0,r.begin_markitems(n)):(i.messagesParam=i.auxData=i.viewInfos=[],i.readState=!0,t.merge(n.changes,r._invalidateEverything()))},i.begin_bulkactions=i.begin_emptyfolder=i.begin_deletefolder=function(i){t.merge(i.changes,this._invalidateEverything(!0)),n.data.QueryUtils.invalidateAllItemListQueries(i.queries)},i.begin_batchmoveitems=function(i){var f=this,u=i.parameters;u.toFid=u.destId,u.markMessagesAsRead=u.markRead,u.unpinOnMove=u.unFlag,t.merge(i.changes,this._invalidateEverything(!0)),n.data.QueryUtils.invalidateAllItemListQueries(i.queries)},i.begin_undomoveitems=function(n){var r=this;var i=n.parameters,u=i.items,f=!!u&&u.length>0,e=!i.isBulk;r._setCommonFppParametersForUndo(n,"messageListParam","messageAuxData"),i.moveInfos=r._getMoveInfosForUndoMove(i),i.moveInfos.length>0?t.merge(n.changes,r._invalidateEverything()):n.serverRequest.blockFpp=!0},i.begin_moveitems=function(i){var o,f,s,h,p,w,y;o=this,f=i.parameters;var l=o._getIndicatedIds(i),a=l.itemIds,v=l.viewIds,c=f.destId;o._setCommonFppParameters(i,"msgs","mads",l),f.toFid=c,f.markMessagesAsRead=f.markRead,f.blockIfDelete=f.blockIfDelete,s=[],h=i.parameters.items,n.GetAppConfig("deleteMessagePerformanceEnabled")&&h.length===1&&!o.areAllMessageHeadersLoadedForItemInView(h[0].itemId,h[0].viewId)&&(p=e.viewFromContainerId(h[0].viewId),w=e.viewFromContainerId(c),p!==w),f.unFlag?(y=this._performActionOnItems(a,function(n,t,i){return e.viewFromContainerId(v[i])===HM.ConversationView.Normal?n.flagItem(t,!!f.includeDuplicates,!1,HM.ConversationView.Normal):[]}),f.unpinOnMove=y.length>0,t.merge(s,y)):f.unpinOnMove=!1,f.markRead&&t.merge(s,o._performActionOnItems(a,function(n,t,i){return n.markItem(t,!!f.includeDuplicates,!0,v[i])})),t.merge(s,o._moveItems(a,!!f.includeDuplicates,v,c,i.queries)),c===u.permDelFid&&(i.parameters.toFid=u.trashFid),s.length?t.merge(i.changes,s):i.serverRequest.blockFpp=!0},i._moveItems=function(n,i,r,f,e){for(var h=[],v=this,c={},l,o,a,s=0;s<n.length;s++){var y=n[s],o=this._getConversationFromId(y),p=c[o.id]=c[o.id]||{itemIds:[],viewIds:[]};p.itemIds.push(y),p.viewIds.push(r[s])}for(l in c)o=this._getConversationFromId(l),a=c[l],t.merge(h,o.moveItems(a.itemIds,i,a.viewIds,f)),f===u.permDelFid&&t.isEmptyObject(o.rollups)&&t.isEmptyObject(o.messages)&&t.isEmptyObject(o.messageRollups)&&t.merge(h,v._invalidateItem(o.id));return v._invalidateQueries(h,e),h},i._isSvmAutoDeleteUrl=function(n){return n&&(n.match(/mail\/SvmFeedback.aspx/i)&&n.match(/autodelete=1/i)||n.match(/cgi-bin\/feedback/i)&&n.match(/MsgClass=/i))},i.begin_svmfeedback=function(n){var i=n.parameters,f=i.svmUrl,e=i.folderId,o=i.svmMsgId;this._isSvmAutoDeleteUrl(f)&&t.merge(n.changes,this._moveItems([o],!1,[e],u.permDelFid,n.queries))},i.begin_undomarkitems=function(n){t.merge(n.changes,this._invalidateEverything());var i=n.parameters,r=i.items,u=!!r&&r.length>0;if(!u)throw new Error("CP.begin_undomarkitems should be working with at least one item.");this._setCommonFppParametersForUndo(n,"messagesParam","auxData"),i.readState=i.asRead},i.begin_markitems=function(n){var i;var f=this,r=f._getIndicatedIds(n),h=r.itemIds,c=r.viewIds,u=n.parameters,e=u.asRead,o="messagesParam",s="auxData";f._setCommonFppParameters(n,o,s,r),u.readState=e,u.isImplicit&&(u.getAffectedHeaders=!1),i=[],t.merge(i,f._performActionOnItems(h,function(n,t,i){return n.markItem(t,!!u.includeDuplicates,e,c[i])})),i.length&&(r=f.filterItems(i,n,o,s,r),t.merge(n.changes,i)),i.length&&n.parameters.items.length||(n.serverRequest.blockFpp=!0)},i.begin_undoflagitems=function(n){t.merge(n.changes,this._invalidateEverything());var i=n.parameters,r=i.items,u=!!r&&r.length>0;if(!u)throw new Error("CP.begin_undoflagitems should be working with at least one item.");this._setCommonFppParametersForUndo(n,"messages","auxData"),i.flagState=i.asFlagged},i.begin_flagitems=function(n){var i;var u=this,r=u._getIndicatedIds(n),h=r.itemIds,c=r.viewIds,f=n.parameters,e=f.asFlagged,o="messages",s="auxData";u._setCommonFppParameters(n,o,s,r),f.flagState=e,i=[],t.merge(i,this._performActionOnItems(h,function(n,t){return n.flagItem(t,!!f.includeDuplicates,e,HM.ConversationView.Normal)})),i.length&&(r=u.filterItems(i,n,o,s,r),t.merge(n.changes,i)),i.length&&n.parameters.items.length||(n.serverRequest.blockFpp=!0)},i.begin_undocategorizeitems=function(n){t.merge(n.changes,this._invalidateEverything());var i=n.parameters,r=i.items,u=!!r&&r.length>0,f=!!i.apply&&i.apply.length>0,e=!!i.remove&&i.remove.length>0;if(!u)throw new Error("CP.begin_undocategorizeitems should be working with at least one item.");if(!f&&!e)throw new Error("Both CP.begin_undocategorizeitems parameters.apply and parameters.apply can't be invalid.");this._setCommonFppParametersForUndo(n,"messageListParam","messageAuxData"),i.actions=this._getActionsForCategorize(i.apply,i.remove),i.suppressListTransition=!0,i.restrictActionToView=!0},i.begin_categorizeitems=function(n){var r;var f=this,u=f._getIndicatedIds(n),c=u.itemIds,l=u.viewIds,i=n.parameters,e=i.apply,o=i.remove,s="messageListParam",h="messageAuxData";i.actions=f._getActionsForCategorize(e,o),this._setCommonFppParameters(n,s,h,u),i.restrictActionToView=!0,i.suppressListTransition=!0,r=[],t.merge(r,this._performActionOnItems(c,function(n,t,r){return n.categorizeItem(t,!!i.includeDuplicates,e,o,l[r])})),r.length&&(u=f.filterItems(r,n,s,h,u),t.merge(n.changes,r)),r.length&&n.parameters.items.length||(n.serverRequest.blockFpp=!0)},i.filterItems=function(n,t,i,r,u){var f=this,e=f.filterItemIds(n,t.parameters.items);return e&&(u=f._getIndicatedIds(t),f._setCommonFppParameters(t,i,r,u)),u},i.filterItemIds=function(n,t){var s=0,f,u,e,h,i,o;if(t&&t.length){for(f={},u=0;u<n.length;u++)e=n[u],h=r.normalizeId(e.id||e.itemId),f[h]=!0;for(i=t.length;i;)i--,o=t[i],r.isConversationId(o.itemId)||f[r.normalizeId(o.itemId)]||(t.splice(i,1),s++)}return s},i.begin_addupdatedeletecategories=function(n){var r=this,i=n.parameters.categoriesToDelete;i&&i.length&&t.merge(n.changes,r._invalidateEverything())},s={enableJmrReporting:!1,markSenderAsSafe:!1,removeFromList:HM.RemoveSenderFromListOption.None,suppressListTransition:!1},i.begin_addcontacts=function(r){var o=r.command,s=r.queries,u=r.parameters.queryAddingContactFrom;if(u&&u.folderId===n.config.sysFldrs.junkFid){var f=[u.containerId],e=[u.folderId],h=this._getAuxData(f,e),c=this._getViewInfos(f,e);t.merge(r.changes,this._moveItems(f,!0,e,n.config.sysFldrs.inboxFid,r.queries))}else i.begin_refresh(r)},i.begin_batchjunkitems=function(n){o(n,{jmrType:HM.JmrType.Junk,messagesParam:[],auxData:[],viewInfos:[],suppressListTransition:!0}),t.merge(n.changes,this._invalidateEverything())},i.begin_batchunjunkitems=function(n){o(n,{jmrType:HM.JmrType.NotJunk,messagesParam:[],auxData:[],viewInfos:[],markSenderAsSafe:!1,suppressListTransition:!0}),t.merge(n.changes,this._invalidateEverything())},i.begin_undojunkandunjunkitems=function(n){t.merge(n.changes,this._invalidateEverything());var i=n.parameters,u=i.items,f=!!u&&u.length>0,e=i.fid&&r.isFolderId(i.fid),o=i.jmrType==HM.JmrType.Junk||i.jmrType==HM.JmrType.NotJunk;if(!f)throw new Error("CP.begin_undojunkandunjunkitems should be working with at least one item.");if(!e)throw new Error("CP.begin_undojunkandunjunkitems fid is not a valid folderId");if(!o)throw new Error("CP.begin_undojunkandunjunkitems jmrType should only be junk or unjunk");this._setCommonFppParametersForUndo(n,"messagesParam","auxData"),i.removeFromList=HM.RemoveSenderFromListOption.None,i.markSenderAsSafe=!1},i.begin_junkitems=function(n){var i,e,t;for(i=n.parameters.items,e=!1,t=0;t<i.length;t++)if(r.isConversationId(i[t].itemId)){e=!0;break}n.parameters.suppressListTransition=n.parameters.atLeastOneMessageFromSelf||e,f(n,this,HM.JmrType.Junk,u.junkFid)},i.begin_unjunkitems=function(n){f(n,this,HM.JmrType.NotJunk,u.inboxFid)},i.begin_markassafe=function(n){var h;var i=this,e=n.parameters,u=e.item.itemId,f=[u],s=[e.item.viewId];o(n,{messagesParam:f,auxData:i._getAuxData(f,s),jmrType:HM.JmrType.NotJunk,viewInfos:i._getViewInfos(f,s),markSenderAsSafe:!0}),h=i._getConversationFromId(u),t.merge(n.changes,h.markSafeMessage(u)),t.merge(n.changes,this._invalidateEverything())},i.begin_compromiseitems=function(n){f(n,this,HM.JmrType.Compromised,u.permDelFid)},i.begin_phishitems=function(n){var t=n.parameters.fid!==u.trashFid?u.trashFid:u.permDelFid;f(n,this,HM.JmrType.Phish,t)},i.begin_unsubscribeitems=function(n){n.parameters.removeFromList=HM.RemoveSenderFromListOption.RemoveContact,f(n,this,HM.JmrType.Unsubscribe,u.noneFid)},i.begin_initiatecompose=function(t){var c,u,r,h,y;var f=this,i=t.parameters,e=i.respondingItemId,l=i.query;l&&f._fixupQuery(l);var a=!e||!i.isInline&&!n.GetUserConfig("ConversationThreading"),s=i.temporaryId,o=null;if(a?o=n.data.makeMessageAsConversation(s):n.data.isConversationId(e)?o=e:(r=f._getConversationFromId(e),o=r&&r.id||n.data.makeMessageAsConversation(s)),c=i.actionType===HM.MessageActionType.ResumeDraft,u=c?f._getMessageByMid(e):f._createTemporaryMessage(s,o),u.message.isComposeSession=!0,u.message.composeActionType=i.actionType,u.message.composeData=i.composeData||null,t.changes.push(HM.createComposeMessageChange({newMessageId:c?e:s,respondingItemId:e})),u.message.to=i.to,u.message.cc=i.cc,u.message.bcc=undefined,u.message.replyingMessageHasAttachments=i.replyingMessageHasAttachments,i.fromDetails&&(u.message.senderDetails=i.fromDetails),u.message.plainText=!!i.plainText,!c)if(a){var p=HM.createRollup({itemId:o,messageIds:[s],count:1,unreadCount:0}),h=HM.createRollupData({rollup:p,conversationView:HM.ConversationView.Normal,conversationId:o,lastUpdatedTimestamp:(new Date).toString()}),v={};v[s]=u,y=HM.createItemListData({rollupData:h,itemMap:v}),f.addItem(y)}else r=f._getConversationFromId(e),r&&r.rollups[HM.ConversationView.Normal]?f.insertMessage(r,HM.ConversationView.Normal,u,e):(r||(r=new n.data.Conversation(o)),h=new HM.RollupData,h.rollup=new HM.Rollup,r.rollups[HM.ConversationView.Normal]=h,f._conversations[o]=r,f.insertMessage(r,HM.ConversationView.Normal,u,o))},i.begin_endcomposesession=function(n){var i=this,u=n.parameters,f=i._getMessageByMid(n.parameters.mid),t=f&&f.message;t&&(u.messageSent?(n.changes.push(r.createInvalidateItemListQueryChange(u.mid,"message")),i._invalidateQueries(n.changes,n.queries)):(t.composeActionType=HM.MessageActionType.None,t.composeData=null))},i.begin_savedraft=function(n){var t=n.parameters,u=this._getMessageByMid(t.messageId),i=u&&u.message,f,r;i&&(i.bcc=t.bcc,i.cc=t.cc,f=JSON.stringify(HM.createBodyProperties()),r=t.message,i.bodies[f]={body:r,hash:0},i.body=r,i.subject=t.subject,i.to=t.to,i.isDraft=!0,i.senderDetails=HM.createSenderDetails({displayName:t.fromName,fromAddress:t.from,icFullName:t.fromName,senderDetails:t.senderDetails}),i.meetingRequestInfo=t.meetingRequestInfo)},i.end_savedraft=function(n){var f,i,r;if(f=n.parameters,i=f.messageId,i&&n.serverResults&&n.serverResults[0]&&n.serverResults[0].type===HM.DLReturnType.SaveDraftData){var u=n.serverResults[0].draftId,e=n.serverResults[0].savedTime,o=n.serverResults[0].savedTimeFull,s=n.serverResults[0].savedTimeLong;u&&e&&o&&s&&(t.merge(n.changes,this._updateIdForSaveDraft(i,u,e,o,s)),r=n.results,r.idMapping||(r.idMapping={}),r.idMapping[i]=u)}},i.end_refresh=i.end_autorefresh=i.end_addcontacts=i.end_undosendermovetoblocklist=function(n){r.modelUtils.handleEndRefresh(n,this)}}(window.ol,window.originaljQuery||window.jQuery),define(["ol"],function(n){"use strict";function u(n,t,u,f){for(var y,a,p,v,h,l,o,c=0;!u.isBlocking&&c<n.length;c++){var s=n[c],w=t[c],e=f._getConversationFromId(s);if(e)if(i.isConversationId(s))if(y=r.viewFromContainerId(w),a=e.rollups[y]&&e.rollups[y].rollup,a&&e._haveMessages(a))for(u.keys.push(s),p=a.messageIds,v=0;v<p.length;v++)if(o=p[v],h=e.messages[o]&&e.messages[o].allHeaders,h&&h.length)for(l=0;l<h.length;l++)u.keys.push(h[l]&&h[l].id);else u.keys.push(o);else u.isBlocking=!0;else(i.isMessageId(s)||i.isMessageAsConversationId(s))&&(o=i.getMid(s),u.keys.push(o,e.id));else u.isBlocking=!0}}var i=n.data=n.data||{},r=i.ConversationPool,t;t=r.prototype,t.getkeysfor_getandmarkasread=t.getkeysfor_markitems=t.getkeysfor_flagitems=t.getkeysfor_categorizeitems=t.getkeysfor_junkitems=t.getkeysfor_unjunkitems=t.getkeysfor_compromiseitems=t.getkeysfor_unsubscribeitems=t.getkeysfor_phishitems=t.getKeysForItemIds=function(n){var i=n.command,t=this._getIndicatedIds(n),r=t.itemIdsWithDuplicates,f=t.viewIdsWithDuplicates;u(r,f,i,this)},t.getkeysfor_moveitems=function(i){var u=i.command,f=i.parameters,o=f.destId,e=u.keys,r=i.parameters.items;n.GetAppConfig("deleteMessagePerformanceEnabled")&&r.length===1&&!this.areAllMessageHeadersLoadedForItemInView(r[0].itemId,r[0].viewId)?e.push(r[0].itemId):t.getKeysForItemIds.apply(this,arguments)}}),function(n,t){"use strict";n=window.ol=n||{};var i=n.data=n.data||{},u=i.ConversationPool,e={senderInfos:!0,messageSizeString:!0,indexInList:!0,indexInSection:!0,subject:!0,subjectWithHtml:!0},o={rollup:!0},s={messageIds:!0,subject:!0,subjectWithHtml:!0},h={rollup:!0},f=function(n){this.body=n.body,this.hash=n.hash||0,this.safetyBar=n.safetyBar,this.unsubscribeBar=n.unsubscribeBar,this.attachments=n.attachments,this.liveViews=n.liveViews},c=i.Conversation=function(n){var t=this;t.id=n,t.rollups={},t.messageRollups={},t.messages={}},r=c.prototype;r.addRollup=function(n,t,i,r){var u,o,s,h,f,e,l,c;if(HM.assertRollupData(n),u=this,o=n&&n.conversationView,n&&o in u.rollups?u._mergeRollupDatas(u.rollups[o],n,!!i,r):u.rollups[o]=n,s=n&&n.rollup&&n.rollup.messageIds,s&&t)for(h=0;h<s.length;h++){for(f=s[h],e=t[f],u.updateMessage(f,e),l=u.messages[f],c=0;c<e.allHeaders.length;c++)u.messages[e.allHeaders[c].id]=l;u.updateMessage(f,e)}},r.addMessageRollup=function(n,t,r,u){var f=this,e=n.rollup.itemId,o=i.getMidFromMessageAsConversation(e);e in f.messageRollups?f._mergeRollupDatas(f.messageRollups[e],n,!!r,u):f.messageRollups[e]=n,t&&(f.messages[o]=t,f.updateMessage(o,t))},r.getRollupFromViewId=function(n){var t=null,i=u.viewFromContainerId(n);return this.rollups&&this.rollups[i]&&(t=this.rollups[i].rollup),t},r._haveMessages=function(n){var t=!0,i=n&&n.messageIds,r;if(i&&i.length===n.count)for(r=0;t&&r<i.length;r++)t=i[r]in this.messages;else t=!1;return t},r._mergeRollupDatas=function(n,t,i,r){var c,l,u,f;c=i?e:s,l=i?o:h,HM.assertRollupData(n),HM.assertRollupData(t);for(u in t)u in l||typeof u=="function"||!t.hasOwnProperty(u)||(n[u]=t[u]);f=t&&t.rollup;for(u in f)u in c||typeof u=="function"||!f.hasOwnProperty(u)||(u==="itemId"&&n.rollup[u]!==f[u]&&r.push(HM.createIdChange({newId:f[u],oldId:n.rollup[u]})),n.rollup[u]=f[u])},r.updateMessage=function(n,t){var e,o,u,r;e=this,e._populateIdLookupTable(t),o=e.messages[n],o?(u=o&&o.message,r=t&&t.message,u.serverMessage=r.serverMessage,u.liveViewsHtml=r.liveViewsHtml,u.safetyBarHtml=r.safetyBarHtml,u.unsubscribeBarHtml=r.unsubscribeBarHtml,u.attachmentsHtml=r.attachmentsHtml,u.allowUnsafe=r.allowUnsafe,u.isContentFiltered=r.isContentFiltered,u.to=r.to,u.toDisplayText=r.toDisplayText,u.cc=r.cc,u.ccDisplayText=r.ccDisplayText,u.bcc=r.bcc,u.editContactUrl=r.editContactUrl,u.showAddContactLink=r.showAddContactLink,u.isMeetingRequest=r.isMeetingRequest,u.meetingRequestInfo=r.meetingRequestInfo,u.eeos=r.eeos,u.bodies=u.bodies||{},r.body!==null&&(u.bodies[JSON.stringify(t.bodyProperties)]=new f({body:r.body,hash:r.bodyHash,safetyBar:r.safetyBarHtml,unsubscribeBar:r.unsubscribeBarHtml,attachments:r.attachmentsHtml,liveViews:r.liveViewsHtml}))):t&&(r=t.message,e.messages[n]=t,r&&r.body!==null&&(r.bodies=r.bodies||{},r.bodies[JSON.stringify(t.bodyProperties)]=new f({body:r.body,hash:r.bodyHash,safetyBar:r.safetyBarHtml,unsubscribeBar:r.unsubscribeBarHtml,attachments:r.attachmentsHtml,liveViews:r.liveViewsHtml})))},r._populateIdLookupTable=function(n){for(var r=n.message,i={},t=0;t<n.allHeaders.length;t++)i[n.allHeaders[t].id]=!0;r.allIds=i},r.getViewInfo=function(n){var t,r,f,e;return t=null,r=null,i.isFolderId(n)?t=n:r=n,f=u.viewFromContainerId(n),e=this.rollups[f],new HM.ViewInfo(e.lastUpdatedTimestamp,t||null,r||null)},r.getAuxData=function(n){var r,f,e;if(r=this,i.isConversationId(n))return"";var u={},o=i.getMid(n),s=i.makeMessageAsConversation(o);return s in r.messageRollups?(f=r.messageRollups[s],t.extend(u,f,f.rollup)):(e=r.messages[o],t.extend(u,e,e.message)),HM.createMarshalableHeaderAuxData(u)},r.getView=function(n){var i,f;var r=this,u=HM.Status.Complete,e=r.rollups[n],t=e&&e.rollup,o={};if(t)if(r._haveMessages(t))for(i=0;i<t.messageIds.length;i++)f=r.messages[t.messageIds[i]].message,o[f.messageId]=f;else u=HM.Status.IncompletePartial;else u=HM.Status.IncompleteNone;return{conversation:{rollup:t,messages:o},status:u}},r.getMessageBody=function(n,t){var r,c,u;var e=this,f=HM.Status.Complete,o=e.messages[n],s=e.messageRollups[i.makeMessageAsConversation(n)],h={};return o?(r=o.message,h[n]=r,t&&(c=JSON.stringify(t),u=r.bodies&&r.bodies[c],u?(r.body=u.body,r.bodyHash=u.hash,r.safetyBarHtml=u.safetyBar,r.unsubscribeBarHtml=u.unsubscribeBar,r.attachmentsHtml=u.attachments,r.liveViewsHtml=u.liveViews):f=HM.Status.IncompletePartial)):f=HM.Status.IncompleteNone,{conversation:{rollup:s&&s.rollup,messages:h},status:f}},r.invalidateRollup=function(n){var i=this,r=[],t=i.rollups[n];return t&&(r.push(HM.createInvalidateRollupChange({itemId:t.rollup.itemId,conversationId:t.rollup.conversationId,view:n})),delete i.rollups[n]),r},r.invalidateRollupAndQueries=function(n){var r=this,u=[];return u.push(i.createInvalidateItemListQueryChange(r.id,"rollup",n,r.messages)),t.merge(u,r.invalidateRollup(n)),u},r.invalidateAllMessageRollups=function(){var t=this,i=[],n,r;for(n in t.messageRollups)r=t.messageRollups[n],r&&(delete t.messageRollups[n],i.push(HM.createInvalidateMessageRollupChange({itemId:n})));return i},r.invalidateMessageAndQueries=function(n){var u,e;var o=this,r=[],f=o.messages[n];if(f)for(u=0;u<f.allHeaders.length;u++)e=f.allHeaders[u].id,n!==e&&r.push(i.createInvalidateItemListQueryChange(e,"message"));return r.push(i.createInvalidateItemListQueryChange(n,"message")),t.merge(r,o.invalidateMessage(n)),r},r.invalidateMessage=function(n){var t=this,u=[],o=t.messages[n],s=i.makeMessageAsConversation(n),h=t.messageRollups[s],f,r,e;if(o)for(f=0;f<o.allHeaders.length;f++)r=o.allHeaders[f].id,delete t.messages[r],u.push(HM.createInvalidateMessageChange({itemId:r})),r!==n&&(e=i.makeMessageAsConversation(r),t.messageRollups[e]&&(delete t.messageRollups[e],u.push(HM.createInvalidateMessageRollupChange({itemId:e}))));return h&&(delete t.messageRollups[s],u.push(HM.createInvalidateMessageRollupChange({itemId:s}))),u},r.moveItems=function(r,f,e,o){var w,b,y,k,nt,v,p,a,g,l,s;var h=this,c=[],d={};for(s=0;s<r.length;s++)w=r[s],b=e[s],b!==o&&(y=u.viewFromContainerId(b),k=u.viewFromContainerId(o),i.isConversationId(w)?(t.merge(c,h.move(b,o)),y!==k&&(t.merge(c,h.invalidateRollupAndQueries(y)),t.merge(c,h.invalidateRollup(k)))):(t.merge(c,h.moveMessage(w,f,b,o,w)),y!==k?(nt=d[y]=d[y]||[],nt.push(i.normalizeId(w)),t.merge(c,h.invalidateRollup(k))):(p=h.rollups[y],a=p&&p.rollup,h._isSingletonView(y)&&(a.folderId=o))));for(v in h.rollups){if(v=parseInt(v),p=h.rollups[v],a=p.rollup,p.originalFolderReason||a.unsubscribeLinkRendered&&o===n.config.sysFldrs.junkFid){if(t.merge(c,h.invalidateAllMessageRollups()),l=a&&a.messageIds,l&&l.length>0)for(s=0;s<l.length;s++)t.merge(c,h.invalidateMessage(l[s]));t.merge(c,h.invalidateRollup(v))}if(d[v]){if(g=!1,l=a&&a.messageIds,l&&l.length===a.count)for(g=!0,s=0;s<l.length;s++)if(t.inArray(l[s],d[v])===-1){g=!1;break}g?t.merge(c,h.invalidateRollupAndQueries(v)):t.merge(c,h.invalidateRollup(v))}}return c},r._canMoveMessage=function(t,r,f){var e=u.viewFromContainerId(f),o=i.isCategoryId(t),s=t===n.config.sysFldrs.searchFid,h=t==n.config.sysFldrs.noneFid,c=e===HM.ConversationView.Normal;return f!==r&&((o||s)&&c||f===t||h)},r.move=function(r,f){var a,v,c,o;var e=this,s=[],h=u.viewFromContainerId(r),y=u.viewFromContainerId(f),l=h in e.rollups&&e.rollups[h],p=l&&l.rollup;if(e._haveMessages(p))for(a in e.messages)t.merge(s,e.moveMessage(a,!0,r,f,e.id));else{for(v in e.messageRollups)c=e.messageRollups[v],o=c&&c.rollup,o&&e._canMoveMessage(r,f,o.folderId)&&(o.folderId=f);s.push(HM.createMoveConversationChange({id:e.id,prevFolderId:i.isFolderId(r)?r:n.config.sysFldrs.noneFid,newFolderId:f,changingView:h!==y,conv:e,threadedListId:e.id,originalMoveId:e.id}))}return s},r.moveMessage=function(r,f,e,o,s){var c,l,k,g,nt,w,h,ft,a;c=this,l=[],r=i.getMid(r);var v=c.messages[r],tt=v&&v.message,it=c.messageRollups[i.makeMessageAsConversation(r)],y=it&&it.rollup,b=u.viewFromContainerId(e),rt=u.viewFromContainerId(o),p=[],d=[],ut=!1;if(v){for(k=0,a=0;a<v.allHeaders.length;a++)h=v.allHeaders[a],(h.id===r||f)&&c._canMoveMessage(e,o,h.folderId)&&(k++,p.push(h),d.push(h.folderId),h.folderId=o,h.id!==r&&(g=c.messageRollups[i.makeMessageAsConversation(h.id)],nt=g&&g.rollup,nt&&(nt.folderId=o)),h.id===tt.messageId&&(tt.folderId=o));ut=k>0&&k<v.allHeaders.length}for(y&&c._canMoveMessage(e,o,y.folderId)&&(p.length||(d.push(y.folderId),p.push(c._makeHeaderFromMessageRollup(y))),y.folderId=o),w=0;w<p.length;w++)h=p[w],l.push(HM.createMoveMessageChange({id:h.id,threadedListId:c.rollups[b]&&c.rollups[b].rollup.itemId,prevFolderId:d[w],newFolderId:o,isRead:h.isRead,categories:c._getAllCategories(h),changingView:b!==rt,originalMoveId:s,conv:c}));if(l.length>0)if(o===n.config.sysFldrs.permDelFid||o===n.config.sysFldrs.junkFid||e===n.config.sysFldrs.junkFid)t.merge(l,c.invalidateMessageAndQueries(r));else if(b!==rt)if(ut)t.merge(l,c.invalidateMessageAndQueries(r));else for(ft=l.length,a=0;a<ft;a++)l.push(i.createInvalidateItemListQueryChange(i.getMid(l[a].id),"message"));return l},r.markItem=function(n,t,r,u){var f=this;return i.isConversationId(n)?f.markReadState(r,u):f.markReadMessage(i.getMid(n),t,r,u)},r.markReadState=function(n,r){var a,v,y,p,h,o;var f=this,c=u.viewFromContainerId(r),l=c in f.rollups&&f.rollups[c],e=l&&l.rollup,s=[];if(f._haveMessages(e))for(a in f.messages)t.merge(s,f.markReadMessage(a,!1,n,r));else{if(!e)throw"rollup is null with non empty messages";v=e.isRead,y=e.unreadCount,e.isRead=n,e.unreadCount=n?0:e.count;for(p in f.messageRollups)h=f.messageRollups[p],o=h&&h.rollup,o&&(o.isRead=n,o.unreadCount=n?0:1);(v!==e.isRead||y!==e.unreadCount)&&s.push(HM.createMarkConversationChange({id:f.id,threadedListId:f.id,isRead:e.isRead,conv:f}))}return s},r.markReadMessage=function(n,t,r,f){var b,nt,y,c,rt,h,tt,p,e;var o=this,a=o.messages[n],k=a&&a.message,d=o.messageRollups[i.makeMessageAsConversation(n)],l=d&&d.rollup,w=u.viewFromContainerId(f),it=o.rollups[w],s=it&&it.rollup,v=[],g=[];if(k){for(b=0;b<a.allHeaders.length;b++)e=a.allHeaders[b],h=0,(e.id===n||t&&u.viewFromContainerId(e.folderId)===w)&&(c=e.isRead,c!==r&&(h=c?1:-1,v.push(e),g.push(h),e.isRead=r),k.isRead=r,k.wasRead=c,e.id!==n&&(nt=o.messageRollups[i.makeMessageAsConversation(e.id)],y=nt&&nt.rollup,y&&(c=y.isRead,y.isRead=r,y.unreadCount=r?0:1)),s&&(s.unreadCount+=h));s&&(s.isRead=s.unreadCount===0)}for(d&&(c=l.isRead,l.isRead=r,rt=l.unreadCount,l.unreadCount=r?0:1,h=l.unreadCount-rt,!a&&s&&(c!==r&&(s.unreadCount+=h),s.isRead=s.unreadCount===0),v.length||h===0||(v.push(o._makeHeaderFromMessageRollup(l)),g.push(h))),tt=[],p=0;p<v.length;p++)e=v[p],tt.push(HM.createMarkMessageChange({id:e.id,threadedListId:o.rollups[w]&&o.rollups[w].rollup.itemId,countChange:g[p],folderId:e.folderId,categories:o._getAllCategories(e),conv:o}));return tt},r.markSafeMessage=function(n){var r;var t=this,f=[],e=t.messages[n];for(r=0;r<e.allHeaders.length;r++){var o=e.allHeaders[r],s=o.folderId,h=u.viewFromContainerId(s);f.push(HM.createMarkSafeMessageChange({id:o.id,threadedListId:t.rollups[h]&&t.rollups[h].rollup.itemId,fid:s,conv:t}))}return f},r._isSingletonView=function(n){var t=this.rollups[n];return t&&i.isMessageAsConversationId(t.rollup.itemId)},r.categorizeItem=function(n,r,u,f,e){var o;if(o=this,i.isConversationId(n))return o.categorize(u,f,e);var c=i.getMid(n),s=o.categorizeMessage(i.getMid(n),r,u,f),h=i.ConversationPool.viewFromContainerId(e);return t.merge(s,o.updateRollupCategories(h,u,f)),s},r.categorize=function(n,r,f){var l,y,a,v;var e=this,s=u.viewFromContainerId(f),o=e.rollups[s]&&e.rollups[s].rollup,h=[];if(e._haveMessages(o)){for(l in e.messages)e._messageIsInView(e.messages[l].message,s)&&t.merge(h,e.categorizeMessage(l,!0,n,r));t.merge(h,e.updateRollupCategories(s))}else{for(y in e.messageRollups)a=e.messageRollups[y],v=a&&a.rollup,v&&e._applyCategories(v.categories,n,r);var p=e.rollups[s],o=p&&p.rollup,c=e._applyCategories(o.categories,n,r);(c.added.length||c.removed.length)&&h.push(HM.createCategorizeConversationChange({id:e.id,apply:c.added,remove:c.removed,isRead:o.isRead,unreadCount:o.unreadCount,count:o.count,conv:e,threadedListId:o.itemId}))}return h},r.updateRollupCategories=function(n,i,r){var c,e,o,p,s,l,h,a;var f=this,v=[],y=f.rollups[n],u=y&&y.rollup;if(u)if(f._haveMessages(u))for(u.categories=[],c=u.messageIds,e=0;e<c.length;e++)for(o=f.messages[c[e]],p=o.message,s=0;s<o.allHeaders.length;s++)for(l=o.allHeaders[s].categories,h=0;h<l.length;h++)a=l[h],t.inArray(a,u.categories)===-1&&u.categories.push(a);else f._isSingletonView(n)?f._applyCategories(u.categories,i,r):t.merge(v,f.invalidateRollup(n));return v},r._applyCategories=function(n,i,r){var f,e,u,o;for(f=[],e=[],u=0;u<i.length;u++)t.inArray(i[u],n)===-1&&(n.push(i[u]),f.push(i[u]));for(u=0;u<r.length;u++)o=t.inArray(r[u],n),o!==-1&&(n.splice(o,1),e.push(r[u]));return{added:f,removed:e}},r.categorizeMessage=function(n,t,r,u){var e=this,a=e.messages[n],h=a&&a.message,v=[],y=[],p,w,b,k,c,o,d,l,f,s;if(h)for(p=0;p<a.allHeaders.length;p++)f=a.allHeaders[p],(f.id===n||t)&&(o=e._applyCategories(f.categories,r,u),(o.added.length||o.removed.length)&&(v.push(f),y.push(o)),f.id!==n&&(w=e.messageRollups[i.makeMessageAsConversation(f.id)],b=w&&w.rollup,b&&e._applyCategories(b.categories,r,u)),f.id===h.messageId&&e._applyCategories(h.categories,r,u));for(k=e.messageRollups[i.makeMessageAsConversation(n)],c=k&&k.rollup,c&&(h&&y.length?c.categories=h.categories:(o=e._applyCategories(c.categories,r,u),(o.added.length||o.removed.length)&&(v.push(e._makeHeaderFromMessageRollup(c)),y.push(o)))),d=[],l=0;l<v.length;l++)f=v[l],s=y[l],(s.added.length||s.removed.length)&&d.push(HM.createCategorizeMessageChange({id:f.id,apply:s&&s.added,remove:s&&s.removed,isRead:f.isRead,conv:e,threadedListId:e._getThreadedListId(f.folderId)}));return d},r.flagItem=function(n,r,u,f){var l,e,a,s,v,h,y;var f=HM.ConversationView.Normal,o=this,c=[];if(c=i.isConversationId(n)?o.flag(u,f):o.flagMessage(i.getMid(n),r,u,f),l=o.rollups[f],e=l&&l.rollup,e&&e.messageIds){for(e.isFlagged=!1,a=e.messageIds,s=0;s<a.length;s++)for(v=a[s],h=0;h<o.messages[v].allHeaders.length;h++)if(y=o.messages[v].allHeaders[h],y.isFlagged){e.isFlagged=!0;break}}else e&&(o._isSingletonView(f)||i.isConversationId(n))?e.isFlagged=u:t.merge(c,o.invalidateRollup(f));return c},r.flag=function(n,i){var o,s,h,e,c,a,v,y,l;var r=this,u=r.rollups[i]&&r.rollups[i].rollup,f=[];if(r._haveMessages(u))if(n){for(o=u.messageIds,s=u.sendersDetails,h=null,e=0;e<s.length;e++)if(!s[e].isSenderSelf&&(c=o[e],!r.messages[c].message.isDraft)){h=c;break}a=h||o[0],t.merge(f,r.flagMessage(a,!1,n,i))}else for(v in r.messages)t.merge(f,r.flagMessage(v,!0,n,i));else{if(!u)throw"rollup is unexpectedly null!";if(n)t.merge(f,r.invalidateAllMessageRollups());else for(y in r.messageRollups)l=r.messageRollups[y],l&&(l.rollup.isFlagged=n);u.isFlagged!==n&&(u.isFlagged=n,f.push(HM.createCategorizeConversationChange({id:r.id,apply:n?[HM.FilterType.FlaggedMessages]:[],remove:n?[]:[HM.FilterType.FlaggedMessages],isRead:u.isRead,conv:r,threadedListId:u.itemId})))}return f},r.flagMessage=function(n,t,r,u){var l,v,y,p,a,f;var e=this,o=e.messages[n],w=e.messageRollups[i.makeMessageAsConversation(n)],s=o&&o.message,h=w&&w.rollup,b=e.rollups[u],k=b&&b.rollup,c=[];if(s)for(l=0;l<o.allHeaders.length;l++)f=o.allHeaders[l],(f.id===n||t)&&(f.isFlagged!==r&&(f.isFlagged=r,c.push(f)),f.id!==n&&(v=e.messageRollups[i.makeMessageAsConversation(f.id)],y=v&&v.rollup,y&&(y.isFlagged=r)),f.id===s.messageId&&(s.isFlagged=r));for(h&&h.isFlagged!==r&&(s||c.push(e._makeHeaderFromMessageRollup(h)),h.isFlagged=r),p=[],a=0;a<c.length;a++)f=c[a],p.push(HM.createCategorizeMessageChange({id:f.id,threadedListId:e._getThreadedListId(f.folderId),apply:r?[HM.FilterType.FlaggedMessages]:[],remove:r?[]:[HM.FilterType.FlaggedMessages],isRead:f.isRead,conv:e}));return p},r.getMessageIndex=function(n,r){var f=this,u,e;return u=-1,n in f.rollups&&(e=f.rollups[n].rollup,u=t.inArray(r,e.messageIds)),u},r._getAllCategories=function(n){var i=this,t=n.categories.slice(0);return n.isRead||t.push(HM.FilterType.UnreadMessages),n.isFlagged&&t.push(HM.FilterType.FlaggedMessages),t},r._makeHeaderFromMessageRollup=function(n){return HM.assertRollup(n),{id:n.itemId,folderId:n.folderId,isRead:n.isRead,isFlagged:n.isFlagged,categories:n.categories}},r._getThreadedListId=function(n){var t=this,i=u.viewFromContainerId(n),r=t.rollups[i]&&t.rollups[i].rollup;return r&&r.itemId||null},r._messageIsInView=function(n,t){return u.viewFromContainerId(n.folderId)===t}}(window.ol,window.originaljQuery||window.jQuery),function(n,t){"use strict";var i=n.data=n.data||{};i.ValidationModel=function(){var i=this;i.formatResults=t.noop,i.register=function(n){n.register("VM",this)},i.validate_updatefolder=i.validate_addfolder=function(t){var i=t.parameters;return!i.isArchive||i.parentFolderId===n.config.sysFldrs.noneFid},i.validate_movefolder=function(n){var t=n.parameters;return t.folderId!==t.newParentFolderId},i.validate_addupdatedeletecategories=function(n){var t=n.parameters;return t.categorySettings||t.categoriesToDelete&&t.categoriesToDelete.length>0||t.categoriesToAdd&&t.categoriesToAdd.length>0||t.categoriesToUpdate&&t.categoriesToUpdate.length>0},i.validate_addupdatedeleterules=function(n){var t=n.parameters;return t.rulesToAdd&&t.rulesToAdd.length>0||t.rulesToEdit&&t.rulesToEdit.length>0||t.ruleIdsToDelete&&t.ruleIdsToDelete.length>0},i.validate_addcontacts=function(n){var t=n.parameters;return t.contactsToAdd&&t.contactsToAdd.length>0},i.validate_initiatecompose=function(n){var t=n.parameters;return t.actionType===HM.MessageActionType.None||t.respondingItemId},i.validate_bulkactions=function(n){var t=n.parameters;return t.actions&&t.actions.length>0&&t.msgs&&t.mads&&t.msgs.length===t.mads.length},i.validate_blocksenders=function(n){var t=n.parameters;return t.senders&&t.senders.length>0},i.validate_createrecipientmoverule=function(n){var t=n.parameters;return t.recipientEmail&&t.recipientEmail.length>0},i.validate_instrumentthis=function(n){var t=n.parameters;return t.cmd}}}(window.ol,window.originaljQuery||window.jQuery),function(n,t){"use strict";var i=n.data=n.data||{};i.GetKeysModel=function(){var i=this;i.formatResults=t.noop,i.register=function(n){n.register("KM",this)},i.getkeysfor_undomovesendertoblocklist=function(n){var t=n.command,i=n.parameters;t.keys.push(i.senderAddress)},i.getkeysfor_collapsefolder=i.getkeysfor_expandfolder=i.getkeysfor_updatefolder=function(n){var t=n.command,i=n.parameters;t.keys.push(i.folderId)},i.getkeysfor_movefolder=function(n){var i=n.command,t=n.parameters;i.keys.push(t.folderId,t.newParentFolderId)},i.getkeysfor_resetsearchcache=function(t){var i=t.command,r=t.parameters;i.keys.push(n.config.sysFldrs.searchFid)}}}(window.ol,window.originaljQuery||window.jQuery),function(n,t){"use strict";var u=n.data=n.data||{},r=HM.ContainerType,e=n.data.ConversationPool,o=u.ContainerModel=function(){var n=this;n._containers={},n._containerLists={},n._typeMap={}},i=o.prototype,f;i._getContainerById=function(n){return this._containers[n]||null},i._invalidateEverything=function(){var n=this;return n._containers={},n._containerLists={},n._typeMap={},[HM.createInvalidateContainerModelChange()]},i._invalidateContainer=function(n){var t,i,r,f,e;if(t=this._typeMap[n],t instanceof Array)for(i=0;i<t.length;i++)r=this._containerLists[t[i]].indexOf(n),r!==-1&&this._containerLists[t[i]].splice(r,1);return delete this._containers[n],delete this._typeMap[n],f=u.isFolderId(n)?n:null,e=u.isCategoryId(n)?n:null,[HM.createInvalidateContainerChange({folderId:f,categoryId:e})]},i._invalidateContainerType=function(n){var f,t,s,h;var i=this,e=i._containerLists[n],o=[];if(delete i._containerLists[n],e)for(f=0;f<e.length;f++)t=e[f],s=u.isFolderId(t)?t:null,h=u.isCategoryId(t)?t:null,o.push(HM.createInvalidateContainerChange({folderId:s,categoryId:h})),delete i._containers[t],delete i._typeMap[t];return n===r.Categories&&(delete i._containerLists[r.QuickViews],delete i._containerLists[r.Filters]),o},i._notInCacheResult=function(n){return HM.createContainerResult({query:n,type:HM.ResultType.Container,status:HM.Status.IncompleteNone})},i._containerQuery=function(n){var t,r,i,e,f,o;if(r=this,i=r._containerLists[n.containerType],i){for(e={},f=0;f<i.length;f++)o=i[f],e[o]=r._containers[o].container;t=HM.createContainerResult({containerIds:i,containerTable:e,query:n,type:HM.ResultType.Container,status:HM.Status.Complete})}else t=r._notInCacheResult(n);return t.dataHash=u.hashResult(t),t},i._getQueryResponse=function(n,t){for(var i,u,f={},r=0;r<n.length;r++)i=n[r],i.type===HM.QueryType.ContainerQuery&&(u=this._containerQuery(i),(u.status!==HM.Status.Complete||i.forceFetch)&&(t?(t.queries=t.queries||[],t.queries.push(i)):u=null),f[i.key()]=u);return f},i._applyServerResults=function(n){this.addListData(n,n.containerType)},i._updateCounts=function(n){var r,f,o,h;var i=this,e=!0,s=n.changes;for(r=0;r<s.length;r++)f=s[r],u.isChangeProcessedByModel(f,i)||(o=i._changeCountFunctions[f.type],o&&(h=o.call(i,f),e=e&&h));e||t.merge(n.changes,i._invalidateEverything())},f=i._changeCountFunctions={},f[HM.ChangeType.MoveMessage]=function(t){var r,u,s,h,c;var l=this,f=t.prevFolderId,a=t.newFolderId,o=t.isRead,i,v=e.viewFromContainerId(f),y=e.viewFromContainerId(a);if(v!==y)for(r=0,v===HM.ConversationView.Normal?r=-1:y==HM.ConversationView.Normal&&(r=1),u=0;u<t.categories.length&&r;u++)s=this._getContainerById(t.categories[u]),s&&(i=s.container,i.totalCount+=r,o||(i.unreadCount+=r));return f===n.config.sysFldrs.noneFid?!1:(h=l._getContainerById(f),h&&(i=h.container,i.totalCount-=1,o||(i.unreadCount-=1)),c=l._getContainerById(a),c&&(i=c.container,i.totalCount+=1,o||(i.unreadCount+=1)),!0)},f[HM.ChangeType.MarkMessage]=function(n){var u,t,i,f,r;if(u=this._getContainerById(n.folderId),u&&(u.container.unreadCount+=n.countChange),t=n.categories,t)for(i=0;i<t.length;i++)t[i]!==HM.FilterType.UnreadMessages&&(f=this._getContainerById(t[i]),f&&(f.container.unreadCount+=n.countChange));return r=this._getContainerById(HM.FilterType.UnreadMessages),r&&(r.container.unreadCount+=n.countChange,r.container.totalCount+=n.countChange),!0},f[HM.ChangeType.CategorizeMessage]=function(n){var t,i,f,e,r,o,u;for(f=n.isRead,e=n.apply,r=0;r<e.length;r++)t=this._getContainerById(e[r]),t&&(i=t.container,i.totalCount+=1,f||(i.unreadCount+=1));for(o=n.remove,u=0;u<o.length;u++)t=this._getContainerById(o[u]),t&&(i=t.container,i.totalCount-=1,f||(i.unreadCount-=1));return!0},f[HM.ChangeType.MarkConversation]=f[HM.ChangeType.MoveConversation]=f[HM.ChangeType.CategorizeConversation]=f[HM.ChangeType.InvalidateConversationPool]=function(){return!1},i._deleteContainer=function(n){var i=this,r,u,f,e;if(delete i._containers[n],r=i._typeMap[n],delete i._typeMap[n],r)for(u=0;u<r.length;u++)f=i._containerLists[r[u]],e=t.inArray(n,f),e!==-1&&f.splice(e,1)},i.beginCommand=function(n){this._updateCounts(n)},i.endCommand=function(n){var i,f,r,t,s,u;if(n.command&&(n.command.name=="deletefolder"||(n.command.name=="updatefolder"||n.command.name=="addfolder")&&n.parameters.isArchive)&&delete this.cachedArchiveFolderId,i=n.serverResults,i){for(r=0;r<i.length;r++)if(t=i[r],t&&t.type===HM.DLReturnType.ContainerPoolData){for(s=n.changes,u=0;u<t.containerList.length;u++){var e=t.containerList[u],h=t.containerMap[e].container,c=this._getContainerById(e),o=c&&c.container;o&&(o.totalCount!==h.totalCount||o.unreadCount!==h.unreadCount)&&s.push(HM.createCountChange({id:e.toString()}))}this._applyServerResults(t)}else t&&t.type===HM.DLReturnType.FoldersHash&&(f=t.foldersHash);f&&this._updateExcoFieldsFromCookie(f)}},i.formatResults=function(n){var t=this._getQueryResponse(n.queries,n.serverRequest);u.uniqueExtend(n.results,t)},i.addListData=function(n,t,i){var u,o,s,l,h,a,c,y;if(u=this,o=u._containerLists[t],o)for(s=0;s<o.length;s++)l=o[s],delete u._containers[l],delete u._typeMap[l];for(h=n.containerList,u._containerLists[t]=h,t===r.Categories&&(u._containerLists[r.QuickViews]=[],u._containerLists[r.Filters]=[]),a=n.containerMap,c=0;c<h.length;c++){var f=h[c],v=a[f],e=v.container;u._containers[f]=v,e.containerType===r.Folders?u._typeMap[f]=[r.Folders]:(u._typeMap[f]=[r.Categories],y=e.properties,e.visibility&HM.CategoryVisibility.QuickView&&e.categoryId>0?y&HM.CategoryProperties.IsHidden||(u._containerLists[r.QuickViews].push(f),u._typeMap[f].push(r.QuickViews)):e.visibility&HM.CategoryVisibility.Filter&&e.categoryId>0&&(u._containerLists[r.Filters].push(f),u._typeMap[f].push(r.Filters)))}t===HM.ContainerType.Folders&&i&&this._updateExcoFieldsFromCookie(i)}}(window.ol,window.originaljQuery||window.jQuery),function(n,t){"use strict";var r=n.data=n.data||{},e=32,u=null,o=r.ContainerModel,f,i;f=HM.ContainerType,i=o.prototype,i.register=function(n){n.register("CM",this)},i.begin_get=function(){},i._validateFolder=function(t,i,r){var e,c,o,s,u,h,f;if(e=this,c=null,!t)return HM.createDLError({type:HM.ErrorType.FolderError,code:HM.FolderError.EmptyName});if(!t.trim().length)return HM.createDLError({type:HM.ErrorType.FolderError,code:HM.FolderError.EmptyName});for(o=n.config.invalidCharacterSet,u=0;u<o.length;u++)if(t.indexOf(o[u])!==-1)return HM.createDLError({type:HM.ErrorType.FolderError,code:HM.FolderError.InvalidCharacters});for(s=e._containerLists[HM.ContainerType.Folders],u=0;u<s.length;u++)if(h=e._getContainerById(s[u]),f=h.container,f.parent===i&&f.folderId!==r&&f.name===t)return HM.createDLError({type:HM.ErrorType.FolderError,code:HM.FolderError.DuplicateName});return t.length>n.GetAppConfig("MaxFolderNameLength")?HM.createDLError({type:HM.ErrorType.FolderError,code:HM.FolderError.TooLong}):null},i.begin_addfolder=function(n){var o=n.parameters,i=this._getContainerById(o.folderId),u=i&&i.container,e=this._validateFolder(n.parameters.folderName,n.parameters.parentFolderId,u&&u.folderId);e?n.errors.push(e):(this._backupContainerExcoMap(),t.merge(n.changes||[],this._invalidateContainerType(f.Folders)))},i.begin_updatefolder=function(n){var u=n.parameters,e=this._getContainerById(u.folderId),i=e&&e.container,o=this._validateFolder(u.newFolderName,i.parent,i&&i.folderId);o?n.errors.push(o):(this._backupContainerExcoMap(),t.merge(n.changes,this._invalidateContainerType(f.Folders)))},i.updateHasChildren=function(n){var i,r,u;i=this._containerLists[HM.ContainerType.Folders],r=t.inArray(n,i),r>-1&&(u=this._containers[i[r]].container,u.hasChildren=r===i.length-1?!1:this._containers[i[r+1]].container.parent===n)},i.begin_addupdatedeletecategories=function(n){var u,i,r;if(u=this,i=n.parameters.categoriesToDelete,i&&i.length)for(r=0;r<i.length;r++)t.merge(n.changes,[HM.createDeleteCategoryChange({id:i[r].categoryId})]),t.merge(n.changes,u._invalidateContainer(i[r].categoryId))},i.begin_deletefolder=function(n){var i,s,e,h,o,a,c,v,l;i=n.parameters.folderId,s=this._getContainerById(i).container;var y=s.parent,u=this._containerLists[HM.ContainerType.Folders],f={};if(f[i]=!0,e=t.inArray(i,u),h=1,e!==-1){if(s.hasChildren)for(o=e+1,a=u.length;o<a;o++)if(c=this._containers[u[o]].container,f[c.parent])v=c.folderId,f[v]=!0,h++;else break;u.splice(e,h);for(l in f)t.merge(n.changes,this._invalidateContainer(l)),n.changes.push(HM.createDeleteFolderChange({folderId:l}));this.updateHasChildren(y),this._backupContainerExcoMap()}},i.begin_movefolder=function(n){this._updateFolderListStructure(n.parameters.folderId,null,n.parameters.newParentFolderId),this._backupContainerExcoMap()},i.begin_expandfolder=function(n){this._expandCollapsefolder(n,!1)},i.begin_collapsefolder=function(n){this._expandCollapsefolder(n,!0)},i._expandCollapsefolder=function(n,t){var u,i;u=n.parameters.folderId,i=this._getContainerById(u).container,i&&i.hasChildren&&(i.isCollapsed=t,this._updateFolderExcoCookie())},i.begin_createrecipientmoverule=function(t){var i=t.parameters.folderId,r=t.parameters.folderName;i&&this._getContainerById(i)||!r||(t.parameters.parentFolderId=n.config.sysFldrs.noneFid,t.parameters.isArchive=!1,this.begin_addfolder(t))},i.begin_refreshfolders=function(n){t.merge(n.changes,this._invalidateContainerType(f.Folders))},i.begin_batchmoveitems=function(){this._invalidateEverything()},i.begin_endcomposesession=function(n){n.parameters.mid&&!r.isTemporaryId(n.parameters.mid)&&this._invalidateEverything()},i.begin_instrumentthis=function(n){var i=this,r,u,e,f;if(i.cachedArchiveFolderId===undefined){if(i.cachedArchiveFolderId=null,r=i._containerLists[HM.ContainerType.Folders],r)for(u=0;u<r.length;u++)if(e=i._getContainerById(r[u]),f=e&&e.container,f&&f.isArchive){i.cachedArchiveFolderId=f.folderId;break}t.merge(n.changes,[HM.createArchiveFolderIdChange({id:i.cachedArchiveFolderId})])}},i._getFoldersExCoState=function(){for(var u="",t=0,h,i=e,r=this._containerLists[f.Folders],c=Math.ceil(r.length/i),o,s,n=0;n<r.length;n++)o=this._getContainerById(r[n]).container,o.isCollapsed&&o.hasChildren&&(h=Number(Math.pow(2,n%i)),t=t|h),s=n==r.length-1,(n%i==i-1||s)&&c!==0&&(u=u+t+(s?"":"|"),c-=1,t=0);return u},i.resetFolderExCoState=function(){for(var t=this._containerLists[HM.ContainerType.Folders],n=0;n<t.length;n++)this._getContainerById(t[n]).container.isCollapsed=!1;this._updateFolderExcoCookie()},i._updateFolderListStructure=function(n,i,r){var u,e,y,f,h,c,p,o,b,l,k,g,s,v;if(u=this._getContainerById(n).container,e=r||u.parent,u){if(this.updateHasChildren(u.parent),y=this._getContainerById(e),u.depth=y?y.container.depth+1:1,u.parent=e,f=this._containerLists[HM.ContainerType.Folders],h={},h[n]=!0,r&&n===e)return;if(c=t.inArray(n,f),c===-1)return;if(p=1,u.hasChildren)for(o=c+1,b=f.length;o<b;o++)if(h[this._containers[f[o]].container.parent])l=this._containers[f[o]].container,k=this._containers[l.parent].container,h[l.folderId]=!0,l.depth=k.depth+1,p++;else break;for(var d=f.splice(c,p),nt=t.inArray(e,f),w,a=nt+1;a<f.length;){if(g=this._getContainerById(f[a]),s=g.container,s.depth<u.depth||!s.isArchive&&s.depth===u.depth&&u.sortIndex<s.sortIndex)break;a++}for(w=a,v=0;v<d.length;v++)f.insert(w,d[v]),w++;r&&n!==e&&this.updateHasChildren(e)}},i._updateFolderExcoCookie=function(t){if(!n.config.serverRenderOnly){var i=n.Cookies.get(n.config.cookies.pdCookie),r=this._getFoldersExCoState();i.FoldersExcoState=r,t&&(i.FoldersModelHash=t),u=null,n.Cookies.setPermanent(n.config.cookies.pdCookie,i)}},i._updateExcoFieldsFromCookie=function(t){var r=this._containerLists[HM.ContainerType.Folders],s=n.Cookies.get(n.config.cookies.pdCookie),h=s.FoldersExcoState,c=s.FoldersModelHash,l,i,f,o;if(t&&t===c&&h!==0)for(l=h.split("|"),i=0,f=r.length;i<f;i++){var o=!1,y=i%e,v=l[Math.floor(i/e)],a=1<<i%e;o=(v&a)===a,this._getContainerById(r[i]).container.isCollapsed=o}else if(t&&t!==c&&u!=null)for(i=0,f=r.length;i<f;i++)o=u.hasOwnProperty(r[i])?u[r[i]]:!1,this._getContainerById(r[i]).container.isCollapsed=o;this._updateFolderExcoCookie(t)},i._backupContainerExcoMap=function(){var t,n,i;for(u={},t=this._containerLists[HM.ContainerType.Folders],n=0;n<t.length;n++)i=this._getContainerById(t[n]).container,u[t[n]]=i&&i.isCollapsed},i.end_refresh=i.end_autorefresh=i.end_addcontacts=i.end_undosendermovetoblocklist=function(n){r.modelUtils.handleEndRefresh(n,this)}}(window.ol,window.originaljQuery||window.jQuery),define(["ol"],function(n){"use strict";function u(n){for(var i=[],t=0;t<n.length;t++)i.push(n[t].categoryId);return i}var i=n.data=n.data||{},r=i.ContainerModel,t;t=r.prototype,t.getkeysfor_addupdatedeletecategories=function(n){var i=n.command,t=n.parameters;t.categoriesToDelete&&t.categoriesToDelete.length?i.isBlocking=!0:t.categoriesToUpdate&&t.categoriesToUpdate.length&&(i.keys=i.keys.concat(u(t.categoriesToUpdate)))}}),function(n,t){"use strict";var r=n.data=n.data||{},u=HM.Status,f=r.MessageListModel=function(){this._fragments={},this._totalCounts={},this._timestamps={}},i=f.prototype;i.register=function(n){n.register("ML",this)},i._getQueryResponse=function(t){var e,c,f,l;HM.assertMessageGroupQuery(t);var o=this,s=t.getMessageListKeyQueryAsString(),h=o._fragments[s],a=o._totalCounts[s],i={status:u.IncompleteNone,query:t,rollup:null,itemsTable:{}};if(h)for(e=0;e<h.length;e++)if(c=h[e],f=c.getPage(t.anchorType,t.getAnchorValue(),t.size,t.includeAnchor,a),f.itemIds.length>0||f.bof||f.eof){i.itemIds=f.itemIds,i.bof=f.bof,i.eof=f.eof,i.view=f.view,i.threaded=f.threaded,l=!f.threaded&&!c.isThreadedList?a:null,i.totalPageCount=l?Math.ceil(l/n.GetAppConfig("MessageListSize")):null,i.timestamp=o._timestamps[s],i.dataHash=r.hashResult(i),i.status=f.complete?u.Complete:u.IncompletePartial;break}return HM.createMessageGroupResult(i)},i._updateId=function(n){var i,u,r,t;i=this._fragments;for(u in i)for(r=i[u],t=0;t<r.length;t++)r[t].updateId(n)},i._updateFragment=function(n,t,i,r,u){var f;var e=this,s=!1,o=e._fragments[n];return f=o[t].updateItemInclusion(i,r.conv,r,u),f.success?f.countChange?e._totalCounts[n]+=f.countChange:e._totalCounts[n]=null:(o.splice(t,1),delete e._totalCounts[n],s=!0),f},i._updateItemInclusion=function(n,t){var i,o,r,h,u;var s=this,f=[],e=s._fragments;for(i in e){for(o=!1,r=0;r<e[i].length;r++)h=e[i],u=s._updateFragment(i,r,n.id,n,t),u.success||(r--,o=!0),u.invalidateMessageGroupQueryChange&&f.push(u.invalidateMessageGroupQueryChange);o&&f.push(HM.createInvalidateMessageListFragmentChange({queryKey:i}))}return f},i.beginCommand=function(n){var t=this,i=n.queries,r=n.changes;t._processChanges(r,i,n.command),t._invalidateQueries(r,i)},i._invalidateList=function(n){var u=this,f=[],i,r,t,e;for(i in u._fragments)for(r=u._fragments[i],t=0;t<r.length;t++)if(e=r[t].list,r[t].isThreadedList===n){delete u._fragments[i],f.push(HM.createInvalidateMessageListFragmentChange({queryKey:i}));break}return f},i._invalidateItem=function(n,i){var f=this,e=[],r,s,o,u,h;for(r in f._fragments)for(s=f._fragments[r],o=0;o<s.length;o++)if(u=s[o],h=u.list,n===u.beginAnchor.id||n===u.endAnchor.id){delete f._fragments[r],e.push(HM.createInvalidateMessageListFragmentChange({queryKey:r})),e.push(HM.createInvalidateMessageGroupQueryChange({queryKey:r,invalidationType:HM.MessageGroupQueryInvalidationType.AnchorChange}));break}else if(t.inArray(n,h)!==-1&&u.isThreadedList===i){delete f._fragments[r],e.push(HM.createInvalidateMessageListFragmentChange({queryKey:r}));break}return e},i.begin_resetsearchcache=function(i){t.merge(i.changes,this._invalidateContainer(n.config.sysFldrs.searchFid))},i.begin_batchmoveitems=i.begin_bulkactions=i.begin_emptyfolder=function(t){n.data.QueryUtils.invalidateAllMessageGroupQueries(t.queries,HM.MessageGroupQueryInvalidationType.AnchorChange)},i._invalidateEverything=function(){return this._fragments={},this._totalCounts={},this._timestamps={},[HM.createInvalidateMessageListModelChange()]},i._invalidateContainer=function(n){var t,f,i,e,u;t=this,f=[];for(i in t._fragments)e=t._fragments[i],u=e[0]&&e[0].messageListKeyQuery,u&&u.containerId!==n&&u.categoryContainerId!==n||(delete t._fragments[i],f.push(HM.createInvalidateMessageListFragmentChange({queryKey:i})));return f},i._processChanges=function(i,u){var s,l,c,h,a,o,y,f;for(s=this,l={},o=0;o<i.length;o++)c=i[o],(c.type===HM.ChangeType.MoveConversation||c.type===HM.ChangeType.MoveMessage)&&(l[r.normalizeId(c.id)]=c,l[r.normalizeId(c.originalMoveId)]=c);for(h=[],a=[],o=0;o<i.length;o++){var f=i[o],v=f.type,e=HM.ChangeType;switch(v){case e.MarkMessage:case e.MarkConversation:case e.MoveMessage:case e.MoveConversation:case e.CategorizeMessage:case e.CategorizeConversation:case e.MarkSafeMessage:(v===e.MoveMessage||v===e.MoveConversation)&&r.QueryUtils.invalidateMessageGroupQueriesByAnchor(u,f.id),r.isChangeProcessedByModel(f,s)||t.merge(h,s._updateItemInclusion(f,l[r.normalizeId(f.id)]));break;case e.Id:s._updateId(f);break;case e.Count:y=r.isFolderId(f.id)?f.id:parseInt(f.id),t.merge(h,s._invalidateContainer(y)),t.merge(h,s._invalidateContainer(n.config.sysFldrs.searchFid));break;case e.InvalidateRollup:case e.InvalidateMessageRollup:a.push(f);break;case e.DeleteFolder:r.QueryUtils.invalidateMessageGroupQueriesByContainer(u,f.folderId);break;case e.DeleteCategory:r.QueryUtils.invalidateMessageGroupQueriesByContainer(u,f.id);break;case e.InvalidateConversationPool:t.merge(h,s._invalidateEverything()),f.invalidateQueries&&r.QueryUtils.invalidateAllAnchoredMessageGroupQueries(u,HM.MessageGroupQueryInvalidationType.InvalidateEverything)}}for(o=0;o<a.length;o++)f=a[o],l[r.normalizeId(f.itemId)]||f.conversationId&&l[r.normalizeId(f.conversationId)]?t.merge(h,s._invalidateItem(f.itemId,f.type===e.InvalidateRollup)):t.merge(h,s._invalidateList(f.type===e.InvalidateRollup));t.merge(i,h)},i.endCommand=function(n){var t,i,r;if(this._processChanges(n.changes,n.queries,n.command),t=n.serverResults,t)for(i=0;i<t.length;i++)r=t[i],r&&r.type===HM.DLReturnType.MessageListData&&this.addMessageListData(r)},i._fixupQuery=function(t){var u=t.anchor,r=t.clone(),i=HM.MessageGroupQueryAnchorType;return(t.anchorType===i.FirstPage||t.anchorType===i.StartId||t.anchorType===i.StartDate)&&(r.size=t.size+n.GetAppConfig("ExtraFetchCount")),t.anchorType!==i.EndId&&t.anchorType!==i.EndDate&&t.anchorType!==i.JumpTo||t.includeAnchor||r.size++,r},i.formatResults=function(n){var t,i,e,a,o,s;var h=n.queries,f=n.serverRequest,c={},l={};for(t=0;t<h.length;t++)i=h[t],i.invalid||i.type!==HM.QueryType.MessageGroupQuery||(e=this._getQueryResponse(i),(e.status!==u.Complete||i.forceFetch)&&(f?(f.queries=f.queries||[],a=this._fixupQuery(i),f.queries.push(a)):e=null),c[i.key()]=e,l[i.getMessageListKeyQueryAsString()]=!0);for(o in this._fragments)if(!(o in l))for(s=this._fragments[o],t=0;t<s.length;t++)s[t].expungeDelayedItems();r.uniqueExtend(n.results,c)},i.addMessageListData=function(n){var e,t,u,o,f,i;if(e=HM.createMessageGroupQuery(n.msgGroupQuery),t=e.getMessageListKeyQueryAsString(),this._totalCounts[t]&&this._totalCounts[t]!==n.totalCount?(delete this._fragments[t],delete this._totalCounts[t]):this._totalCounts[t]=n.totalCount,u=new r.MessageListFragment(e,n),o=this._fragments,t in o){for(f=o[t],i=0;i<f.length;i++)f[i].merge(u)&&(u=f[i],f.splice(i,1),i--);this.addFragment(u)}else this.addFragment(u);this._timestamps[t]=n.lastUpdatedTimestamp},i.addFragment=function(n){var t=n.messageListKeyQuery.stringify(),i=this._fragments[t]=this._fragments[t]||[];i.push(n)},i._invalidateQueries=function(n,t){for(var r,e,o,u,f,i=0;i<t.length;i++)if(r=t[i],e=t[i].type,e===HM.QueryType.MessageGroupQuery)for(o=r.getMessageListKeyQueryAsString(),u=0;u<n.length;u++)f=n[u],f.type===HM.ChangeType.InvalidateMessageGroupQuery&&f.queryKey===o&&(r.invalid=!0,r.setInvalidationType(f.invalidationType))},i.end_refresh=i.end_autorefresh=i.end_addcontacts=i.end_undosendermovetoblocklist=function(n){r.modelUtils.handleEndRefresh(n,this)}}(window.ol,window.originaljQuery||window.jQuery),function(n){"use strict";var t=ol.data=ol.data||{},i=t.MessageListFragment=function(i,r){function p(n){return n===f.StartTimestamp||n===f.StartId||n===f.JumpTo}function c(n){return n===f.EndTimestamp||n===f.EndId}function w(n){return n===f.StartId||n===f.EndId}function b(n){return n===f.StartTimestamp||n===f.EndTimestamp}function k(n,t){var i,r,f=u.list;if(u.messageListKeyQuery.sortOrder===HM.MessageListKeyQuerySortOrder.Ascending){for(i=0;i<f.length;i++)if(r=f[i],u.timestamps[r]>=n)return c(t)||u.timestamps[r]===n?i:i-1}else for(i=f.length;i>=0;i--)if(r=f[i],u.timestamps[r]>=n)return c(t)||u.timestamps[r]===n?i:i+1;return null}function d(n,i){var r,e;if(w(n))return i in u.index?u.index[i]:null;if(b(n)){if(i=t.canonicalizeDate(i),r=u.getTimespan(),r.begin<=i&&i<=r.end)return k(i,n)}else if(n===f.JumpTo)return e=u._jumpToAnchors[i],e in u.index?u.index[e]:null;return null}function g(n,t,i){for(var u,f=[],o=-1,r=0;r<n.length;)if(n[r]in i){var s=i[n[r]],e=[],h=r;for(u=0;s+u<t.length&&r+u<n.length;u++)if(t[s+u]===n[r+u])e.push(n[r+u]);else break;e.length>f.length&&(f=e,o=h),r+=e.length}else r++;return{sequence:f,index:o,otherIndex:i[f[0]]}}function o(t,i,r){var o,f,e;for(r||(o=u.list,u.list=i,i=o),n.merge(u.list,i),r?u.endAnchor=t.endAnchor:u.beginAnchor=t.beginAnchor,n.extend(u._jumpToAnchors,t._jumpToAnchors),u.bof=u.bof||t.bof,u.eof=u.eof||t.eof,f=0;f<u.list.length;f++)e=u.list[f],u.index[e]=f,u.timestamps[e]=u.timestamps[e]||t.timestamps[e]}function a(n){var t,i;for(u.list=n.list,u.endAnchor=n.endAnchor,u.beginAnchor=n.beginAnchor,u._jumpToAnchors=n._jumpToAnchors,u.bof=n.bof,u.eof=n.eof,u.index={},u.timestamps={},t=0;t<u.list.length;t++)i=u.list[t],u.index[i]=t,u.timestamps[i]=n.timestamps[i]}function l(i,r){return i===ol.config.sysCats.flaggedFltid?r.isFlagged:i===ol.config.sysCats.unreadFltid?!r.isRead:n.inArray(i,r.categories)!==-1}function s(t,i){var r=HM.ChangeType,u=[];switch(i.type){case r.MarkMessage:case r.MarkConversation:u=[ol.config.sysCats.unreadFltid];break;case r.FlagMessage:case r.FlagConversation:u=[ol.config.sysCats.flaggedFltid];break;case r.CategorizeMessage:case r.CategorizeConversation:i.apply&&n.merge(u,i.apply),i.remove&&n.merge(u,i.remove)}return n.inArray(t,u)!==-1}function nt(n,i,r,f,e){var h,nt,a,b,ut,k,d,g;HM.assertRollupData(i);var v=!1,o=null,y=u.messageListKeyQuery,tt=y.containerType,p=y.containerId,c=i.rollup,ft=HM.ConversationView.Normal,et=t.ConversationPool.viewFromContainerId;if(tt===HM.ItemListQueryContainerType.Folder)if(h=c.messageIds,h&&h.length>0){for(nt=!1,a=0;a<h.length;a++)if(n.messages[h[a]]){var it=n.messages[h[a]],ot=it.message,w=!1,rt=it.allHeaders;for(b=0;!w&&b<rt.length;b++)w=w||p===rt[b].folderId;if(w){nt=!0;break}}o=nt}else e?(o=c.folderId===p,!o&&f&&f.prevFolderId!==p&&(o=null)):f&&f.prevFolderId===p&&(o=!1);else tt===HM.ItemListQueryContainerType.Category&&(l(u.messageListKeyQuery.categoryContainerId,c)?(ut=f&&et(f.newFolderId)!==ft,o=!ut||t.normalizeId(i.rollup.itemId)!==t.normalizeId(r.id)):(o=!1,v=u.supportsDelayedRemoval&&!f));return k=!0,d=y.filterId,d&&(s(d,r)||o)&&(l(d,c)||(o=!1,v=!f,k=!1)),g=y.excludeFilterId,g&&(s(g,r)||o)&&l(g,c)&&(o=!1,v=!1,k=!1),{isMember:o,delay:v,noop:o===null&&!k}}function tt(i,r){var o,h,c,s,f;if(o=u.list,h=!1,n.inArray(i,o)!==-1)h=!0;else if(u.messageListKeyQuery.sortType===HM.SortBy.Date){if(c=u.timestamps,c[i]=t.canonicalizeDate(r),s=-1,o.length===0&&u.bof&&u.eof)s=0;else for(f=0;f<o.length+1;f++){var y=f===0,p=f===o.length,l=c[u.list[f]],a=y?null:c[u.list[f-1]];if(u.messageListKeyQuery.sortOrder===HM.MessageListKeyQuerySortOrder.Ascending){if(y&&u.bof&&r<=l||a<=r&&r<=l||p&&u.eof&&a<=r){s=f;break}}else if(y&&u.bof&&r>=l||a>=r&&r>=l||p&&u.eof&&a>=r){s=f;break}}s!==-1&&o.splice(s,0,i),h=!0}return h&&v(),f=n.inArray(i,e),f!==-1&&e.splice(f,1),h}function h(t){var i=n.inArray(t,u.list);return i!==-1&&(u.list.splice(i,1),delete u.timestamps[t],v()),!0}function it(t){return n.inArray(t,u.list)!==-1&&e.push(t),!0}function v(){var t,n,i;for(u.index={},t=u.list,n=0;n<t.length;n++)i=t[n],u.index[i]=n}function y(n,i,r,f,e,o){var s,c,l;return s=null,c=null,f&&(l=f.rollup,c=nt(r,f,i,e,o),c.noop?(s=!0,c=null):c.isMember===null?s=!1:c.isMember?s=l.senderInfos?tt(n,l.timestampInMillisecondsSinceEpoch):!1:(s=!0,c.delay?it(n):h(n))),!s&&e&&(u.isThreadedList&&t.isConversationId(n)&&t.normalizeId(e.originalMoveId)!==t.normalizeId(n)?s=!1:e.newFolderId===u.messageListKeyQuery.containerId?s=!1:e.prevFolderId===u.messageListKeyQuery.containerId?s=h(n):u.messageListKeyQuery.categoryContainerId!==null&&e.changingView?s=t.ConversationPool.viewFromContainerId(e.newFolderId)===HM.ConversationView.Normal?!1:h(n):(s=!0,c=null)),{success:s}}function rt(){for(var o,e=u.list=r.itemList.slice(0),n=0;n<e.length;n++)o=e[n],u.index[o]=n,u.timestamps[o]=t.canonicalizeDate(r.itemMap[o].rollup.timestampInMillisecondsSinceEpoch);u.bof=r.bof,u.eof=r.eof,u.supportsDelayedRemoval=i.supportsDelayedRemoval,u.messageListKeyQuery=i.getMessageListKeyQuery(),u.isThreadedList=r.threaded;switch(i.anchorType){case f.StartTimestamp:u.beginAnchor.type=f.StartTimestamp,u.beginAnchor.timestamp=i.anchorDate;break;case f.EndTimestamp:u.endAnchor.type=f.EndTimestamp,u.endAnchor.timestamp=i.anchorDate;break;case f.StartId:u.beginAnchor.type=f.StartId,u.beginAnchor.id=i.anchor;break;case f.EndId:u.endAnchor.type=f.EndId,u.endAnchor.id=i.anchor;break;case f.JumpTo:u.beginAnchor.type=f.JumpTo,u.beginAnchor.jumpToAnchor=i.jumpToAnchor,u._jumpToAnchors[i.jumpToAnchor]=e[0];break;case f.FirstPage:u.beginAnchor.type=f.FirstPage;break;case f.LastPage:u.endAnchor.type=f.LastPage}}var u=this,e,f;u.list=null,u.bof=!1,u.supportsDelayedRemoval=!0,u.eof=!1,u.messageListKeyQuery=null,u.index={},u.timestamps={},u.beginAnchor={},u.endAnchor={},u.isThreadedList=!1,u._jumpToAnchors={},e=[],f=HM.MessageGroupQueryAnchorType,u.getTimespan=function(){var t=864e13,i=-864e13,r=u.timestamps,f,n;for(f in r)n=r[f],n>i&&(i=n),n<t&&(t=n);return{begin:t,end:i}},u.merge=function(n){var t=g(u.list,n.list,n.index),i=!0;return t.index===-1?u.beginAnchor.type===f.StartId&&u.beginAnchor.id===n.list[n.list.length-1]||n.endAnchor.type===f.EndId&&n.endAnchor.id===u.list[0]?o(n,n.list,!1):u.endAnchor.type===f.EndId&&u.endAnchor.id===n.list[0]||n.beginAnchor.type===f.StartId&&n.beginAnchor.id===u.list[u.list.length-1]?o(n,n.list,!0):u.beginAnchor.type===f.FirstPage&&n.beginAnchor.type===f.FirstPage||u.endAnchor.type===f.LastPage&&n.endAnchor.type===f.LastPage?a(n):i=!1:t.index===0&&t.otherIndex+t.sequence.length===n.list.length?o(n,n.list.slice(0,n.list.length-t.sequence.length),!1):t.index+t.sequence.length===u.list.length&&t.otherIndex===0?o(n,n.list.slice(t.sequence.length),!0):t.index===0&&u.list.length===t.sequence.length&&t.otherIndex>0&&n.list.length>t.sequence.length?(u.list=n.list.slice(0),o(n,[],!0)):t.index>0&&u.list.length>t.sequence.length&&t.otherIndex===0&&n.list.length===t.sequence.length?o(n,[],!0):a(n),i},u.updateItemInclusion=function(i,r,f,e){var a,ut,ft,d;var et=u.list.length,v=null,o=!1,g=null,c,h=i,l=u.messageListKeyQuery,p=l.filterId,w=l.excludeFilterId,ot=!p||!s(p,f),st=!w||!s(w,f),nt=l.containerType,tt=l.categoryContainerId,b=u.messageListKeyQuery.containerId,k=ot&&st,it=nt===HM.ItemListQueryContainerType.Category&&!s(tt,f),rt=t.ConversationPool.viewFromContainerId(b||tt);if(i===u.beginAnchor.id||i===u.endAnchor.id?(o=!1,g=HM.createInvalidateMessageGroupQueryChange({queryKey:u.messageListKeyQuery.stringify(),invalidationType:HM.MessageGroupQueryInvalidationType.AnchorChange})):b===HM.FilterType.Other||u.messageListKeyQuery.excludeFilterId===HM.FilterType.Other||u.messageListKeyQuery.filterId===HM.FilterType.Other||b===ol.config.sysFldrs.searchFid?o=!1:k&&!e&&nt!==HM.ItemListQueryContainerType.Category?o=!0:w&&p&&w===p?o=!0:k&&it&&!e?o=!0:k&&it&&e&&t.ConversationPool.viewFromContainerId(e.newFolderId)===HM.ConversationView.Normal&&t.ConversationPool.viewFromContainerId(e.prevFolderId)===HM.ConversationView.Normal?o=!0:e&&t.ConversationPool.viewFromContainerId(e.newFolderId)!==rt&&t.ConversationPool.viewFromContainerId(e.prevFolderId)!==rt?o=!0:u.isThreadedList?(a=t.ConversationPool.viewFromContainerId(l.containerId),c=r.rollups[a],h=f.threadedListId,h&&(a=t.ConversationPool.viewFromContainerId(u.messageListKeyQuery.containerId),c=r.rollups[a],h=f.threadedListId,h?(v=y(h,f,r,c,e,t.isMessageAsConversationId(h)),o=v.success,o===null&&n.inArray(h,u.list)!==-1&&(o=!1)):o=!1)):u.isThreadedList||t.isConversationId(i)||(ut=t.getMid(i),h=t.makeMessageAsConversation(ut),c=r.messageRollups[h],v=y(h,f,r,c,e,!0),o=v.success,o===null&&(o=!1)),ft=u.isThreadedList?null:u.list.length-et,n.inArray(h,u.list)===-1)for(d in u._jumpToAnchors)u._jumpToAnchors[d]===h&&delete u._jumpToAnchors[d];return{success:o,countChange:ft,invalidateMessageGroupQueryChange:g}},u.updateId=function(i){var r=t.isMessageId(i.oldId)?t.makeMessageAsConversation(i.oldId):i.oldId,f=t.isMessageId(i.newId)?t.makeMessageAsConversation(i.newId):i.newId,e=n.inArray(r,u.list);e!==-1&&(u.list[e]=f,u.index[f]=e,u.timestamps[f]=u.timestamps[r],delete u.index[r],delete u.timestamps[r])},u.expungeDelayedItems=function(){for(var n=0;n<e.length;n++)h(e[n]);e=[]},u.getPage=function(n,i,r,e,o){var e=e||n===f.JumpTo,v=i?d(n,i):null,y=u.list,w=y.length,s=null,h=null,l=null,a=!0;return v===null&&n!==f.FirstPage&&n!==f.LastPage?(s=[],a=!1):p(n)?(e||v++,h=v,l=Math.min(v+r,w),s=y.slice(h,l),s.length<r&&!u.eof&&(a=!1)):c(n)?(e||v--,h=Math.max(v+1-r,0),l=v+1,s=y.slice(h,l),s.length<r&&!u.bof&&(a=!1)):n===f.FirstPage?u.bof?(h=0,l=Math.min(r,w),s=y.slice(h,l),s.length<r&&!u.eof&&(a=!1)):(s=[],a=!1):n===f.LastPage&&(u.eof?(typeof o!="number"||u.isThreadedList||(r=o%ol.GetAppConfig("MessageListSize")),h=Math.max(w-r,0),l=w,s=y.slice(h,l),s.length<r&&!u.bof&&(a=!1)):(s=[],a=!1)),{itemIds:s,complete:a,bof:u.bof&&h===0,eof:u.eof&&l===w,view:t.ConversationPool.viewFromContainerId(u.messageListKeyQuery.containerId),threaded:u.isThreadedList}},rt()}}(window.originaljQuery||window.jQuery),function(n,t){"use strict";function u(n){if(n)for(var t=0;t<n.length;t++)n[t].Conditions=s(n[t].Conditions),n[t].Actions=f(n[t].Actions);return n}function o(n){if(n)for(var t=0;t<n.length;t++)n[t].IsComplicated||(n[t].Conditions=h(n[t].Conditions),n[t].Actions=c(n[t].Actions));return n}function s(n){for(var i=HM.createFilterConditionMarshallingContainer(),t=0;t<n.length;t++)switch(n[t].Type){case HM.FilterConditionType.Sender:case HM.FilterConditionType.Recipient:case HM.FilterConditionType.Subject:case HM.FilterConditionType.Keywords:i.AqsConditions.push(n[t]);break;case HM.FilterConditionType.SenderAddress:i.SenderAddressConditions.push(n[t]);break;case HM.FilterConditionType.HasAttachments:case HM.FilterConditionType.IsUnread:case HM.FilterConditionType.HasBeenRepliedTo:case HM.FilterConditionType.IsFlagged:i.BooleanConditions.push(n[t]);break;case HM.FilterConditionType.HasCategory:case HM.FilterConditionType.DoesNotHaveCategory:i.CategoryConditions.push(n[t]);break;case HM.FilterConditionType.Folder:i.FolderConditions.push(n[t]);break;case HM.FilterConditionType.LegacyHeaderSearchFilter:i.HeaderSearchFilterConditions.push(n[t])}return i}function h(n){var r,u,f,t,i;r=[],u=["Aqs","SenderAddress","Boolean","Category","Folder","HeaderSearchFilter"];for(f in u)if(t=n[u[f]+"Conditions"],t)for(i=0;i<t.length;i++)r.push(t[i]);return r}function f(n){for(var i=HM.createMailActionMarshallingContainer(),t=0;t<n.length;t++)switch(n[t].Type){case HM.MailActionType.Move:i.MoveActions.push(n[t]);break;case HM.MailActionType.Mark:i.MarkActions.push(n[t]);break;case HM.MailActionType.Flag:i.FlagActions.push(n[t]);break;case HM.MailActionType.Forward:i.ForwardActions.push(n[t]);break;case HM.MailActionType.AssignCategory:case HM.MailActionType.RemoveCategory:i.CategorizeActions.push(n[t])}return i}function c(n){var r,u,f,t,i;r=[],u=["Move","Mark","Flag","Forward","Categorize"];for(f in u)if(t=n[u[f]+"Actions"],t)for(i=0;i<t.length;i++)r.push(t[i]);return r}var r=n.data=n.data||{},e=r.RulesModel=function(){this._rules=null},i=e.prototype;i._invalidateEverything=function(){this._rules=null},i._getRulesByQuery=function(n){var t={query:n,type:HM.ResultType.Rules,status:HM.Status.IncompleteNone};return this._rules&&(t.status=HM.Status.Complete,t.rules=this._rules),HM.createRulesResult(t)},i._getQueryResponse=function(n,t){for(var i,u,f={},r=0;r<n.length;r++)i=n[r],i.type===HM.QueryType.RulesQuery&&(u=this._getRulesByQuery(i),(u.status!==HM.Status.Complete||i.forceFetch)&&(t?(t.queries=t.queries||[],t.queries.push(i)):u=null),f[i.key()]=u);return f},i.endCommand=function(n){if(n.serverResults)for(var t=0;t<n.serverResults.length;t++)n.serverResults[t]&&n.serverResults[t].type===HM.DLReturnType.Rules&&(this._rules=o(n.serverResults[t].rules))},i.begin_createrecipientmoverule=i.begin_reorderrules=function(){this._invalidateEverything()},i.begin_addupdatedeleterules=function(n){n.command.args.rulesToAdd=u(n.command.args.rulesToAdd),n.command.args.rulesToEdit=u(n.command.args.rulesToEdit),this._invalidateEverything()},i.begin_undocategorizeitems=i.begin_categorizeitems=i.begin_bulkactions=function(n){n.command.args.actions=f(n.command.args.actions)},i.begin_deletefolder=function(n){var t=n.command.args.folderId,i=this.findRuleSatisfyingCriteria(function(n){return n.Type===HM.FilterConditionType.Folder&&n.FolderID===t},function(n){return n.Type===HM.MailActionType.Move&&n.FolderID===t});i&&this._invalidateEverything()},i.begin_addupdatedeletecategories=function(n){var i=n.command.args.categoriesToDelete,r,u,f;if(i&&i.length>0){for(r=!1,u=0;u<i.length;u++)if(f=i[u],r=this.findRuleSatisfyingCriteria(function(n){return(n.Type===HM.FilterConditionType.HasCategory||n.Type===HM.FilterConditionType.DoesNotHaveCategory)&&t.inArray(f,n.CategoryIDs)>=0},function(n){return(n.Type===HM.MailActionType.AssignCategory||n.Type===HM.MailActionType.RemoveCategory)&&t.inArray(f,n.CategoryIDs)>=0}),r)break;r&&this._invalidateEverything()}},i.findRuleSatisfyingCriteria=function(n,t){var i=!1,u,r,f,o,e,s;if(this._rules)for(u=0;u<this._rules.length;u++){if(r=this._rules[u],!i&&n)for(f=0;f<r.Conditions.length;f++)if(o=r.Conditions[f],n(o)){i=!0;break}if(!i&&t)for(e=0;e<r.Actions.length;e++)if(s=r.Actions[e],t(s)){i=!0;break}}return i},i.formatResults=function(n){var t=this._getQueryResponse(n.queries,n.serverRequest);r.uniqueExtend(n.results,t)},i.register=function(n){n.register("RM",this)}}(window.ol,window.originaljQuery||window.jQuery),function(){"use strict";var f=window.ol=window.ol||{},n=ol.data=ol.data||{},u=n.fpp=n.fpp||{},t=u.FppEngine,e=window.ActionQueue,r=window.ActionQueueTypes.ActionType,i={fppMethod:"GetInboxData",shouldMakeFppCall:function(n){return n.queries&&n.queries.length>0},tokenConfig:{friendlyName:"refreshInbox",actionType:function(t,i){var f=n.FppUtils.getConversationQueries(i.itemListQueries),e=!1,u;if(f)for(u=0;u<f.length;u++)if(f[u].prefetch){e=!0;break}return e?r.prefetch:r.view},getTokenKeys:function(t,i){var r=[],u=n.FppUtils.getConversationQueries(i.itemListQueries),f=n.FppUtils.getMessageQueries(i.itemListQueries),e=i.messageGroupQueries,o=i.optionsQueries;return u&&u.length===1&&(r.push(u[0].containerId),r.push(u[0].folderId)),f&&f.length===1&&r.push(f[0].containerId),e&&e.length===1&&r.push(e[0].folderId),o&&o.length>0&&r.push("getuseroptions"),r}},cmdArgs:[]};t.registerFppConfig("get",i),t.registerFppConfig("refresh",i),t.registerFppConfig("autorefresh",i)}(),function(n,t){"use strict";function ut(){return{control:null,isSelectionRoot:!1,isMultiselectEnabled:!0,isAutoselectEnabled:!0,isSelectable:!0,selectedSubcontrols:[],removedSelectedSubControls:[],addedSelectedSubControls:[]}}function f(n){return n.IsSelectable&&!w(n)&&(n.Control.isCurrentlySelectable?n.Control.isCurrentlySelectable():!0)}function w(n){return n.Control&&n.Control.data&&typeof n.Control.data.preparedToRemove=="function"&&n.Control.data.preparedToRemove()}function b(t){var r,u,i;for(r=[t],u=n.findChildTag(t),i=0;i<u.length;i++)u[i].selection&&(r=r.concat(b(u[i])));return r}function k(n){for(var t=l(n);t&&!f(t.selection);)t=l(t);return t}function d(n){for(var t=a(n);t&&!f(t.selection);)t=a(t);return t}function l(i){var r,o,u,s,e,f;if(r=i.parent,!i.selection||i.selection.IsSelectionRoot||!r||!r.selection)return null;for(o=n.findChildTag(r),s=t.inArray(i,o),e=s-1;e>=0&&!u;e--)f=o[e],f.selection&&(u=v(f,HM.AutoSelectType.Last,!1));return u||(u=r),u}function a(i){var u,r,e,f,o;if(!i||!i.selection)return null;for(u=n.findChildTag(i),r=0;r<u.length;r++)if(e=u[r],e.selection)return e;for(f=i.parent;f&&f.selection;i=f,f=f.parent){for(u=n.findChildTag(f),o=t.inArray(i,u),r=o+1;r<u.length;r++)if(u[r].selection)return u[r];if(f.selection.IsSelectionRoot)break}return null}function v(t,i,r){var o,e,u;if(o=n.findChildTag(t),i===HM.AutoSelectType.First){for(u=0;u<o.length;u++)if(e=g(o[u],i,r),e&&f(e.selection))return e}else if(i===HM.AutoSelectType.Last)for(u=o.length-1;u>=0;u--)if(e=g(o[u],i,r),e&&f(e.selection))return e;return f(t.selection)?t:null}function g(n,t,i){if(!n.selection||i&&!n.selection.IsAutoselectEnabled)return null;var r=v(n,t,i);return r||n}function e(n){while(!n.selection.IsSelectionRoot)n=n.parent;return n}function ft(i,r){var e,u,f,o;if(e=!1,i===r)return e;for(u=i.parent,f=i;u&&u.selection;f=u,u=u.parent)u.childIndex=t.inArray(f,n.findChildTag(u));for(u=r.parent,f=r;u&&u.selection;f=u,u=u.parent)if(typeof u.childIndex!="undefined"){o=t.inArray(f,n.findChildTag(u)),e=u.childIndex<o;break}for(u=i.parent,f=i;u&&u.selection;f=u,u=u.parent)delete u.childIndex;return e}function et(n,t,i){for(var f=[],r=t;r&&r!==i;)f.push(r),r=n===u.eDirection.next?a(r):l(r);return r?r===i&&f.push(r):f=[],f}function ot(n,t,i){var e,u,r,f;for(e=i===n,u=!1,e&&t.length>0&&(u=t[t.length-1]===i),r=i;!u&&!e&&r;r=r.Control.parent?r.Control.parent.selection:null){for(f=0;f<t.length;f++)if(t[f]===r){u=!0;break}else if(r.Control.parent&&t[f]===r.Control.parent.selection){t.splice(f,1,i),u=!0;break}e=r===n}u||t.push(i)}function nt(n,t,i,r,u){ot(n,t,i),r.Selected&&!u.selected?i.RemovedSelectedSubControls.push(r):u.selected&&i.AddedSelectedSubControls.push(r)}function tt(n,i,r){for(var e,f,u=0;u<r.length;u++)e=r[u],f=t.inArray(e,i),f===-1&&n?i.push(e):f===-1||n||i.splice(f,1)}function h(n,t,i){var r=n.focusControl;r&&r!==t&&it(r,!1),n.focusControl=t,r=n.focusControl,n.Control.focusedControl(t),t&&(it(t,!0),typeof t.focus=="function"&&i&&t.focus())}function it(n,t){s&&(clearTimeout(s),s=null),n.focused(t),s=setTimeout(function(){n.data&&n.data.focused(t)},0)}function st(n,t,i){n.selected(t),n.checked(i);var r=n.data;r&&(r.selected(t),r.checked(i))}function ht(n){for(var i=[],u=n.SelectedSubcontrols,f,r,e,t=0;t<u.length;t++)i.push(u[t].Checked);for(f=n.pendingChanges,t=0;t<f.length;t++)r=f[t],e=u.indexOf(r.node.Control),e!==-1?i.splice(e,1):r.selected&&i.push(r.checked);return i.length===1&&!i[0]}function rt(n,t,i,r){var c,o,f,l,s,e;if(r=r||{},c=ht(t),(n.clearAllSelected||c&&!n.changeFocusOnly)&&t._clear(t),t.selectArgs=r,n.updatesAnchor&&(t.anchorControl=i),o=!0,r&&r.skipFocus&&(o=!1),n.name!=="unselectBatch"&&h(t,i,o),f=!0,n.name==="focus"?f=i.selected():(n.name==="unselect"||n.name==="uncheck"||n.name==="unselectBatch")&&(f=!1),n.isMultiSelect)for(l=ft(t.anchorControl,i)?u.eDirection.next:u.eDirection.prev,s=et(l,t.anchorControl,i),e=0;e<s.length;e++)s[e].selection._setSelectionState(f,f,t);else n.name!=="focus"&&n.name!=="focusPrev"&&n.name!=="focusNext"&&i.selection._setSelectionState(f,!1,t);r.targetControl=i,t._applyAllPendingChanges(r)}var y={selected:!1,focused:!1,checked:!1},s=null,p={focusedControl:null},u=n.Selection=function(t){var i=this,r,u,f;i._queueChanges=!1,i.initAccessorValues(t),r=i.Control,u={};for(f in y)typeof r[f]=="undefined"&&(u[f]=!1);n.InitAccessorValues(r,u),i.isSelectionRoot()?(i.pendingChanges=[],n.InitAccessorValues(r,p)):i.IsAutoselectEnabled=i.IsAutoselectEnabled&&r.parent.selection.IsAutoselectEnabled},i=u.prototype,r,c,o;for(u.CreateSelectablePropertiesAccessors=function(t){n.CreateMissingAccessors(t,y)},u.CreateSelectableRootControlAccessors=function(t){n.CreateMissingAccessors(t,p)},i.reset=function(){this.anchorControl=null;var t=e(this.Control),n=t.selection;n.isResetting=!0,h(n,null,!0),n._controlsInitialized&&n.unselectAll(),t.pendingChanges=[],n._controlsInitialized=!1,n.SelectedSubcontrols=[],n.isResetting=!1},i.batchModeEnabled=function(){var n=e(this.Control).selection;return n._queueChanges},i.autoSelect=function(n,t){var i=this.getAutoselectControl(n);return i?(t=t||{},t.skipHistory=!0,i.selection.select(t),!0):!1},i.getAutoselectControl=function(n){return n===HM.AutoSelectType.None?null:v(this.Control,n,!0)},i.selectAll=function(){this._setAll(!0)},i.unselectAll=function(){this._setAll(!1)},i.beginBatch=function(){var n=e(this.Control).selection;n._queueChanges=!0},i.endBatch=function(){var n=e(this.Control).selection;n._queueChanges=!1,n.pendingChanges.length>0&&n._applyAllPendingChanges()},i._setAll=function(n){for(var t=e(this.Control).selection,u=b(this.Control),o=null,r,s,i=0;i<u.length;i++)r=u[i].selection,s=w(r),(f(r)||!n&&s)&&(r._setSelectionState(n,n,t),o||s||!r.IsAutoselectEnabled||(o=u[i]));t._applyAllPendingChanges(),n&&(t.anchorControl=o),t.anchorControl&&n&&h(t,t.anchorControl,!0)},i._applyAllPendingChanges=function(t){var u=this,s,r,h,o,l,a,c;if(!u._queueChanges){for(u._controlsInitialized=!0,s=[],h=u.pendingChanges,r=0;r<h.length;r++){var f=h[r],i=f.node,e=i.Control,v=e;if(i===u)nt(u,s,u,e,f);else for(o=e.parent;o;o=o.parent)if(l=o.selection,nt(u,s,l,e,f),v=o,l===u)break}for(r=0;r<h.length;r++)f=h[r],e=f.node.Control,st(e,f.selected,f.checked);for(r=0;r<s.length;r++)i=s[r],a=t||i.selectArgs,delete i.selectArgs,c=i.SelectedSubcontrols.slice(0),tt(!0,c,i.AddedSelectedSubControls),tt(!1,c,i.RemovedSelectedSubControls),i.SelectedSubcontrols=c,n.Cmd("sel.selectedcontrols").bubble(i.Control,{selectedControls:i.SelectedSubcontrols,unselectedControls:i.RemovedSelectedSubControls,selectArgs:a}),i.RemovedSelectedSubControls=[],i.AddedSelectedSubControls=[];u.pendingChanges=[]}},i._clear=function(n){for(var u,r,i=this.SelectedSubcontrols,t=0;t<i.length;t++)u=i[t].selection,u._setSelectionState(!1,!1,n);for(t=0;t<n.pendingChanges.length;t++)r=n.pendingChanges[t],r.selected=!1,r.checked=!1},i._setSelectionState=function(n,t,i){var r,u,f,e;if(r=this,r.IsSelectable){for(u=i.pendingChanges=i.pendingChanges||[],f=0;f<u.length;f++)if(e=u[f],e.node===r){e.selected=n,e.checked=t;return}(r.Control.Selected!==n||r.Control.Checked!==t)&&u.push({node:r,selected:n,checked:t})}},i._getTargetControl=function(t,i){var o,r,e;return o=this,r=o.Control,o===i&&(r=i.focusControl||i.Control),i.anchorControl=i.anchorControl||r,e=r,!i.focusControl&&f(e.selection)?i.anchorControl=e:t.direction===u.eDirection.next?e=d(r):t.direction===u.eDirection.prev&&(e=k(r)),e||n.Cmd("sel.scopeexceeded").bubble(r,{control:o,direction:t.direction,name:t.name}),e},i._select=function(n,t){var f,i,r,u;return(f=this,i=f.Control,!i.parent&&!i.getOnAfterLinkPromise&&!f.IsSelectionRoot)?!1:(r=e(i).selection,n.isMultiSelect&&!r.IsMultiselectEnabled)?!1:(u=f._getTargetControl(n,r),u&&(i.getOnAfterLinkPromise?i.getOnAfterLinkPromise().then(function(){rt(n,r,u,t)}):rt(n,r,u,t)),!!u)},n.AddOptionsAccessorAndInitFunctions(i,ut),u.batchUpdate=function(n,t,i){for(var u=n[0],d=u?u.getRowIndex():-1,p=u?u.getGroupIndex():-1,l=n.length,g=!1,r,o,w,s,b,c,a,k,y,v=0;v<n.length;v++){if(r=n[v],o=r.data,!r.selection)return;(p<r.getGroupIndex()||p===r.getGroupIndex()&&r.getRowIndex()>d)&&(u=r,d=u.getRowIndex(),p=u.getGroupIndex()),o.preparedToRemove()&&(r.focused()&&(g=!0),r.selection.unselectBatch(),l--),w=i[o.id()]||i[o.conversationId()],w&&(s=t(w),s&&s.selection&&f(s.selection)&&(o.checked()?(l++,s.selection.check()):o.selected()&&(l++,s.selection.selectBatch())))}if(l&&g){for(b=n.length-1,c=-1,a=b;a>=0;a--)if(n[a].focused()){c=a;break}c!==-1&&(k=n[c===b?c--:c++],y=e(k),y&&y.selection&&h(y.selection,k,!0))}return{selectedCount:l,lastControl:u}},i.peekPrevControl=function(n){return k(n)},i.peekNextControl=function(n){return d(n)},u._test_getSelectionRootControl=e,u.eDirection={next:"next",prev:"prev",none:"none"},r=u.eDirection,c=[{name:"select",updatesAnchor:!0,direction:r.none,clearAllSelected:!0},{name:"unselect",updatesAnchor:!0,direction:r.none},{name:"selectNext",updatesAnchor:!0,direction:r.next,clearAllSelected:!0},{name:"selectPrev",updatesAnchor:!0,direction:r.prev,clearAllSelected:!0},{name:"check",updatesAnchor:!0,direction:r.none,isMultiSelect:!0},{name:"uncheck",updatesAnchor:!0,direction:r.none,isMultiSelect:!0},{name:"selectBatch",updatesAnchor:!0,direction:r.none,isBatch:!0},{name:"unselectBatch",updatesAnchor:!0,direction:r.none,isBatch:!0},{name:"selectTo",direction:r.none,isMultiSelect:!0,clearAllSelected:!0},{name:"selectMultiPrev",direction:r.prev,isMultiSelect:!0,clearAllSelected:!0},{name:"selectMultiNext",direction:r.next,isMultiSelect:!0,clearAllSelected:!0},{name:"focus",toggleSelection:!0,updatesAnchor:!0,direction:r.none,isMultiSelect:!1,changeFocusOnly:!0},{name:"focusPrev",updatesAnchor:!0,direction:r.prev,isMultiSelect:!1,changeFocusOnly:!0},{name:"focusNext",updatesAnchor:!0,direction:r.next,isMultiSelect:!1,changeFocusOnly:!0}],o=0;o<c.length;o++)i[c[o].name]=function(n){return function(t){return this._select(n,t)}}(c[o])}(window.ol,window.originaljQuery||window.jQuery),function(n){"use strict";function a(){return{name:"",unreadCount:0,totalCount:0,count:0,id:null,containerType:HM.ContainerType.Folders,isCollapsed:!1,properties:0,visibility:0,isPending:!1,isUncommitted:!1,isEditing:!1,isFilter:!1,isQuickview:!1,folderType:HM.FolderType.SYSTEM,isArchive:!1,visibleWhenSelected:!1,isDragAllowed:undefined,showCount:undefined,selectionState:i.vm.Container.ContainerSelection.NONE,selected:!1,items:[],selectedItems:[],depth:1,parentContainer:null,error:null,search:null,pendingName:null,editEntryPoint:-1,shouldReceiveFocus:!1}}function c(n){for(var i=0,t=n.parentContainer();t;)i++,t=t.parentContainer();return i}var i=window.ol=window.ol||{},u=i.vm=i.vm||{},f=i.config.sysCats,r=i.config.sysFldrs,s=null,h=null,l=-32768,o={},e,t;o[HM.FolderError.EmptyName]="Error.Folder.FolderNameEmpty",o[HM.FolderError.InvalidCharacters]="Error.Folder.FolderNameContainsInvalidChars",o[HM.FolderError.DuplicateName]="Error.Folder.FolderNameInUse",o[HM.FolderError.SystemName]="Error.Folder.FolderNameIsSystemFolderName",o[HM.FolderError.TooLong]="Error.Folder.FolderNameTooLong",e=u.Container=function(n){var t=this;t.initAccessorValues(n),t.IsSearch=!!(n&&n.isSearch),i.SilentlyRefreshProperty(t,"count"),i.SilentlyRefreshProperty(t,"isDragAllowed"),i.SilentlyRefreshProperty(t,"hasEditingChildren"),i.SilentlyRefreshProperty(t,"isQuickview"),i.SilentlyRefreshProperty(t,"showCount"),i.SilentlyRefreshProperty(t,"isFilter"),t.SortIndex=n&&n.sortIndex},e.ContainerSelection={NONE:-1,OFF:0,ON:1,MIXED:2,PARENT_ON:3},e.CountType={Unread:0,Total:1},e.GetErrorMessage=function(n){return o[n.code]},t=e.prototype,i.AddOptionsAccessorAndInitFunctions(t,a),i.Selection.CreateSelectablePropertiesAccessors(t),t.SortIndex=0,t.count=function(n){var t=this;return i.Accessor(t,"Count",n,function(){return t.countType()===e.CountType.Unread?t.UnreadCount:t.TotalCount})},t.countType=function(){return e.CountType[this.Id===r.draftsFid||this.Id===i.config.sysCats.flaggedFltid?"Total":"Unread"]},t.isCategory=function(){return this.ContainerType===HM.ContainerType.Categories},t.isFolder=function(){return this.ContainerType===HM.ContainerType.Folders},t.isSearch=function(){return this.IsSearch},t.isFilter=function(n){var t=this;return i.Accessor(t,"IsFilter",n,function(){return t.isCategory()&&!!(t.Visibility&HM.CategoryVisibility.Filter)})},t.isQuickview=function(n){var t=this;return i.Accessor(t,"IsQuickview",n,function(){return t.isCategory()&&!!(t.Visibility&HM.CategoryVisibility.QuickView)})},t.isDragAllowed=function(n){var t=this;return i.Accessor(t,"IsDragAllowed",n,function(){return t.isFolder()&&t.FolderType!==HM.FolderType.SYSTEM&&!t.isArchive()&&!t.IsPending})},t.isDeleteAllowed=t.isRenameAllowed=function(){var n=this,t=!1;return n.isFolder()?t=!n.IsPending&&(n.folderType()===HM.FolderType.USER_DEFINED||n.folderType()===HM.FolderType.AGGREGATED):n.isCategory()&&(t=!n.IsPending&&u.Container.isPersonalCategory(n.Id)),t},t.isChildAllowed=function(){return this.isFolder()&&!this.isSearch()},t.isEmptyAllowed=function(){return!this.isFolder()||!this.isSearch()},t.isCustomizable=function(){return this.isCategory()&&(this.Properties&HM.CategoryProperties.IsCustomizable)>0},t.isCategorizable=function(){return this.isCategory()&&(this.Properties&HM.CategoryProperties.IsCategorizable)>0},t.isSearchable=function(){var n=this,t=n.isFolder()&&!n.isSearch()&&n.id()!==r.junkFid&&n.id()!==r.trashFid,i=n.isCategory()&&(n.isCustomizableSystemCategory()||n.isPersonalCategory());return t||i},t.canBeRuleAction=function(){var n=this,t=n.isFolder()&&!n.isArchive()&&!n.isSearch()&&n.id()!==r.junkFid&&n.id()!==r.draftsFid&&n.id()!==r.sentFid&&n.id()!==r.trashFid,i=n.isCategorizable()||n.isEditing();return t||i},t.canBeRuleCondition=function(){var n=this,t=n.isFolder()&&!n.isSearch(),i=n.isCategory()&&(n.isCustomizableSystemCategory()&&n.id()!==f.flaggedFltid&&n.id()!==f.unreadFltid||n.isPersonalCategory());return t||i},t.isValidMoveToFolder=function(){return!this.isSearch()},t.showCount=function(n){var t=this;return i.Accessor(t,"ShowCount",n,function(){return!t.isFolder()||t.Id!==r.sentFid&&t.Id!==r.searchFid&&!t.isArchive()&&t.Id!==r.trashFid})},t.isArchive=function(n){var t=this,r=i.Accessor(t,"IsArchive",n,function(){return t.isFolder()&&t.IsArchive});return n!==undefined&&(i.RefreshProperty(t,"isDragAllowed"),i.RefreshProperty(t,"showCount")),r},t.hasEditingChildren=function(){var n=this;return n.Items&&n.Items.length&&n.Items[0].isUncommitted()},t.expandCollapseTooltip=function(){var t=this,n=null;return n=t.ContainerType===HM.ContainerType.Folders?"ExpandCollapse.Tooltip.ItemName.Folders":"ExpandCollapse.Tooltip.ItemName.QuickViews",i.GetString("ExpandCollapse.Tooltip.Label").format(i.GetString(n))},t.setVisibilityFlag=function(n,t){var r=this;r.visibility(t?r.visibility()|n:r.visibility()&~n),i.RefreshProperty(r,"isFilter"),i.RefreshProperty(r,"isQuickview")},t.setFilterVisibility=function(n){var t=this;t.setVisibilityFlag(HM.CategoryVisibility.Filter,n)},t.setQuickViewVisibility=function(n){var t=this;t.setVisibilityFlag(HM.CategoryVisibility.QuickView,n)},t.isVisibleInLeftNav=function(){var n=this;return n.depth()>0&&(n.isFolder()||n.isQuickview())},t.showChevron=function(){return!this.hasEditingChildren()},t.hasVisibleName=function(){var n=this;return n.name()!==""},t.isCustomizableSystemCategory=function(){var n=this;return n.hasVisibleName()&&u.Container.isSystemCategory(n.id())&&!(n.Properties&HM.CategoryProperties.IsHidden)&&n.isCustomizable()},t.isPersonalCategory=function(){var n=this;return n.isCategory()&&u.Container.isPersonalCategory(n.id())},t.isPending=function(n){var t=this,r;return r=i.Accessor(t,"IsPending",n),n!==undefined&&i.RefreshProperty(t,"isDragAllowed"),r},t.folderType=function(n){var t=this,r;return r=i.Accessor(t,"FolderType",n),n!==undefined&&i.RefreshProperty(t,"isDragAllowed"),r},t.totalCount=function(n){var t=this,r;return r=i.Accessor(t,"TotalCount",n),n!==undefined&&i.RefreshProperty(t,"count"),r},t.unreadCount=function(n){var t=this,r;return r=i.Accessor(t,"UnreadCount",n),n!==undefined&&i.RefreshProperty(t,"count"),r},t.addItem=function(t){var i=this;n.observable(i.Items).insert(i.Items.length,t)},t.getQueryConfig=function(){var n=this,t;return n.Id===r.inboxFid?{firstPage:{activeGroup:1,userPropertyFilter:"IsPinningEnabledForUser",groups:[{query:HM.createMessageGroupQuery({categoryContainerId:HM.FilterType.FlaggedMessages,size:i.GetAppConfig("PinboardMessageSize"),containerType:HM.ContainerType.Categories,supportsDelayedRemoval:!1}),showFooter:!0,unflagOnMove:!0,autoSelectable:!1},{query:HM.createMessageGroupQuery({containerId:r.inboxFid,excludeFilterId:HM.FilterType.FlaggedMessages,size:i.GetAppConfig("MessageListSize"),containerType:HM.ContainerType.Folders}),autoSelectable:!0}]},defaultPage:{activeGroup:0,groups:[{query:HM.createMessageGroupQuery({containerId:r.inboxFid,size:i.GetAppConfig("MessageListSize"),containerType:HM.ContainerType.Folders}),autoSelectable:!0}]}}:(t=null,t=n.isCategory()?HM.createMessageGroupQuery({categoryContainerId:n.id(),size:i.GetAppConfig("MessageListSize"),containerType:HM.ContainerType.Categories}):HM.createMessageGroupQuery({containerId:n.id(),size:i.GetAppConfig("MessageListSize"),containerType:HM.ContainerType.Folders,search:n.search()}),{defaultPage:{activeGroup:0,groups:[{query:t,autoSelectable:!0}]}})},t.deleteContainer=function(n){var t=this,r,f;return r=null,f=null,t.isCategory()?u.Container.saveCategoryChanges({categoriesToDelete:[t.createCategory()],entryPoint:n}):(r="deletefolder",f={folderId:t.id(),folderType:t.folderType(),entryPoint:n},i.Dispatcher.fireCmd(r,f).deferred.fail(function(){i.Dispatcher.fireCmd("refreshfolders")}))},t.emptyContainer=function(n){var t=this,r,u;if(t.isQuickview())i.Cmd("bulkactionbycontainer").fire({action:"delete",quickViewId:t.id(),entryPoint:n});else if(t.isFolder()&&t.totalCount()>i.GetAppConfig("emptyDeleteThreshold"))i.Cmd("bulkactionbycontainer").fire({action:"delete",fromFid:t.id(),entryPoint:n});else if(t.isFolder())return r="emptyfolder",u={folderId:t.id(),entryPoint:n},i.Dispatcher.fireCmd(r,u).deferred.promise()},t.markAllAsRead=function(n){var t=this;i.Cmd("bulkactionbycontainer").fire({action:"mark",readState:!0,fromFid:t.isQuickview()?undefined:t.id().toString(),quickViewId:t.isQuickview()?t.id():undefined,entryPoint:n})},t.removeItem=function(t){var r=this,i;i=n.inArray(t,r.Items),i>=0&&n.observable(r.Items).remove(i,1)},t.moveItem=function(n,t){var r=this;var f={folderId:r.id(),newParentFolderId:n.Id,isArchive:!1,oldDepth:c(r)-1,newDepth:c(n),entryPoint:t},u=i.Dispatcher.fireCmd("movefolder",f).deferred;return u.fail(function(){i.Dispatcher.fireCmd("refreshfolders")}),u},t.newItem=function(t){var i=this,r;return r=new e(n.extend({isEditing:!0,isUncommitted:!0,parentContainer:i,depth:i.Depth+1},t)),i.addItem(r),r},t.cancelEdit=function(){var n=this;n.isUncommitted()?(n.error(null),n.parentContainer().removeItem(n)):(n.isPending(!1),n.error(null),n.isEditing(!1))},t.createCategory=function(){var n=this;return HM.createCategory({categoryId:n.Id,properties:n.Properties,visibility:n.Visibility,name:n.Name})},t.isTopLevelCustomFolder=function(){return this.isFolder()&&this.depth()===1&&this.folderType()===HM.FolderType.USER_DEFINED},t.addUpdateFolder=function(n){var t=this,f,e,u,o;return t.isPending(!0),u=n.newName||t.name(),o=n.isArchive!==undefined?n.isArchive:t.isArchive(),t.isUncommitted()?(f="addfolder",e={folderName:u,parentFolderId:t.parentContainer()?t.parentContainer().id():r.noneFid,isArchive:o,folderDepth:c(t)-1,entryPoint:t.editEntryPoint()}):(f="updatefolder",e={folderId:t.id(),newFolderName:u,parentFolderId:t.parentContainer()?t.parentContainer().id():r.noneFid,isArchive:o,isRename:u!==t.name(),entryPoint:t.editEntryPoint()}),i.Dispatcher.fireCmd(f,e).deferred.promise()},t.addUpdateCategory=function(n){var t=this,i;return t.isPending(!0),i=this.createCategory(),i.name=n,t.isUncommitted()?u.Container.saveCategoryChanges({categoriesToAdd:[i],entryPoint:t.editEntryPoint()}):u.Container.saveCategoryChanges({categoriesToUpdate:[i],entryPoint:t.editEntryPoint()})},t.completeEdit=function(t,r){var u=this,f,o;return f=null,t=t.trim(),!t&&(u.isUncommitted()||this.ContainerType===HM.ContainerType.Categories)||!u.isUncommitted()&&t===u.name()||r&&r==="focusout"&&t===u.pendingName()?(u.cancelEdit(),u.PendingName=null):(o=!u.isUncommitted(),u.pendingName(t),f=u.ContainerType===HM.ContainerType.Folders?u.addUpdateFolder({newName:t}):u.addUpdateCategory(t),f.always(function(n,t){var f="",h=n.errors[0],l,c,s,r;if(h&&$Network.FppProxy.checkFPPTypeName(h,"DLError"))l=e.GetErrorMessage(h),f=i.GetString(l);else if(t)for(c=!1,s=0;s<t.length;s++){if(r=t[s],r)switch(r.type){case HM.DLReturnType.FppError:case HM.DLReturnType.ServerErrorMessage:f=r.type===HM.DLReturnType.FppError?r.fppError.Message:r.serverErrorMessageString,c=!0,n.focusId=undefined;break;case HM.DLReturnType.ChangeFolder:n.focusId=r.folderId;break;case HM.DLReturnType.ChangeCategories:r.newCategories&&r.newCategories.length&&(n.focusId=r.newCategories[0].categoryId+"");break;case HM.DLReturnType.ContainerPoolData:o&&(n.focusId=u.Id+"")}if(c)break}f?(u.isPending(!1),u.error(f,{forceSetValue:!0})):u.cancelEdit()})),n.when(f)},t.setSelectionRecursively=function(n,t){var r=this,u,i;for(r.selectionState(n),u=t!==undefined?t:n,i=0;i<r.items().length;i++)r.items()[i].setSelectionRecursively(u)},t.isParentSelected=function(){var n=this;return n.parentContainer()&&(n.parentContainer().selectionState()===i.vm.Container.ContainerSelection.ON||n.parentContainer().selectionState()===i.vm.Container.ContainerSelection.PARENT_ON)},t.update=function(n){for(var t=this,f=[],r=0;r<t.defaultSettingsProps.length;r++){var e=t.defaultSettingsProps[r],o=i.GetPropName(e),s=t[o],u=n[e];u!==undefined&&s!==u&&(t[e](u),f.push({path:o,oldValue:s,value:u}))}return typeof n.sortIndex!="undefined"&&(t.SortIndex=n.sortIndex),f},t.hasDuplicateContainer=function(n){var r=this,i,t;if(i=r.Items,n.ParentContainer.Id===r.Id)return!0;for(t=0;t<i.length;t++)if(i[t].Name===n.Name||i[t].SortIndex===n.SortIndex)return!0;return!1},t.isDescendantOfContainer=function(n){for(var i=this,t=i;t.ParentContainer;){if(t.ParentContainer.Id===n.Id)return!0;t=t.ParentContainer}return!1},t.updateExCoState=function(){var n=this,t,r;return t=n.isCollapsed()?"expandfolder":"collapsefolder",r={folderId:n.id()},i.Dispatcher.fireCmd(t,r).deferred.promise()},u.Container.createDefaultCategoryOptions=function(t){var i={id:l,containerType:HM.ContainerType.Categories,properties:0,name:"",totalCount:0,unreadCount:0,visibility:HM.CategoryVisibility.QuickView};return t&&(i=n.extend(i,t)),i},u.Container.saveCategoryChanges=function(n){var f=n.categoriesToAdd||[],e=n.categoriesToUpdate||[],o=n.categoriesToDelete||[],r=typeof n.showCategoryColumn!="undefined"&&n.showCategoryColumn!==null,u=typeof n.showEverythingElseFilter!="undefined"&&n.showEverythingElseFilter!==null,t;return t=null,(r||u)&&(t=new HM.CategorySettings,r&&(t.ColumnEnabled=n.showCategoryColumn),u&&(t.ShowEverythingElseFilter=n.showEverythingElseFilter)),i.Dispatcher.fireCmd("addupdatedeletecategories",{categoriesToAdd:f,categoriesToUpdate:e,categoriesToDelete:o,categorySettings:t,entryPoint:n.entryPoint}).deferred.promise()},u.Container.isSystemFolder=function(n){if(!h){h={};for(var t in r)h[r[t]]=t}return!!h[n]},u.Container.isPersonalCategory=function(n){return typeof n!="number"?!1:n!==f.noneFltid&&n!==f.otherFltid&&n!==f.textMessagesFltid&&!u.Container.isSystemCategory(n)},u.Container.isSystemCategory=function(n){if(typeof n!="number")return!1;if(!s){s={};for(var t in f)s[f[t]]=t}return s[n]!==undefined&&n!==f.noneFltid&&n!==f.otherFltid&&!!(n%2)},u.Container.getMaxNameLength=function(n){return i.config.appSettings[n.isFolder()?"maxCustomFolderNameLength":"maxCustomCategoryNameLength"]}}(window.originaljQuery||window.jQuery),function(n){"use strict";function e(n){return{id:null,title:"Unknown",refreshCmd:null,type:n?null:HM.ContainerType.Folders,isPending:!1,isCollapsed:!1,newItemLabel:"New",expandCollapseTooltip:null,rootContainer:n?null:new r.Container({depth:0}),containerMap:{},isCategoryColumnEnabled:n?null:t.config.appSettings.categorySettings.isColumnEnabled,showEverythingElseFilter:n?null:t.config.appSettings.categorySettings.showEverythingElseFilter,dropTarget:null,totalMsgCount:0,selectedItems:[]}}var t=window.ol=window.ol||{},r=t.vm=t.vm||{},f=t.config.sysFldrs,o=t.Accessor,i=null,u=r.ContainerList=function(u){function h(){var t,n;for(i={},t=e.rootContainer().items(),n=0;n<t.length;n++)i[t[n].id()]=n}function c(){return i||(h(),n.observable.simpleOn([e.rootContainer().Items],"arrayChange",h)),function(n,t){return i[n.id()]-i[t.id()]}}function l(n,i){if(!t.config.serverRenderOnly){var r=t.Cookies.get(t.config.cookies.pdCookie);r!==null&&n===HM.ContainerType.Folders?r.excofl=i?1:0:r!==null&&n===HM.ContainerType.QuickViews&&(r.excoqv=i?1:0),t.Cookies.setPermanent(t.config.cookies.pdCookie,r)}}function a(){if(e.type()===HM.ContainerType.Folders&&!(o in e.ContainerMap)){var n=new r.Container({id:o,name:t.GetString("Folder.SearchResults"),depth:1,isSearch:!0,parentContainer:e.rootContainer(),visibleWhenSelected:!0});e.ContainerMap[o]=n,e.rootContainer().addItem(n)}}function v(){t.RefreshProperty(e,"expandCollapseTooltip"),s=HM.createContainerQuery({containerType:e.Type}),t.Dispatcher.register([s],e.apply,e),t.Dispatcher.fireCmd("get")}var e=this,s,o;e.initAccessorValues(u),o=t.config.sysFldrs.searchFid,t.OverridePropertyGetter(e,"ExpandCollapseTooltip",function(){var n=t.GetString("ExpandCollapse.Tooltip.Label");switch(e.type()){case HM.ContainerType.Folders:n=n.format(t.GetString("ExpandCollapse.Tooltip.ItemName.Folders"));break;case HM.ContainerType.Categories:n=n.format(t.GetString("ExpandCollapse.Tooltip.ItemName.QuickViews"));break;default:n="Type not supported: "+e.type()+" -- ContainerList$selectSearchFolder()"}return n}),e.selectSearchFolder=function(n){e.ContainerMap[o].search(n),t.Cmd("selectcontainer").fire({id:o,entryPoint:HM.InstrumentationEntryPoint.LeftNav})},e.getQueryKey=function(){return s.key()},e.getContainerById=function(n){return e.ContainerMap[n]},e.apply=function(i,r){function l(n,i,r){var f=n.containerTable[i],e;return f.parentContainer=r,f.id=i,u[i]?(u[i].update(f),e=u[i]):e=new t.vm.Container(f),e}function h(t,i,r,f){var a,s,v,c,p,w,b,k,y;if(t)for(s=0;s<t.Items.length||r<i.containerIds.length;)if(r<i.containerIds.length?(a=i.containerIds[r],c=i.containerTable[a]):(a=null,c=null),c&&c.depth&&c.depth>f&&s>0)t.Items&&t.Items.length>0&&(r=h(t.Items[s-1],i,r,f+1));else if(c&&c.depth&&c.depth<f){for(v=s;v<t.Items.length&&t.Items[v];)t.Items[v].isUncommitted()?v++:n.observable(t.Items).remove(v,1);break}else if(s<t.Items.length&&t.Items[s].id()!==null&&t.Items[s].id()===a)c=t.Items[s],p=i.containerTable[c.id()],p.parentContainer=u[c.parent],w=c.update(p),r++,s++,w.length>0&&n.observable.trigger(e,"itemPropertiesChanged",{item:c,propertiesChanged:w}),s>0&&t.Items[s-1].Items.length>0&&(r=h(t.Items[s-1],i,r,f+1));else if(s<t.Items.length&&a===null)t.Items[s].id()===o||t.Items[s].isUncommitted()?s++:n.observable(t.Items).remove(s,1);else if(u[a]&&u[a].ParentContainer.Id===t.id()){for(y=s+1;y<t.Items.length;y++)if(t.Items[y].id()===a){k=t.Items[y],n.observable(t.Items).remove(y,1);break}n.observable(t.Items).insert(s,k)}else b=l(i,a,t),u[a]&&(b.Items=u[a].Items),n.observable(t.Items).insert(s,b),r++,s++;return r}function v(n){function r(n,t){for(var u,e=0;e<n.Items.length;e++)u=n.Items[e],t[u.id()]=u,u.Id!==f.trashFid&&u.Id!==o&&(i+=u.TotalCount),r(u,t)}var t={},i=0;r(n,t),e.TotalMsgCount=i,e.containerMap(t)}var u=e.containerMap(),c;s.key()in r&&(c=r[s.key()],c.status===HM.Status.Complete&&(h(e.rootContainer(),c,0,1),a(),v(e.rootContainer())))},e.getCategoryListFromIds=function(n){for(var r=[],u,i,t=0;t<n.length;t++)u=n[t],i=e.ContainerMap[u],i&&i.isCategorizable()&&r.push(i);return r},e.getContainerNameById=function(n){if(e.containerMap()){var t=e.containerMap()[n];if(t)return t.name()}return null},e.setContainerFocus=function(n){var i=e.containerMap(),t;i&&(t=i[n],t&&t.shouldReceiveFocus(!0))},e.getSortedCategoryListFromIds=function(n){var t=[];return t=e.getCategoryListFromIds(n),t.sort(c())},e.getSortedCategoryNamesFromIds=function(n){for(var r=e.getSortedCategoryListFromIds(n),u=[],f,i,t=0;t<r.length;t++)f=r[t],i=f.name(),!i||u.push(i);return u},e.getArchiveFolder=function(){for(var t=e.rootContainer().items(),n=0;n<t.length;n++)if(t[n].isFolder()&&t[n].isArchive())return t[n]},e.getNumberOfCustomFolders=function(){for(var t=e.rootContainer().items(),i=0,n=0;n<t.length;n++)t[n].isFolder()&&t[n].folderType()!==HM.FolderType.SYSTEM&&i++;return i},e.topLevelCustomFolders=function(){return n.grep(e.rootContainer().items(),function(n){return n.isFolder()&&n.folderType()!==HM.FolderType.SYSTEM})},e.forAllContainers=function(t){n.each(e.ContainerMap,t)},e.getCustomFolderCount=function(){var n=0;return e.forAllContainers(function(t,i){i.folderType()===HM.FolderType.USER_DEFINED&&n++}),n},e.updateExCoState=function(){var n=this.Type===HM.ContainerType.Folders?HM.ContainerType.Folders:HM.ContainerType.QuickViews;l(n,this.isCollapsed())},e.getTopLevelContainerByName=function(n,t){var f=null,r,i,u;if(n)for(r=this.rootContainer().items(),t&&(n=n.toLowerCase()),i=0;i<r.length;i++)if(u=r[i].name(),t&&(u=u.toLowerCase()),n===u){f=r[i];break}return f},v()};t.AddOptionsAccessorAndInitFunctions(u.prototype,e),t.Selection.CreateSelectablePropertiesAccessors(u.prototype)}(window.originaljQuery||window.jQuery),function(n){"use strict";function f(n){var f,e,o=!1;t.config.renderAscxLeftNav||n||(f=new t.vm.ContainerList({title:t.GetString("QuickView.Header.Label"),newItemLabel:t.GetString("QuickView.NewCategory"),type:HM.ContainerType.Categories,isCollapsed:r(HM.ContainerType.QuickViews)}),e=new t.vm.ContainerList({title:t.GetString("FolderList.Header.Label"),newItemLabel:t.GetString("ManageFolders.AddFolder.Title"),type:HM.ContainerType.Folders,refreshCmd:!0,isCollapsed:r(HM.ContainerType.Folders),rootContainer:new t.vm.Container({id:t.config.sysFldrs.noneFid,depth:0,isCollapsed:!1})}),o=r("WebIMExcoState"));var s=n?null:new t.vm.LeftNav({containerLists:[e,f],webIMCollapsed:o}),u=n?null:new i.InboxLayout,h=n?null:new i.MessageList({layout:u}),c=!n&&i.ReadMessage?new i.ReadMessage:null,l=!n&&i.Undo&&t.config.features.undo?new i.Undo({leftNav:s}):null;return{leftNav:s,messageList:h,readMessage:c,search:n?null:new i.Search,prefetch:null,demandPrefetch:null,selectedThread:null,selectedContainer:null,categoryList:f,folderList:e,layout:u,rightRail:n?null:new i.RightRail({layout:u}),autoRefresh:null,bulkActions:null,archive:null,serverMessages:null,instrumentation:!n&&i.Instrumentation?new i.Instrumentation({layout:u,messageList:h}):null,undo:l}}function r(n){var i=t.Cookies.get(t.config.cookies.pdCookie),r=!1;return i!==null&&(r=n===HM.ContainerType.Folders?parseInt(i.excofl)===1:n===HM.ContainerType.QuickViews?parseInt(i.excoqv)===1:parseInt(i.excowebim)===1),r}var t=window.ol=window.ol||{},i=t.vm=t.vm||{},u=t.Accessor,e=i.Inbox=function(r){function l(){var s,n,u,a,r,c,e,p,w;if(t.init&&t.init.NotifyLoad("App1").then(function(){t.GetAppConfig("isDemandPrefetchEnabled")&&f.demandPrefetch(new i.DemandPrefetch({messageList:f.messageList(),readMessage:f.readMessage()})),t.GetAppConfig("isOptimisticPrefetchEnabled")&&f.prefetch(new i.Prefetch({messageListQueries:f.messageList().queries()})),f.autoRefresh(new i.AutoRefresh({messageList:f.messageList()})),f.serverMessages(new i.ServerMessages),new i.ServerQueryInvalidation,f.bulkActions(new i.BulkActions)}),s=t.initialDataJSON,n=t.config.initialStateJson,s){var v=n.fid||n.qvid||t.config.sysFldrs.inboxFid,b=t.data.isFolderId(v)?HM.ItemListQueryContainerType.Folder:HM.ItemListQueryContainerType.Category,k=f.initialSelectionId=n.mid||n.cid||n.tid,d=n.fltid||null,o=f.messageList(),h=[],l=null;for(r=0;r<s.length;r++)u=s[r],u&&(u.type===HM.DLReturnType.MessageListData?h.push(u.msgGroupQuery):u.type===HM.DLReturnType.SearchDataWrapper&&(l=u.searchData));if(h.length>0){for(a=[],r=0;r<h.length;r++)c=HM.createMessageGroupQuery(h[r]),c.size=Math.min(c.size,t.GetAppConfig("MessageListSize")),a.push(c);t.config.renderAscxLeftNav||(p=b===HM.ItemListQueryContainerType.Folder?"FolderList":"CategoryList",e=f[p].getContainerById(v)),e.selected(!0),f.selectedContainer(e),o.pageNumber(n.pidx),o.filterId(d),o.sortKey.sortOrder(n.sa?HM.MessageListKeyQuerySortOrder.Ascending:HM.MessageListKeyQuerySortOrder.Descending),o.sortKey.sortBy(n.so),w=o.setQueries(e,a,!1,null,k),w.then(function(){e.isFilter()&&t.Cmd("instrument.filter").fire({entryPoint:HM.InstrumentationEntryPoint.RRU,fId:e.id()})})}(l||f.messageList().isSearchResult())&&(t.init&&t.init.Load("SearchFilters"),f.search().setFromSearchParams(l))}f.layout().applySizerBarCookie(),y()}function s(n){setTimeout(function(){n.deferred.resolve()},0)}function a(n){var i=this,r=f.readMessage().thread();f.layout().isReadingPaneOn()&&r&&n.threadId===r.id()?(c(n.isFullView,n.isRightRailForcedOff,n.dontUpdateSelectedThread),s(i)):f.readMessage().setThreadById(n.threadId,n.viewId,!1,n.skipHistory).then(function(r){var e,o,u;if(i.settings.storeCsdForLater(i,r),c(n.isFullView,n.isRightRailForcedOff,n.dontUpdateSelectedThread),s(i),e=f.selectedThread(),e&&(n.deferredInstrumentation&&t.Cmd("instrument.readmessage").fire({msgInst:t.Instrumentation.getThreadInstrumentation(e),entryPoint:n.entryPoint}),o=e.items(),u=o&&o.length>0&&o[0].biciData(),u&&u.OfficialLetterType))if(u.OfficialLetterType===HM.OfficialLetterType.SwitchCompletionLetter){var h=$Cookie.getSessionCookie("swps"),l=$Cookie.getSessionCookie("swep"),a={SwEvent:HM.SwitchEvent.Select,SwEnterInfo:HM.SwitchEnterInfo.NotApplicable,SwSelectInfo:HM.SwitchSelectInfo.StatusLetter,SwExitInfo:HM.SwitchExitInfo.NotApplicable,SwEventInfo:"NA",SwState:HM.SwitchState.Inbox,SwPrevState:h!=null?parseInt(h):HM.SwitchState.Unknown,SwEntryID:l!=null?parseInt(l):HM.SwitchEntryPoint.Unknown};t.Cmd("log.importaccount").fire(a),$Cookie.setSessionCookie("swps",a.SwState)}else u.OfficialLetterType!==0&&t.Cmd("instrument.readmessagebici").fire({bici:u})},function(n){i.deferred.reject(n)})}function c(n,t,i){i||f.selectedThread(f.readMessage().thread(),{forceSetValue:!0}),f.Layout.isRightRailForcedOff(!!t),n!==undefined&&f.Layout.isFullView(!!n)}function v(i){var e=this,r=i.selectedContainer,u=i.messageGroupQueries,o=null,h=function(){f.selectedContainer(r),t.Cmd("ml.postcommit").unsubscribe(h)};t.Cmd("ml.postcommit").subscribe(h),o=u?f.messageList().setQueries(r,u):f.messageList().setQueryConfigs(r,i),o.then(function(){s(e)},e.deferred.reject)}function y(){t.Cmd("accept").subscribe(o),t.Cmd("addcontacts").subscribe(p),t.Cmd("decline").subscribe(o),t.Cmd("forward").subscribe(o),t.Cmd("nav.message").subscribe(a),t.Cmd("newmessage").subscribe(w),t.Cmd("reply").subscribe(o),t.Cmd("replyall").subscribe(o),t.Cmd("resumedraft").subscribe(o),t.Cmd("search").subscribe(g),t.Cmd("nav.container").subscribe(v),t.Cmd("sendemailtosender").subscribe(d),t.Cmd("tentative").subscribe(o),t.Cmd("endcomposesession").subscribe(b),t.Cmd("undoaction").subscribe(k)}function p(){this.deferred.then(function(){$Do.when("$pwc",0,function(){$pwc.client.deltaSync()})})}function w(n){t.Cmd("begincomposesession").fire({action:n.action,needToComputeFriendshipCache:h(),curView:t.Instrumentation.currentView(),entryPoint:n.entryPoint,numParticipants:0,priority:HM.InstrumentationPriority.Normal,composeLoaded:t.Instrumentation.composeLoaded(),isFullCompose:!0})}function o(n){var i=n.thread.getActionableMessageThread(),r=i.canRespondInline(f.layout().isReadingPaneOrFullViewOn()&&!f.messageList().showMessageCount(),n.action,f.readMessage().thread());t.Cmd("begincomposesession").fire({action:n.action,respondingItemId:i.id(),canRespondInline:r,thread:i,needToComputeFriendshipCache:h(),selectedContainerId:f.selectedContainer().id(),curView:t.Instrumentation.currentView(),entryPoint:n.entryPoint,msgInst:t.Instrumentation.getThreadInstrumentation(i),composeLoaded:t.Instrumentation.composeLoaded(),isFullCompose:!r})}function b(n){n.messageSent&&n.isFullCompose&&f.Layout.isFullView(!1)}function k(n){f.undo()&&f.undo().canUndo()&&f.undo().undoLastAction(n)}function d(n){t.Cmd("begincomposesession").fire({action:"newmessage",composeData:{To:n.senderEmail},entryPoint:n.entryPoint,numParticipants:1,curView:t.Instrumentation.currentView(),priority:HM.InstrumentationPriority.Normal,needToComputeFriendshipCache:h(),composeLoaded:t.Instrumentation.composeLoaded(),isFullCompose:!0})}function g(){f.beginSearch()}function h(){var n=f.rightRail().peoplePaneManager();return n?n.isPeoplePaneEnabled()&&!n.isFriendshipCacheReady():!1}function nt(n,t){if(!n&&t||n&&!t||n.length!==t.length)return!1;for(var i=0;i<n.length;i++)if(n[i].id()!==t[i].id()||n[i].Checked!==t[i].Checked)return!1;return!0}var f=this,e;f.initAccessorValues(r),f.refresh=function(){return t.Dispatcher.fireCmd("refresh",{isRefreshMessageList:!0,restoreMessageListFocus:!0}).deferred.promise()},f.selectedContainer=function(n){var t=u(f,"SelectedContainer",n);return n!==undefined&&f.search().selectedContainer(n),t},f.isContainerNavigation=function(n){return u(f,"IsContainerNavigated",n)},f.beginSearch=function(){var n=f.leftNav().containerLists()[0],t=f.search().getSearchParams();n.selectSearchFolder(t)},f.isBulkSelected=function(){return f.messageList().bulkSelected()},f.getSelectedThreads=function(){return f.Layout.IsFullView&&f.selectedThread()&&f.selectedContainer().id()!==t.config.sysFldrs.searchFid?[f.selectedThread()]:f.messageList().selectedItems()},f.getSelectedThreads2=function(){var r=function(t,i){var r=null,f;if(t&&i&&(n.isArray(t)?n.isArray(i)?t.length!==i.length?r="Set length mismatch.":t.length===1?t[0].Id!==i[0].Id&&(r="Both sets contain one element but they have different IDs: "+t[0].Id+" vs "+i[0].Id):r="Sets have more than one element.":r="Set 'set2' is not array.":r="Set 'set1' is not array."),r)try{throw new Error(r);}catch(u){f=u.stack?u.stack:"(no stack available)",r="(929813) getSelectedThreads2: "+r+"\n\n"+f,HM.ReportError(r,n.noop)}},i=f.getSelectedThreads(),t;return f.Layout.isReadingPaneOrFullViewOn()&&f.readMessage().thread()?(t=[f.readMessage().thread()],r(i,t),t):i},f.getContainer=function(n,t){var i=t===HM.ItemListQueryContainerType.Folder?"FolderList":"CategoryList";return f[i].getContainerById(n)},f.handleMessagelistSelection=function(n,i,r){var c=null,a=f.messageList().bulkSelected(),u,h,o,l,s;if(f.messageList().bulkSelected(!1),u=n.length===1&&n[0]&&!n[0].Checked?n[0]:null,h=null,u&&e&&(e.length>1||e.length===1&&e[0].Checked)&&!f.layout().isReadingPaneOn()){for(h=[],o=0;o<e.length;o++)h.push({id:e[o].id(),checked:e[o].checked()});f.messageList().savedSelectionState.bulkSelected=a}f.messageList().savedSelectionState.selectionStates=h,l=nt(n,e),l&&(!u||f.readMessage().thread())?l&&f.layout().isReadingPaneOn()&&r&&!r.isFullView&&f.Layout.isFullView(!1):(e=HM.deepCopy(n),f.layout().isReadingPaneOrFullViewOn()||r&&r.isFullView?u?c=t.Cmd("nav.message").fire({skipHistory:r&&r.skipHistory,threadId:u.id(),viewId:u.viewId(),isFullView:r&&r.isFullView,rpState:f.layout().isReadingPaneOn(),type:u.LiveViewsHtml?"v":u.count()>1?"t":"s",prefetchState:u.isPrefetched(),entryPoint:r&&r.entryPoint?r.entryPoint:HM.InstrumentationEntryPoint.Other,msgInst:t.Instrumentation.getThreadInstrumentation(u)}):(f.Layout.isFullView(!1),f.readMessage().setThreadById(null,null,!1).then(function(){f.selectedThread(u)})):u?f.selectedThread(u):f.readMessage().setThreadById(null,null,!1).then(function(){f.selectedThread(null)})),s=r&&r.promise,s&&(c?c.deferred.then(s.resolve,s.reject):s.resolve())},f.handleLeftNavSelection=function(i,r,u){var s=n.Deferred().resolve(),e=n.Deferred().resolve(),h=!1,o=n.Deferred();return u&&u.isContainerReselect&&!u.skipSelectContainer&&!f.Layout.IsFullView&&(f.messageList().filterId(null,{silentlyUpdate:!0}),f.messageList().getPage(HM.ListNavigateDirection.FirstPage,!0).then(function(){s=t.Dispatcher.fireCmd("refresh",{isRefreshMessageList:f.messageList().pageNumber()===1,pageNumber:1,fltid:null}).deferred}),h=!0),u.skipSelectContainer||h&&f.messageList().pageNumber()===1||(e=n.Deferred(),s.then(function(){t.Cmd("nav.container").fire({skipHistory:u&&u.skipHistory,allowAutoSelect:u&&u.allowAutoSelect,selectedContainer:i,messageGroupQueries:u&&u.messageGroupQueries,entryPoint:u&&u.entryPoint,dontInstrument:u&&u.dontInstrument,fltid:u&&u.fltid,sortOrder:u&&u.sortOrder,sortType:u&&u.sortType}).deferred.then(e.resolve,e.reject)})),t.deferredUtils.whenAll([s,e]).then(o.resolve,o.reject),u&&u.promise&&o.then(u.promise.resolve,u.promise.reject),o.promise()},l()};t.AddOptionsAccessorAndInitFunctions(e.prototype,f)}(window.originaljQuery||window.jQuery),function(n){"use strict";function r(n){return{readingPaneMode:n?null:t.GetUserConfig("ReadingPaneLocation"),isPinningEnabled:n?null:t.GetUserConfig("IsPinningEnabledForUser"),isPinboardExpanded:n?null:t.GetUserConfig("IsPinboardExpanded"),isFullView:n?null:!!t.GetInitialStateConfig("fv"),isRightRailForcedOff:!1,contentLeftWidthMin:100,contentRightWidthMin:525,messageListWidthMin:335,readingPaneWidthMin:300,messageListHeightMin:125,readingPaneHeightMin:100,leftNavWidth:205,messageListWidth:335,messageListHeight:268,webImModuleHeight:t.config.appSettings.isWebIMLeftNavModuleEnabled?199:0,webImMinModuleHeight:130,webImHiddenModuleHeight:50}}var t=window.ol=window.ol||{},i=t.vm=t.vm||{},f=t.Accessor,u=i.InboxLayout=function(i){function o(){t.config.serverRenderOnly||(n(window).resize(r.windowResized),r.windowResized()),t.Cmd("switchreadingpanemode").subscribe(function(n){r.readingPaneMode(n.value)})}var e=n(window),r=this,u,f;r.initAccessorValues(i),u={width:0,height:0},f=null,r.isReadingPaneOrFullViewOn=function(){return r.isReadingPaneOn()||r.IsFullView},r.isReadingPaneOn=function(){var n=r.readingPaneMode();return n===HM.ReadingPaneLocation.Right||n===HM.ReadingPaneLocation.Bottom},r.readingPaneMode=function(n){typeof n!="undefined"&&typeof r.ReadingPaneMode!="undefined"&&n!==r.ReadingPaneMode&&t.writeOptionToServer("ReadingPaneLocationWriter",n);return t.Accessor(r,"ReadingPaneMode",n)},r.isPinningEnabled=function(n){return typeof n!="undefined"&&typeof r.IsPinningEnabled!="undefined"&&n!==r.IsPinningEnabled&&t.writeOptionToServer("PinningEnabledStateWriter",n),t.Accessor(r,"IsPinningEnabled",n)},r.isPinboardExpanded=function(n){return typeof n!="undefined"&&typeof r.IsPinboardExpanded!="undefined"&&n!==r.IsPinboardExpanded&&t.writeOptionToServer("PinboardExpansionStateWriter",n),t.Accessor(r,"IsPinboardExpanded",n)},r.applySizerBarCookie=function(){var i,n;t.config&&t.config.cookies&&(i=t.config.serverRenderOnly?t.config.sizerBarCookies.sbsz:t.Cookies.get(t.config.cookies.pdCookie).sbsz,i&&(n=i.split("-"),n[0]&&r.leftNavWidth(n[0]),n[1]&&r.messageListWidth(n[1]),n[2]&&r.messageListHeight(n[2]),n[3]&&r.webImModuleHeight(n[3])))},r.windowResized=function(){function n(){var n=e.width(),i=e.height(),r;(u.width!=n||u.height!=i)&&(u.width=n,u.height=i,r={dimensions:u},t.Cmd("windowresize").fire(r))}f&&clearTimeout(f),f=setTimeout(n,50)},r.setSizerBarCookie=function(n,i){var f=t.Cookies.get(t.config.cookies.pdCookie),u=f.sbsz?f.sbsz.split("-"):["","",""];switch(n){case"master":u[0]=i;break;case"rpRight":u[1]=i;break;case"rpBottom":u[2]=i;break;case"webim":u[3]=i,r.webImModuleHeight(u[3])}f.sbsz=u.join("-"),t.Cookies.setPermanent(t.config.cookies.pdCookie,f)},o()};t.AddOptionsAccessorAndInitFunctions(u.prototype,r)}(window.originaljQuery||window.jQuery),function(){"use strict";function u(){return{containerLists:[],selectedItems:[],webIMCollapsed:!1}}var n=window.ol=window.ol||{},r=n.vm=n.vm||{},f=n.Accessor,t=r.LeftNav=function(n){var t=this;t.initAccessorValues(n)},i=t.prototype;i.getContainerNameById=function(n){var t,i,r,u;if(t=null,i=this.containerLists(),i)for(r=0;r<i.length;r++)if(u=i[r],u&&(t=u.getContainerNameById(n),t))break;return t},i.updateWebIMExcoState=function(t){if(!n.config.serverRenderOnly){var i=n.Cookies.get(n.config.cookies.pdCookie);i!==null&&(i.excowebim=t?"1":"0"),n.Cookies.setPermanent(n.config.cookies.pdCookie,i)}},n.AddOptionsAccessorAndInitFunctions(t.prototype,u),n.Selection.CreateSelectablePropertiesAccessors(t.prototype)}(),function(){"use strict";function i(){return{title:"",menuAnchorClass:"",titleClass:"",items:[],params:null,loc:1,menuChevClass:"ExcoOpenSmall",sutraTag:"",toolTip:"",edgeOffsetFunction:null,layout:null,key:""}}var n=window.ol=window.ol||{},t=n.vm=n.vm||{},u=n.Accessor,r=t.Menu=function(n){var t=this;t.initAccessorValues(n)};n.AddOptionsAccessorAndInitFunctions(r.prototype,i)}(),function(){"use strict";function i(){return{template:"#menuItemTemplate",cssClass:"",text:"",key:"",eventData:{},keyboardShortcutAction:"",sutraTag:"Hotmail.Link",titleResource:"",tooltip:"",itemImageClass:"",encodeHtml:!0,itemAltText:"",id:"",title:"",inlineStyle:"",isSelected:!1}}var n=window.ol=window.ol||{},t=n.vm=n.vm||{},u=n.Accessor,r=t.MenuItem=function(n){var t=this;t.initAccessorValues(n)};n.AddOptionsAccessorAndInitFunctions(r.prototype,i)}(),function(n,t){"use strict";function u(t){return{items:[],query:null,queryConfig:null,showFooter:!1,queryContainerId:t?null:n.config.sysFldrs.noneFid,bof:!1,eof:!1,totalPageCount:null,visiblePageCount:0,timestamp:null}}var r=n.vm=n.vm||{},f=n.Accessor,i=r.MessageGroup=function(i){var r=this;r.initAccessorValues(i),r.getThreadById=function(n){for(var i,t=0;t<r.Items.length;t++)if(i=r.Items[t],i.areSameThreadIds(n))return i;return null},r._prepareListForMerge=function(t,i){return n.vm.MessageThread.prepareListForMerge({currentItems:r.Items,newItemIds:t.itemIds,newItemsTable:t.itemsTable,idMapping:t.idMapping,maxCount:r.visiblePageCount(),viewId:r.viewId(),useViewIdFromMessage:r.viewId()===n.config.sysFldrs.searchFid,queryContainerId:r.queryContainerId(),sectionStart:i})},r.apply=function(n,t,i){var u,f;return HM.assertMessageGroupResult(t),u=null,t&&t.itemIds&&(f=t.query,r.showFooter(!!(r.queryConfig()&&r.queryConfig().showFooter&&t.itemIds.length>0)),r.bof(t.bof),r.eof(t.eof),r.totalPageCount(t.totalPageCount),r.timestamp(t.timestamp),u=r._prepareListForMerge(t,i)),u},r.commit=function(){for(var i,n=0;n<r.Items.length;n++)i=r.Items[n],i.preparedToRemove()&&(t.observable(r.Items).remove(n,1),i.preparedToRemove(!1),n--),i.preparedToAdd()&&i.preparedToAdd(!1)},r.viewId=function(){return n.data.getViewId(r.query())},r.unflagOnMove=function(){return!!(r.queryConfig()&&r.queryConfig().unflagOnMove)}};n.AddOptionsAccessorAndInitFunctions(i.prototype,u),n.Selection.CreateSelectablePropertiesAccessors(i.prototype)}(window.ol,window.originaljQuery||window.jQuery),function(n){"use strict";function o(n){return{selectionCmd:null,items:[],selectedItems:[],initialThreadId:null,numThreads:0,dragSource:null,queries:[],groupConfigQueries:[],groupConfigs:[],queryContainer:null,pageNumber:1,totalPageCount:0,showMessageCount:!1,selectedMessageCount:0,activeGroupIndex:0,jumpToAnchor:null,isConversationThreadingOn:n?null:t.GetUserConfig("ConversationThreading"),layout:null,checkAllChecked:!1,bulkSelected:!1,gotoPickerHelper:null,disableAutoRefresh:!1,filterId:null,restoreBulkSelection:!1}}var t=window.ol=window.ol||{},r=t.vm=t.vm||{},i=null,u=!1,f=!0,e=r.MessageList=function(e){function h(){for(var t=o.Queries.length===o.Items.length,n=0;t&&n<o.Queries.length;n++)t=o.Queries[n].key()===o.Items[n].query().key();return t}function c(n){if(o.ActiveGroupIndex<o.Queries.length){var t=n[o.Queries[o.ActiveGroupIndex].key()];if(t.bof&&t.query.anchorType===HM.MessageGroupQueryAnchorType.EndId)return o.getPage(HM.ListNavigateDirection.FirstPage),!0}return!1}function s(t,i){n.merge(t.addedThreads,i.addedThreads),n.merge(t.removedThreads,i.removedThreads),n.extend(t.addedThreadsMap,i.addedThreadsMap),n.extend(t.removedThreadsMap,i.removedThreadsMap)}function l(){var r,n,t;if(i&&i.Items.length>0)for(n=0;n<i.Items.length;n++)if(t=i.Items[n],!t.preparedToRemove()){r=t;break}return r}function a(){var r,n,t;if(i&&i.Items.length>0)for(n=i.Items.length-1;n>=0;n--)if(t=i.Items[n],!t.preparedToRemove()){r=t;break}return r}var o=this;o.initAccessorValues(e),o.sortKey={},t.AddAccessor(o.sortKey,"sortBy"),t.AddAccessor(o.sortKey,"sortOrder"),o.savedSelectionState={selectionIds:null,bulkSelected:!1},o.sortKey.sortBy(HM.SortBy.Date,{silentlyUpdate:!0}),o.sortKey.sortOrder(HM.MessageListKeyQuerySortOrder.Descending,{silentlyUpdate:!0}),o.isEmptyMessageList=function(n){var i=!0,t;if(n&&n.length>0)for(t=0;t<n.length;t++)if(i&=n[t].Items.length===0,!i)break;return i},o.setCountState=function(n,t){o.showMessageCount(t),o.selectedMessageCount(n),n===0&&o.checkAllChecked(!1)},o.getThreadById=function(n){var r,t,i;for(r=o.Items,t=null,i=0;!t&&i<r.length;i++)t=r[i].getThreadById(n);return t},o.isSearchResult=function(){var n=o.queries();return!!(n&&n.length===1&&n[0].containerId===t.config.sysFldrs.searchFid)},o.activeGroup=function(){return i},o.hasMoreThanOnePage=function(){return u},o._calculateVisiblePageCount=function(n){var i,f,e,s;var h=parseInt(o.layout().readingPaneMode()!==HM.ReadingPaneLocation.Right?t.GetAppConfig("VisiblePinnedMessageLimitRPOff"):t.GetAppConfig("VisiblePinnedMessageLimitRPOn")),c=parseInt(t.GetAppConfig("MessageListSize")),r=0,u=[];for(i=0;i<o.Queries.length;i++)f=n[o.Queries[i].key()],e=i===o.ActiveGroupIndex?c-r:h,s=u[i]=Math.min(f.itemIds.length,e),r+=s;return u},o._shouldResultsBeApplied=function(n,t){var i,u,r;i=!0;for(u in t)if(r=t[u].status,r!==HM.Status.Complete&&(r!==HM.Status.IncompletePartial||n.name==="get")){i=!1;break}return i&&!c(t)},o._areAllResultsComplete=function(n){for(var t in n)if(n[t].status!==HM.Status.Complete)return!1;return!0},o._prepareForCommit=function(n,f){var e,p,l,w,c,a,y,v;if(e={addedThreads:[],removedThreads:[],addedThreadsMap:{},removedThreadsMap:{},queryChange:!1},p=o._calculateVisiblePageCount(f),h()){for(e.queryChange=n.name==="setconversationmode",a=0;a<o.Items.length;a++)y=o.Items[a],y.visiblePageCount(p[a]),v=y.apply(n,f[y.query().key()]),s(e,v);o.totalPageCount(i?i.totalPageCount():0)}else{for(l=[],w=0,c=0;c<o.Queries.length;c++){var b=o.Queries[c],k=new r.MessageGroup({query:b,queryContainerId:t.data.getViewId(b),queryConfig:o.GroupConfigs[c],visiblePageCount:p[c]}),v=k.apply(n,f[b.key()],w);s(e,v),l.push(k),w+=k.Items.length}e.queryChange=!0,o.queryContainer(o._pendingQueryContainer,{silentlyUpdate:!0}),o._pendingQueryContainer=null,i=null,l.length>o.ActiveGroupIndex&&(i=l[o.ActiveGroupIndex]),o.totalPageCount(i?i.totalPageCount():0,{silentlyUpdate:!0}),u=i&&(!i.bof()||!i.eof()),n&&n.args&&(i&&i.bof()?o.pageNumber(1):o._pendingPageNumber!==undefined&&o.pageNumber(o._pendingPageNumber),n.args.fltid!==undefined&&o.filterId(n.args.fltid,{silentlyUpdate:!0}),n.args.sortOrder!==undefined&&o.sortKey.sortOrder(n.args.sortOrder,{silentlyUpdate:!0}),n.args.sortType!==undefined&&o.sortKey.sortBy(n.args.sortType,{silentlyUpdate:!0})),o.items(l)}return e},o.apply=function(r,u){var s,h,e;if(s=null,o._shouldResultsBeApplied(r,u)){if(o._mayRefreshMessagelist(r,u),o.disableAutoRefresh()&&i)return;h=o._prepareForCommit(r,u),o.dataAvailableDeferred.resolve(),o.resultsComplete=o._areAllResultsComplete(u),t.Cmd("ml.precommit").fire(n.extend({cmd:r,isAutorefreshing:r.name==="autorefresh"},h)),s=r.animPromise||n.when(),s.then(function(){for(var f=0,i,n=0;n<o.Items.length;n++)i=o.Items[n],i.commit(r,u[i.query().key()]),f+=i.Items.length;o.numThreads(f),t.Cmd("ml.postcommit").fire({cmd:r,isAutorefreshing:r.name==="autorefresh"})}),f&&(e=null,o.initialThreadId()?e=o.getThreadById(o.initialThreadId()):t.GetUserConfig("ShowFirstMessage")&&o.Layout.isReadingPaneOn()&&(e=i.Items[0]),e&&e.selected(!0),o.initialThreadId(null),f=!1)}return s},o.handleInvalidQueries=function(n,i){var u=HM.MessageGroupQueryInvalidationType,f,r;for(f in i)r=i[f],r&&r.isQueryInvalidationChange&&$Network.FppProxy.checkFPPTypeName(r,"MessageGroupQueryInvalidationResult")&&(r=HM.createMessageGroupQueryInvalidationResult(r),r.isInvalidationTypeSet(u.ContainerRemoval)?(o.dataAvailableDeferred&&o.dataAvailableDeferred.state()==="pending"&&o.dataAvailableDeferred.reject(),t.Cmd("selectcontainer").fire({id:t.config.sysFldrs.inboxFid,entryPoint:HM.InstrumentationEntryPoint.Other})):(r.isInvalidationTypeSet(u.AnchorChange)||r.isInvalidationTypeSet(u.InvalidateEverything))&&n.name!=="addupdatedeletecategories"&&n.name!=="deletefolder"&&(o.dataAvailableDeferred&&o.dataAvailableDeferred.state()==="pending"&&o.dataAvailableDeferred.reject(),o.getPage(HM.ListNavigateDirection.FirstPage)))},o.setQueryConfigs=function(n,t){var i={pageNumber:1,fltid:t&&t.fltid||null,sortOrder:t&&t.sortOrder,sortType:t&&t.sortType};return o.setQueries(n,undefined,!1,i)},o.isLastMessageSelected=function(){var t=o.items(),r=!1,u=o.selectedItems().length===1?this.selectedItems()[0]:null,i,n,f;if(u&&t&&t.length>0)for(i=t.length-1;i>=0;i--)if(n=t[i].items(),n&&n.length>0){f=n[n.length-1],f.equals(u)&&(r=!0);break}return r},o.isFirstMessageSelected=function(){var n=o.items(),r=!1,u=o.selectedItems().length===1?this.selectedItems()[0]:null,t,i,f;if(u&&n&&n.length>0)for(t=0;t<n.length;t++)if(i=n[t].items(),i&&i.length>0){f=i[0],f.equals(u)&&(r=!0);break}return r},o._mayRefreshMessagelist=function(n,t){var u,r,s,f;if(n.name==="autorefresh"&&o.selectedItems().length>0){var h=o._calculateVisiblePageCount(t),e=o.selectedItems(),i=!0;for(u=0;u<e.length;u++){for(i=!0,r=o.Queries.length-1;r>=0;r--){for(s=t[o.Queries[r].key()].itemIds,f=0;f<h[r];f++)if(e[u].areSameThreadIds(s[f])){i=!1;break}if(!i)break}if(i){o.disableAutoRefresh(i);return}}o.disableAutoRefresh(i)}else o.disableAutoRefresh(!1)},o._extractConfig=function(n,i,r){var y,s,h,u,c;o._pendingQueryContainer=n;var p=i.pageNumber===undefined?o.pageNumber():i.pageNumber,l=i.fltid===undefined?o.filterId():i.fltid,w=i.sortOrder===undefined?o.sortKey.sortOrder():i.sortOrder,b=i.sortType===undefined?o.sortKey.sortBy():i.sortType,a=n.getQueryConfig(),f=a.firstPage,e=f&&f.userPropertyFilter,v=!0;for(e&&(y=l===t.config.sysCats.flaggedFltid,v=y?!1:e==="IsPinningEnabledForUser"?o.layout().isPinningEnabled():t.GetUserConfig(e)),s=p===1&&f&&v?f:a.defaultPage,h=s.groups,o.ActiveGroupIndex=r?0:s.activeGroup,o.GroupConfigs=[],o.GroupConfigQueries=[],u=0;u<h.length;u++)c=h[u],o.GroupConfigs[u]=c,o.GroupConfigQueries[u]=HM.createMessageGroupQuery(c.query),o.GroupConfigQueries[u].sortType=b,o.GroupConfigQueries[u].sortOrder=w,o.GroupConfigQueries[u].filterId=l},o.setQueries=function(i,r,u,f,e){if(f=f||{},r!==o.Queries||!u&&!this._getCmdPromise){e&&o.initialThreadId(e);var s=!1;o.dataAvailableDeferred&&o.dataAvailableDeferred.state()==="pending"&&(s=!0,o.dataAvailableDeferred.reject()),o.dataAvailableDeferred=n.Deferred(),o.resultsComplete=!1,o._extractConfig(i,f,r&&r.length===1),r===undefined&&(r=o.GroupConfigQueries),this._getCmdPromise=null,o.Queries&&t.Dispatcher.unregister(o.apply,o),o.queries(r),o._pendingPageNumber=f.pageNumber,r&&r.length>0&&(t.Dispatcher.register(r,o.apply,o,o.handleInvalidQueries),u||(f.updateAsGroup=!0,f.isQueryChange=!0,this._getCmdPromise=t.Dispatcher.fireCmd("get",f).deferred.promise())),s&&t.Cmd("selectcontainer").fire({id:i.Id,messageGroupQueries:r,entryPoint:HM.InstrumentationEntryPoint.MessageList,dontInstrument:!0})}return this._getCmdPromise?this._getCmdPromise:n.when()},o.setSortOrderAndType=function(n,i,r){o.sortKey.sortOrder(n,{silentlyUpdate:!0}),o.sortKey.sortBy(i,{silentlyUpdate:!0}),o.pageNumber(1),t.config.userPreferences.ConversationThreading!==r&&(t.config.userPreferences.ConversationThreading=r,o.isConversationThreadingOn(r),t.Dispatcher.fireCmd("setconversationmode",{conversationSetting:r}))},o.getActiveQuery=function(){return o.GroupConfigQueries[o.ActiveGroupIndex]},o.getPageNumber=function(){return o.pageNumber()},o.getAllVisibleThreads=function(){for(var r=[],i,t,n=0;n<o.items().length;n++)for(i=o.items[n],t=0;t<i.items().length;t++)r.push(i.items[t]);return r},o.updateFilter=function(){var i=[],r={pageNumber:1},n,t;for(o._extractConfig(o.queryContainer(),r),n=0;n<o.GroupConfigQueries.length;n++)t=o.GroupConfigQueries[n],t.sortType=this.sortKey.SortBy,t.sortOrder=this.sortKey.SortOrder,i.push(t);return o.setQueries(o.queryContainer(),i,!1,r)},o.initiateJumptoNavigation=function(n){var r,i,t;return r=[],i={},o.GroupConfigQueries.length&&(i.pageNumber=null,o._extractConfig(o.queryContainer(),i),t=o.getActiveQuery(),t.anchorType=HM.MessageGroupQueryAnchorType.JumpTo,t.jumpToAnchor=n,t.sortType=this.sortKey.SortBy,t.sortOrder=this.sortKey.SortOrder,r.push(t)),o.setQueries(o.queryContainer(),r,!1,i)},o.isQuickViewFilterOrSearch=function(){return o.isSearchResult()||o.filterId()||o.queryContainer()&&o.queryContainer().isQuickview()},o._computeAnchorData=function(n){var f,e;var r=HM.MessageGroupQueryAnchorType.None,t=o.PageNumber,s=null,h=null,u=HM.ListNavigateDirection;switch(n){case u.FirstPage:r=HM.MessageGroupQueryAnchorType.FirstPage,t=1;break;case u.LastPage:r=HM.MessageGroupQueryAnchorType.LastPage,t=o.totalPageCount();break;case u.NextPage:f=a(),f&&(r=HM.MessageGroupQueryAnchorType.StartId,h=f.Id,s=f.Timestamp,t=t?t+1:null);break;case u.PreviousPage:i&&(t=t?t-1:null,t===1?r=HM.MessageGroupQueryAnchorType.FirstPage:(e=l(),e&&(r=HM.MessageGroupQueryAnchorType.EndId,h=e.Id,s=e.Timestamp)));break;case u.CurrentPage:break;default:throw"Unhandled HM.ListNavigateDirection case "+n;}return{anchorType:r,pageNumber:t,anchorDate:s,anchor:h}},o.getPage=function(n,t){var r,e,u,f,i;for(r=o._computeAnchorData(n),e={pageNumber:r.pageNumber},o._extractConfig(o.queryContainer(),e),u=r.pageNumber===1?o.GroupConfigQueries.slice(0):[o.getActiveQuery()],f=0;f<u.length;f++)i=u[f],i.anchorType=r.anchorType,i.anchor=r.anchor,i.anchorDate=r.anchorDate,i.sortType=o.sortKey.SortBy,i.sortOrder=o.sortKey.SortOrder,i.jumpToAnchor=null;return o.setQueries(o.queryContainer(),u,t,e)}};t.AddOptionsAccessorAndInitFunctions(e.prototype,o),t.Selection.CreateSelectablePropertiesAccessors(e.prototype)}(window.originaljQuery||window.jQuery),function(n){"use strict";function h(){return{id:"",conversationId:null,senderInfos:"",senderICDisplayName:"",senders:[],senderDetails:null,sendersDetails:[],to:"",toDisplayText:"",cc:"",ccDisplayText:"",bcc:"",bccDisplayText:"",subject:"",subjectWithHtml:"",snippet:"",hasFakeSnippet:!1,editContactUrl:null,emojiEnabledSubject:"",dateReceivedLocal:"",dateReceivedLocalFull:"",messageSizeString:"",folderId:t.config.sysFldrs.noneFid,folderName:"",categories:[],count:0,body:null,safetyType:HM.BodySafetyType.Unspecified,historyType:HM.BodyHistoryType.Unspecified,isDraft:!1,isFlaggable:!1,items:[],selectedItems:[],forwarded:!1,moved:!1,replied:!1,selected:!1,isFlagged:!1,hasAttachments:!1,isVoicemail:!1,isVoicemailOnPhone:!1,isCallLog:!1,mayNotKnowSender:!1,showUnsubscribeLink:!1,unsubscribeLink:"",showAddContactLink:!1,taggingDescription:"",importance:null,isRead:!0,wasRead:!0,isSvmMail:!1,plainText:!1,isContentFiltered:!1,parent:null,liveViewsHtml:"",isMeetingRequest:!1,meetingRequestInfo:null,attachmentsHtml:"",showExpandedHeaders:!1,isConversationPart:!1,showMaxMessagesLimitHitNotification:!1,safetyBarHtml:"",unsubscribeBarHtml:"",queryContainerId:"",viewId:null,isBodyExpanded:!1,collapsible:!1,extendedType:0,timestamp:null,timestampInMillisecondsSinceEpoch:null,isTrustedSender:!1,containsNonChatItems:!1,containsChatHistoryItems:!1,containsTextMessageItems:!1,containsIMConvItems:!1,isOnlyChatHistoryItems:!1,isOnlyTextMessageItems:!1,isNewsletter:!1,isAllExpanded:!1,showCompromisedReporting:!1,socialInboxMembershipData:null,warnOnReplyForward:!1,passwordSafetySet:!1,codePage:undefined,detectedCodePages:[],isComposeSession:!1,composeActionType:HM.MessageActionType.None,composeData:null,replyAction:"",replyAllAction:"",forwardAction:"",attachments:null,quotedTextShown:!1,isFullCompose:!1,quotedText:"",composeMessageBody:"",textMode:"",draftSavedLabel:"",inlineReplySaveDraftDate:"",replyFromAddress:"",replyToRecipients:"",replyCcRecipients:"",replyAllToRecipients:"",replyAllCcRecipients:"",isPrint:!1,serverMessage:"",isPrefetched:!1,partIndex:0,ati:"",allIds:{},messageBodySize:0,inlineAttachmentsSize:0,regularAttachmentsSize:0,biciData:null,replyingMessageHasAttachments:!1,isComposeReady:!1,eeos:null}}function c(n){for(var r={},u=n.length,i,t=0;t<n.length;t++)i=n[t],i&&l(r,i.categories());return a(r,u)}function f(n,i,r){for(var e=[],f=0;f<n.length;f++){var u=n[f],o=r==="deletemsg",s=r==="markasnotjunk",h={itemId:u.id(),viewId:i&&!s&&!(o&&u.viewId()===t.config.sysFldrs.trashFid)?t.config.sysFldrs.noneFid:u.viewId(),msgInst:t.Instrumentation.getThreadInstrumentation(u),convId:u.conversationId(),checked:u.Checked};e.push(h)}return e}function l(n,t){for(var i,r=t.length;r--;)i=t[r],n[i]===undefined&&(n[i]=0),n[i]++}function a(t,i){var r=[],u=[];return n.each(t,function(n,t){n=parseInt(n,10),t===i?r.push(n):u.push(n)}),{all:r,some:u}}function s(n,t,i){var r,u;if(n.push(i),t[i.id()]=i,i.conversationId()&&(t[i.conversationId()]=i),r=i.allIds(),r)for(u in r)t[u]=i}var t=window.ol=window.ol||{},u=t.vm=t.vm||{},e="<span id='messageBoundary'><\/span>",r=u.MessageThread=function(i){var f=this,h,e,s,o;if(i&&i.composeVm&&(h=i.composeVm,delete i.composeVm),f._sourceHash=JSON.stringify(i),f.initAccessorValues(i),f._apply=n.proxy(f.apply,f),f._handleInvalidQueries=n.proxy(f.handleInvalidQueries,f),i&&i.isComposeSession&&(f._composeDataReady=n.Deferred(),f.IsComposeReady=u.Compose.isInlineComposeReadyImmediately(i),u.Compose.mapComposeDataToMessageThread({thread:f,composeVm:h,ignoreAddress:!f.IsFullCompose})),e=f.items(),e.length>0){for(s=[],o=0;o<e.length;o++)s.push(new r(t.GetObservables(e[o])));f.items(s,{silentlyUpdate:!0}),f.addChatHistoryTypeData({silentlyUpdate:!0}),f.isNewsletter(f.hasCategory(t.config.sysCats.newslettersFltid),{silentlyUpdate:!0})}f._updateQuery()},i=r.prototype,o;t.AddOptionsAccessorAndInitFunctions(i,h),t.Selection.CreateSelectablePropertiesAccessors(i),i.safetyType=function(n){var i=this,r=t.Accessor(i,"SafetyType",n);return n===undefined||i.__silentlySetProperties||i._updateQuery(),r},i.getCcAndBccDisplayText=function(n,i){var r="";return n&&(r+=t.GetString("MessageHeader.Cc")+n),n&&i&&(r+="; "),i&&(r+=t.GetString("MessageHeader.Bcc")+i),r},i.historyType=function(n){var i=this,r=t.Accessor(i,"HistoryType",n);return n===undefined||i.__silentlySetProperties||i._updateQuery(),r},i.isBodyExpanded=function(n,i){var r=this,u=r.IsBodyExpanded,f=t.AccessorWithOptions(r,"IsBodyExpanded",n,i);return n===undefined||r.__silentlySetProperties||t.data.isTemporaryId(r.Id)||n===u||!n||r._updateQuery(),f},i._preparedToRemove=!1,i._preparedToAdd=!1,i._query=null,i._indexInList=-1,i._indexInSection=-1,i.preparedToAdd=function(n){return typeof n!="undefined"&&(this._preparedToAdd=n),this._preparedToAdd},i.preparedToRemove=function(n){return typeof n!="undefined"&&(this._preparedToRemove=n),this._preparedToRemove},i.indexInList=function(n){var t=this;return typeof n!="undefined"&&(t._indexInList=n),t._indexInList},i.indexInSection=function(n){var t=this;return typeof n!="undefined"&&(t._indexInSection=n),t._indexInSection},i.clone=function(){return new r(t.GetObservables(this))},i._updateQuery=function(n){var i=this;i._query&&t.Dispatcher.unregister(i._apply,i),(n||i.isBodyExpanded())&&(i._query=HM.createItemListQuery({folderId:i.folderId(),containerId:i.id(),containerType:HM.ItemListQueryContainerType.Message,bodyProperties:HM.createBodyProperties({safetyType:i.safetyType(),historyType:i.historyType(),overrideCodepage:i.codePage(),isPrint:i.isPrint()}),dataHash:null}),t.Dispatcher.register([i._query],i._apply,i,i._handleInvalidQueries))},i.requestBody=function(i){var r=this,e;var u=r.items(),f=!1,o=n.when();if(u&&u.length){for(e=0;e<u.length;e++)if(u[e].body()===null){f=!0;break}}else r.body()===null?f=!0:r.isPrint()&&r.hasAttachments()&&(f=!0);return f&&(r._updateQuery(!0),i||(o=t.Dispatcher.fireCmd("get").deferred.promise())),o},i.updateAllExpanded=function(n){var t=this,i,r,u;if(i=t.items(),i&&i.length){for(r=0;r<i.length;r++)u=i[r],u.isBodyExpanded(n),u.isAllExpanded(n);t.isBodyExpanded(n),t.isAllExpanded(n)}else t.isBodyExpanded(n),t.isAllExpanded(n)},i.submitSvmFeedback=function(n){var i=this,r=t.Dispatcher.fireCmd("svmfeedback",{svmUrl:n,folderId:i.folderId(),svmMsgId:i.id()})},i.unregisterAllBodies=function(){var t=this,i,n;for(t.isBodyExpanded(!1,{silentlyUpdate:!0}),t._updateQuery(),i=t.items(),n=0;n<i.length;n++)i[n].unregisterAllBodies()},i.showHistoryBody=function(){var n=this;n.historyType(HM.BodyHistoryType.History),t.Dispatcher.fireCmd("get")},i.hideHistoryBody=function(){var n=this;n.historyType(HM.BodyHistoryType.NonHistory),t.Dispatcher.fireCmd("get")},i.getMessageSenderAsMessengerContact=function(){var i=this;var r=i.senderDetails(),n=r?senderDetails.senderCid:null,t=null;return n&&(t=$WLXIM.user.get_contacts().findByCid(n)),t},i.unsubscribe=function(i){var e=this,r,u;return r=[e],u=n.extend({fid:this.FolderId,items:f(r),threads:r},i),t.Dispatcher.fireCmd("unsubscribeitems",u).deferred.promise()},i.markAsSafe=function(i){var e=this,r,u;return r=[e],u=n.extend({fid:this.FolderId,item:f(r)[0]},i),t.Dispatcher.fireCmd("markassafe",u).deferred.promise()},i.showUnsafe=function(){var r=this,n,i;r.safetyType(HM.BodySafetyType.Unsafe),t.Dispatcher.fireCmd("get"),n=r.sendersDetails(),i=n&&n.length>0&&n[0].icImageTileType,i||(i="PWN"),$BSI.reportEvent("Log.IC.Pic",{PS:i})},i.codePage=function(n){var i=this,r;return r=t.Accessor(i,"CodePage",n)||i._query&&i._query.bodyProperties&&i._query.bodyProperties.overrideCodepage||-1,n===undefined||i.__silentlySetProperties||i._updateQuery(),r},i.selectCodePage=function(n){var i=this;i.codePage(n),t.Dispatcher.fireCmd("get")},i.apply=function(n,i){var r=this,u,e,f,o;u=i[r._query.key()],u.status===HM.Status.Complete&&(e=r._query.containerId,f=t.data.getMappedIdIfNecessary(e,u.idMapping),f!==e&&(r.id(f),r._updateQuery()),o=u.messages[f],r.update(o))},i.handleInvalidQueries=function(n,i){var r=this,u=i[r._query.key()];u&&u.isQueryInvalidationChange&&(t.Dispatcher.unregister(r._apply,r),r._query=null)},i.hasCategory=function(t){var r=this,i;return i=r.categories(),n.inArray(t,i)!==-1},i.addChatHistoryTypeData=function(n){var t=this,r,f,e;if(r=t.items(),r){var o=!1,i=!1,u=!1,s=!1,h=!0;for(f=0;f<r.length;f++)if(e=r[f],e){switch(parseInt(e.extendedType())){case HM.ExtendedType.e16_SMS:i=!0,u=!0;break;case HM.ExtendedType.e18_IM_CONV:i=!0,s=!0;break;case HM.ExtendedType.e19_MMS:i=!0,u=!0;break;default:o=!0}!e.isBodyExpanded()&&h&&(h=!1)}t.containsChatHistoryItems(i,n),t.isOnlyChatHistoryItems(i&&!o,n),t.containsTextMessageItems(u,n),t.isOnlyTextMessageItems(u&&!o&&!s,n),t.containsIMConvItems(s,n),t.isAllExpanded(h,n)}},i.addItem=function(t){var i=this;n.observable(i.Items).insert(i.Items.length,t)},i.update=function(n,t){var i=this,u,f,r;if(u=JSON.stringify(n),f={selected:!0,clone:!0,composeData:!0,isComposeSession:!0},i._sourceHash!==u){for(r in n)!f[r]&&r in i&&i[r](n[r],t);i._sourceHash=u}n.isComposeSession!==undefined&&i.isComposeSession(n.isComposeSession),n.composeData!==undefined&&i.composeData(n.composeData)},i.updateFromResult=function(i,u,f){var e=this,o,y,a,v,l,h,s,c;if(o=i.rollup,y=[],o)if(e.update(o,f),e.id(o.itemId,f),u){for(a=[],v=o.messageIds,l=0;l<v.length;l++)h=v[l],s=new t.vm.MessageThread,s.update(i.messages[h],f),s.id(h,f),s.viewId(e.viewId(),f),i.messages[h].body&&s.body(i.messages[h].body,f),a.push(s);e.items(a,f)}else c=r.prepareListForMerge({currentItems:e.Items,newItemIds:o.messageIds,newItemsTable:i.messages,idMapping:i.idMapping,viewId:e.viewId()}),f&&f.changes&&(n.merge(f.changes.addedThreads,c.addedThreads),n.merge(f.changes.removedThreads,c.removedThreads),n.extend(f.changes.addedThreadsMap,c.addedThreadsMap),n.extend(f.changes.removedThreadsMap,c.removedThreadsMap));return e.addChatHistoryTypeData(f),e.isNewsletter(e.hasCategory(t.config.sysCats.newslettersFltid),f),e.resetExpansionState(f),t.deferredUtils.whenAll(y)},i.resetExpansionState=function(n){for(var r=this,u=r.items().length,f=0,t,e,i=0;i<u;i++)(t=r.Items[i],t.preparedToRemove())||(u>1?(t.collapsible(!0,n),e=f===0||t.body()!==null&&t.body()!==undefined&&(!t.wasRead()||t.isDraft()||t.isFlagged()),t.isBodyExpanded(t.isBodyExpanded()||e,n),t.isConversationPart(!0,n)):(t.isBodyExpanded(!0,n),t.collapsible(!1,n),t.isConversationPart(!1,n)),f++)},i.commit=function(){for(var r=this,i,t=0;t<r.Items.length;t++)i=r.Items[t],i.preparedToRemove()&&(i.dispose(),n.observable(r.Items).remove(t,1),i.preparedToRemove(!1),t--),i.preparedToAdd()&&i.preparedToAdd(!1)},o={reply:!0,replyall:!0,forward:!0,resumedraft:!0},i.canRespondInline=function(n,i,r){var u=this,e=!0,s=u.folderId(),f,h;if(i==="resumedraft"){var c=t.data.canonicalizeDate(u.inlineReplySaveDraftDate()),l=t.data.canonicalizeDate(u.timestampInMillisecondsSinceEpoch()),a=s===t.config.sysFldrs.draftsFid&&!t.GetUserConfig("ConversationThreading")&&!u.isConversationPart();(Math.abs(l-c)>t.config.compose.inlineReply.resumeDraftThreshold||u.plainText()||t.Cookies.isPlainTextCookieSet()||a)&&(e=!1)}return f=!0,r&&r.items()&&r.items().length!==0||(f=!1),h=s===t.config.sysFldrs.trashFid,n&&f&&!!o[i]&&e&&t.config.compose.inlineReply.inlineReplyEnabled&&!h},i.markReadUnread=function(n,t,i){var u=this;r.performActionOnThreads(n?"markasread":"markasunread",[u],{entryPoint:t},i)},i.viewSource=function(n,i){var u=this,r;r="{0}/mail/GetMessageSource.aspx?tid={1}&fid={2}".format(t.GetAppConfig("getSrcHttps"),u.id(),n),window.open(r),t.Cmd("instrument.viewsource").fire({msgInst:t.Instrumentation.getThreadInstrumentation(this),entryPoint:i})},i.print=function(n){var r=this,i;i=t.vm.MessageThread.openPrintWindow(),t.vm.MessageThread.printThread(r,i.printWindow,i.printWindowLoaded,n)},i.getActionableMessageThread=function(){var t=this,n,u,i,r;if(n=null,t.items().length===0)n=this;else{for(u=t.items().length,i=0;i<u;i++)if(r=t.Items[i],!r.isDraft()&&!r.isComposeSession()){n=r;break}null===n&&(n=t.Items[0])}return n},i.equals=function(n){var t=n.id();return this.conversationId()&&n.conversationId()&&this.conversationId()===n.conversationId()||this.areSameThreadIds(t)},i.areSameThreadIds=function(n){var i=this.id();return i===n||this.conversationId()===n||!t.data.isConversationId(i)&&!t.data.isConversationId(n)&&t.data.getMid(i)===t.data.getMid(n)},i.senders=function(n,i){return t.ComplexTypeAccessor(this,"Senders",n,null,i)},i.sendersDetails=function(n,i){return t.ComplexTypeAccessor(this,"SendersDetails",n,null,i)},i.senderDetails=function(n,i){return t.ComplexTypeAccessor(this,"SenderDetails",n,null,i)},i.getSenderData=function(n,t){var u=this,o=[],f=u.isConversationPart()?[u.senderDetails()]:u.sendersDetails(),s={},r,e,i;if(f)for(r=0;r<f.length;r++)if(e=f[r],i=e.fromAddress,i&&!s[i]&&(o.push(t?i:{name:e.displayName,email:i}),s[i]=!0,n))break;return o},i.categories=function(n,i){return t.ComplexTypeAccessor(this,"Categories",n,null,i)},i.from=function(){return this.SenderDetails.fromAddress},i.fromName=function(){return this.SenderDetails.displayName},i.draftId=function(){var n=this;return t.data.isTemporaryId(n.Id)?"":n.Id},i.attachmentIds=function(){return this.Attachments?this.Attachments.serializeAttachmentsList():""},i.isComposeDataReady=function(t){var i=this,r=n.Deferred();return i.composeActionType()!==HM.MessageActionType.None||i._composeDataReady.isResolved()||i._composeDataReady.resolve(),i._composeDataReady.then(function(){r.resolve(t)}),r},i.saveDraft=function(t,i){var r=this;return r.isComposeDataReady({isAutoSave:t,entryPoint:i}).pipe(n.proxy(r.saveDraftImpl,r))},i.saveDraftImpl=function(i){var c=i.isAutoSave,r=this,s=r.ComposeMessageBody.length,h=!r.isFullCompose()&&!r.quotedTextShown(),f,o,u;return!h&&r.ComposeData&&r.ComposeData.MessageBody&&(s-=r.ComposeData.MessageBody.length),f=r.ComposeMessageBody,r.isFullCompose()||r.plainText()||(f+=e),f+=r.QuotedText,o={to:r.To,from:r.from(),cc:r.Cc,bcc:r.Bcc,priority:r.Importance,subject:r.Subject,message:f,composeMessageBody:r.ComposeMessageBody,attachmentList:r.attachmentIds(),inlineAttList:r.Attachments.serializeRoundTrippedInlineFiles(),rfc822MsgId:(r.ComposeData?r.ComposeData.Rfc822MessageId:"")||"",rfc822References:(r.ComposeData?r.ComposeData.Rfc822References:"")||"",rfc822InReplyTo:(r.ComposeData?r.ComposeData.Rfc822InReplyTo:"")||"",draftId:r.draftId(),originalMessageId:(r.ComposeData?r.ComposeData.OriginalMessageId:"")||"",replyState:(r.ComposeData?r.ComposeData.SentState:HM.MessageActionType.None)||HM.MessageActionType.None,isAutoSave:c,meetingICalId:(r.ComposeData?r.ComposeData.MeetingIcalId:"")||"",saveAsPlainText:r.PlainText,isInlineReply:h,messageId:r.Id,fromName:r.fromName(),senderDetails:"<b>"+r.from()+"<\/b>",toDisplayText:(r.ComposeData?r.ComposeData.ToDisplayText:"")||"",messageLength:s,entryPoint:i.entryPoint,isFullCompose:r.isFullCompose(),meetingRequestInfo:r.meetingRequestInfo},u=n.Deferred(),t.Dispatcher.fireCmd("savedraft",o).deferred.then(u.resolve,function(n,i){i&&t.data.fpp.FppErrorManager.serverResultsContainUpgradeError(i)?t.Dispatcher.fireCmd("savedraftm2",o).deferred.then(u.resolve,u.reject):u.reject(n,i)}),u},i.sendMessage=function(t,i,r){var u=this;return u.isComposeDataReady({needToComputeFriendshipCache:t,checkForgottenAttachment:i,entryPoint:r}).pipe(n.proxy(u.sendMessageImpl,u))},i.sendMessageImpl=function(n){for(var i=this,a=n.needToComputeFriendshipCache,v=n.checkForgottenAttachment,y=n.entryPoint,p=i.Attachments.ShareSkyDriveFiles?i.Attachments.ShareSkyDriveFiles.getDataPoints():{},u=i.ComposeMessageBody+i.QuotedText,c=u.length,f=0,e=0,l=i.Attachments.RegularFiles,w=l.length,o,s,h,r=0;r<w;r++)e+=l[r].size();for(o=i.Attachments.InlineFiles,s=o.length,r=0;r<s;r++)f+=o[r].size();return e+=f,h=t.Dispatcher.fireCmd("sendmessage",{to:i.To,from:i.from(),cc:i.Cc,bcc:i.Bcc,priority:i.Importance,subject:i.Subject,message:u,attachmentIds:i.Attachments.allAttachmentsHeadersList(),draftId:i.draftId(),draftFolderId:t.config.sysFldrs.draftsFid?t.config.sysFldrs.draftsFid:"",originalMessageId:(i.ComposeData?i.ComposeData.OriginalMessageId:"")||"",rfc822MessageId:(i.ComposeData?i.ComposeData.Rfc822MessageId:"")||"",rfc822InReplyTo:(i.ComposeData?i.ComposeData.Rfc822InReplyTo:"")||"",rfc822References:(i.ComposeData?i.ComposeData.Rfc822References:"")||"",sentState:(i.ComposeData?i.ComposeData.SentState:HM.MessageActionType.None)||HM.MessageActionType.None,sendByPlainTextFormat:i.PlainText,meetingICalId:(i.ComposeData?i.ComposeData.MeetingIcalId:"")||"",shareSkyDriveNumFiles:p.count||0,computeFriendshipCacheAndMeInformation:a,checkForgottenAttachment:v,messageId:i.Id,shouldSuppressLoadingIndicator:!0,entryPoint:y,composeActionType:i.ComposeActionType,messageLength:u.length-(i.ComposeData&&i.ComposeData.MessageBody?i.ComposeData.MessageBody.length:0),sendAsMailDomain:t.String.emailDomain(i.from()),inlineImageCount:s,isFullCompose:i.isFullCompose()}).deferred,h.then(function(){$CSIPerf.addCsd("SZB",Math.ceil((c+f)/102.4)),$CSIPerf.addCsd("SZT",Math.ceil((c+e)/102.4)),$CSIPerf.addCsd("inlinereply",!i.isFullCompose())}),h},i.endCompose=function(i){var e=i.messageSent,o=i.messageDeleted,r=this,u=0,f;return e&&(u=HM.InstrumentationComposeCancelAction.Save),o&&(u=HM.InstrumentationComposeCancelAction.Discard),f={mid:r.id(),potentialContacts:[],potentialSocialNetworkUpsellData:{},isFullCompose:r.isFullCompose(),cancelAction:u,entryPoint:HM.InstrumentationEntryPoint.Other},n.extend(f,i),r.attachments()&&r.attachments().empty(),r.IsComposeReady=!1,r.IsFullCompose=!1,t.Dispatcher.fireCmd("endcomposesession",f).deferred},i.composeData=function(i){var r=this,f,o,h,s;return i&&(f=r.composeActionType(),(f===HM.MessageActionType.Reply||f===HM.MessageActionType.ReplyAll||f===HM.MessageActionType.Forward)&&(i.OriginalMessageId=i.MessageId),JSON.stringify(i)!==JSON.stringify(r.composeData())?(o=!r.isFullCompose(),r._composeDataReady||(r._composeDataReady=n.Deferred()),u.Compose.mapComposeDataToMessageThread({thread:r,composeData:i,ignoreBody:o,ignoreAddress:o}),o&&t.config.compose.inlineReply.inlineReplyEnabled&&(f===HM.MessageActionType.ResumeDraft?(h=i.MessageBody,s=h.split(e),r.composeMessageBody(s[0]),r.quotedText(r.convertToPlainTextIfNeeded(s[1]))):f===HM.MessageActionType.Forward?(r.composeMessageBody(r.composeMessageBody()+i.MessageBody),r.quotedText(""),r.quotedTextShown(!0)):r.quotedText(r.convertToPlainTextIfNeeded(i.MessageBody))),r._composeDataReady.isResolved()||r._composeDataReady.resolve(),r.isComposeReady(!0)):r.from()||u.Compose.initializeSendersFromComposeData(r,i)),t.Accessor(this,"ComposeData",i)},i.convertToPlainText=function(i){var r=window.RTE,f=r.Editor,u=t.EmojiRenderer;return f.isEmojiEnabled()&&u&&(i=u.ReverseRenderEmoji(i)),i=r.Editor.ConvertLineBreaks(i,!0),r.ConvertToPlainText(n("<div><\/div>").html(i)[0])},i.convertToRichText=function(i){var r=window.RTE,u=r.Editor,f=t.EmojiRenderer;return i=r.ConvertToPlainText(n("<div><\/div>").html(i)[0],!0),u.isEmojiEnabled()&&f&&(i=f.RenderEmoji(u.getImageServerPath(),i)),i},i.convertToPlainTextIfNeeded=function(n){var t=this;return n!==undefined&&t.TextMode===u.Compose.TextModes.PlainText&&(n=t.convertToPlainText(n)),n},i.textMode=function(i,r){var f=this,e,o,s;return i&&(f.plainText(i===u.Compose.TextModes.PlainText),i===u.Compose.TextModes.PlainText&&f.Attachments&&n.observable(f.Attachments.InlineFiles).remove(0,f.Attachments.InlineFiles.length),r||(e=t.Cookies.get(t.config.cookies.pdCookie),e.ptm=i===t.vm.Compose.TextModes.PlainText?"1":"0",t.Cookies.setPermanent(t.config.cookies.pdCookie,e))),o=f.TextMode,s=t.Accessor(f,"TextMode",i),i&&f.QuotedText&&(i===u.Compose.TextModes.PlainText?f.quotedText(f.convertToPlainText(f.QuotedText)):o===u.Compose.TextModes.PlainText&&f.quotedText(f.convertToRichText(f.QuotedText))),s},i.dispose=function(){var n=this;n.disposeItems(),n.Attachments&&(n.Attachments.dispose(),n.attachments(null))},i.disposeItems=function(){var t=this,n,i;if(t.Items)for(n=0;n<t.Items.length;n++)i=t.Items[n],i.dispose&&i.dispose()},i.items=function(n,i){var r=this;return n!==undefined&&r.disposeItems(),t.AccessorWithOptions(r,"Items",n,i)},r.createFromResult=function(n){var t=new r;return t.updateFromResult(n,!0,{silentlyUpdate:!0}),t},r.createFromSource=function(n,i,r,f){n.id=i,n.queryContainerId=r,n.viewId=f;return new u.MessageThread(n)},r.openPrintWindow=function(){var i=n.Deferred(),r;return window.printMessagesCb=function(){i.resolve();try{delete window.printMessagesCb}catch(n){window.printMessagesCb=undefined}},r=window.open(t.baseMailUrl("PrintMessages")+"?mkt="+$Config.mkt,"","width=600px,height=400px,menubar=no,location=no,toolbar=no,resizable=yes,scrollbars=yes"),{printWindow:r,printWindowLoaded:i}},r.printThread=function(i,r,u,f){var o,s;if(t.delayLoadedControls.printMessageControl){var c="",e=i.clone(),h=e.Items;if(h.length===0)e.isPrint(!0),e.requestBody(!0),e.isBodyExpanded(!0);else for(o=0;o<h.length;o++)s=h[o],s.isPrint(!0),s.requestBody(!0),s.isBodyExpanded(!0);t.deferredUtils.whenAll([t.Dispatcher.fireCmd("get").deferred,u]).then(function(){var u=n.templates("{{printMessageControl thread=#data /}}"),i;c+=u.render(e,t.getContextObject()),r&&r.document&&(i=n(r.document.body).find(".PrintContent"),i.html(c),t.Cmd("instrument.print").fire({msgInst:t.Instrumentation.getThreadInstrumentation(e),entryPoint:f}),$B.IE&&$B.V>=10&&r.focus(),r.print())})}},r.performActionOnThreads=function(i,r,u,e){var v,nt,b,l,k,w,tt,a,h;if(!r||r.length===0)return n.when();var ft=this,s=f(r,e,i),p=!!e,o=null,c=u&&u.entryPoint;switch(i){case"markasread":case"markasunread":o=t.Dispatcher.fireCmd("markitems",{items:s,asRead:i==="markasread",includeDuplicates:p,entryPoint:c}).deferred.promise();break;case"markasflagged":case"markasunflagged":o=t.Dispatcher.fireCmd("flagitems",{items:s,asFlagged:i==="markasflagged",includeDuplicates:p,entryPoint:c}).deferred.promise();break;case"deletemsg":v=n.Deferred(),t.Instrumentation.startCSIPerfScenario({performanceId:"DM",tr:i,deferred:v,automaticallyEndScenario:!0});var it=s[0].viewId,rt=it===t.config.sysFldrs.trashFid,ut=rt?t.config.sysFldrs.permDelFid:t.config.sysFldrs.trashFid;o=t.Dispatcher.fireCmd("moveitems",{items:s,destId:ut,unFlag:!0,markRead:!1,blockIfDelete:!1,includeDuplicates:p,entryPoint:c,originalAction:i,csiPerfDeferred:v}).deferred.promise(),o.then(v.resolve,v.reject);break;case"movemsg":case"movetoarchive":nt=u.folderId===t.config.sysFldrs.trashFid||u.folderId===t.config.sysFldrs.junkFid,o=t.Dispatcher.fireCmd("moveitems",{items:s,destId:u.folderId,unFlag:u.unflag||nt,markRead:!!u.markRead,blockIfDelete:!1,includeDuplicates:p,entryPoint:c,skipFocus:u.skipFocus,toArchive:i==="movetoarchive"||u.toArchive}).deferred.promise();break;case"markasjunk":for(b=function(n){var t=n.sendersDetails();return t||n.items().length!==1||(n=n.items()[0],t=n.sendersDetails()),t.length>0?t[0]:n.senderDetails()},l=!1,h=0;!l&&h<r.length;h++)for(k=b(r[h]),w=0;!l&&w<k.length;w++)l=k[w].isSenderSelf;if(tt=r.length===1,tt&&!t.data.isConversationId(r[0].id())){var d=r[0],g=d.items(),y=b(g&&g.length>0?g[0]:d);o=n.Deferred(),t.controlHelpers.SafetyUI.create().maybeShowJunkSenderExperience({isSenderInContactList:!l&&y.isSenderInContactList,isSenderInWhiteList:!l&&y.isSenderInWhiteList,senderEmailAddress:y.fromAddress,senderDisplayName:y.displayName,showCompromisedReporting:!l&&d.showCompromisedReporting(),isSenderPinned:y.isSenderPinned}).then(function(n){var f=HM.RemoveSenderFromListOption.None,i=!1,r;n&&(i=n.accountIsCompromised,f=n.removeFromList),r=t.Dispatcher.fireCmd(i?"compromiseitems":"junkitems",{fid:u.folderId,items:s,atLeastOneMessageFromSelf:l,enableJmrReporting:u.enableJmrReporting,removeFromList:f,entryPoint:c}).deferred.promise(),r.always(function(){r.isResolved()?(i&&o.done(function(){t.controlHelpers.SafetyUI.create().showSafetyNotificationWithNavigationButton({message:t.GetString("Inbox.Safety.Notifications.Compromised.Message")})}),o.resolve()):o.reject()})})}else o=t.Dispatcher.fireCmd("junkitems",{fid:u.folderId,items:s,atLeastOneMessageFromSelf:l,enableJmrReporting:u.enableJmrReporting,entryPoint:c}).deferred.promise();break;case"markasnotjunk":for(a=null,h=0;h<r.length;h++)(!a||r[h].timestamp()>a.timestamp())&&(a=r[h]);o=t.Dispatcher.fireCmd("unjunkitems",{fid:u.folderId,items:s,enableJmrReporting:u.enableJmrReporting,entryPoint:c}).deferred.promise(),a&&o.done(function(){var n={srcCtl:u.srcCtl};s.length===1?(n.message=t.GetString("Inbox.Safety.Notifications.NotJunk.Message.Single"),n.button={caption:t.GetString("Inbox.Safety.Notifications.NotJunk.Single.ButtonText"),navigateTo:"/default.aspx?tid="+a.id()}):n.message=t.GetString("Inbox.Safety.Notifications.NotJunk.Message.Multiple"),t.controlHelpers.SafetyUI.create().showSafetyNotificationWithNavigationButton(n)});break;case"markascompromised":o=t.Dispatcher.fireCmd("compromiseitems",{fid:u.folderId,items:s,enableJmrReporting:u.enableJmrReporting,entryPoint:c}).deferred.promise();break;case"markasphish":o=t.Dispatcher.fireCmd("phishitems",{fid:u.folderId,items:s,enableJmrReporting:u.enableJmrReporting,entryPoint:c}).deferred.promise()}return o},r.categorizeThreads=function(n,i,r,u,e){if(u)$menu.closeCurrent(),t.Cmd("bulkactionbycontainer").fire({action:"categorize",categoryChanges:i,entryPoint:r});else{var o=f(n,e);t.Dispatcher.fireCmd("categorizeitems",{items:o,apply:i.apply,remove:i.remove,includeDuplicates:!!e,entryPoint:r})}},r.getCurrentCategorySelection=function(n){var t,i;return n.length>1?t=n:n.length===1&&n[0].Items.length>0?t=n[0].Items:i={all:n[0].categories(),some:[]},!t||(i=c(t)),i},r.getItemIdsFromMessageInfos=function(n){var i=[],t;if(n&&n.length)for(t=0;t<n.length;t++)i[t]=n[t].itemId;return i},r.prepareListForMerge=function(i){function p(){if(c<d.length){r=d[c],a=t.data.getMappedIdIfNecessary(r.id(),i.idMapping);var u=n.inArray(a,l);y=u===-1||u>=k||c>u||c<v,c++}else r=a=null,y=!1}function w(){v<k?(h=l[v],u=nt[h],v++):u=h=null}var e;var o={addedThreads:[],removedThreads:[],addedThreadsMap:{},removedThreadsMap:{}},l=i.newItemIds,nt=i.newItemsTable,k=typeof i.maxCount=="number"?Math.min(i.maxCount,l.length):l.length,u,h,d=i.currentItems.slice(0),r,a,y,v=0,c=0;var f=0,b=i.sectionStart,g=typeof b!="undefined";for(p(),w();r||u;){if(a===h)u.viewId=i.viewId,r.update(u),r.id(u.messageId||u.itemId),g&&(r.indexInList(b+f),r.indexInSection(f)),p(),w();else if(y)r.preparedToRemove(!0),s(o.removedThreads,o.removedThreadsMap,r),r.indexInList(-1),r.indexInSection(-1),p();else if(u)e=t.vm.MessageThread.createFromSource(u,h,i.queryContainerId,i.viewId),n.observable(i.currentItems).insert(f,e),e.preparedToAdd(!0),s(o.addedThreads,o.addedThreadsMap,e),g&&(e.indexInList(b+f),e.indexInSection(f)),w();else throw"ol.vm.MessageThread.prepareListForMerge: Invalid data returned from data layer -- an iteration resulted in no action!";f++}return o}}(window.originaljQuery||window.jQuery),function(n){"use strict";function o(r,u,f){var o=this,e=null;if(!r)return null;switch(f){case i.Archive:case i.Delete:case i.Move:case i.Sweep:e="";break;case i.Categorize:e=n.inArray(parseInt(u),r.categories())>=0?"0":"1";break;case i.Junk:e=r.folderId()===t.config.sysFldrs.junkFid?"0":"1";break;case i.Pin:e=r.isFlagged()?"0":"1";break;case i.Read:e=r.isRead()?"0":"1"}return e}var t=window.ol=window.ol||{},s=t.vm=t.vm||{},h=t.Accessor,c=t.config.sysFldrs,r={archive:t.GetString("InstantActions.Tooltips.Archive"),add:t.GetString("InstantActions.Tooltips.Categorize.Add"),remove:t.GetString("InstantActions.Tooltips.Categorize.Remove"),deleteStr:t.GetString("InstantActions.Tooltips.Delete"),junk:t.GetString("InstantActions.Tooltips.Junk.Junk"),notJunk:t.GetString("InstantActions.Tooltips.Junk.NotJunk"),flagged:t.GetString("InstantActions.Tooltips.Flag.Flagged"),pinFlaggingEnabled:t.GetString("InstantActions.Tooltips.Flag.Unflagged.PinFlaggingEnabled"),pinFlaggingDisabled:t.GetString("InstantActions.Tooltips.Flag.Unflagged.PinFlaggingDisabled"),read:t.GetString("InstantActions.Tooltips.Mark.Read"),notRead:t.GetString("InstantActions.Tooltips.Mark.NotRead"),sweepMove:t.GetString("InstantActions.Tooltips.Sweep.Move"),sweepDelete:t.GetString("InstantActions.Tooltips.Sweep.Delete"),moveAndMark:{targeted:t.GetString("InstantActions.Tooltips.MoveAndMark.Targeted"),generic:t.GetString("InstantActions.Tooltips.MoveAndMark.Generic")},move:{targeted:t.GetString("InstantActions.Tooltips.Move.Targeted"),generic:t.GetString("InstantActions.Tooltips.Move.Generic")}},u={action:"",index:"",target:"",read:!1,imageTitle:"",imageClassname:"",thread:null,folderList:null,categoryList:null,layout:null},e=s.InstantActionItem=function(n){var t=this;t._instance="",t.Action=n.action||u.action,t.Index=n.index||u.index,t.Target=n.target||u.target,t.Read=n.read||u.read,t.ImageTitle=n.imageTitle||u.imageTitle,t.ImageClassname=n.imageClassname||u.imageClassname,t.Thread=n.thread||u.thread,t.FolderList=n.folderList||u.folderList,t.CategoryList=n.categoryList||u.categoryList,t.Layout=n.layout||u.layout,t._update(!0)},f=e.prototype,i;f.subscribe=function(){var r=this;r._namespace=t.createControlNamespace("InstantActionItemViewModel");var e=r.Action,u=null,f=null;e===i.Move?(u=r.FolderList,f=r.Target):e===i.Categorize&&(u=r.CategoryList,f=parseInt(r.Target)),u&&(r._containerModel=u.getContainerById(f),r._containerModel&&n.observable.simpleOn(r._containerModel,"propertyChange."+r._namespace,n.proxy(r.propertyChangeUpdateHandler,r)))},f.getImageTitle=function(){var n=this,t=null,c=n.Thread,u,f,e;switch(n.Action){case i.Archive:t=r.archive;break;case i.Categorize:var o=parseInt(n.Target),s=n.CategoryList.getContainerById(o).name(),h=n._instance!=="0"?r.add:r.remove;t=h.format(s);break;case i.Delete:t=r.deleteStr;break;case i.Junk:t=n._instance==="0"?r.junk:r.notJunk;break;case i.Move:u=n.FolderList.getContainerById(n.Target),f=u?u.name():"",e=n.Read?"moveAndMark":"move",t=f?r[e].targeted.format(f):r[e].generic;break;case i.Pin:t=n._instance==="0"?r.flagged:n.layout().isPinningEnabled()?r.pinFlaggingEnabled:r.pinFlaggingDisabled;break;case i.Read:t=n._instance==="0"?r.read:r.notRead;break;case i.Sweep:t=n.Index==="0"?r.sweepDelete:r.sweepMove}return t},f.getImageClassname=function(){var n=this,t="ia_i_"+n.Action+n.Index;return n._instance&&(t+="_"+n._instance),t},f.updateThreadAndGroupConfig=function(n,t){this.Thread=n,this._groupConfigForFloatingIA=t,this._update()},f.getGroupConfigForFloatingIA=function(){return this._groupConfigForFloatingIA},f._update=function(n){var t=this;n?(t._instance=o(t.Thread,t.Target,t.Action),t.ImageTitle=t.getImageTitle(),t.ImageClassname=t.getImageClassname()):(t._instance=o(t.Thread,t.Target,t.Action),t.imageTitle(t.getImageTitle()),t.imageClassname(t.getImageClassname()))},f.propertyChangeUpdateHandler=function(n,t){switch(t.path){case"Name":case"IsRead":case"IsFlagged":case"Categories":this._update()}},f.dispose=function(){var t=this;t._containerModel&&n.observable.simpleOff(t._containerModel,"propertyChange."+t._namespace)},f.isJunkOrNotJunk=function(){var n=this;return n._instance!=="0"},f.isApplyOrRemoveCategory=function(){var n=this;return n._instance!=="0"},t.CreateAccessors(f,u),i=e.ActionType={Archive:"a",Categorize:"c",Delete:"d",Junk:"j",Move:"v",Pin:"p",Read:"r",Sweep:"s"}}(window.originaljQuery||window.jQuery),function(n){"use strict";var t=window.ol=window.ol||{},r=t.vm=t.vm||{},f=t.Accessor,u=r.InstantActionSetting={},i;u.cachedSettings={},u.getUserSettings=function(n){var l=t.config.appSettings.IsPinningAllowed,i=u.cachedSettings[!!n+""],e,r,f,h,c;if(i)return i;if(e="p",i={hoverItems:[],fixedItems:[]},r=t.config.instantActionsSettings,r)for(f in r){var o=r[f],s=f.substring(0,1),a=f.substring(1);(!n||l&&s===e)&&(h=n?s!==e:o._IATYPE_==="h",c={action:s,index:a,target:o.t,read:!!o.r,hover:h},i[h?"hoverItems":"fixedItems"].push(c))}return u.cachedSettings[!!n+""]=i,i},i=r.InstantActions=function(n){var f=this,e,i;f.hoverItems=[],f.fixedItems=[],f._namespace=t.createControlNamespace("InstantActionsViewModel");for(var o=r.InstantActionSetting.getUserSettings(n.isMessagePart),s=o.hoverItems,u=0,u=0;u<s.length;u++)i=s[u],f.hoverItems.push(new r.InstantActionItem({action:i.action,index:i.index,target:i.target,read:i.read,thread:n.thread,folderList:n.folderList,categoryList:n.categoryList,layout:n.layout}));for(e=o.fixedItems,u=0;u<e.length;u++)i=e[u],f.fixedItems.push(new r.InstantActionItem({action:i.action,index:i.index,target:i.target,read:i.rea,thread:n.thread,folderList:n.folderList,categoryList:n.categoryList,layout:n.layout}));f.thread=n.thread},i.prototype.updateThreadAndGroupConfig=function(n,t){var r=this,i,u=[];for(r._unsubscribeFromThreadChanges(),i=0;i<r.hoverItems.length;i++)u.push(r.hoverItems[i]),r.hoverItems[i].updateThreadAndGroupConfig(n,t);for(i=0;i<r.fixedItems.length;i++)u.push(r.fixedItems[i]),r.fixedItems[i].updateThreadAndGroupConfig(n,t);r.thread=n,r._subscribeToThreadChanges(u)},i.prototype.subscribe=function(){var n=this,t,i;if(n.thread){for(t=n.hoverItems.concat(n.fixedItems),i=0;i<t.length;i++)t[i].subscribe();n._subscribeToThreadChanges(t)}},i.prototype._subscribeToThreadChanges=function(t){var i=this;i.thread&&n.observable.simpleOn(i.thread,"propertyChange."+i._namespace,function(n,i){for(var r=0;r<t.length;r++)t[r].propertyChangeUpdateHandler(n,i)})},i.prototype._unsubscribeFromThreadChanges=function(){var t=this;t.thread&&n.observable.simpleOff(t.thread,"propertyChange."+t._namespace)},i.prototype.dispose=function(){var n=this,i,t;if(n.thread){for(i=n.hoverItems.concat(n.fixedItems),t=0;t<i.length;t++)i[t].dispose();n._unsubscribeFromThreadChanges()}}}(window.originaljQuery||window.jQuery),function(n){"use strict";function i(n){return{from:"",to:"",subject:"",keywords:"",categories:[],folders:[],date:"",dateRange:n?null:HM.SearchDateRange.ThreeDays,hasAttachments:n?null:HM.SearchHasAttachments.AnyAttachments,contactMappings:{},selectedContainer:null,searchEnabled:!0,folderList:null,categoryList:null}}var t=window.ol=window.ol||{},r=t.vm=t.vm||{},e=t.Accessor,u=r.Search=function(r){function o(n){var r="",t,i,u;if(n){t=[];for(i in n)u=n[i],t.push(encodeURIComponent(i)+"="+encodeURIComponent(u));r=t.join("&")}return r}function s(n){var r={},i,t;if(n)for(i=n.split("&"),t=0;t<i.length;t++){var u=i[t].split("="),f=decodeURIComponent(u[0]),e=decodeURIComponent(u[1]);r[f]=e}return r}function h(){u.FolderList||u.folderList(new t.vm.ContainerList({newItemLabel:null,type:HM.ContainerType.Folders,rootContainer:new t.vm.Container({id:t.config.sysFldrs.noneFid,depth:0})})),u.CategoryList||u.categoryList(new t.vm.ContainerList({newItemLabel:null,type:HM.ContainerType.Categories})),t.config.serverRenderOnly||n.observable.simpleOn(u,"propertyChange",function(n,t){t.path==="SelectedContainer"&&u.onSelectedContainerChanged()})}var u=this,f=i(),e;u.initAccessorValues(r),e=null,u.resetSearch=function(){u.resetTextFields(),u.resetFilterFields(),u.contactMappings(n.extend(!0,{},f.contactMappings))},u.resetSearchMessageListCache=function(){t.Dispatcher.fireCmd("resetsearchcache")},u.resetTextFields=function(){u.from(f.from),u.to(f.to),u.subject(f.subject),u.keywords(f.keywords)},u.resetFilterFields=function(){u.categories(f.categories.slice(0)),u.folders(f.folders.slice(0)),u.date(f.date),u.dateRange(f.dateRange),u.hasAttachments(f.hasAttachments)},u.commitSearchBox=function(n,t){var i,r;u.resetTextFields();for(i in n)if(u[i])n[i]instanceof Array?u[i](n[i].slice(0)):u[i](n[i]);else if(i==="newContactMappings")for(r in n.newContactMappings)u.contactMappings()[r]=n.newContactMappings[r];else i==="mustHaveAttachments"&&u.hasAttachments(HM.SearchHasAttachments.HasAttachments);u.performSearch(t)},u.getSearchBoxParams=function(){return{to:this.to(),from:this.from(),subject:this.subject(),keywords:this.keywords(),categories:this.categories().slice(0),folders:this.folders().slice(0),mustHaveAttachments:this.hasAttachments()===HM.SearchHasAttachments.HasAttachments}},u.performSearch=function(n){u.removeUnusedContactMappings(),t.Cmd("search").fire({entryPoint:HM.InstrumentationEntryPoint.LeftNav,searchOrigin:n,searchContext:u.getInstrumentationSearchContext(),searchIncludesDeleted:!1})},u.getInstrumentationSearchContext=function(){if(u.selectedContainer()){if(u.selectedContainer().id()===t.config.sysFldrs.searchFid)return HM.InstrumentationSearchContext.SearchResults;if(u.selectedContainer().id()===t.config.sysFldrs.inboxFid)return HM.InstrumentationSearchContext.Inbox;if(u.selectedContainer().isCategory())return HM.InstrumentationSearchContext.Category;if(u.selectedContainer().isFolder())return HM.InstrumentationSearchContext.Folder}return HM.InstrumentationSearchContext.Unknown},u.removeUnusedContactMappings=function(){var t,n;for(t in u.contactMappings())n="["+t+"]",u.to().indexOf(n)<0&&u.from().indexOf(n)<0&&u.subject().indexOf(n)<0&&u.keywords().indexOf(n)<0&&delete u.contactMappings()[t]},u.getSearchParams=function(){var n=null;return this.isDefaultState()||(n=HM.createAdvancedSearch({From:u.from(),To:u.to(),Subject:u.subject(),Keywords:u.keywords(),Folders:u.folders()&&u.folders().length?u.folders().slice(0):null,Categories:u.categories()&&u.categories().length?u.categories().slice(0):null,Date:u.date(),DateRange:u.dateRange(),HasAttachments:u.hasAttachments(),ContactMappings:u.contactMappings()})),n},u.setFromSearchParams=function(t){t&&(u.from(t.From||f.from),u.to(t.To||f.to),u.subject(t.Subject||f.subject),u.keywords(t.Keywords||f.keywords),u.categories(t.Categories?t.Categories.slice(0):f.categories.slice(0)),u.folders(t.Folders?t.Folders.slice(0):f.folders.slice(0)),u.date(t.Date||f.date),u.dateRange(t.DateRange||f.dateRange),u.hasAttachments(t.HasAttachments||f.hasAttachments),u.contactMappings(n.extend(!0,{},t.ContactMappings||f.contactMappings)))},u.clone=function(){var n=HM.deepCopy({from:u.from(),to:u.to(),subject:u.subject(),keywords:u.keywords(),categories:u.categories(),folders:u.folders(),date:u.date(),dateRange:u.dateRange(),hasAttachments:u.hasAttachments(),contactMappings:u.contactMappings()});return n.folderList=u.folderList(),n.categoryList=u.categoryList(),new t.vm.Search(n)},u.copyFrom=function(t){u.from(t.from()),u.to(t.to()),u.subject(t.subject()),u.keywords(t.keywords()),u.categories(t.categories().slice(0)),u.folders(t.folders().slice(0)),u.date(t.date()),u.dateRange(t.dateRange()),u.hasAttachments(t.hasAttachments()),u.contactMappings(n.extend(!0,{},t.contactMappings()))},u.getHistoryState=function(n){var i={},r={folders:n.fid&&n.fid!==t.config.sysFldrs.inboxFid?[n.fid]:[],categories:n.qvid?[n.qvid]:[]};return this.isDefaultState(r)||(i.srch=1,i.sfrm=this.from(),i.sto=this.to(),i.ssub=this.subject(),i.skws=this.keywords(),i.sfld=this.folders().join(),i.scat=this.categories().join(),i.sdt=this.date(),i.sdr=this.dateRange(),i.satt=this.hasAttachments(),i.scmp=o(this.contactMappings())),i},u.restoreFromHistory=function(t){t.srch?(u.from(t.sfrm||f.from),u.to(t.sto||f.to),u.subject(t.ssubj||f.subject),u.keywords(t.skws||f.keywords),u.folders(t.sfld?t.sfld.split(","):f.folders),u.categories(t.scat?n.map(t.scat.split(","),Number):f.categories),u.date(t.sdt||f.date),u.dateRange(parseInt(t.sdr)),u.hasAttachments(parseInt(t.satt)),u.contactMappings(s(t.scmp))):u.resetSearch()},u.onSelectedContainerChanged=function(){var i=u.selectedContainer(),n=i&&i.id(),r;if(i&&n!==t.config.sysFldrs.searchFid){u.resetSearch(),e===t.config.sysFldrs.searchFid&&u.resetSearchMessageListCache();switch(n){case t.config.sysFldrs.inboxFid:break;default:r=i.containerType(),r===HM.ContainerType.Folders?this.folders([n]):r===HM.ContainerType.Categories&&this.categories([n])}u.searchEnabled(i.isSearchable())}e=n?n:null},u.areFoldersDefault=function(){return t.Array.areEquivalent(u.folders(),f.folders)},u.areCategoriesDefault=function(){return t.Array.areEquivalent(u.categories(),f.categories)},u.areAttachmentsDefault=function(){return u.hasAttachments()===f.hasAttachments},u.isDateDefault=function(){return u.date()===f.date},u.isDefaultState=function(i){var r=n.extend({},f,i);return u.to()===r.to&&u.from()===r.from&&u.subject()===r.subject&&u.keywords()===r.keywords&&t.Array.areEquivalent(u.folders(),r.folders)&&t.Array.areEquivalent(u.categories(),r.categories)&&u.date()===r.date&&u.dateRange()===r.dateRange&&u.hasAttachments()===r.hasAttachments},h()},f=u.prototype;t.AddOptionsAccessorAndInitFunctions(f,i)}(window.originaljQuery||window.jQuery),function(){"use strict";function r(){return{peoplePaneManager:null,rightRailManager:null,adbar:null,layout:null,rightRailRemoved:!1}}var n=window.ol=window.ol||{},i=n.vm=n.vm||{},f=n.data=n.data||{},t=ol.controlHelpers=ol.controlHelpers||{},e=t.SocialInbox=t.SocialInbox||{},o=ol.Accessor,u=i.RightRail=function(n){var t=this;t.initAccessorValues(n),this.canShowRightRail=function(){var i=this.Layout.isRightRailForcedOff(),n=this.Layout.isFullView(),r=this.Layout.isReadingPaneOn(),t=!ol.config.adbar.renderAd,u=t&&!ol.config.socialInbox.enabled||this.isWebImShowing()||this.rightRailRemoved()||n&&i||!n&&!r&&t;return!u},this.isWebImShowing=function(){var n=window.$WLXIM;return n&&n.isSidebarOpened()}};ol.AddOptionsAccessorAndInitFunctions(u.prototype,r)}(),function(n){"use strict";var i=window.wLive,t=window.ol=window.ol||{},r;t.pages=t.pages||{},t.pages.PageManagerProxy=function(n,t){var i=this,r=n;i.registerKeyboardHandler=function(i){return n.registerKeyboardHandler(i,t)},i.getCurrentView=n.getCurrentView,i.wrapRestoreHistoryFunction=n.wrapRestoreHistoryFunction},r=t.pages.PageManager=function(r,u,f,e){function at(){$Do.when("$PF.attachPreMerge",0,wt),$Do.when("NotificationControls",0,function(){$B.IE&&$B.V<=8||i.Controls.Notifications.enableAriaSupport(),i.Controls.Notifications.getQueue().start()});n(window).on("unload",et).on("beforeunload",ot);t.Cmd.exists("nav.cancelpendingcsiperfscenario")&&t.Cmd("nav.cancelpendingcsiperfscenario").subscribe(rt)}function k(t){var u=n.Deferred(),f=t.settings.navigatesTo,i,r;return f?(v<=0&&(!t.args||!t.args.skipHistory)&&t.deferred.done(vt),t.historyRestore=t.args&&t.args.skipHistory,i=n.when(),h&&h.promise&&(i=h.promise),r=i.pipe(function(){return ut(f,t)}),t.settings.onlyNavigates&&r.then(t.deferred.resolve,t.deferred.reject),r):(u.resolve(),u.promise())}function tt(){$Do.when("$History.attach",0,function(n,t){pt(t)})}function vt(){var n=o.getCurrentHistoryStates(),i,r;for(i in n)r=n[i],(r===null||r===""||d[i]==r)&&delete n[i];t.config.appSettings.ComScoreBeaconUrl&&$Beacon.fire(t.config.appSettings.ComScoreBeaconUrl,null,null,null,!0),setTimeout(function(){$Do.when("$History",0,function(){top.History.addNavigationStep(n,!0)})},50)}function yt(n){var t,r;for(t in n){var i=n[t],u=lt[t],f=typeof i;u==="number"&&f==="string"&&(r=n[t]=parseInt(i,10),isNaN(r)&&(n[t]=i))}}function pt(i,r){yt(i),i=n.extend({},d||{},i);var u=i.page;r=n.extend(!0,{historyRestore:!0},r),o.loadAndInitializeView(u,r).then(function(){var n=s[u];n&&n.onRestoreFromHistory&&o.wrapRestoreHistoryFunction(n.onRestoreFromHistory,n)(i,r,new t.pages.PageManagerProxy(o,u))})}function it(n){var t=s[n];l.unRegisterHandler(n),t&&(t.dispose(),delete s[n],a("onviewdisposed",{view:n}),$CSIPerf.clearTTxDeferred())}function wt(){ft(c).done(function(){$PF.allowMerge()})}function rt(){o._navCmdPending&&(t.Instrumentation.cancelCSIPerfScenario({cmd:o._navCmdPending}),o._navCmdPending=null)}function ut(n,t){return!t||t.args&&(t.args.dontInstrument||t.args.alreadyRecordedStart)||(rt(),$BSI.informNav()),t=t||{},t.isInitialPage=!b,nt&&ct(!0,n+" loading..."),h&&(h.aborted=!0,h=null),a("onbeginnavigate",t),st([o.loadViewWithLoadingIndicator,o.initializeView,ft,kt,dt,bt],[n,t],!0)}function bt(r,u){if(u&&u.args&&u.args.dontInstrument||gt(r,u),nt&&(ct(!1,r+" finished loading"),ni(!0,r)),!b){var f=n(_ge("Curtain"));f[0]&&i.Animations.fadeOut(f[0]).then(function(){t.Cmd("curtaindown").fire({state:t.init.getCurtainState()}),f.remove(),t.init.curtainDown()}),n(".glassContent").remove(),t.Cmd.exists("glassdown")&&t.Cmd("glassdown").fire(),b=!0}return t.Cmd("nav.complete").fire({view:r}),n.Deferred().resolve(r,u).promise()}function ft(t,i){var u=s[c],r=n.Deferred();return u&&u.onBeforeNavigateFrom?u.onBeforeNavigateFrom(i).then(function(n){n&&n.context&&n.context.historyRestore&&n.navigateAway?top.history.go(-1):r.resolve(t,n&&n.context?n.context:i)},function(n){r.reject(t,n&&n.context?n.context:i)},function(n){a("onnavigationprevented",n&&n.context?n.context:i)}):r.resolve(t,i),r.promise()}function kt(t,i){var u=s[t],f=t!==c,r=n.Deferred();return u.onBeforeNavigateTo?u.onBeforeNavigateTo(f,i).then(function(n){r.resolve(t,n&&n.context?n.context:i)},function(n){r.reject(t,n&&n.context?n.context:i)}):r.resolve(t,i),r.promise()}function dt(i,r){var f,v,h;var e=s[i],p=y[c],w=y[i],u=c,o=i!==u;if(o){if(u&&l.enableHandler(u,!1),a("onbeforeviewswitch",r),f=u&&s[u].viewContainer,v=e.viewContainer,f&&f.addClass("NoDisplay"),v.removeClass("NoDisplay"),$B.IE_M7&&(f&&f.find("INPUT").addClass("NoDisplay"),v.find("INPUT").removeClass("NoDisplay")),h=s[u],h&&h.onNavigateFrom)h.onNavigateFrom(r);c=i}if($menu.closeAll(),t.DismissNotifications(t.NotificationDismissalType.navigation,!o),e&&e.onNavigateTo)e.onNavigateTo(o,r);return l.enableHandler(i,!0),a("onafterviewswitch",r),o&&p&&p.disposeOnNavigation&&it(u),a("onendnavigate",r),n.Deferred().resolve(i,r).promise()}function et(){$BSI.informNav(),$BSI.informPVHead(),$BSI.informLoaded(!0,!0),$CSIPerf.clearTTxDeferred()}function ot(n){var i=s[c],t;if(i&&i.getOnBeforeUnloadString&&(t=i.getOnBeforeUnloadString(),t))return n.returnValue=t,t}function st(t,i,r){var f,e,u,o;for(f=null,r&&(h=f={aborted:!1,promise:null}),e=n.Deferred(),u=e,o=0;o<t.length;o++)u=u.pipe(t[o]),r&&(u=u.pipe(function(){var t=n.Deferred();return f.aborted?t.reject.apply(t,arguments):t.resolve.apply(t,arguments),t.promise()}));return r&&(f.promise=u.promise().always(function(){h=null})),e.resolve.apply(e,i),u.promise()}function ht(n,t){$CSIPerf.csdContains("TR")||(t&&!t.isInitialPage&&t.name?$CSIPerf.addCsd("TR",t.name):($CSIPerf.setPerformanceId(n),$CSIPerf.addCsd("TR","nav."+n)))}function gt(n,i){if(i.deferred){o._navCmdPending=i;var r=i.csiPerfDeferred||i.deferred;r.done(function(){o._navCmdPending===i&&(o._navCmdPending=null,ht(n,i),i&&i.settings&&i.settings.setCsd&&i.settings.setCsd(i),t.Instrumentation.endCSIPerfScenario({cmd:i}))})}else ht(n,i),i&&i.settings&&i.settings.setCsd&&i.settings.setCsd(i),t.Instrumentation.endCSIPerfScenario({glassAlreadyRecorded:i.isInitialPage})}function a(n,t){p.trigger(n,t)}function ct(t,i){var r=n("#PageReadyDiv");r.html(i),r.toggle(t)}function ni(t,i){t?n(document.body).attr("pagefunctional",i):n(document.body).removeAttr("pagefunctional")}var p=n(this),o=this,c,h,y=u.manifests,l=new t.KeyboardHandlerManager,s={},w={},d=f||{},lt=e||{},g=n(r),nt=t.config.requestSettings.IsSutraEnabled,b=!1,v=0;o.$=p,o.dispose=function(){t.Cmd.unregisterExecutionStrategy(k),n(window).off("unload",et).off("beforeunload",ot);for(var i in s)it(i);p.unbind(),t.Cmd("keyboardhandler.enable").unsubscribe(o._keyboardEnable),t.Cmd("keyboardhandler.register").unsubscribe(o._keyboardRegister),l.dispose(),l=s=null},o.initialize=function(i,r){var u=null;return r&&r.rruCommand?(tt(),t.Cmd.registerExecutionStrategy(k),u=t.Cmd(r.rruCommand).fire(r).deferred):u=ut(i,r).always(function(){tt(),t.Cmd.registerExecutionStrategy(k)}),o._keyboardEnable=n.proxy(o.onKeyboardHandlerEnable,o),o._keyboardRegister=n.proxy(o.onKeyboardHandlerRegister,o),t.Cmd("keyboardhandler.enable").subscribe(o._keyboardEnable),t.Cmd("keyboardhandler.register").subscribe(o._keyboardRegister),u},o.onKeyboardHandlerEnable=function(n){var t=n.page||c;t&&l.enableHandler(t,n.value)},o.onKeyboardHandlerRegister=function(n){o.registerKeyboardHandler(n.handler,n.page)},o.getCurrentView=function(){return c},o.loadAndInitializeView=function(n,t){return st([o.loadView,o.initializeView],[n,t],!1)},o.loadViewWithLoadingIndicator=function(n,t){return o.loadView(n,t,!0)},o.loadView=function(i,r,u){function o(){w[i]||(w[i]=!0,a("onviewloaded",{view:i,context:r})),f.resolve(i,r)}var f,e;return f=n.Deferred(),w[i]?o():(e=y[i],e?e.load?t.init.LoadAll(e.load,u).then(o,function(){f.reject(i,r)}):o():f.reject(i,r)),f.promise()},o.initializeView=function(i,r){var e,h,f,u;return e=n.Deferred(),s[i]||(h=y[i],f=new t.pages[h.className],u=g.find("#page"+i),(u.length===0||u.is(".glassContent"))&&(u=n("<div/>",{id:"page"+i,"class":"v-Page NoDisplay"}).appendTo(g)),f.initialize(u,new t.pages.PageManagerProxy(o,i),h.initContext,r),s[i]=f,f.view=i,f.viewContainer=u,a("onviewinitialized",{view:i,viewInstance:s[i],context:r})),e.resolve(i,r),e.promise()},o.getCurrentHistoryStates=function(){var i={page:c},t=s[c];return t&&t.getHistoryState&&n.extend(i,t.getHistoryState()),i},o.registerKeyboardHandler=function(n,i){l.registerHandler(n,i)},o.toggleKeyboardHandler=function(n){l.enableHandler(o.getCurrentView(),n)},o.wrapRestoreHistoryFunction=function(n,t){return function(){v++;try{n.apply(t,arguments)}finally{v--}}},at()}}(window.originaljQuery||window.jQuery),function(n,t){"use strict";function f(n,t){var i="",r;return n&&t>0&&(r=" "+($B.rtl?"‏":""),i=r+t),i}var u="containerTemplate",e=20,o=10,s=20,i,h=t.templates(null,{markup:"#"+u,allowCode:!0,converters:{getSubtreeClass:function(n){return"exco_body"+(n?"":" NoDisplay")},getExcoImgClass:function(n,t,i){return(!n||t)&&!i?"ExcoOpenNormal":"ExcoClosedNormal"}}}),r={templateId:u,template:h,attr:"html",_timeoutId:null,_$contentsDroppable:null,expanding:function(t){return n.Accessor(this,"Expanding",t)},collapsing:function(t){return n.Accessor(this,"Collapsing",t)},collapsed:function(t){return n.Accessor(this,"Collapsed",t)},getLabelClass:function(){var t=this.data,i="";return t.ShowCount&&t.countType()===n.vm.Container.CountType.Unread&&t.Count>0&&(i="Unread TextSemiBold"),i},getTooltip:function(){var n=this.data;return n.Name+f(n.ShowCount,n.Count)},getDisplayName:function(){return this.data.Name},getDisplayCount:function(){var n=this.data;return f(n.ShowCount,n.Count)},getPadding:function(t,i,r){var u=e+(t-1)*o;return i>0&&!r&&!this.data.hasEditingChildren()&&(u-=s),(n.config.Ltr?"padding-left:":"padding-right:")+u+"px"},getContainerClass:function(){var n="leftnavitem lnav_item",i=this,t=i.data;return t.isFolder()&&(n+=" Droppable",t.IsDragAllowed&&(n+=" Draggable")),t.IsEditing||(n+=" selectable"),i.selected()&&!t.IsEditing&&(n+=" selected t_sel"),!i.selected()&&t.VisibleWhenSelected&&(n+=" NoDisplay"),n},init:function(i){var r=this,u=i.ctx;r.container=r.data=u.container,r.selected(r.data.selected()),r.selection=new n.Selection({control:r,isSelectionRoot:!!i.props.isSelectionRoot,isSelectable:r.data.isVisibleInLeftNav()||r.data.id()===n.config.sysCats.flaggedFltid}),r.container.isUncommitted()||n.Cmd("selectcontainer").subscribe(t.proxy(r.onSelectContainer,r)),r.collapsed(r.data.isCollapsed()),r.expanding(!1),r.collapsing(!1),r.ControlNamespace=n.createControlNamespace(r.tagName),r.ErrorId=n.createControlNamespace(r.tagName+"Error"),n.UpdateProperty(r,"LabelClass",!0),n.UpdateProperty(r,"Tooltip",!0),n.UpdateProperty(r,"DisplayCount",!0),n.UpdateProperty(r,"ContainerClass",!0)},render:function(){return this.tagCtx.render(this.data)},handleClicks:function(){var n=this;return n.data.isUncommitted()||n.data.isEditing()||n.selection.select({isContainerReselect:n.Selected,entryPoint:HM.InstrumentationEntryPoint.LeftNav}),!1},toggleExpand:function(){var n=this.contents().first().next(),i;if(this.data.depth()!==0)return this.collapsed()?(this.expanding(!0),n.removeClass("NoDisplay"),i=wLive.Animations.expand(n)):(this.collapsing(!0),i=wLive.Animations.collapse(n)),this.data.updateExCoState(),i.then(t.proxy(function(){this.expanding(!1),this.collapsing(!1),this.collapsed(!this.collapsed())},this)),!1},edit:function(n){this.data.editEntryPoint(n&&n.entryPoint),this.data.isEditing(!0)},focus:function(){var t=this;n.setFocus(function(){t.contents(".leftnavitem").focus()})},isSelfAndAncestorsExpanded:function(){var n=this.parent;return!this.data.isCollapsed()&&(n&&n.isSelfAndAncestorsExpanded?n.isSelfAndAncestorsExpanded():!0)},isCurrentlySelectable:function(){var i=this,t=i.parent,n=i.data,r=t&&t.isSelfAndAncestorsExpanded?t.isSelfAndAncestorsExpanded():!0;return r&&(n.isSearch()?n.visibleWhenSelected()&&n.selected():!0)&&n.isVisibleInLeftNav()},onAfterLink:function(){var i=this,u=i.contents(),r;i.data.selected()&&i.selection.select({skipSelectContainer:!0,skipFocus:!0}),r=u.filter(".leftnavitem");r.on("click",t.proxy(i.handleClicks,this));r.on("dblclick",t.proxy(i.handleClicks,this));r.on("click",".toggleExpand",t.proxy(i.toggleExpand,i));r.on("contextmenu",function(n){i._handleContextMenu(n)});i.data.isFolder()&&(i.DropTarget=new n.DropTarget({targetControl:i})),i._propertyChangedInit||(t.observable.simpleOn(i.container,"propertyChange."+i.ControlNamespace,t.proxy(i._onPropertyChange,i)),t.observable.simpleOn(i,"propertyChange."+i.ControlNamespace,t.proxy(i._onTagPropertyChange,i)),i._propertyChangedInit=!0)},grabFocus:function(){this.selection.focus(),this.data.shouldReceiveFocus(!1)},canAcceptDrop:function(n){var t=this,i=!1;return!t.data.isFolder()||t.data.isEditing()||t.data.isSearch()||(n.dragType==="containerListControl"?i=t.data.isChildAllowed():n.dragType==="messageListControl"&&(i=!0)),i},handleDrop:function(t){var u=this,r=u.data,f=HM.InstrumentationEntryPoint.DragAndDrop,i=t.draggableItems,e;t.dragType==="containerListControl"&&i&&i.length&&i[0].data&&i[0].data.Id!==r.Id&&i[0].data.parentContainer().Id!==r.Id&&(u.data.hasDuplicateContainer(t.draggableItems[0].data)?wLive.Controls.Notifications.createTopBar({content:n.GetString("Error.Folder.CannotMoveFolderNameCollision"),dismissalMode:wLive.Controls.Notifications.BarDismissalMode.Timeout}).show():u.data.isDescendantOfContainer(t.draggableItems[0].data)?wLive.Controls.Notifications.createTopBar({content:n.GetString("Error.Folder.CannotMoveParentFolderUnderChildFolder"),dismissalMode:wLive.Controls.Notifications.BarDismissalMode.Timeout}).show():i[0].data.moveItem(u.data,f).done(function(){i[0].data.shouldReceiveFocus(!0)})),t.dragType==="messageListControl"&&t.sourceControl&&(e=t.sourceControl.shouldUnflagOnMove(),t.sourceControl.data.bulkSelected()?n.Cmd("bulkactionbycontainer").fire({action:"move",destId:r.id(),entryPoint:f}):n.vm.MessageThread.performActionOnThreads("movemsg",t.sourceControl.data.SelectedItems,{folderId:r.id(),unflag:e,entryPoint:f,toArchive:r.isArchive()})),r.isCollapsed()&&u.toggleExpand()},getControlsForStyling:function(){return this.data?(this._$contentsDroppable||(this._$contentsDroppable=this.contents(".Droppable").first()),this._$contentsDroppable):null},getTooltipMessageAndCursor:function(t){var r=this;t.dragType==="containerListControl"&&(t.draggableItems&&t.draggableItems[0].data.Id===r.data.Id?t.tooltip=r.data.Name:r.data.RootContainer?t.tooltip=n.GetString("DragNDrop.DragFolderToBase"):r.data&&(i||(i=n.GetString("DragNDrop.DragFolder")),t.tooltip=i.format(r.data.Name)))},onCmdBubble:function(t,i,r){var u=this;return i.name==="el.completed"?(u.data.completeEdit(r.text,r.eventType).then(function(t){t&&t.focusId&&n.Cmd("sel.focuscontainer").bubble(u,{focusId:t.focusId})}),!1):i.name==="el.canceled"?(u.data.cancelEdit(),!1):i.name=="dragdrop.move"?(u=this,u._timeoutId&&window.clearTimeout(u._timeoutId),u._timeoutId=setTimeout(function(){u.collapsed()&&!u.expanding()&&r.sourceControl.data.Id!==u.data.Id&&r.currentHoverControl&&r.currentHoverControl.data.Id===u.data.Id&&u.toggleExpand(),window.clearTimeout(u._timeoutId),u._timeoutId=null},600),u.DropTarget&&u.DropTarget.activateMove(r),!1):i.name=="dragdrop.up"?(u.DropTarget&&u.DropTarget.activateUp(r),!1):void 0},onSelectContainer:function(n){var t=this;t.container.id()===n.id&&t.selection.select({skipHistory:n.skipHistory,allowAutoSelect:n.allowAutoSelect,id:n.id,messageGroupQueries:n.messageGroupQueries,promise:n.promise,skipFocus:!0,entryPoint:n.entryPoint,dontInstrument:n.dontInstrument,fltid:n.fltid,sortOrder:n.sortOrder,sortType:n.sortType})},newSubfolder:function(n){this.collapsed()&&this.toggleExpand(),this.container.newItem(n)},deleteContainer:function(n){var t=this,i=t.container.isCategory()?HM.ContentId.DeleteCategory:HM.ContentId.DeleteFolder,r=function(){var r=DemandLoadHandler.getContent(i);wLive.Controls.Notifications.createFlyout({title:r.hdr,content:r.msg,anchor:t.contents(".leftnavitem").get(0),buttons:{action:r.delBtn}}).show().then(function(i){i.buttonClicked==="action"&&wLive.Animations.deleteFromList(t.contents()).then(function(){t.container.deleteContainer(n&&n.entryPoint)})})};DemandLoadHandler.demandLoadContent([i],[r],null,!1,[t.container.Id,t.container.TotalCount,t.container.Name,t.container.FolderType])},emptyContainer:function(t){n.Cmd("tryemptycontainer").fire({senderElement:this.contents(".leftnavitem").get(0),container:this.container,entryPoint:t})},markAllAsRead:function(n){this.container.markAllAsRead(n)},_handleContextMenu:function(t){n.Cmd("ln.showcontextmenu").bubble(this,{control:this,$event:t}),t.stopPropagation(),t.preventDefault()},onDispose:function(){var n=this;n.DropTarget=null,t.observable.simpleOff(n.container,"propertyChange."+n.ControlNamespace),t.observable.simpleOff(n,"propertyChange."+n.ControlNamespace)},_onTagPropertyChange:function(t,i){if(i.path==="Selected"){var r=this;setTimeout(function(){n.UpdateProperty(r,"ContainerClass")},0)}},_onPropertyChange:function(t,i){var u=this,r=i.path;(r==="Count"||r==="ShowCount")&&(n.UpdateProperty(u,"LabelClass"),n.UpdateProperty(u,"DisplayCount")),(r==="Name"||r==="ShowCount"||r==="Count")&&n.UpdateProperty(u,"Tooltip"),(r==="IsEditing"||r==="VisibleWhenSelected"||r==="IsDragAllowed")&&n.UpdateProperty(this,"ContainerClass"),r==="ShouldReceiveFocus"&&i.value&&u.grabFocus(),r==="Visibility"&&u.refresh()}};n.Selection.CreateSelectablePropertiesAccessors(r),n.Selection.CreateSelectableRootControlAccessors(r),t.views.tags({containerControl:r})}(window.ol,window.originaljQuery||window.jQuery),function(n,t){"use strict";var r="containerListTemplate",u=t.templates(null,{markup:"#"+r,allowCode:!0,converters:{getSubtreeClass:function(n){return"exco_body"+(n?"":" NoDisplay")},getContainerListClass:function(n){return"exco c-ContainerList"+(n?"":" NoDisplay")},getExcoImgClass:function(n,t,i){return(n||t)&&!i?"ExcoOpen":"ExcoClosed"}}}),i={templateId:r,template:u,attr:"html",expanded:function(t){return n.Accessor(this,"Expanded",t)},expanding:function(t){return n.Accessor(this,"Expanding",t)},collapsing:function(t){return n.Accessor(this,"Collapsing",t)},containsVisibleItems:function(t){return n.Accessor(this,"ContainsVisibleItems",t)},isSelfAndAncestorsExpanded:function(){return this.expanded()},init:function(t){var i=this;i.data=t.ctx.containerList,i.selection=new n.Selection({control:i,isSelectable:!1,isSelectionRoot:!!t.props.isSelectionRoot}),i.expanded(!this.data.isCollapsed()),i.expanding(!1),i.collapsing(!1),i.updateContainsVisibleItems(),i.ControlNamespace=n.createControlNamespace(i.tagName)},onDispose:function(){this.onContainerListPropertyChange&&t.observable.simpleOff(this.data,"propertyChange",this.onContainerListPropertyChange)},render:function(){return this.tagCtx.render(this.data)},updateContainsVisibleItems:function(){for(var t=this.data.rootContainer().items(),i=!1,n=0;n<t.length;n++)if(t[n].isVisibleInLeftNav()){i=!0;break}this.containsVisibleItems(i)},sutraLabel:function(){return this.data.Type===HM.ContainerType.Folders?"folderlistnewfolder":"quickviewsnewcategorylink"},canAcceptDrop:function(n){return n.dragType==="containerListControl"&&this.data.Type===HM.ContainerType.Folders&&n.draggableItems&&n.draggableItems.length&&n.draggableItems[0].data.ContainerType===HM.ContainerType.Folders&&t(n.mouseMoveEvent.target).closest(".lnav_topItem").length},handleDrop:function(t){if(t.draggableItems&&t.draggableItems.length&&t.draggableItems[0]&&t.dragType==="containerListControl"){if(this.data.RootContainer.id()===t.draggableItems[0].data.parentContainer().id())return;this.data.RootContainer.hasDuplicateContainer(t.draggableItems[0].data)?wLive.Controls.Notifications.createTopBar({content:n.GetString("Error.Folder.CannotMoveFolderNameCollision"),dismissalMode:wLive.Controls.Notifications.BarDismissalMode.Timeout}).show():t.draggableItems[0].data.moveItem(this.data.RootContainer,HM.InstrumentationEntryPoint.DragAndDrop).done(function(){t.draggableItems[0].data.shouldReceiveFocus(!0)})}},moveFocusToContainerListRoot:function(){var n=this.contents().find(".containerListRoot");n&&n.length&&n[0].focus()},getDefaultTooltipString:function(t){var i=n.GetControlFromEvent(t.mouseDownEvent,"containerControl");return i&&t.dragType==="containerListControl"?i.getDisplayName():null},getControlsForStyling:function(n){return n&&n.isOverDropTarget?this.contents().find(".lnav_topItem").first():null},getDraggableDomArea:function(){return this.contents()},getTooltipMessageAndCursor:function(t){t.draggableItems&&t.draggableItems.length&&(t.tooltip=n.GetString("DragNDrop.DragFolderToBase"))},refreshChildren:function(i){var f=i.target,u=t(f).closest(".leftnavitem"),r;return u.length?(r=n.GetControlFromDOMElement(u),r!==null?[r]:null):[]},getDragControls:function(t){var i=n.GetControlFromEvent(t,"containerControl");return[i]},isDraggable:function(t){if(t&&t.target){var i=n.GetControlFromEvent(t);return i&&i.data.isDragAllowed()&&!i.data.isEditing()}return!0},onCmdBubble:function(n,t,i){var r=this,u=!0;if(r.DropTarget)switch(t.name){case"dragdrop.move":r.DropTarget.activateMove(i),u=!1;break;case"dragdrop.up":r.DropTarget.activateUp(i),u=!1}switch(t.name){case"sel.focuscontainer":r.data.setContainerFocus(t.args.focusId)}return u},onAfterLink:function(){var i=this,r=this.contents(),u=i.data;this._refreshButton=t(r.find("#Refresh img")[0]);r.on("click",".expandCollapseLink",t.proxy(i.onExpandCollapse,i)).on("click",".lnav_topItemMenuIcon #Refresh",function(){return n.Cmd("ln.refresh").bubble(i),!1}).on("click",".lnav_newContainer",function(){var t={editEntryPoint:HM.InstrumentationEntryPoint.LeftNav};return i.data.Type===HM.ContainerType.Folders?i.data.RootContainer.newItem(t):i.data.RootContainer.newItem(n.vm.Container.createDefaultCategoryOptions(t)),!1}).on("contextmenu",".lnav_topItemLabel",function(n){i.handleContextMenu(n)});i.data.Type===HM.ContainerType.Folders&&(i.DragSource=new n.DragSource({sourceControl:i,controlNamespace:i.ControlNamespace}),i.DropTarget=new n.DropTarget({targetControl:i})),i.onContainerListPropertyChange=function(n,t){t.path==="ContainerMap"&&i.updateContainsVisibleItems()},t.observable.simpleOn(i.data,"propertyChange",i.onContainerListPropertyChange)},handleContextMenu:function(t){n.Cmd("ln.showcontextmenu").bubble(this,{control:this,$event:t}),t.stopPropagation(),t.preventDefault()},spinRefresh:function(n){this._refreshButton.toggleClass("i_refresh",!n).toggleClass("i_refreshing",n)},toggleExpandCollapse:function(){var t=this.contents().find(".exco_body").first(),i,n=this;return n.expanded()?(n.collapsing(!0),i=wLive.Animations.collapse(t),n.data.isCollapsed(!0)):(n.expanding(!0),t.removeClass("NoDisplay"),i=wLive.Animations.expand(t),n.data.isCollapsed(!1)),n.data.updateExCoState(),i.then(function(){n.expanding(!1),n.collapsing(!1),n.expanded(!n.expanded())})},onExpandCollapse:function(){return this.toggleExpandCollapse(),!1}};n.Selection.CreateSelectablePropertiesAccessors(i),n.Selection.CreateSelectableRootControlAccessors(i),t.views.tags({containerListControl:i})}(window.ol,window.originaljQuery||window.jQuery),function(n,t){"use strict";function i(i){var r=i.data;(!r||r.editing())&&(n.Cmd("el.completed").bubble(i.target,{text:t(i.target).val(),eventType:i.type}),i.preventDefault(),i.stopPropagation())}var r="editableLabelTemplate",u=13,e=27,f=9,o=t.templates(null,{markup:"#"+r,converters:{spanClass:function(n){return"editableLabel readonly"+(n?" NoDisplay":"")}}}),s={templateId:r,template:o,attr:"html",editing:function(t){return n.Accessor(this,"Editing",t)},text:function(t){return n.Accessor(this,"Text",t)},disabled:function(t){return n.Accessor(this,"Disabled",t)},textProperty:"",pendingProperty:"",editingProperty:!1,handleFocusOut:!0,init:function(i){var r=this,u=i.ctx;r.data=u.data,r.maxlength=u.maxlength,r.textProperty=u.textProperty,r.pendingProperty=u.pendingProperty,r.editingProperty=u.editingProperty,r._errorId=u.errorId,r.errorProperty=u.errorProperty!==undefined?u.errorProperty:null,r.handleFocusOut=u.handleFocusOut!==undefined?u.handleFocusOut:!0,r.editing(r.data[r.editingProperty]),r.disabled(!1),r.text(r.data[r.textProperty]),r.ControlNamespace=n.createControlNamespace(r.tagName),t.observable.simpleOn(r.data,"propertyChange."+r.ControlNamespace,function(t,i){i.path===r.errorProperty&&r._errorElement&&(i.value?(r._errorElement.text(i.value),r._errorElement.removeClass("DisplayNone"),wLive.Animations.expand(r._errorElement),r.focus()):wLive.Animations.expand(r._errorElement).then(function(){r._errorElement.addClass("DisplayNone")})),i.path===r.textProperty?r.text(i.value):i.path===r.editingProperty?(r.editing(i.value),i.value?(n.Cmd("accessibility.suppressrestorefocus").bubble(r),n.Cmd("el.started").bubble(r),r.focusAndSelect()):r.text(r.data[r.textProperty])):i.path===r.pendingProperty&&r.disabled(i.value)})},render:function(){return this.tagCtx.render(this.data)},focus:function(){var t=this,n=_$ge(t.ControlNamespace);try{n.focus()}catch(i){}return n},focusAndSelect:function(){return this.focus().select()},onAfterLink:function(){var r=this,o=r.contents(),s=r._errorId!==undefined?_ge(r._errorId):undefined;r._errorElement=s!==undefined?t(s):undefined,r.editing()&&(n.Cmd("accessibility.suppressrestorefocus").bubble(r),r.focusAndSelect());o.on("keyup",".editableLabel.readwrite",function(t){t.which===u?t.preventDefault():t.which===e&&(n.Cmd("el.canceled").bubble(t.target),t.preventDefault())}).on("keypress",".editableLabel.readwrite",function(n){n.which===u&&(i(n),n.preventDefault())}).on("contextmenu",".editableLabel.readwrite",function(n){n.stopPropagation()});if(r.handleFocusOut)o.on("focusout",".editableLabel.readwrite",this,i);else o.on("keydown",".editableLabel.readwrite",function(n){(n.which===f||n.shiftKey&&n.keyCode===f)&&i(n)})},onDispose:function(){var n=this;t.observable.simpleOff(n.data,"propertyChange."+n.ControlNamespace)}};t.views.tags({editableLabelControl:s})}(window.ol,window.originaljQuery||window.jQuery),function(n,t){"use strict";function r(n,t){for(var f=n?"before":"after",e=n?"show":"dismiss",r=["bubble","bar","flyout","dialog","toast"],u="",i=0;i<r.length;i++)u+=(i>0?" ":"")+f+r[i]+e+"."+t;return u}function f(t){var i=t.data,r=i.layout().isFullView();return r&&n.Cmd("closeview").bubble(t,{thread:i.readMessage().thread()}),r}var u="inboxTemplate",i=n.config.sysFldrs,e=t.templates("#"+u),o={templateId:u,template:e,attr:"html",canDisplayAdvancedSearchControl:function(t){return n.Accessor(this,"CanDisplayAdvancedSearchControl",t)},init:function(i){var r=this;r.data=i.props.inbox,r.ControlNamespace=n.createControlNamespace(r.tagName),r.data.traceCtx={trace:window.Trace,cmd:n.Cmd,enableFireTab:n.config.enableFireTab},r.contextMenu=new n.ContextMenu,r.showForwardingVacationNotification(),n.Cmd("bulkactionbysender").subscribe(t.proxy(r.handleBulkActionBySenderCommand,r)),n.Cmd("bulkactionbycontainer").subscribe(t.proxy(r.handleBulkActionByContainerCommand,r)),n.Cmd("rm.messageloaded").subscribe(t.proxy(r.updateToolbar,r)),n.Cmd("curtaindown").subscribe(t.proxy(r.updateToolbar,r)),n.Cmd("glassdown").subscribe(t.proxy(r.updateToolbar,r)),n.Cmd("nav.managerulesold").subscribe(function(){window.$BSI.navigateTo("/mail/ManageRules.aspx?n="+n.DynamicNonce())})},contentRightClass:function(n,t){var i="ContentRight";this.data.RightRail.canShowRightRail()&&(i+=" WithRightRail"),n&&(i+=" FullView"),this.data.Layout.isReadingPaneOn()?i+=" RPOn":n||(i+=" RPOff");switch(t){case HM.ReadingPaneLocation.Right:i+=" RPRight";break;case HM.ReadingPaneLocation.Bottom:i+=" RPBottom"}return i},readMessageContainerFocus:function(){n.callFocus(_ge(this.ControlNamespace+"v-ReadMessageContainer"))},readMessageContainerStyle:function(){var t=this.data.Layout,r=t.ReadingPaneMode,i="";return r===HM.ReadingPaneLocation.Right?i=(n.config.Ltr?"left:":"right:")+t.MessageListWidth+"px;":r===HM.ReadingPaneLocation.Bottom&&(i="top:"+t.MessageListHeight+"px;"),i},messageListContainerStyle:function(){var n="",t=this.data.Layout,i=t.ReadingPaneMode;return i===HM.ReadingPaneLocation.Right?n="width:"+t.MessageListWidth+"px;":i===HM.ReadingPaneLocation.Bottom&&(n="height:"+t.MessageListHeight+"px;"),n},skipInitAutoSelect:function(){var t=n.pages.pageManager&&n.pages.pageManager.getCurrentView()||n.init.pages.initialPage;return this.data.initialSelectionId||t!==n.config.pageManager.manifests.Inbox.name},render:function(){return this.tagCtx.render(this.data)},registerSaveRestoreFocusHandlers:function(){function e(t,r){var u=r.menu,f;u&&u&&u.triggerEventType()==="mousedown"||(f=n.getActiveElement(),n.isFocusOnMenu(f)||(i.savedActiveElement=f))}function o(n,r){var u=r.menu,f=u&&u.closeEventSource&&u.closeEventSource()===i.savedActiveElement,e;i.savedActiveElement&&i.savedActiveElement!==document.body&&!f&&(e=i.savedActiveElement,t(i.savedActiveElement).focus()),i.savedActiveElement=null}var i=this,u=wLive.Controls,f=u.Notifications;t(f).on(r(!0,i.ControlNamespace),e);t(f).on(r(!1,i.ControlNamespace),o);t(u).on("beforemenushow."+i.ControlNamespace,e);t(u).on("aftermenudismiss."+i.ControlNamespace,o)},showForwardingVacationNotification:function(){var i=n.GetUserConfig("forwardingVacationMessage"),t,r;i&&(t=wLive.Controls.Notifications,r=t.createBottomBar({content:i,dismissalMode:t.BarDismissalMode.Explicit,buttons:{action:n.GetUserConfig("forwardingVacationLabel"),close:n.GetUserConfig("forwardingVacationCloseLabel")}}),r.show().then(function(t){if(t.buttonClicked==="action")return $BSI.navigateTo(n.GetUserConfig("forwardingVacationLink")),!1}))},getOnBeforeUnloadString:function(){var t=n.findChildTag(this.readMessageControl,"composeControl")[0];if(t)return t.getOnBeforeUnloadString()},getBulkActionsControl:function(){var i=this,r=t.Deferred();return n.init.NotifyLoad("App1").then(function(){i.bulkActionsControl||(n.Accessor(i,"BulkActionsControlNeeded",!0),i.bulkActionsControl=n.findChildTag(i,"bulkActionsControl")[0]),r.resolve(i.bulkActionsControl)}),r},handleBulkActionBySenderCommand:function(n){var t=this;t.getBulkActionsControl().then(function(i){t.handleBulkActionBySenderCommandImpl(i,n)})},handleBulkActionBySenderCommandImpl:function(t,i){var r=null,e=this,u=e.data,f,o;t?u.isBulkSelected()&&!i.selection?r=n.GetString("BulkAction.SenderBased.BulkSelectedError"):(f=i.selection||e.messageListControl.selection.selectedSubcontrols(),f&&f.length?(o={action:i.action,selection:f,selectedContainer:u.selectedContainer(),folderList:u.folderList(),timestamp:u.messageList().activeGroup().timestamp(),sortKey:u.messageList().activeGroup().query().sortType,categoryChanges:i.categoryChanges,entryPoint:i.entryPoint,sourceEl:i.sourceEl},t.beginBulkActionBySenderUi(o)):r=n.GetString("BulkAction.NothingSelectedError")):r=n.GetString("BulkAction.GenericError"),r&&wLive.Controls.Notifications.createTopBar({content:r,dismissalMode:wLive.Controls.Notifications.BarDismissalMode.Timeout}).show()},handleBulkActionByContainerCommand:function(n){var t=this;t.getBulkActionsControl().then(function(i){t.handleBulkActionByContainerCommandImpl(i,n)})},handleBulkActionByContainerCommandImpl:function(t,r){var e=null,c=this,o,s,u,h,f;t?(o=c.data,s=o.messageList(),typeof r.fromFid=="undefined"&&(r.fromFid=i.noneFid),typeof r.quickViewId=="undefined"&&(r.quickViewId=n.config.sysCats.noneFltid),r.quickViewId===n.config.sysCats.noneFltid&&r.fromFid===i.noneFid&&(u=o.selectedContainer(),h=u.isQuickview(),h?r.quickViewId=u.id():r.fromFid=u.id()),f=s.activeGroup(),r.timestamp=f.timestamp(),r.categoryFilterId=s.filterId(),r.advancedSearch=f.query().search,r.sortKey=f.query().sortType,r.action==="delete"&&(r.destId=r.fromFid===i.trashFid||r.fromFid===i.junkFid?i.permDelFid:i.trashFid),t.beginBulkActionByContainerUi(r)):e=n.GetString("BulkAction.GenericError"),e&&wLive.Controls.Notifications.createTopBar({content:e,dismissalMode:wLive.Controls.Notifications.BarDismissalMode.Timeout}).show()},onCmdBubble:function(t,r,u){var f=this,e=f.data,h,c,s,y,p,b,k,o,w;switch(r.name){case"sel.selectedcontrols":if(h=u.unselectedControls,c=u.selectedControls,t.tagName==="messageGroupControl")t.onSelectionChange(h,c);else if(t===f.messageListControl){for(y=[],p=[],s=0;s<c.length;s++)y.push(c[s].data);for(s=0;s<h.length;s++)p.push(h[s].data);e.handleMessagelistSelection(y,p,u.selectArgs),e.messageList().restoreBulkSelection()&&(e.messageList().bulkSelected(!0),e.messageList().restoreBulkSelection(!1));f.messageListControl.onSelectionChange(c,h,u);f.onSelectionChange(),f.updateToolbar()}else t===f.leftNavControl&&(b=c[0].data,k=h.length>0?h[0].data:null,e.handleLeftNavSelection(b,k,u.selectArgs));break;case"sel.keyboardshortcut":r.deferred.reject();break;case"sel.next":t===f.readMessageControl&&f.messageListControl.selection.selectNext();break;case"sel.prev":t===f.readMessageControl&&f.messageListControl.selection.selectPrev();break;case"accessibility.focus":u.focusTo==="readMessageControl"&&f.readMessageContainerFocus();break;case"accessibility.suppressrestorefocus":f.savedActiveElement=null;break;case"sel.clearall":e.selectedThread(null),f.messageListControl.clearAllSelection(),f.updateToolbar(!1);break;case"sel.bulk":f.updateToolbar();break;case"messagepartclicked":case"showunsafebody":f.updatePeoplePane(u.conversationThread,u.activeMessageThread,!0,r.name==="showunsafebody");break;case"refreshads":f.refreshAds();break;case"updatepeoplepane":o=e.selectedThread(),f.updatePeoplePane(o);break;case"fullview":var o=u.thread,a=u.threadId||o.id(),v=u.viewId||o.viewId(),l={threadId:a,viewId:v,isFullView:!0,isRightRailForcedOff:u.forceCloseRightRail,dontUpdateSelectedThread:e.Layout.isReadingPaneOn()};u.dontInstrument||(l.msgInst=n.Instrumentation.getThreadInstrumentation(o),l.entryPoint=u.entryPoint,l.rpState=e.Layout.isReadingPaneOn(),l.type=o.LiveViewsHtml?"v":o.count()>1?"t":"s",l.prefetchState=o.isPrefetched()),n.Cmd("nav.message").fire(l).deferred.then(function(){f.readMessageContainerFocus()});break;case"closeview":var o=u.thread,a=null,v=null,d=!1;f.data.layout().isReadingPaneOn()&&(a=o&&o.id(),v=o&&o.viewId(),d=!0),n.Cmd("nav.message").fire({threadId:a,viewId:v,isFullView:!1,dontInstrument:!0,dontUpdateSelectedThread:d}).deferred.then(function(){e.layout().applySizerBarCookie(),f.messageListControl.restoreSelection(),f.messageListControl.FocusedControl&&f.messageListControl.FocusedControl.focus(),e.layout().isReadingPaneOn()||f.updatePeoplePane(null)}).then(function(){f.refreshAds()});break;case"shiftclickmsg":w=e.SelectedContainer.isFolder()?e.SelectedContainer.id():i.noneFid,f.contextMenu.cancelTimers(),window.open("{0}?{1}&n={2}{3}{4}".format(n.GetAppConfig("SELF_PATH"),"tid={0}".format(t.data.Id),n.DynamicNonce(),e.SelectedContainer.IsSearch||w===i.noneFid?"":"&fid={0}".format(w),e.SelectedContainer.isCategory()?"&qvid={0}".format(e.SelectedContainer.Id):""));break;case"sb.setsizerbarcookie":e.layout().setSizerBarCookie(u.key,u.size);break;case"ln.refresh":n.inboxFlow&&n.inboxFlow.importProgressIndicator&&n.inboxFlow.importProgressIndicator.getAndUpdateImportProgress(),f.refreshInbox();break;case"search":e.beginSearch();break;case"openadvancedsearch":f.canDisplayAdvancedSearchControl(!0),f.advancedSearchControl||(f.advancedSearchControl=n.findChildTag(f,"advancedSearchControl")[0]),f.advancedSearchControl.open();break;case"inboxcommandbar.hide":f.hideToolbar();break;case"inboxcommandbar.show":f.updateToolbar();break;case"nav.firstpage":case"nav.prevpage":case"nav.nextpage":case"nav.lastpage":case"nav.filter":case"nav.arrangeby":n.Cmd("ml.change").fire({changeAction:n.Instrumentation.pagingMapping(r.name),entryPoint:HM.InstrumentationEntryPoint.MessageList});break;case"gotopickerinitiatejump":var g=new Date(u.anchor),nt=(new Date).getTime(),tt=nt-g,it=Math.round(tt/864e5);n.Cmd("ml.change").fire({changeAction:n.Instrumentation.pagingMapping(r.name),entryPoint:HM.InstrumentationEntryPoint.MessageList,payload:it})}},onDispose:function(){var n=this,i;t.observable.simpleOff(n.data,"propertyChange."+n.ControlNamespace),t.observable.simpleOff(n.data.layout(),"propertyChange."+n.ControlNamespace),t.observable.simpleOff(n.messageListControl.selection,"propertyChange."+n.ControlNamespace),i=wLive.Controls,t(i.Notifications).off(r(!0,n.ControlNamespace)),t(i.Notifications).off(r(!1,n.ControlNamespace)),t(i).off("beforemenushow."+n.ControlNamespace,_onBeforeShowMenuOrNotification),t(i).off("aftermenudismiss."+n.ControlNamespace,_onAfterDismissMenuOrNotification)},onAfterLink:function(){var r=this,u,e;r.registerSaveRestoreFocusHandlers(),r.messageListControl=n.findChildTag(r,"messageListControl")[0],r.leftNavControl=n.findChildTag(r,"leftNavControl")[0],r.rightRailControl=n.findChildTag(r,"rightRailControl")[0],r.readMessageControl=n.findChildTag(r,"readMessageControl")[0],r.instantActionsFloatingControl=n.findChildTag(r,"instantActionsFloatingControl")[0],t.observable.simpleOn(r.data,"propertyChange."+r.ControlNamespace,t.proxy(r.onInboxChange,r)),t.observable.simpleOn(r.data.layout(),"propertyChange."+r.ControlNamespace,t.proxy(r.onLayoutChange,r)),r.data.messageList().selectedItems().length>0?(r.applyMessageListSelection(),r.onSelectionChange()):(u=n.Object.clone(n.config.initialStateJson),u.forceThreadIntoReadingPane=!0,r.setState(u)),e=t(_ge(r.ControlNamespace)),r.instantActionsFloatingControl&&r.instantActionsFloatingControl.attachMouseEvents(e),t("#c_clogot").click(function(t){if(n.pages.pageManager.getCurrentView()===n.config.pageManager.manifests.Inbox.name&&!n.isOpenNewTabClick(t)){var u=f(r);return u||(r.data.leftNav().selectedItems()[0].id()===i.inboxFid?n.Cmd("ln.refresh").bubble(r):(n.Cmd("ln.refresh").bubble(r),n.Cmd("selectcontainer").fire({id:i.inboxFid,entryPoint:HM.InstrumentationEntryPoint.CommandBar}))),!1}})},refreshAds:function(){this.rightRailControl&&this.rightRailControl.refreshAds(null,"Read")},setState:function(r){var e=this,a=t.Deferred(),u=t.Deferred(),h=e.data,f=r.fid||r.qvid||i.inboxFid,v=n.data.isFolderId(f)?HM.ItemListQueryContainerType.Folder:HM.ItemListQueryContainerType.Category,o=r.mid||r.cid||r.tid,y=r.fltid,p=r.sa?HM.MessageListKeyQuerySortOrder.Ascending:HM.MessageListKeyQuerySortOrder.Descending,w=r.so,s=r.pidx,c,l;return r.pat===HM.MessageGroupQueryAnchorType.FirstPage?s=1:r.pat===HM.MessageGroupQueryAnchorType.LastPage&&(s=null),c=null,l=n.pages.pageManager?n.pages.pageManager.wrapRestoreHistoryFunction:t.proxy,l(function(){var b=h.search(),k=parseInt(r.pat,10),i;b.restoreFromHistory(r),(k!==HM.MessageGroupQueryAnchorType.FirstPage||r.srch)&&(i={containerType:v,sortOrder:p,sortType:w,anchor:r.paid,anchorDate:r.pad,anchorType:k,size:n.GetAppConfig("MessageListSize"),search:b.getSearchParams(),filterId:y},v===HM.ItemListQueryContainerType.Folder?t.extend(i,{containerId:f}):t.extend(i,{categoryContainerId:f}),c=[HM.createMessageGroupQuery(i)]),s&&h.messageList().pageNumber(s),a.then(l(function(){if(o){var i={skipHistory:!0,isFullView:!h.layout().isReadingPaneOn()||!!r.fv,entryPoint:HM.InstrumentationEntryPoint.Other,promise:u},s=e.messageListControl.selectThreadsById([o],i)>0;!s&&r.forceThreadIntoReadingPane&&(t.extend(i,{threadId:o,viewId:f,deferredInstrumentation:!0}),n.Cmd("nav.message").fire(i).deferred.then(u.resolve,u.reject))}else u.resolve()},e),u.reject),n.Cmd("selectcontainer").fire({skipHistory:!0,allowAutoSelect:!o,id:f,messageGroupQueries:c,promise:a,entryPoint:HM.InstrumentationEntryPoint.RRU,fltid:y,sortOrder:p,sortType:w})},e)(),u.promise()},applyMessageListSelection:function(){var i=this,r=i.data,u=r.readMessage().getQueriedMessage(),f;setTimeout(function(){var f=t("#"+i.ControlNamespace+"v-ReadMessageContainer .rmMessages")[0],e,r,o;if(f)if(u){for(e=n.findChildTag(i.readMessageControl,"readMessagePartControl"),r=0;r<e.length;r++)if(o=e[r],u===o.data){n.scrollIntoView(_ge(o.ControlNamespace),f,50);break}}else f.scrollTop=0},50),f=r.selectedThread(),f&&r.layout().isFullView()&&i.readMessageContainerFocus(),i.updatePeoplePane(f,u)},updatePeoplePane:function(n,t,i,r){var u=this;n?(!t&&n.items().length&&(t=n.Items[0]),u.rightRailControl&&t&&(u.rightRailControl.updatePeoplePane(t,t.senderDetails(),n.socialInboxMembershipData(),r),i||(u.rightRailControl.refreshAds(t.ati(),u.data.isContainerNavigation()?"Inbox":"Read"),u.data.isContainerNavigation(!1)))):u.rightRailControl&&u.rightRailControl.hidePeoplePane()},onSelectionChange:function(){var t=this,u=t.messageListControl.selection,n=u.SelectedSubcontrols,i=0,r,f;n.length===1&&n[0].Checked?i=1:n.length>1&&(i=n.length),r=t.data.messageList(),u.isResetting||(f=i>0||n.length===0&&t.data.Layout.isReadingPaneOn(),r.setCountState(n.length,f)),t.readMessageControl.show(!r.showMessageCount()&&!!t.data.SelectedThread)},onInboxChange:function(n,t){var i=this,u=i.data,r;t.path==="SelectedThread"?(i.applyMessageListSelection(),i.updateToolbar(),r=u.messageList(),i.readMessageControl.show(!r.showMessageCount()&&!!t.value),i.enableNextPrevForMessageInRP()):t.path==="SelectedContainer"&&(i.updateToolbar(),i.data.isContainerNavigation(!0),i.messageListControl.animationPromise.then(function(){i.rightRailControl.refreshAds(null,"Inbox")}))},onLayoutChange:function(r,u){var e=this,o=this.data,s,h;u.path==="IsFullView"?(n.config.Browser.isChrome&&t(".c_base").css("overflow-x",u.value?"hidden":""),u.value?(e.contextMenu.cancelTimers(),o.layout().readingPaneMode()===HM.ReadingPaneLocation.Off&&e.readMessageControl.performAnimations(),e.enableNextPrevForMessageInRP()):o.Layout.isReadingPaneOn()||o.rightRail().rightRailManager().setAdControl()):u.path==="ReadingPaneMode"&&(s=o.selectedContainer().id(),h=e.contents(),s===i.inboxFid&&o.messageList().pageNumber()===1&&o.layout().isPinningEnabled()?n.Cmd("selectcontainer").fire({id:s,dontInstrument:!0}):f(e),h.find(".v-MessageListContainer").attr("style",e.messageListContainerStyle()),h.find(".v-ReadMessageContainer").attr("style",e.readMessageContainerStyle()))},keyShortcutsEnabled:function(){var t=n.c.BulkActionsControl,i=window.WebDialogManager;return(!t||!t.isBusy)&&(!i||!i.getInstance().isDialogVisible())&&!n.isMenuOpen()},leftSizerCallback:function(){var n=this;setTimeout(function(){var i=t(n._firstElement).width();t("#c_header").css({"min-width":i+588+"px"}),t(window).trigger("resize")},0)},hideToolbar:function(){n.CommandBarWrapper.hideItems()},enableNextPrevForMessageInRP:function(){var t=this,i=t.data.messageList(),n;t.data.Layout.isReadingPaneOrFullViewOn()&&(n=i.activeGroup(),t.readMessageControl.hasPrevious(!!n&&!(n.bof()&&i.isFirstMessageSelected())),t.readMessageControl.hasNext(!!n&&!(n.eof()&&i.isLastMessageSelected())))},updateToolbar:function(t){for(var i=this,f=i.messageListControl.selection.selectedSubcontrols(),u=[],e,r=0;r<f.length;r++)u.push(f[r].data);e={inboxControl:this,isReadingFullView:i.data.Layout.isFullView(),selectedThread:i.data.selectedThread(),numSelected:u.length,selectedContainer:i.data.selectedContainer(),checkedThreads:u,forceRelayout:t},n.CommandBarWrapper.updateToolbar(e)},refreshInbox:function(){var n=this,t=n.data;n.leftNavControl.spinRefresh(!0),t.refresh().always(function(){n.leftNavControl.spinRefresh(!1)})},getArchiveControl:function(){var t=this;return n.vm.Archive&&!t.archiveControl&&(t.data.archive(new n.vm.Archive),n.Accessor(t,"ArchiveControlNeeded",!0),t.archiveControl=n.findChildTag(t,"archiveControl")[0]),t.archiveControl},getEditRuleControl:function(){var t=this;return t.editRuleControl||(n.Accessor(t,"EditRuleControlNeeded",!0),t.editRuleControl=n.findChildTag(t,"editRuleControl")[0]),t.editRuleControl}};t.views.tags({inboxControl:o})}(window.ol,window.originaljQuery||window.jQuery),function(n,t){"use strict";var r="leftNavTemplate",f=t.templates(null,{markup:"#"+r,allowCode:!0,converters:{getSubClass:function(n){return"webIMMessagingSnippet t_sbgc "+(n?"":"NoDisplay")},getExcoImgClass:function(n,t,i){return(n||t)&&!i?"ExcoOpen":"ExcoClosed"},getWebIMModuleSize:function(n,t,i){return n?t:i}}}),u=function(n,t,i,r,u){var f=wLive.Animations.animateProperty(n,{propertyName:"height",initValue:r,finalValue:u}),e=wLive.Animations.animateProperty(t,{propertyName:"bottom",initValue:r,finalValue:u}),o=wLive.Animations.animateProperty(i,{propertyName:"bottom",initValue:r,finalValue:u});return[f,e,o]},i={templateId:r,template:f,attr:"html",expanded:function(t){return n.Accessor(this,"Expanded",t)},expanding:function(t){return n.Accessor(this,"Expanding",t)},collapsing:function(t){return n.Accessor(this,"Collapsing",t)},init:function(t){var i=this;i.data=t.ctx.leftNav,i.layout=t.ctx.layout,i.selection=new n.Selection({control:i,isSelectionRoot:!0,isSelectable:!1,isMultiselectEnabled:!1}),i.expanded(!i.data.webIMCollapsed()),i.expanding(!1),i.collapsing(!1),i.SizerBarInitSize=i.expanded()?i.parent.data.Layout.WebImModuleHeight:i.parent.data.Layout.WebImHiddenModuleHeight,n.config.serverRenderOnly||(i.inboxContextMenu=t.props.contextMenu)},render:function(){return this.selection.reset(),this.tagCtx.render(this.data)},moveContainerFocus:function(i){var r=this,u=!1,c=t(n.getActiveElement()),v,s,y,h;if(c.is(".containerListRoot, .lnav_item")){var f=r.selection.focusControl,l=!1,e=null,o=r.getControlAncestor(f,".containerListRoot"),a=c.is(".containerListRoot");return a&&(e=n.GetControlFromDOMElement(n.getActiveElement()),l=e===o),a&&i?u=l?r.selection.focus():e.selection.focusNext():(u=!0,i?(v=r.selection.peekNextControl(f),s=r.getControlAncestor(v,".containerListRoot"),s&&s===o&&r.selection.focusNext()):(y=r.selection.peekPrevControl(f),h=r.getControlAncestor(y,".containerListRoot"),h&&h===o&&r.selection.focusPrev())),u}},setTabFocus:function(){var u=t(n.getActiveElement()),r,i;u.is(".lnav_item")&&(r=this.selection.focusControl,i=this.getControlAncestor(r,".containerListRoot"),i&&i.moveFocusToContainerListRoot())},getControlAncestor:function(i,r){var f=null,u;return i&&r&&(u=t(i.contents()).closest(r),u&&(f=n.GetControlFromDOMElement(u))),f},onCmdBubble:function(i,r,u){var f=this,e=!0,s,o;switch(r.name){case"ln.showcontextmenu":f.onShowContextMenu(u.$event,i);e=!1;break;case"ln.webimresize":i.tagName==="sizerBarControl"&&(f.expanded()||(parseInt(i._$element.css("bottom"),10)>=i._firstMin?f.toggleExpandCollapse():f.parent.data.Layout.setSizerBarCookie("webim",i._firstMin))),e=!1;break;case"ln.menu.click":u.key==="manageCategories"&&n.Cmd("nav.managecategories").fire(),e=!1;break;case"sel.selectedcontrols":i.selection.IsSelectionRoot&&(s=u.selectedControls[0],s.data&&f.data.selectedItems([s.data]));break;case"sel.keyboardshortcut":o=!1;switch(u.name){case"nextMsg2":o=f.moveContainerFocus(!0),e=!o;break;case"prevMsg2":o=f.moveContainerFocus(!1),e=!o;break;case"openMsg2":i.tagName==="containerControl"&&(o=f.FocusedControl.selection.select({entryPoint:HM.InstrumentationEntryPoint.LeftNav}),e=!1),t(u.srcElement.parentElement).hasClass("webIMMessagingContainer")&&f.toggleExpandCollapse(u.entryPoint);break;case"focusNextMsg":this.setTabFocus();break;case"focusPrevMsg":this.setTabFocus()}e||(o?r.deferred.resolve():r.deferred.reject()),e=!1}return e},onAfterLink:function(){var i=this,r=i.contents();i.contextMenuControl=n.findChildTag(i,"leftNavContextMenuControl")[0],i.searchBoxControl=n.findChildTag(i,"searchBoxControl")[0],i.containerListControls=n.findChildTag(i,"containerListControl");r.on("mouseover",function(){r.addClass("draghover")});r.on("mouseout",function(){r.removeClass("draghover")});r.on("keydown",".expandCollapseLink",function(n){n.keyCode==13&&t(n.target.parentElement).hasClass("webIMMessagingContainer")&&n.preventDefault()});r.on("click",".expandCollapseLink",t.proxy(i.onExpandCollapse,i));if($B.IE&&$B.V<10)r.on("selectstart",function(n){if(n.target.nodeName!=="INPUT"&&n.target.nodeName!=="TEXTAREA")return!1})},toggleExpandCollapse:function(i){var r=this,o=r.contents(),s=o.find(".webIMMessagingSnippet"),l=o.filter(".sizerBarX"),c=o.filter(".webIMMessagingContainer"),a=o.filter(".LeftNav"),y=r.parent.data.Layout.WebImHiddenModuleHeight+"px",p=Math.max(r.parent.data.Layout.WebImModuleHeight,r.parent.data.Layout.WebImMinModuleHeight)+"px",v=c.css("height"),h,f,e;r.expanded()?(r.collapsing(!0),r.expanding(!1),f=[],f.push(wLive.Animations.collapse(s)),s.hide(),s.css({height:"",width:""}),f=t.merge(f,u(c,l,a,v,y)),h=t.when.apply(r,f)):(r.expanding(!0),r.collapsing(!1),e=[],e.push(wLive.Animations.expand(s)),e=t.merge(e,u(c,l,a,v,p)),h=t.when.apply(r,e),h.then(function(){r.webIMModuleSizerCallback({isFirstLoad:!1})})),h.done(function(){r.expanded(!r.expanded()),r.data.updateWebIMExcoState(!r.expanded()),n.Cmd("instrument.webimexpandcollapse").fire({expanded:r.expanded(),entryPoint:i!==undefined?i:HM.InstrumentationEntryPoint.LeftNav})})},onExpandCollapse:function(){return this.toggleExpandCollapse(),!1},onShowContextMenu:function(n,t){this.contextMenuControl&&this.contextMenuControl.show(n,t),n.stopPropagation(),n.preventDefault()},spinRefresh:function(n){t.each(this.containerListControls,function(t,i){i.spinRefresh(n)})},webIMModuleSizerCallback:function(i,r,u){var f=this;u||(setTimeout(function(){t(".webIMMessagingSnippet").triggerHandler("resize")},0),n.Cmd("ln.webimresize").bubble(f,{control:f}))}};n.Selection.CreateSelectablePropertiesAccessors(i),n.Selection.CreateSelectableRootControlAccessors(i),t.views.tags({leftNavControl:i})}(window.ol,window.originaljQuery||window.jQuery),function(n,t){"use strict";var i="menuTemplate",r={templateId:i,template:t.templates("#"+i),attr:"html",init:function(n){var t=this,i=n.ctx;t.data=n.args[0],t.tabindex=typeof i.tabindex=="function"?null:i.tabindex},menuCreated:function(t){return n.Accessor(this,"MenuCreated",t)},render:function(){return this.tagCtx.render(this.data)},onDispose:function(){var n=this;n.contents().filter(".c_ml").off(".menucontrol"),n.contents().off(".menucontrol",".menuLinkItem"),n.$menuElt=null},onAfterLink:function(){var i=this,r=i.contents();i.$menuElt=r.filter(".c_m");r.filter(".c_ml").on("click.menucontrol",function(r){i.menuCreated(!0),i.data.EdgeOffsetFunction&&(i.data.Params=i.data.Params||{},i.data.Params.edgeOffsets=i.data.EdgeOffsetFunction(i.data.layout()),i.data.Params.noDockCache=!0);var u=t(this).view().data;return n.Cmd("menu.opening").bubble(r.currentTarget,{key:u.Key}),$menu.create(r,i.data.Loc,i.data.Params),n.Cmd("menu.open").bubble(r.currentTarget,{key:u.Key}),!1});r.on("click.menucontrol",".menuLinkItem",function(r){var u=t(this).view().data,f=t.extend({key:u.Key,targetElement:r.target},u.EventData);return n.Cmd("menu.click").bubble(r.currentTarget,f),i.close(),!1})},onCmdBubble:function(n,t,i){var r=!0;return t.name==="sel.keyboardshortcut"&&(i.name==="nextMsg2"||i.name==="prevMsg2")&&(r=!1),r},isOpen:function(){return this.$menuElt.css("visibility")!=="hidden"},update:function(){this.$menuElt.length>0&&this.$menuElt[0].binding&&this.$menuElt[0].binding.update()},close:function(){$menu.closeCurrent()}};t.views.tags({menuControl:r}),t.templates("#menuSeparatorTemplate"),t.templates("#menuItemTemplate")}(window.ol,window.originaljQuery||window.jQuery),function(n,t){"use strict";var r="messageGroupTemplate",i={templateId:r,template:t.templates("#"+r),attr:"html",allRowsSelected:function(t){return n.Accessor(this,"AllRowsSelected",t)},init:function(t){var i=this,r;i.data=t.props.messageGroup,r=t.ctx,i.categoryList=r.categoryList,i.folderList=r.folderList,i.layout=r.layout,i.ControlNamespace=n.createControlNamespace(i.tagName),i.selection=new n.Selection({control:i,isSelectable:!1,isAutoselectEnabled:!!this.data.QueryConfig.autoSelectable,isSelectionRoot:!!t.props.isSelectionRoot}),i.sortKey=t.ctx.sortKey,i.data.showFooter()?i.isSectionExpanded(i.layout.isPinboardExpanded()):i.isSectionExpanded(!0),i._setContainer()},render:function(){return this.tagCtx.render(this.data)},onDispose:function(){var n=this;n.contents().off("."+n.ControlNamespace),t.observable.simpleOff(n.data,"propertyChange."+n.ControlNamespace),t.observable.simpleOff(n.selection,"propertyChange."+n.ControlNamespace),n.categoryList=n.folderList=n=null},isAllRowsSelected:function(n){var t,i;for(n=n||this.selection.selectedSubcontrols(),t=0,i=0;i<n.length;i++)n[i].Checked&&t++;return t&&t===this.data.Items.length},isSectionExpanded:function(t){return n.Accessor(this,"IsSectionExpanded",t)},isCurrentlySelectable:function(){var n=this;return n.isSectionExpanded()&&(n.parent&&n.parent.isCurrentlySelectable?n.parent.isCurrentlySelectable():!0)},getNarrowClass:function(n,t,i){return(n||"")+(t!==HM.ReadingPaneLocation.Right?"":"Narrow ")+(i||"")},getMainCssClass:function(n,t){return n+(t?"":"NoDisplay")},getTrayCBTitle:function(){return n.GetString("Options.Pinning.Mode.Off")},getTrayToggleTitle:function(t){return t?n.GetString("PinBoard.CollapseWidget.Hide.Title"):n.GetString("PinBoard.CollapseWidget.Show.Title")},getTrayToggleText:function(t){return t?n.GetString("PinBoard.TrayMessage.Hide"):n.GetString("PinBoard.TrayMessage.Show")},getTrayFooterLinkText:function(){return n.GetString("MessageCategoryFilter.FlaggedMessages.Label")},getTrayCloseIconClass:function(){return"pinTrayCBImg"},_setContainer:function(){var t=this,i=t.data.queryContainerId(),r=t.folderList.getContainerById(i)||t.categoryList.getContainerById(i);n.Accessor(t,"Container",r)},onAfterLink:function(){var i=this,r=i.contents();t.observable.simpleOn(i.data,"propertyChange."+i.ControlNamespace,function(n,t){switch(t.path){case"SelectedItems":i.data.SelectedItems.length>0&&i.isSectionExpanded(!0);break;case"QueryContainerId":i._setContainer()}});r.on("click."+i.ControlNamespace,".toggleSection",function(t){var r=i.isSectionExpanded(),u=i.selection.SelectedSubcontrols.length;return r&&u>0&&(i.selection.unselectAll(),n.Cmd("sel.pinboardselcleared").bubble(i,{})),i.isSectionExpanded(!r),i.layout.isPinboardExpanded(!r),t.preventDefault(),!1});r.on("click."+i.ControlNamespace,".mgFooterLink",function(t){return n.Cmd("viewallincontainer").fire({containerId:i.data.queryContainerId()}),t.preventDefault(),!1});r.on("click."+i.ControlNamespace,".mgTrayCB",function(t){var r=wLive.Controls.Notifications,u=r.createFlyout({title:n.GetString("PinBoard.Alert.Disable.Title"),content:n.GetString("PinBoard.Alert.Disable.Message"),anchor:this,buttons:{action:n.GetString("PinBoard.Alert.Disable.Title")}});return u.show().then(function(n){i._closePinBoardAlertCallback(n.buttonClicked)}),t.preventDefault(),!1})},_closePinBoardAlertCallback:function(t){return t==="action"&&(this.layout.isPinningEnabled(!1),n.Cmd("selectcontainer").fire({id:n.config.sysFldrs.inboxFid,dontInstrument:!0})),!0},focus:function(){var t=this;n.setFocus(function(){t.contents().find("a.toggleSection").focus()})},getGroupIndex:function(){return this.ctx.groupIndex},onCmdBubble:function(i,r,u){var e=this,f=!0;switch(r.name){case"sel.keyboardshortcut":u.name==="focusNextMsg"&&t(u.srcElement).hasClass("toggleSection")&&(n.Cmd("accessibility.focus").bubble(e,{}),f=!1)}return f},onSelectionChange:function(n,t){this.allRowsSelected(!!this.isAllRowsSelected(t))}};n.Selection.CreateSelectablePropertiesAccessors(i),n.Selection.CreateSelectableRootControlAccessors(i),t.views.tags({messageGroupControl:i})}(window.ol,window.originaljQuery||window.jQuery),function(n,t){"use strict";function l(i,r){var u,f;n.config.instantActionsSettings&&(u=n.findChildTag(i,"instantActionsFloatingControl")[0],u?r?u.handleInstantActionsDisable():u.handleInstantActionsEnable():(f=t(".c-MessageList"),f.toggleClass(h,!r)))}var s="messageListTemplate",h="InstantActionsEnabled",i=n.vm,r=HM.FilterType,u=n.config.sysFldrs,f=n.config.messageList,e=window.wLive,c,a,o;t.templates("#categorizeMenuPlaceHolderTemplate"),c=t.templates(null,{markup:"#"+s,converters:{footerClass:function(n){return n.isReadingPaneOn()?"NoDisplay":""},emptyMessageListMessage:function(n,t,i){return a.getMessage(n,t,i)}}}),a=new function(){function i(i,r,u,f,e){var o="",h=r&&n.GetString(r),s=e&&n.GetString(e),c,l;return s&&s.length>0&&u&&u.length>0?(c='<a class="t_tci" href="{0}" onclick="window.open(this.href, \'_self\')">{1}<\/a>'.format(u,s),o=h.format(c)):!r&&f&&f.length>0?(l=i&&n.GetString(i),o=l.format(t.views.converters.html(f))):o=h,o}function f(){var t='<a class="t_tci advSearchLink" href="#" {0}>{1}<\/a>'.format(n.getSutra("tryadvancedsearchlink"),n.GetString("MessageList.NoMatches.AdvancedSearch"));return n.GetString("MessageList.NoMatches.Format").format(t)}function e(t,u){var f=null,e=null,o=null,s=null;switch(t){case r.UnreadMessages:f="MessageList.NoMessages.Filter.UnreadMessages.Text";break;case r.FromContacts:f="MessageList.NoMessages.Filter.FromContacts.Text",s="MessageList.NoMessages.Filter.FromContacts.LinkText",o=n.GetAppConfig("fromContactsActionUrl");break;case r.SocialUpdates:f="MessageList.NoMessages.Filter.SocialUpdates.Text";break;case r.MailingList:f="MessageList.NoMessages.Filter.MailingList.Text";break;case r.Newsletters:f="MessageList.NoMessages.Filter.Newsletters.Text";break;case r.Other:f="MessageList.NoMessages.Filter.Other.Text";break;default:e=u.containerMap()[t]&&u.containerMap()[t].name()}return i("MessageList.NoMessages.Filter.Default.Text",f,o,e,s)}function o(n){var t=null,u=n.name();switch(n.id()){case r.FlaggedMessages:t="MessageList.NoMessages.QuickView.FlaggedMessages.Text";break;case r.Photos:t="MessageList.NoMessages.QuickView.Photos.Text";break;case r.Document:case r.DocumentPlus:t="MessageList.NoMessages.QuickView.File.Text";break;case r.ShippingNotification:t="MessageList.NoMessages.QuickView.ShippingNotification.Text"}return i("MessageList.NoMessages.QuickView.Default.Text",t,null,u,null)}function s(t){var r=null,f=null,e=null,o=HM.FolderType.USER_DEFINED===t.folderType()||HM.FolderType.AGGREGATED===t.folderType();if(o)r="MessageList.NoMessages.Folder.Custom.Text",f=n.baseLegacyUrl(n.GetAppConfig("customFolderActionUrl")),e="MessageList.NoMessages.Folder.Custom.LinkText";else switch(t.id()){case u.inboxFid:n.GetUserConfig("IsManagedRestricted")||n.GetUserConfig("IsEasiAccountWithoutFullAccess")?r="MessageList.NoMessages.Folder.Inbox.Text":(r="MessageList.NoMessages.Folder.InboxWithPopUpsell.Text",f=n.GetAppConfig("composeAccountsActionUrl"),e="MessageList.NoMessages.Folder.InboxWithPopUpsell.LinkText");break;case u.trashFid:r="MessageList.NoMessages.Folder.Trash.Text";break;case u.sentFid:r="MessageList.NoMessages.Folder.Sent.Text",e="MessageList.NoMessages.Folder.Sent.LinkText",f=n.baseLegacyUrl(n.GetAppConfig("sentActionUrl"));break;case u.draftsFid:r="MessageList.NoMessages.Folder.Drafts.Text";break;case u.junkFid:r="MessageList.NoMessages.Folder.Junk.Text"}return i("MessageList.NoMessages.Folder.Default.Text",r,f,null,e)}this.getMessage=function(n,t,i){return n.isSearch()?f():t?e(t,i):n.isCategory()?o(n):s(n)}},o={templateId:s,template:c,attr:"html",_autoSelectEnabledOnFirstPage:!0,_disableAutoSelectOnNextRequest:!1,init:function(i){var r=this,u=i.ctx,f;r.data=u.messageList,r.categoryList=u.categoryList,r.folderList=u.folderList,r.layout=u.layout,r.search=u.search,r._autoSelectEnabledOnFirstPage=n.GetUserConfig("ShowFirstMessage")&&r.data.Layout.isReadingPaneOn(),r._preventFirstScroll=!r._autoSelectEnabledOnFirstPage,r.ControlNamespace=n.createControlNamespace(r.tagName),r.selection=new n.Selection({control:r,isSelectionRoot:!0,isSelectable:!1}),f=t(".messageListContainer"),r._serverScrollTop=f.scrollTop()||0,r.animationPromise=t.Deferred(),i.ctx.skipInitAutoSelect&&(r._disableAutoSelectOnNextRequest=!0),n.config.serverRenderOnly||(r.createContextMenu(),r.inboxContextMenu=i.props.contextMenu),r._cmdHandlers={},r._cmdHandlers["ml.toggleselectallmessages"]=r.onSelectAll,r._cmdHandlers["accessibility.focus"]=r.onFocus,r._cmdHandlers["ml.menu.click"]=r.onContextMenuClick,r._cmdHandlers["ml.showmessagemenu"]=r.onShowMessageContextMenu,r._cmdHandlers["ml.showcategorize"]=r.onShowCategorize,r._cmdHandlers["sel.scopeexceeded"]=r.onSelectionScopeExceeded,r._cmdHandlers["nav.nextpage"]=r.onNextPage,r._cmdHandlers["nav.prevpage"]=r.onPrevPage,r._cmdHandlers["nav.firstpage"]=r.onFirstPage,r._cmdHandlers["nav.lastpage"]=r.onLastPage,r._cmdHandlers["nav.filter"]=r.onFilter,r._cmdHandlers["nav.arrangeby"]=r.onArrangeBy,r._cmdHandlers["sel.selectedcontrols"]=r.onSelectedControls,r._cmdHandlers["sel.pinboardselcleared"]=r.onPinboardSelCleared,r._cmdHandlers.gotopickerinitiatejump=r.initiateJumpNavigation,r._cmdHandlers["sel.keyboardshortcut"]=r.onSelectionKeyboardShortcut,n.Cmd("ml.precommit").subscribe(t.proxy(r._onPreCommit,r)),n.Cmd("ml.postcommit").subscribe(t.proxy(r._onPostCommit,r)),n.Cmd("nav.container").subscribe(function(){var n=this;r.data.dataAvailableDeferred.then(function(t){var i=n.args.skipHistory,u=n.args.allowAutoSelect,f=i&&!u?HM.AutoSelectType.None:HM.AutoSelectType.First,e=i&&(!r.layout.isReadingPaneOrFullViewOn()||!u);r.onAfterQuery(f,!i,!1,n.deferred,t,e)})}),n.Cmd("refresh").subscribe(function(n){n&&n.isRefreshMessageList?r.data.dataAvailableDeferred.then(function(){r.onDataAvailable(HM.AutoSelectType.First,!0,!1,!1,!0)}):n&&n.restoreMessageListFocus&&r.FocusedControl&&r.FocusedControl.focus()}),t.observable.simpleOn(r.categoryList,"itemPropertiesChanged."+r.ControlNamespace,t.proxy(r.onCategoryPropertyChange,r)),t.observable.simpleOn(r.data.layout(),"propertyChange."+r.ControlNamespace,function(t,i){if(i.path==="ReadingPaneMode"){r.linkPromiseCreated=!0,n.Cmd("accessibility.suppressrestorefocus").bubble(r),r._createLinkPromise(),r._autoSelectEnabledOnFirstPage=n.GetUserConfig("ShowFirstMessage")&&r.data.Layout.isReadingPaneOn();r.onDataAvailable(HM.AutoSelectType.First,!1,!1)}})},initiateJumpNavigation:function(n,t,i){var r=this;r.data.initiateJumptoNavigation(i.anchor),r.data.dataAvailableDeferred.always(function(n){r.onAfterQuery(HM.AutoSelectType.First,!1,!1,this,n)})},contextMenu:function(t){return n.Accessor(this,"ContextMenu",t)},cssClasses:function(t,i){return"c-MessageList "+h+" "+n.c.InstantActionsControl.getMessageListCssClasses(this.data.QueryContainer,i)+(t===HM.ReadingPaneLocation.Right?" Narrow":" Wide")},cssInnerContainer:function(n){var t=n===HM.ReadingPaneLocation.Right||n===HM.ReadingPaneLocation.Bottom?"RPOn":"RPOff";switch(n){case HM.ReadingPaneLocation.Right:t+=" RPRight";break;case HM.ReadingPaneLocation.Bottom:t+=" RPBottom"}return this.bottomMsg()&&(t+=" BottomMsg"),t},render:function(){var n=this;return n.selection.reset(),n.shouldDisplayBottomMsg(),n.linkPromiseCreated||n._createLinkPromise(),n.linkPromiseCreated=!1,n.tagCtx.ctx.messageListLinkPromise=n.linkPromise.promise(),this.tagCtx.render(this.data)},shouldDisplayBottomMsg:function(){var e=this.data.queryContainer()?this.data.queryContainer().Id:null,t,i,r;switch(e){case n.config.sysCats.flaggedFltid:this.layout.isPinningEnabled()===!1&&(t=f.pinQuickViewBotLink.format(n.GetString("Pinning.Quickview.UpsellFormat.LinkText"),n.DynamicNonce(),n.getSutra("bottommessagelink")),this.bottomMsg(n.GetString("Pinning.Quickview.UpsellFormat").format(t)));break;case u.junkFid:t=f.junkFolderBotLink.format(n.GetString("MessageList.Junk.BottomText.Link"),n.DynamicNonce(),n.getSutra("bottommessagelink")),this.bottomMsg(n.GetString("MessageList.Junk.BottomText").format(t));break;case u.trashFid:n.config.messageList.trashRecoveryAvail?(i=f.recoverLink.format(n.GetString("MessageList.Deleted.BottomText.RecoverLink"),n.getSutra("restoretrashlink")),r=f.learnMoreLink.format(n.GetString("MessageList.Deleted.BottomText.LearnMoreLink"),f.learnMoreUrl,n.getSutra("restoretrashhelplink")),this.bottomMsg(n.GetString("MessageList.Deleted.BottomText.ExecuteMessageRecoveryFormat").format(i,r))):this.bottomMsg("");break;default:this.bottomMsg("")}},bottomMsg:function(t){return n.Accessor(this,"BottomMsg",t)},_createLinkPromise:function(){this.linkPromise=t.Deferred()},createContextMenu:function(){var u=[],t,r;u.push(new i.MenuItem({template:"#contextMenuItemTemplate",text:n.GetString("ContextMessage.Reply"),key:"reply",sutraTag:"ContextMenuItem"})),u.push(new i.MenuItem({template:"#contextMenuItemTemplate",text:n.GetString("ContextMessage.ReplyAll"),key:"replyall",sutraTag:"ContextMenuItem"})),u.push(new i.MenuItem({template:"#contextMenuItemTemplate",text:n.GetString("ContextMessage.Forward"),key:"forward",sutraTag:"ContextMenuItem"})),t=[],t.push(new i.MenuItem({template:"#contextMenuItemTemplate",text:n.GetString("ContextMessage.MarkRead"),key:"markasread",sutraTag:"ContextMenuItem"})),t.push(new i.MenuItem({template:"#contextMenuItemTemplate",text:n.GetString("ContextMessage.MarkUnread"),key:"markasunread",sutraTag:"ContextMenuItem"})),t.push(new i.MenuItem({template:"#contextMenuItemTemplate",text:n.GetString("ContextMessage.Delete"),key:"deletemsg",sutraTag:"ContextMenuItem"})),n.GetAppConfig("IsArchiveEnabled")&&t.push(new i.MenuItem({template:"#contextMenuItemTemplate",text:n.GetString("ContextMessage.Archive"),key:"archive",sutraTag:"ContextMenuItem"})),n.GetUserConfig("IsManagedRestricted")||t.push(new i.MenuItem({template:"#contextMenuItemTemplate",text:n.GetString("ContextMessage.ReportAndDelete"),key:"markasjunk",sutraTag:"ContextMenuItem"})),t.push(new i.MenuItem({template:"#contextMenuItemTemplate",text:n.GetString("ContextMessage.NotJunk"),key:"markasnotjunk",sutraTag:"ContextMenuItem"})),t.push(new i.MenuItem({template:"#contextMenuItemTemplate",text:n.GetString("ContextMessage.Move"),key:"movetopopup",sutraTag:"ContextMenuItem"})),n.GetAppConfig("IsAdvancedRulesEnabled")&&t.push(new i.MenuItem({template:"#contextMenuItemTemplate",text:n.GetString("ContextMessage.CreateRule"),key:"createrule",sutraTag:"ContextMenuItem"})),t.push(new i.MenuItem({template:"#contextMenuItemTemplate",text:n.GetString("ContextMessage.ViewSource"),key:"viewsource",sutraTag:"ContextMenuItem"})),r=[],n.GetAppConfig("EnableCtxMenuSenderActions")&&(r.push(new i.MenuItem({template:"#contextMenuItemTemplate",text:n.GetString("ContextMessage.SendEmail"),key:"sendemailtosender",sutraTag:"ContextMenuItem"})),r.push(new i.MenuItem({template:"#contextMenuItemTemplate",text:n.GetString("ContextMessage.FindEmail"),key:"viewallfromsender",sutraTag:"ContextMenuItem"})),n.GetAppConfig("IsBulkActionsEnabled")&&(r.push(new i.MenuItem({template:"#contextMenuItemTemplate",text:n.GetString("MoveAllFromSender.Generic"),key:"moveallfromsender",sutraTag:"ContextMenuItem"})),r.push(new i.MenuItem({template:"#contextMenuItemTemplate",text:n.GetString("DeleteAllFromSender.Generic"),key:"deleteallfromsender",sutraTag:"ContextMenuItem"})))),this.contextMenu(new i.MessageListContextMenu({params:{edgeOffsets:{top:120,bottom:120}},loc:1,sendMenuItems:u,messageMenuItems:t,senderMenuItems:r}))},_disposeLastContents:function(){var t=this;t._$lastContents&&(t.inboxContextMenu.cancelTimers(),n.c.MessageRowControl.detachEvents(t._$lastContents),n.c.InstantActionsControl.detachEvents(t._$lastContents),t._$lastContents.off(".mlc"),t.DragSource=t.$categorizeMenu=t.contextMenuControl=t.messageListHeaderControl=t.messageListNavigationControl=t._$lastContents=null)},onDispose:function(){var n=this;n._disposeLastContents(),t.observable.simpleOff(n.selection,"propertyChange."+this.ControlNamespace),t.observable.simpleOff(n.categoryList,"propertyChange."+this.ControlNamespace),t.observable.simpleOff(this.folderList,"propertyChange."+this.ControlNamespace)},_onPreCommit:function(r){function h(t){for(var r,f=n.findChildTag(u,"messageRowControl",!0),i=0;i<f.length;i++)if(r=f[i],r.data.equals(t)&&!r.data.preparedToRemove())return r;return null}var f=r.cmd,u=this,o=r.addedThreads,s=r.removedThreads,e=u.selection;if((o.length!==0||s.length!==0)&&(f.animPromise=r.queryChange?t.when():u.animateMoveMessages(r),f.args.csiPerfDeferred&&setTimeout(function(){f.args.csiPerfDeferred.resolve()},0),e.SelectedSubcontrols.length!==0)){f.animPromise.always(function(){var t,o,s,c,l;e.beginBatch(),t=n.Selection.batchUpdate(e.SelectedSubcontrols,h,r.addedThreadsMap),o=t.selectedCount===0,t.lastControl&&(s=i.MessageThread.getItemIdsFromMessageInfos(f.args.items),c=f.name==="flagitems"&&s.indexOf(t.lastControl.data.id())!==-1&&u.data.Layout.isPinboardExpanded(),c?u._deferSelection={check:t.lastControl.checked()}:o?t.lastControl.selection.selectNext()||t.lastControl.selection.selectPrev()||u.clearAllSelection():u.data.checkAllChecked()&&(u.data.bulkSelected()?(n.Cmd("ml.toggleselectallmessages").bubble(u,{selectAllMessages:!0,entryPoint:HM.InstrumentationEntryPoint.Canvas}),u.data.restoreBulkSelection(u.data.bulkSelected())):u.data.checkAllChecked(!1)),o&&u.data.Layout.isFullView()&&n.GetUserConfig("IsNextMessageEnabled")===!1&&(l=u._getSingleSelectedMessageThread(),n.Cmd("closeview").bubble(u,{thread:l})))});return}},_onPostCommit:function(n){var f=n.cmd,t=this,r,u;return t.selection.batchModeEnabled()&&(t._deferSelection&&(r=i.MessageThread.getItemIdsFromMessageInfos(f.args.items),u=t.selectThreadsById(r),u!==r.length?t.selection.reset():t._deferSelection.check&&t.selection.check(),t._deferSelection=null),t.selection.endBatch()),!1},_scrollControlIntoView:function(i){var r=this;if(i)try{i.contents?n.scrollIntoView(i.contents().get(0),_ge(r.ControlNamespace+"messageListContainer"),100):HM.ReportError("selectedControl does not have contents: "+JSON.stringify(i),t.noop)}catch(u){}},onAfterLink:function(){var i=this,r,e,o,u;for(i._disposeLastContents(),r=t(_ge(i.ControlNamespace)),i._serverScrollTop&&(i.scrollToTop(i._serverScrollTop),i._serverScrollTop=null),n.c.InstantActionsControl.attachEvents(r),n.c.MessageRowControl.attachEvents(r,t.proxy(i.onMouseOutMessageRow,i),t.proxy(i.onMouseOverMessageRow,i)),i.data.checkAllChecked(!1),i.contextMenuControl=n.findChildTag(i,"messageListContextMenuControl")[0],i.categorizeMenuControl=null,e=n.findChildTag(i,"messageRowControl",!0),i.selection.beginBatch(),u=0;u<e.length;u++)e[u].applyGlassChanges(u)&&(i._disableAutoSelectOnNextRequest=!0,o=e[u]);if(o){for(u=0;u<e.length;u++)e[u].selected()&&!e[u].isCheckedInGlass()&&e[u].selection.unselect();o.selection.check()}i.DragSource=new n.DragSource({sourceControl:i,controlNamespace:i.ControlNamespace}),n.c.MessageRowControl.clearGlassChanges(),i.messageListHeaderControl=n.findChildTag(i,"messageListHeaderControl")[0],i.messageListNavigationControl=n.findChildTag(i,"messageListNavigationControl")[0],i.$categorizeMenu=r.find(".cm_menu");r.on("focusin.mlc",function(){r.removeClass("t_mlli")});r.on("focusout.mlc",function(){r.addClass("t_mlli")});r.on("click.mlc",".advSearchLink",function(){return n.Cmd("openadvancedsearch").bubble(i),!1});if($B.IE&&$B.V<10)r.on("selectstart",function(n){if(n.target.nodeName!=="INPUT"&&n.target.nodeName!=="TEXTAREA")return!1});r.on("click.mlc",".recoveryLink",function(){n.Dispatcher.fireCmd("restorehiddentrash").deferred.then(function(t,r){var s=0,u,e,h,o;if(r)for(u=0;u<r.length;u++)e=r[u],e&&e.type===HM.DLReturnType.RestoreHiddenTrashNumRestored&&(s=e.numMessagesRestored);if(s>0){var c=n.GenerateLinkHtml("#",n.GetString("MessageList.Deleted.BottomText.SuccessLinkText"),null,n.getSutra("restoretrashsuccesslink"),null,"class='recoverFeedbackSuccess'"),l=n.GenerateLinkHtml("#",n.GetString("MessageList.Deleted.BottomText.FailureLinkText"),null,n.getSutra("restoretrashfailurelink"),null,"class='recoverFeedbackFailed'"),o=n.GetString("MessageList.Deleted.BottomText.SomeMessagesRecoveredFormat").format(c,l);i.bottomMsg(o)}else h=f.learnMoreLink.format(n.GetString("MessageList.Deleted.BottomText.LearnMoreLink"),f.learnMoreUrl,n.getSutra("restoretrashhelplink")),o=n.GetString("MessageList.Deleted.BottomText.NoMessagesRecoveredFormat").format(h),i.bottomMsg(o);return!1})});r.on("click.mlc",".recoverFeedbackSuccess, .recoverFeedbackFailed",function(r){return t(r.srcElement).hasClass("recoverFeedbackSuccess")?i.bottomMsg(n.GetString("MessageList.Deleted.BottomText.SuccessConfirmation")):t(r.srcElement).hasClass("recoverFeedbackFailed")&&i.bottomMsg(n.GetString("MessageList.Deleted.BottomText.FailureConfirmation")),!1});i._$lastContents=r,i.linkPromise.resolve().then(function(){i.selection.endBatch()}),t.observable.simpleOff(i.folderList,"propertyChange."+i.ControlNamespace),i.layout.ReadingPaneMode!==HM.ReadingPaneLocation.Right&&i.data.isSearchResult()&&t.observable.simpleOn(i.folderList,"itemPropertiesChanged."+i.ControlNamespace,t.proxy(i.onFolderPropertyChange,i))},onAfterQuery:function(n,t,i,r,u,f){this.onDataAvailable(n,t,i,!!f,!1)},onDataAvailable:function(i,r,u,f){var o=this;o._preventFirstScroll?o._preventFirstScroll=!1:o.scrollToTop(),r&&e.Animations.enterContent(_ge(o.ControlNamespace+"messageListInnerContainer"),undefined,undefined,!0).then(function(){setTimeout(function(){var n=o.animationPromise;o.animationPromise=t.Deferred(),n.resolve()},0)}),o.linkPromise.then(function(){o.autoSelectMessage(i,u)?o.data.setCountState(1,!1):(f||(o.clearAllSelection(),o.data.setCountState(0,o.layout.isReadingPaneOn()),o.selection.reset()),n.isFocusOnTextBox()||n.getActiveElement()===document.body||o.focus())})},focus:function(){this.FocusedControl?this.FocusedControl.focus():n.setFocus(function(){n.isFocusOnTextBox()||n.getActiveElement()===document.body||n.getActiveElement().blur()})},preDragSetup:function(){l(this.parent,!0)},postDropSetup:function(){l(this.parent,!1)},isDraggable:function(){return!0},getControlsForStyling:function(n){return t(n.mouseMoveEvent.target).closest(".c-MessageList *").length>0?this.contents(".c-MessageList"):null},getDraggableDomArea:function(){return this.contents()},getDefaultTooltipString:function(){return null},getTooltipMessageAndCursor:function(t){var i=this.selection.SelectedSubcontrols.length,r;this.data.bulkSelected()&&(i=this.data.queryContainer().TotalCount),r=null,r=this.data.checkAllChecked()?n.GetString("DragNDrop.DragMessage.All"):(i===1?n.GetString("DragNDrop.DragMessage.Single"):n.GetString("DragNDrop.DragMessage.Multiple")).format(i),t.tooltip=r},refreshChildren:function(t){var i=n.GetControlFromDOMElement(t.target);return i&&!i.Selected&&(this.clearAllSelection(),i.selection.check()),this.selection.SelectedSubcontrols},getDragControls:function(){return this.selection.SelectedSubcontrols},onCmdBubble:function(n,t,i){var r=!0;return this._cmdHandlers[t.name]&&(r=this._cmdHandlers[t.name].call(this,n,t,i)),r},getActiveGroupControl:function(){var t=n.findChildTag(this,"messageGroupControl"),i=this.data.activeGroupIndex();return i<t.length?t[i]:null},onFocus:function(){this.focus()},onSelectAll:function(n,t,i){if(this.selection.unselectAll(),i.selectAllMessages){var r=this.getActiveGroupControl();r&&r.selection&&r.selection.selectAll()}},onSelectionChange:function(n,t,i){var r=this,u,f=r.getActiveGroupControl(),e=f&&f.allRowsSelected();(r.data.checkAllChecked(!!e),n.length!==0)&&(n.length===1||e?u=n[0]:n.length>0&&(u=i&&i.selectArgs&&i.selectArgs.targetControl?i.selectArgs.targetControl:n[n.length-1]),r._scrollControlIntoView(u))},restoreSelection:function(){var n=this;n.data.savedSelectionState.selectionStates&&(n.selectThreadsById(null,null,n.data.savedSelectionState.selectionStates),n.data.bulkSelected(n.data.savedSelectionState.bulkSelected)),n.data.savedSelectionState.selectionStates=null,n.data.savedSelectionState.bulkSelected=!1},selectThreadsById:function(t,i,r){var e=0,u,h,f,l,o,c;if(t&&t.length===0||r&&r.length===0)return e;var s=this,a=n.findChildTag(s,"messageRowControl",!0),v=s.selection.batchModeEnabled();for(v||s.selection.beginBatch(),u=0,h=0;h<a.length;h++){if(f=a[h],l=f.data,r)for(u=r.length,o=0;o<u;o++)l.areSameThreadIds(r[o].id)&&(u!==1||r[o].checked?f.selection.check(i):f.selection.selectBatch(i),e++);else for(u=t.length,c=0;c<u;c++)l.areSameThreadIds(t[c])&&(u===1?f.selection.selectBatch(i):f.selection.check(i),e++);if(e===u)break}return v||s.selection.endBatch(),e},onFilter:function(t,i,r){var f=this,u=f.data,e=u.queries();e.length?(u.filterId(r.filterId,{silentlyUpdate:!0}),u.updateFilter(r.anchor).always(function(t){f.onAfterQuery(HM.AutoSelectType.First,!0,!1,this,t);n.Cmd("instrument.filter").fire({entryPoint:HM.InstrumentationEntryPoint.Canvas,fId:r.filterId})}).then(i.deferred.resolve,i.deferred.reject)):i.deferred.resolve()},onArrangeBy:function(t,i,r){var f=this,u=f.data,a=f.folderList.totalMsgCount(),h=n.GetAppConfig("bigCount"),v=u.IsConversationThreadingOn!==r.conversationModeOn,c,l,o,s;!h||a<h||r.sortType===HM.SortBy.Date?(c=u.queries(),c.length?(l=n.GetUserConfig("ShowFirstMessage")?HM.AutoSelectType.First:HM.AutoSelectType.None,f.messageListNavigationControl.resetGotoPickerValues(r.sortType),o=u.sortKey.SortOrder,o=u.sortKey.SortBy===r.sortType&&u.isConversationThreadingOn()===r.conversationModeOn?u.sortKey.SortOrder==HM.MessageListKeyQuerySortOrder.Descending?HM.MessageListKeyQuerySortOrder.Ascending:HM.MessageListKeyQuerySortOrder.Descending:f.messageListNavigationControl.getDefaultSortDirection(r.sortType),v&&f.clearAllSelection(),u.setSortOrderAndType(o,r.sortType,r.conversationModeOn),f._getPage(HM.ListNavigateDirection.FirstPage,l,!0).then(i.deferred.resolve,i.deferred.reject)):i.deferred.resolve()):(s=e.Controls.Notifications,s.createTopBar({content:n.GetString("MessageList.Sort.BigInboxError.Para1"),dismissalMode:s.BarDismissalMode.Timeout}).show(),i.deferred.reject())},onContextMenuClick:function(i,r,u){var f=u.isSenderMenu?HM.InstrumentationEntryPoint.HoverMenu:HM.InstrumentationEntryPoint.ContextMenu,e,s,o;switch(u.key){case"viewsource":e=this.selection.selectedSubcontrols(),e.length===1&&(s=this.data.queryContainer().isFolder()?this.data.queryContainer().id():n.config.sysFldrs.noneFid,e[0].data.viewSource(s,f));break;case"reply":case"replyall":case"forward":o=this._getSingleSelectedMessageThread(),o&&n.Cmd(u.key).fire({action:u.key,thread:o,entryPoint:f});break;case"sendemailtosender":case"viewallfromsender":n.Cmd(u.key).fire({action:u.key,senderEmail:i.data.senderEmail(),entryPoint:f});break;case"deletemsg":case"markasread":case"markasunread":n.Cmd(u.key).fire(t.extend({},u,{entryPoint:f}));break;case"movetopopup":n.Cmd("showmoveto").fire({entryPoint:f,event:u.event,triggeredByExternalEvent:!0});break;case"markasjunk":n.Cmd("junk").fire({entryPoint:f});break;case"markasnotjunk":n.Cmd("notjunk").fire({entryPoint:f});break;case"archive":n.Cmd("archive").fire({entryPoint:f});break;case"createrule":n.Cmd("createrule").fire({event:u.event,entryPoint:f});break;case"deleteallfromsender":n.Cmd("bulkactionbysender").fire({action:"sweep",selection:u.isSenderMenu?[i.data.messageRow()]:null,entryPoint:f});break;case"moveallfromsender":n.Cmd("bulkactionbysender").fire({action:"move",selection:u.isSenderMenu?[i.data.messageRow()]:null,entryPoint:f})}},onShowMessageContextMenu:function(n,i,r){if(this.contextMenuControl){t.inArray(n,this.selection.selectedSubcontrols())===-1&&(this.selection.unselectAll(),n.selection.check());var u=this.selection.selectedSubcontrols();this.contextMenuControl.handleContextMenuInRow(r.$event,n,u,!1,this.data.queryContainer().id())}},onMouseOutMessageRow:function(t){this.contextMenuControl&&this.contextMenuControl.handleMouseOutRow(t,n.GetControlFromEvent(t,"messageRowControl"))},onMouseOverMessageRow:function(t){this.contextMenuControl&&this.contextMenuControl.handleMouseOverRow(t,n.GetControlFromEvent(t,"messageRowControl"),this.data.queryContainer().id())},onShowCategorize:function(t,i,r){this.categorizeMenuControl||(this.categorizeMenuControl=n.c.categorizeMenuControl.initializeCategorize(this.$categorizeMenu));var u=this.data.queryContainer().id(),f=n.config.sysFldrs,e=u===f.sentFid||u===f.draftsFid;this.categorizeMenuControl.show({ev:r.$event.originalEvent,sourceEl:r.sourceEl,selectedMsgs:[t.data],selectedMsgRow:t,disableBulkApply:e,sourceOffMenuElt:!0,extraMenuParams:{sourceRelativeToBody:!0},entryPoint:HM.InstrumentationEntryPoint.MessageList})},onCategoryPropertyChange:function(n,t){var r,i,u;if(this.layout.ReadingPaneMode!==HM.ReadingPaneLocation.Right)for(r=t.propertiesChanged,i=0;i<r.length;i++)if(u=r[i],u.path==="Name"){this.updateMessageRowCategories(t.item);break}},updateMessageRowCategories:function(t){for(var r=n.findChildTag(this,"messageRowControl",!0),i=0;i<r.length;i++)r[i].onCategoryRename(t)},onFolderPropertyChange:function(n,t){for(var r=t.propertiesChanged,u,i=0;i<r.length;i++)if(u=r[i],u.path==="Name"){this.updateMessageRowFolders(t.item);break}},updateMessageRowFolders:function(t){for(var r=n.findChildTag(this,"messageRowControl",!0),i=0;i<r.length;i++)r[i].onFolderRename(t)},onSelectionScopeExceeded:function(t,i,r){(r.name==="selectNext"||r.name==="selectPrev")&&(r.direction===n.Selection.eDirection.next&&!this.data.activeGroup().eof()&&this.data.resultsComplete?this._getPage(HM.ListNavigateDirection.NextPage,HM.AutoSelectType.First,!0):r.direction!==n.Selection.eDirection.prev||this.data.activeGroup().bof()||this._getPage(HM.ListNavigateDirection.PreviousPage,HM.AutoSelectType.Last,!0))},onSelectionKeyboardShortcut:function(t,i,r){function l(t){if(t){t.selection.select();var i=t.data;i&&n.Cmd("fullview").bubble(u,{thread:i,entryPoint:HM.InstrumentationEntryPoint.KeyboardShortcut})}}var f=!1,u=this,s=u.selection.selectedSubcontrols().length===0,e=!1,h,c,o;if(s&&!u.FocusedControl&&(r.name==="focusNextMsg"||r.name==="focusNextMsg2"||r.name==="focusPrevMsg2")&&u.data.NumThreads&&(u.autoSelectMessage(HM.AutoSelectType.First,!0,!0),f=!0,e=!0),!e)switch(r.name){case"openMsg":l(u.focusedControl()),f=!0,e=!0;break;case"focusNextMsg2":f=u.selection.focusNext(),e=!0;break;case"focusPrevMsg2":f=u.selection.focusPrev(),e=!0;break;case"focusPrevMsg":if(t.tagName==="messageRowControl"){for(h=n.findChildTag(u,"messageGroupControl"),o=0;o<h.length;o++)h[o].data.showFooter()&&(c=h[o]);c&&c.isSectionExpanded()?c.focus():u.messageListHeaderControl.focus(),f=!0,e=!0}break;case"nextMsg":case"prevMsg":case"nextMsg2":case"prevMsg2":s&&!u.FocusedControl?(u.autoSelectMessage(HM.AutoSelectType.First,!0),f=!0):f=r.name==="nextMsg2"||r.name==="nextMsg"?u.selection.selectNext(r):u.selection.selectPrev(r),e=!0;break;case"multiNextMsg":s&&!u.FocusedControl?u.autoSelectMessage(HM.AutoSelectType.First,!0,!1,!0):f=u.selection.selectMultiNext(),e=!0;break;case"multiPrevMsg":f=u.selection.selectMultiPrev(),e=!0}if(!e&&t.tagName==="messageRowControl")switch(r.name){case"nextMsg2":case"prevMsg2":s&&!u.FocusedControl?(u.autoSelectMessage(HM.AutoSelectType.First,!0),f=!0):f=r.name==="nextMsg2"?u.selection.selectNext(r):u.selection.selectPrev(r);break;case"multiNextMsg":f=u.selection.selectMultiNext();break;case"multiPrevMsg":f=u.selection.selectMultiPrev();break;case"openMsg2":u.layout.isReadingPaneOn()||u.layout.isFullView()?n.Cmd("accessibility.focus").bubble(u,{focusTo:"readMessageControl"}):l(u.focusedControl()),f=!0}return f?i.deferred.resolve():i.deferred.reject(),!f},onNextPage:function(t,i){var r=n.GetUserConfig("ShowFirstMessage")&&this.layout.isReadingPaneOn()?HM.AutoSelectType.First:HM.AutoSelectType.None;this._getPage(HM.ListNavigateDirection.NextPage,r,!0).then(i.deferred.resolve,i.deferred.reject)},onPrevPage:function(t,i){var r=n.GetUserConfig("ShowFirstMessage")&&this.layout.isReadingPaneOn()?HM.AutoSelectType.First:HM.AutoSelectType.None;this._getPage(HM.ListNavigateDirection.PreviousPage,r,!0).then(i.deferred.resolve,i.deferred.reject)},onFirstPage:function(t,i){var r=n.GetUserConfig("ShowFirstMessage")&&this.layout.isReadingPaneOn()?HM.AutoSelectType.First:HM.AutoSelectType.None;this._getPage(HM.ListNavigateDirection.FirstPage,r,!0).then(i.deferred.resolve,i.deferred.reject)},onLastPage:function(t,i){var r=n.GetUserConfig("ShowFirstMessage")&&this.layout.isReadingPaneOn()?HM.AutoSelectType.First:HM.AutoSelectType.None;this._getPage(HM.ListNavigateDirection.LastPage,r,!0).then(i.deferred.resolve,i.deferred.reject)},onPinboardSelCleared:function(){return this.layout.isReadingPaneOn()&&n.GetUserConfig("ShowFirstMessage")&&this.selection.SelectedSubcontrols.length===0&&this.autoSelectMessage(HM.AutoSelectType.First,!0,!1),!1},onSelectedControls:function(n,t,i){var r,u,f,e;if(n===this){for(u=[],f=i.selectedControls,r=0;r<f.length;r++)e=f[r],e.data&&u.push(e.data);return this.data.selectedItems(u),!0}},_getPage:function(n,t,i){var r=this,u=r.layout.isFullView(),f=r.data.getPage(n);return r.data.dataAvailableDeferred.then(function(n){r.layout.isFullView(u);r.onAfterQuery(t,i,!0,this,n,!1)}),f},scrollToTop:function(n){var i=this;n=n||0,setTimeout(function(){t(_ge(i.ControlNamespace+"messageListContainer")).scrollTop(n)},0)},autoSelectMessage:function(n,t,i,r){var f=n!==HM.AutoSelectType.None&&(t||this._autoSelectEnabledOnFirstPage&&!this._disableAutoSelectOnNextRequest),u;return(this._disableAutoSelectOnNextRequest=!1,!f)?!1:(this.data.checkAllChecked(!1),i?(u=this.selection.getAutoselectControl(n),u)?(u.selection.focus(),!0):!1:r?(u=this.selection.getAutoselectControl(n),u)?(u.selection.check(),!0):!1:this.selection.autoSelect(n))},clearAllSelection:function(){this.selection.unselectAll(),this.data.setCountState(0,this.layout.isReadingPaneOn())},_getSingleSelectedMessageThread:function(){var n=this.selection.selectedSubcontrols();return n[0].data},animateMoveMessages:function(i){var l=this,f=[],a=[],v=[],o=[],y=[],p=0,s=0,h=0,c,r,u;if(e.Animations.Enabled)for(f=l.contents().find(".InboxTable .animatable").not(".NoDisplay.animatable, .NoDisplay .animatable").toArray(),c=0;c<f.length;c++)r=f[c],u=n.GetControlFromDOMElement(r,"messageRowControl"),h===0&&(h=t(r).height()),y.push({top:-s,left:0}),u&&u.data.preparedToRemove()?(a.push(r),o.push({top:-s,left:0}),s+=h):u&&u.data.preparedToAdd()?(v.push(r),o.push({top:-s,left:0}),p+=h):o.push({top:-p,left:0});return e.Animations.addAndDeleteInListFast(a,v,f,o,y).then(function(){i&&i.removedThreads&&i.removedThreads.length&&!l.layout.isReadingPaneOn()&&n.Cmd("refreshads").bubble(l)})},shouldUnflagOnMove:function(){for(var u=this,i=n.findChildTag(u,"messageGroupControl",!1),t=0,r=i.length;t<r;t++)if(i[t].data.unflagOnMove()&&i[t].selection.SelectedSubcontrols.length>0)return!0;return!1}},n.Selection.CreateSelectablePropertiesAccessors(o),n.Selection.CreateSelectableRootControlAccessors(o),t.views.tags({messageListControl:o})}(window.ol,window.originaljQuery||window.jQuery),function(n,t){"use strict";function e(){var t=n.config.sysCats,i=n.config.sysFldrs;return!0}var i=n.vm,u=n.config.sysFldrs,r,f;t.templates("#messageListHeaderCheckAllTemplate"),r="messageListHeaderTemplate",f={templateId:r,template:t.templates("#"+r),attr:"html",init:function(t){var i=this,r=t.ctx;i.ControlNamespace=n.createControlNamespace(i.tagName),i.data=r.messageList,i.categoryList=r.categoryList,i.folderList=r.folderList,i.layout=r.layout,i.search=r.search,i.createCategoryFiltersMenu(),i.createArrangeByMenu()},render:function(){return this.tagCtx.render(this.data)},arrangeByMenu:function(t){return n.Accessor(this,"ArrangeByMenu",t)},categoryFiltersMenu:function(t){return n.Accessor(this,"CategoryFiltersMenu",t)},shouldDisplayFilterItem:function(n){if(n&&n.IsFilter){var t=n.Id;if(this.data.queryContainer().isFolder())return e(t,this.data.queryContainer().Id);if(this.data.queryContainer().isCategory())return this.data.queryContainer().id()!=n.Id}return!1},isMessageCountOverlappingFilters:function(n,t){return t&&n===HM.ReadingPaneLocation.Off},createCategoryFiltersMenu:function(n){var u=[],f="",e=this.categoryList&&this.categoryList.rootContainer().items(),r,t;if(e){for(r=0;r<e.length;r++)t=e[r],this.shouldDisplayFilterItem(t)&&(r==0&&(f=t.Name),u.push(new i.MenuItem({text:t.Name,key:"categoryFilter",sutraTag:"FilterView",eventData:{filterId:t.Id},itemImageClass:this.getFilterSelectionImageClass(t.Id)})));n&&this.filterCategoriesVM?(u.length&&this.filterCategoriesVM.title(this.getFilterSelectionDisplay(f)),this.filterCategoriesVM.items(u)):(this.filterCategoriesVM=new i.Menu({title:this.getFilterSelectionDisplay(f),menuAnchorClass:"filterBarMenu TextSizeSmall",titleClass:"t_atc",loc:0,sutraTag:"FilterViewsDropdown",items:u}),this.categoryFiltersMenu(this.filterCategoriesVM))}},getFilterSelectionImageClass:function(n){return!this.data.FilterId&&n===0||n===this.data.FilterId?"g_bul":"g_noimg"},getFilterSelectionDisplay:function(t){var i,u,r;return this.data.FilterId&&(u=this.data.FilterId,r=this.categoryList.containerMap()[u],i=r&&r.name()),i=i||t||"","{0} {1}".format(n.GetString("FilterSelector.CurrentView"),i)},createArrangeByMenu:function(t){function f(n){if(n){if(s.data.sortKey.SortOrder===HM.MessageListKeyQuerySortOrder.Descending)return"g_sort_desc";if(s.data.sortKey.SortOrder===HM.MessageListKeyQuerySortOrder.Ascending)return"g_sort_asc"}else return a}var s=this,a="g_sort_none",r=[],e=s.data.sortKey.SortBy,h=this.data.queryContainer().Id,v=h===n.config.sysFldrs.sentFid,y,p,c,o,l;for(r.push(new i.MenuItem({text:n.GetString("MessageList.SortInboxByDate"),key:"arrangeBy",sutraTag:"DropDownMenuItem",eventData:{sortType:HM.SortBy.Date,conversationModeOn:!1},itemImageClass:f(e===HM.SortBy.Date&&(v||!this.data.isConversationThreadingOn()))})),y=h===u.sentFid||h===u.draftsFid,p=y?n.GetString("MessageList.SortInboxByTo"):n.GetString("MessageList.SortInboxByFrom"),r.push(new i.MenuItem({text:p,key:"arrangeBy",sutraTag:"DropDownMenuItem",eventData:{sortType:HM.SortBy.Sender,conversationModeOn:!1},itemImageClass:f(e===HM.SortBy.Sender)})),r.push(new i.MenuItem({text:n.GetString("MessageList.SortInboxBySubject"),key:"arrangeBy",sutraTag:"DropDownMenuItem",eventData:{sortType:HM.SortBy.Subject,conversationModeOn:!1},itemImageClass:f(e===HM.SortBy.Subject)})),r.push(new i.MenuItem({text:n.GetString("MessageList.SortInboxBySize"),key:"arrangeBy",sutraTag:"DropDownMenuItem",eventData:{sortType:HM.SortBy.Size,conversationModeOn:!1},itemImageClass:f(e===HM.SortBy.Size)})),v||r.push(new i.MenuItem({text:n.GetString("MessageList.SortInboxByConversation"),key:"arrangeBy",sutraTag:"DropDownMenuItem",eventData:{sortType:HM.SortBy.Date,conversationModeOn:!0},itemImageClass:f(e===HM.SortBy.Date&&this.data.isConversationThreadingOn())})),c="",o=0;o<r.length;o++)l=r[o],l.ItemImageClass!==a&&(c=n.GetString("MessageList.SortByLabel").format(l.Text));t&&this.filterCategoriesVM?this.arrangeByVM.items(r):this.arrangeByVM=new i.Menu({title:n.GetString("MessageList.SortBy"),menuAnchorClass:"filterBarMenu TextSizeSmall",titleClass:"t_atc",loc:1,sutraTag:"DropDownMenu",items:r,toolTip:c}),this.arrangeByMenu(this.arrangeByVM)},focus:function(){n.callFocus(_ge("msgChkAll"))},onAfterLink:function(){var i=this,r=i.contents();i._propertyChangedInit||(t.observable.simpleOn(i.data.sortKey,"propertyChange."+i.ControlNamespace,function(){i.createArrangeByMenu(!0)}),t.observable.simpleOn(i.data,"propertyChange."+i.ControlNamespace,function(n,t){t.path==="IsConversationThreadingOn"&&i.createArrangeByMenu(!0),t.path==="FilterId"&&i.createCategoryFiltersMenu(!0)}),i._propertyChangedInit=!0);r.on("click","#msgChkAll",function(t){var r=i.data.items()[i.data.activeGroupIndex()];r&&r.items().length>0?n.Cmd("ml.toggleselectallmessages").bubble(i,{selectAllMessages:this.checked,entryPoint:HM.InstrumentationEntryPoint.Canvas}):t.preventDefault()});r.on("click","#sortMenu",function(){return!1});r.on("click","li.FilterSelector",function(){return!1})},onCmdBubble:function(t,i,r){if(i.name==="menu.click"){var u=this;return r.key==="categoryFilter"?n.Cmd("nav.filter").bubble(u,r):r.key==="arrangeBy"&&n.Cmd("nav.arrangeby").bubble(u,r),!1}return!0},onDispose:function(){var n=this;t.observable.simpleOff(n.data.sortKey,"propertyChange."+n.ControlNamespace),t.observable.simpleOff(n.data,"propertyChange."+n.ControlNamespace)}},t.views.tags({messageListHeaderControl:f})}(window.ol,window.originaljQuery||window.jQuery),function(n,t){"use strict";var n=window.ol=window.ol||{},f=n.controlHelpers=n.controlHelpers||{},i="messageListNavigationTemplate",r=t.templates(null,{markup:"#"+i,converters:{messageCount:function(t,i,r,u){var e=t.isSearch(),f;return r!==HM.ReadingPaneLocation.Right&&!u&&!e?(f=n.GetString("ReadMessage.TotalCountText"),f.format(i)):""}}}),u={templateId:i,template:r,attr:"html",init:function(n){var t=this,i=n.ctx;t.messageList=i.messageList,t.layout=i.layout},generatePageNumber:function(t,i){var r="";return t&&i?r=n.GetString("PaginationControl.FullPagingFormat").format(t,i):t&&(r=n.GetString("PaginationControl.BlindPagingFormat").format(t)),r},shouldRenderGotoLink:function(t){return t===HM.SortBy.Date&&n.config.gotoPicker.datePickerEnabled||t===HM.SortBy.Sender&&n.config.gotoPicker.alphaPickerEnabled||t===HM.SortBy.Subject&&n.config.gotoPicker.alphaPickerEnabled||t===HM.SortBy.Type},getDefaultSortDirection:function(n){return n===HM.SortBy.Date||n===HM.SortBy.Type?HM.MessageListKeyQuerySortOrder.Descending:HM.MessageListKeyQuerySortOrder.Ascending},render:function(){return this.tagCtx.render(this.data)},getBeginEndClass:function(n,t,i){var r="PageNavigation FloatRight",u=this.messageList.activeGroup();return u&&(n&&(r+=" BeginOfList"),t&&(r+=" EndOfList"),!i&&n&&t&&(r+=" NoDisplay")),r},dockClass:function(){return this.layout.ReadingPaneMode===HM.ReadingPaneLocation.Off||this.layout.ReadingPaneMode===HM.ReadingPaneLocation.None?"":"navigationDocked"},onDispose:function(){t(this.contents()).find(".c-MessageListNavigation[onclick]").each(function(n,t){t.onclick=null})},onAfterLink:function(){var t=this;t.messageListGotoPickerControl=n.findChildTag(t,"messageListGotoPickerControl")[0];t.contents().on("click",".firstPageLink",function(i){return n.Cmd("nav.firstpage").bubble(t,{}),i.preventDefault(),!1}).on("click",".prevPageLink",function(i){return n.Cmd("nav.prevpage").bubble(t,{}),i.preventDefault(),!1}).on("click",".nextPageLink",function(i){return n.Cmd("nav.nextpage").bubble(t,{}),i.preventDefault(),!1}).on("click",".lastPageLink",function(i){return n.Cmd("nav.lastpage").bubble(t,{}),i.preventDefault(),!1})},resetGotoPickerValues:function(n){this.messageListGotoPickerControl&&this.messageListGotoPickerControl.resetGotoPickerValues(n)},onCmdBubble:function(){}};t.views.tags({messageListNavigationControl:u})}(window.ol,window.originaljQuery||window.jQuery),function(n,t){"use strict";var i="pageFooterTemplate",r=t.templates(null,{markup:"#"+i}),u={templateId:i,template:r,attr:"html",generateTrademark:function(){return n.GetString("Live.Shared.Strings.Footer.Links.Trademark.Label").format(n.config.pageFooter.TrademarkYear)},generateCustomLinkOnClick:function(){return n.config.pageFooter.CustomLinkOnClick?n.config.pageFooter.CustomLinkOnClick:""}};t.views.tags({pageFooterControl:u})}(window.ol,window.originaljQuery||window.jQuery),function(n,t){"use strict";var n=window.ol=window.ol||{},i=n.controlHelpers=n.controlHelpers||{},u="messageListGotoPickerTemplate",r={DatePicker:"datePicker",AlphaPicker:"alphaPicker",None:""},f={templateId:u,template:t.templates("#"+u),attr:"html",init:function(r){var u=this;u.data=r.ctx.messageList,u.ControlNamespace=n.createControlNamespace(u.tagName),i.MessageListGotoPickerHelper?u._createGotoPickerHelper():n.init.NotifyLoad("App1").then(t.proxy(u._createGotoPickerHelper,u))},_createGotoPickerHelper:function(){var n=this;i.MessageListGotoPickerHelper&&(n.data.gotoPickerHelper()?n.data.gotoPickerHelper().delegate=n:n.data.gotoPickerHelper(new i.MessageListGotoPickerHelper(n,"#c_base")))},render:function(){return this.tagCtx.render(this.data)},initiateJumptoNavigation:function(t){n.Cmd("gotopickerinitiatejump").bubble(this,{anchor:t})},currentPickerMode:function(t){return n.Accessor(this,"CurrentPickerMode",t)},updatePickerMode:function(){var n=this.data.sortKey.SortBy;n===HM.SortBy.Date||n===HM.SortBy.Type?this.currentPickerMode(r.DatePicker):n==HM.SortBy.Sender||n==HM.SortBy.Subject?this.currentPickerMode(r.AlphaPicker):this.currentPickerMode(r.None)},onAfterLink:function(){var n=this;n.contents("#gotoLink").click(function(t){var i=n.data.gotoPickerHelper();return i&&i.launchGotoPicker(n.CurrentPickerMode,t),t.preventDefault(),!1}),t.observable.simpleOn(n.data.sortKey,"propertyChange."+n.ControlNamespace,function(t,i){i.path==="SortBy"&&n.updatePickerMode()}),n.updatePickerMode()},onDispose:function(){var n=this;t.observable.simpleOff(n.data.sortKey,"propertyChange."+n.ControlNamespace)},resetGotoPickerValues:function(n){this.data.gotoPickerHelper().resetGotoPickerValues(n)}};t.views.tags({messageListGotoPickerControl:f})}(window.ol,window.originaljQuery||window.jQuery),function(n,t){"use strict";function s(n,t){return(n?"":"TextSemiBold ")+(t||"")}function l(n){return n.stopPropagation(),n.preventDefault(),!0}function c(n){return n.is("label")||n.attr("name")==="mCk"||n.attr("name")==="mCC"}var e="messageRowTemplate",r,o=!1,u=null,i={},h,f;i[HM.ExtendedType.e4_ICAL_REQUEST]={css:"mr_m_r",text:n.GetString("MeetingRequest.MeetingRequest.AltText")},i[HM.ExtendedType.e3_ICAL_GENERIC]={css:"mr_m_r",text:n.GetString("MeetingRequest.MeetingRequest.AltText")},i[HM.ExtendedType.e5_ICAL_CANCEL]={css:"mr_m_c",text:n.GetString("MeetingRequest.MeetingCancelled.AltText")},i[HM.ExtendedType.e6_ICAL_ACCEPTED]={css:"mr_m_a",text:n.GetString("MeetingRequest.ResponseAccept.AltText")},i[HM.ExtendedType.e7_ICAL_TENTATIVE]={css:"mr_m_t",text:n.GetString("MeetingRequest.ResponseTentative.AltText")},i[HM.ExtendedType.e8_ICAL_DECLINED]={css:"mr_m_d",text:n.GetString("MeetingRequest.ResponseDecline.AltText")},h=t.templates(null,{markup:"#"+e,allowCode:!0,converters:{getClassesForSenderInfos:function(n){return s(n,"t_qtc FmSender")},getClassesForSubject:function(n){return s(n,"t_estc t_elnk")},getTabIndex:function(t){return t?n.getTabIndex("messageRow"):"-1"}}}),f={templateId:e,template:h,attr:"html",getStatusImageClass:function(){var t="",n=this.data;return n.Count===1?i[n.ExtendedType]?t=i[n.ExtendedType].css:n.IsVoicemail?t="i_voicemail":n.IsCallLog?t="i_calllog":n.Replied?t="i_c_r":n.Forwarded&&(t="i_c_f"):n.Count>1&&(n.Replied?t="i_c_r":n.Forwarded&&(t="i_c_f")),t},getStatusImageAltText:function(){var r="",t=this.data;return t.Count===1?i[t.ExtendedType]?r=i[t.ExtendedType].text:t.IsVoicemail?r=n.GetString("MessageList.Icons.Voicemail.AltText"):t.IsCallLog?r=n.GetString("MessageList.Icons.Calllog.AltText"):t.Replied?r=n.GetString("MessageList.Icons.Replied.AltText"):t.Forwarded&&(r=n.GetString("MessageList.Icons.Forwarded.AltText")):t.Count>1&&(t.Replied?r=n.GetString("MessageList.Icons.Replied.AltText"):t.Forwarded&&(r=n.GetString("MessageList.Icons.Forwarded.AltText"))),r},getCategoryClass:function(){var n=this,i=n.data.Categories,r=n.categoryList,t=r.getCategoryListFromIds(i);return(t&&t.length>0?"":"nc ")+"t_qtc t_cag cg"},getRowIndex:function(){return this.ctx.rowIndex},getGroupIndex:function(){return this.parent.getGroupIndex()},getMessageRowClass:function(){var i=this,u=i.data.IsRead,f=i.data.IsFlagged,r=i.Selected,e=i.Focused,t="c-MessageRow ia_hc animatable";return t+=" Draggable",t+=u?" mlRd":" mlUnrd",t+=f?" mlFlg":" mlUnFlg",r?t+=" mlSel t_sel":(t+=" mlUnsel",$B.IE&&$B.V<=8||n.isIOS()||(t+=" t_s_hov")),n.config.instantActionsSettings&&n.config.instantActionsSettings.p||(t+=" mlNoFlag"),e&&!r&&(t+=" t_s_sel"),t},getAriaLabel:function(){var t=this.data,s=t.Subject,r=t.SendersDetails,h=t.DateReceivedLocal,o=t.Count,c=t.HasAttachments,l=t.IsFlagged,a=t.Importance,v=t.IsRead,u="",y=r&&r.length>1,f,i;if(r&&r.length&&(f=r[0].displayName.split(";"),f&&f.length&&(i=f[0].split('"'),i&&i.length)))switch(i.length){case 0:break;case 1:u=i[0];break;default:u=i[1]}u+=u===""?n.GetString("MessageList.Checkbox.DefaultSender"):"";var p=v?"":n.GetString("Accessibility.MessageList.Checkbox.Label.Unread"),w=l?n.GetString("Accessibility.MessageList.Checkbox.Label.Flagged"):"",e="";switch(a){case 1:e=n.GetString("Accessibility.MessageList.Checkbox.Label.LowImportance");break;case 2:e=n.GetString("Accessibility.MessageList.Checkbox.Label.HighImportance")}var b=y?n.GetString("Accessibility.MessageList.Checkbox.Label.MoreSenders"):n.GetString("Accessibility.MessageList.Checkbox.Label.SingleSender"),k=c?n.GetString("Accessibility.MessageList.Checkbox.Label.HasAttachments"):"",d=o>1?n.GetString("Accessibility.MessageList.Checkbox.Label.MoreMessages").format(o-1):"";return n.GetString("Accessibility.MessageList.Checkbox.Label.Template").format(p,w,e,b.format(u),s,h,k,d)},getCategoriesForTooltip:function(){var t=this,i=t.data.Categories;return t._getCategories(i,n.GetString("Toolbar.CategorizeDropdownTitle"))},isCurrentlySelectable:function(){var n=this.parent;return n&&n.isCurrentlySelectable?n.isCurrentlySelectable():!0},getCategoriesForLabel:function(){var t=this,i=t.data.Categories;return this._getCategories(i,n.GetString("MessageList.Categorize"))},_getCategories:function(n,t){var r=this.categoryList,i;return n&&(i=r.getSortedCategoryNamesFromIds(n)),i&&i.length>0?i.join(", "):t},evalHasAttachments:function(n,t){return!(n===HM.ExtendedType.e16_SMS||n===HM.ExtendedType.e18_IM_CONV)&&t},isSearchResults:function(t){return t===n.config.sysFldrs.searchFid},init:function(i){var u=this,s=i.ctx,h=i.props,e,f;if(u.data=h.thread,u.ControlNamespace=n.getSutraControlId(u.data.Id),u.categoryList=s.categoryList,u.folderList=s.folderList,u.layout=s.layout,u.selected(u.data.selected()),u.selection=new n.Selection({control:u,isSelectionRoot:!!i.props.isSelectionRoot}),u.updateFolderName(),n.UpdateProperty(u,"AriaLabel",!0),n.UpdateProperty(u,"MessageRowClass",!0),n.GetUserConfig("IsCategoryColumnEnabled")&&u.layout.ReadingPaneMode!==HM.ReadingPaneLocation.Right&&(n.UpdateProperty(u,"CategoryClass",!0),n.UpdateProperty(u,"CategoriesForTooltip",!0),n.UpdateProperty(u,"CategoriesForLabel",!0)),n.UpdateProperty(u,"StatusImageClass",!0),n.UpdateProperty(u,"StatusImageAltText",!0),!r&&!n.config.serverRenderOnly)for(r=[],e=t(".glassContent .mlCheckbox"),f=0;f<e.length;f++)r.push(e[f].checked),o=o||e[f].checked},render:function(){return this.tagCtx.render(this.data)},updateFolderName:function(){var n=this.folderList.getContainerById(this.data.FolderId);n&&this.folderName(n.Name)},folderName:function(t){return n.Accessor(this,"FolderName",t)},getElement:function(){var n=this;return n._element||(n._element=_ge(n.ControlNamespace)),n._element},onAfterLink:function(){var i=this;i._propertyChangedInit||(t.observable.simpleOn(i,"propertyChange."+i.ControlNamespace,function(r,u){var e=i._getCheckboxElt(),f=u.path;f==="Checked"?e.checked=i.checked():f==="Focused"?n.UpdateProperty(i,"MessageRowClass"):f==="Selected"&&(t(".t_mlli").removeClass("t_mlli"),n.UpdateProperty(i,"MessageRowClass"))}),t.observable.simpleOn(i.data,"propertyChange."+i.ControlNamespace,function(t,r){var u=r.path;(u==="Subject"||u==="SendersDetails"||u==="DateReceivedLocal"||u==="Count"||u==="HasAttachments"||u==="IsFlagged"||u==="Importance"||u==="IsRead")&&n.UpdateProperty(i,"AriaLabel"),(u==="IsRead"||u==="IsFlagged"&&n.config.appSettings.IsInstantActionsEnabled&&n.config.instantActionsSettings&&n.config.appSettings.ShouldUseFloatingInstantActions)&&n.UpdateProperty(i,"MessageRowClass"),u==="Categories"&&n.GetUserConfig("IsCategoryColumnEnabled")&&i.layout.ReadingPaneMode!==HM.ReadingPaneLocation.Right&&(n.UpdateProperty(i,"CategoryClass"),n.UpdateProperty(i,"CategoriesForTooltip"),n.UpdateProperty(i,"CategoriesForLabel")),(u==="Count"||u==="ExtendedType"||u==="IsVoicemail"||u==="IsCallLog"||u==="Replied"||u==="Forwarded")&&(n.UpdateProperty(i,"StatusImageClass"),n.UpdateProperty(i,"StatusImageAltText")),r.path==="FolderId"&&i.isSearchResults(i.data.QueryContainerId)&&i.updateFolderName()}),i._propertyChangedInit=!0)},onDispose:function(){var n=this;t.observable.simpleOff(n,"propertyChange."+n.ControlNamespace),t.observable.simpleOff(n.data,"propertyChange."+n.ControlNamespace),n._element=n._checkbox=n.data=n.categoryList=n.folderList=n.layout=null},onCmdBubble:function(t,i,r){var u=this;switch(i.name){case"clickmsg":return u.selection.select({entryPoint:HM.InstrumentationEntryPoint.MessageList}),!1;case"checkmsgclick":return u._onCheckMessageClick(r.$event),!1;case"bulkinstantaction":return n.Cmd("bulkactionbysender").fire({action:r.action,selection:[u],entryPoint:HM.InstrumentationEntryPoint.MessageList}),!1}},getOnAfterLinkPromise:function(){return this.tagCtx.ctx.messageListLinkPromise},onCategoryRename:function(n){var i=this.data.categories(),u=n.id(),r;t.inArray(u,i)&&(r=i.slice(),this.data.categories(r,{forceSetValue:!0}))},onFolderRename:function(n){n.id()===this.data.FolderId&&this.updateFolderName()},_handleMsgRowClick:function(n){if(!n.which||n.which===1||n.which===32)return this._onBodyClick(n),!1},_handleMsgRowKeyUp:function(n){return n.which==32&&this._handleMsgRowClick(n),!0},_onBodyClick:function(i){var f=t(i.target),r=this,u;if(c(f)){n.Cmd("checkmsgclick").bubble(r,{$event:i});return}if(u=f.closest("[aId='tCg']")[0],u){n.Cmd("ml.showcategorize").bubble(r,{$event:i,sourceEl:u.parentNode}),i.preventDefault();return}n.isOpenNewTabClick(i)?(n.Cmd("shiftclickmsg").bubble(r,{control:r}),l(i)):(n.Cmd("clickmsg").bubble(r,{control:r}),r.layout.isReadingPaneOn()||n.Cmd("fullview").bubble(r,{thread:r.data,entryPoint:HM.InstrumentationEntryPoint.MessageList}),i.preventDefault())},_onCheckMessageClick:function(n){var t=this._getCheckboxElt();n.shiftKey?(this.selection.selectTo(),t.checked=this.checked()):(n.target!==t&&(t.checked=!t.checked),t.checked?this.selection.check():this.selection.uncheck())},_onDblClick:function(i){var r=t(i.target);if(c(r)||r.closest("[aId='tCg']")[0])return!1;n.Cmd("fullview").bubble(this,{thread:this.data,entryPoint:HM.InstrumentationEntryPoint.MessageList})},_getCheckboxElt:function(){var n=this;return n._checkbox||(n._checkbox=n.contents().find(".mlCheckbox")[0]),n._checkbox},_handleContextMenu:function(t){n.Cmd("ml.showmessagemenu").bubble(this,{$event:t}),t.stopPropagation(),t.preventDefault()},_getSenderElts:function(n){var t=this.contents().find("SPAN[email]");return n?t:t.makeArray()},getSenderDataByElt:function(n){var i=t(n),f=i.attr("email"),r=i.attr("de"),e=i.text(),u={email:f,name:e};return r&&t.extend(u,{displayEmail:r}),u},getSenderData:function(n,t){var u=this._getSenderElts(!0),i=[],r={},f=this;return u.each(function(u,e){var s=f.getSenderDataByElt(e),o=s.email;if(o&&!r[o])return i.push(t?o:s),r[o]=!0,!n}),i},focus:function(){var t=this;t.getOnAfterLinkPromise().then(function(){u&&(clearTimeout(u),u=null);var i=t._getCheckboxElt();u=n.setFocus(function(){try{!u||n.isFocusOnTextBox()||n.ContextMenu.isFocusOnContextMenu()||n.c.readMessageControl.isFocusOnReadingPaneHeader()||i.focus()}catch(t){}})})},isCheckedInGlass:function(){return this._getCheckboxElt().checked},applyGlassChanges:function(n){if(!r||r.length===0)return!1;var t=r[n];return t&&(this.selection.check(),this._getCheckboxElt().checked=t),t},getAnimatableElement:function(){return this.contents&&this.contents().filter("li")[0]}},n.c=window.ol.c||{},n.c.MessageRowControl={},n.c.MessageRowControl.clearGlassChanges=function(){r=[]},n.c.MessageRowControl.selectorClassName=".c-MessageRow",n.c.MessageRowControl.detachEvents=function(t){n.c.MessageRowControl.detachMouseOverEvents(t),t.off(".mrc")},n.c.MessageRowControl.attachEvents=function(t,i,r){var u=n.c.MessageRowControl.selectorClassName;t.on("click.mrc",u,function(t){if(!t.handledByInstantAction){var i=n.GetControlFromEvent(t,"messageRowControl");i&&i._handleMsgRowClick(t)}});t.on("keyup.mrc",u,function(t){var i=n.GetControlFromEvent(t,"messageRowControl");i&&i._handleMsgRowKeyUp(t)});t.on("dblclick.mrc",u,function(t){var i=n.GetControlFromEvent(t,"messageRowControl");i&&i._onDblClick(t)});t.on("contextmenu.mrc",u,function(t){var i=n.GetControlFromEvent(t,"messageRowControl");i&&i._handleContextMenu(t)});n.c.MessageRowControl.attachMouseOverEvents(t,i,r);t.on("mousedown.mrc",".mlCheckbox",function(n){n.stopPropagation()})},n.c.MessageRowControl.detachMouseOverEvents=function(n){n.off(".mrcoe")},n.c.MessageRowControl.attachMouseOverEvents=function(t,i,r){var u=n.c.MessageRowControl.selectorClassName;t.on("mouseover.mrcoe",u,r);t.on("mouseout.mrcoe",u,i)},n.Selection.CreateSelectablePropertiesAccessors(f),n.Selection.CreateSelectableRootControlAccessors(f),t.views.tags({messageRowControl:f})}(window.ol,window.originaljQuery||window.jQuery),function(n,t){"use strict";var r="instantActionsTemplate",u=n.vm,i=u.InstantActionItem.ActionType,e=t.templates(null,{markup:"#"+r,allowCode:!0,converters:{getHoverClasses:function(){return"ia_h "+($B.IE_M7?"":"t_selh t_s_hovh")}}}),f={templateId:r,template:t.templates("#"+r),attr:"html",init:function(t){var i=this,r=t.ctx;i.ControlNamespace=n.createControlNamespace(i.tagName),i.data=new n.vm.InstantActions(r),n.SetupManualLifecycleForChildren(i)},render:function(){return this.tagCtx.render(this.data)},onDispose:function(){n.DestroyChildrenManually(this),this.data.dispose()},onAfterLink:function(){var t=this;n.LinkChildrenManually(t),t.data.subscribe()},updateThreadAndGroupConfig:function(n,t){this.data.updateThreadAndGroupConfig(n,t)}};n.c=window.ol.c||{},n.c.InstantActionsControl={},n.c.InstantActionsControl.selectorClassName=".ia_c IMG, .ia_c A",n.c.InstantActionsControl.detachEvents=function(t){t.off(".ia",n.c.InstantActionsControl.selectorClassName)},n.c.InstantActionsControl.attachEvents=function(i){var r=0,f=250,u=n.c.InstantActionsControl.selectorClassName;i.on("click.ia",u,function(i){if(r)return!1;r=setTimeout(function(){r=0},f);var e=i.currentTarget,u=n.c.InstantActionItemControl.getItem(t(e));if(u)return i.handledByInstantAction=!0,u._handleItemClick(i),i.stopPropagation(),!1});i.on("dblclick.ia",u,function(){return!1})},n.c.InstantActionsControl.getMessageListCssClasses=function(r,u){var c,l;if(r&&r.Id!==null&&r.Id!==undefined){var o=n.config.sysFldrs,e=r.Id,h=u&&u.getArchiveFolder(),s="",f={};return f[o.junkFid]=[i.Pin,i.Sweep],f[o.trashFid]=[i.Pin,i.Sweep],f[o.draftsFid]=[i.Junk,i.Move,i.Pin,i.Sweep],f[o.sentFid]=[i.Junk,i.Move,i.Pin,i.Sweep],h!==undefined&&h!==null&&(f[h.id()]=[i.Archive]),c=function(r,u){var l=0,h,c,o;for(e=e.toString(),h=0;h<r.length;h++)c=r[h],o=c.action,f[e]&&t.inArray(o,f[e])>=0||o===i.Sweep&&!n.GetAppConfig("IsBulkActionsEnabled")?s+=" ia_h_"+o:o===i.Move&&c.target.toLowerCase()===e.toLowerCase()?s+=" ia_h_"+o+c.index:l++;s+=" "+u+l},l=n.vm.InstantActionSetting.getUserSettings(),c(l.hoverItems,"ia_vc_h"),c(l.fixedItems,"ia_vc_f"),s}},t.views.tags({instantActionsControl:f})}(window.ol,window.originaljQuery||window.jQuery),function(n,t){"use strict";var f="instantActionItemTemplate",r=n.vm,i=r.InstantActionItem.ActionType,u,e;n.c=window.ol.c||{},u={},e={templateId:f,template:t.templates(null,{markup:"#"+f,allowCode:!0}),attr:"html",init:function(t){var i=this,r=t.ctx;i.ControlNamespace=n.createControlNamespace(i.tagName),i.data=t.props.item,n.AddManualChild(i)},render:function(){return this.tagCtx.render(this.data)},getNamespaceAttr:function(){return n.config.serverRenderOnly?"":"data-ians='"+this.ControlNamespace+"'"},_getImgTag:function(){var n=this;return n._imgTag||(n._imgTag=t(_ge(n.ControlNamespace)).find("img")),n._imgTag},onAfterLink:function(){var n=this;u[n.ControlNamespace]=n,t.observable.simpleOn(n.data,"propertyChange."+n.ControlNamespace,function(t,i){var r=null;switch(i.path){case"ImageClassname":r=n._getImgTag(),r.attr("class",i.value);break;case"ImageTitle":r=n._getImgTag(),r.attr("title",i.value)}})},onDispose:function(){var n=this;n._imgTag&&(n._imgTag=null),t.observable.simpleOff(n.data,"propertyChange."+n.ControlNamespace),delete u[n.ControlNamespace]},_handleItemClick:function(t){var u=this,h,c,o;if(u.data){var f=u.data.thread(),s=u.ctx.folderList,l=u.ctx.groupConfig||u.data.getGroupConfigForFloatingIA(),a=s.selectedItems(),w=a.length>0?a[0].id():n.config.sysFldrs.noneFid,e=HM.InstrumentationEntryPoint.InstantAction;switch(u.data.action()){case i.Archive:n.Cmd("archive").fire({folderList:s,selectedThreads:[f],unflag:!!l.unflagOnMove,isBulkSelected:!1,entryPoint:e,isMessagePartAction:u.ctx.isMessagePart});break;case i.Categorize:h={apply:[],remove:[]},h[u.data.isApplyOrRemoveCategory()?"apply":"remove"].push(parseInt(u.data.target())),r.MessageThread.categorizeThreads([f],h,e);break;case i.Delete:r.MessageThread.performActionOnThreads("deletemsg",[f],{entryPoint:e},u.ctx.isMessagePart);break;case i.Junk:c=t.target,o=u.data.isJunkOrNotJunk(),n.controlHelpers.SafetyUI.create().maybeShowFre({jmrType:HM.JmrType[o?"Junk":"NotJunk"],anchor:c}).done(function(t){r.MessageThread.performActionOnThreads(o?"markasjunk":"markasnotjunk",[f],{folderId:o?n.config.sysFldrs.inboxFid:n.config.sysFldrs.junkFid,enableJmrReporting:t?t.enableJmrReporting:!1,srcCtl:c,entryPoint:e},u.ctx.isMessagePart)});break;case i.Move:var v=s.getArchiveFolder(),y=u.data.target(),p=v&&v.id()===y;r.MessageThread.performActionOnThreads("movemsg",[f],{folderId:y,unflag:!!l.unflagOnMove,toArchive:!!p,entryPoint:e,markRead:!!u.data.read()},u.ctx.isMessagePart);break;case i.Pin:r.MessageThread.performActionOnThreads(f.isFlagged()?"markasunflagged":"markasflagged",[f],{entryPoint:e},u.ctx.isMessagePart);break;case i.Read:f.markReadUnread(!f.isRead(),e,u.ctx.isMessagePart);break;case i.Sweep:n.Cmd("bulkinstantaction").bubble(u,{action:u.data.index()==="1"?"move":"sweep"})}}return!1}},n.c.InstantActionItemControl={getItem:function(n){return u[n.data("ians")]}},t.views.tags({instantActionItemControl:e})}(window.ol,window.originaljQuery||window.jQuery),function(n,t){"use strict";var i="instantActionsBurntTemplate",r={templateId:i,template:t.templates("#"+i),attr:"html"};t.views.tags({instantActionsBurntControl:r})}(window.ol,window.originaljQuery||window.jQuery),function(n,t){"use strict";var n=window.ol=window.ol||{},i=n.controlHelpers=n.controlHelpers||{},r=i.SocialInbox=i.SocialInbox||{},u="rightRailTemplate",f={templateId:u,template:t.templates("#"+u),attr:"html",init:function(i){var r=this,u=i.ctx;r.layout=u.layout,r.rightRail=u.rightRail,this._windowResizeProxy=t.proxy(this.windowResize,this),this._pageViewChangedProxy=t.proxy(this.pageViewChanged,this),n.Cmd("windowresize").subscribe(this._windowResizeProxy),n.Cmd("nav.complete").subscribe(this._pageViewChangedProxy)},render:function(){return this.tagCtx.render(this.data)},getRightRailContainerClass:function(){var t="c-RightRail RightRailContainerWidth t_sbgc";return this.rightRail.canShowRightRail()||(t+=" DisplayNone"),n.config.adbar.renderAd||(t+=" Premium"),t},getAdClass:function(){var n="";return!1&&(n+="DisplayNone "),n},_rightRailManagerSetupEvents:function(){var i=this;$Do.when("$WLXIM.SidebarCreated",0,function(){t($WLXIM.sidebar).bind("onSidebarOpenedEvent",i.rightRail.RightRailManager.onSidebarOpenedEventCallback),t($WLXIM.sidebar).bind("onSidebarCloseCompletedEvent",i.rightRail.RightRailManager.onSidebarClosedCompletedEventCallback),$WLXIM.setSidebarOverlayWindowWidth(n.GetAppConfig("messengerOverlayWindowWidth"))}),$Do.register("$RightRailManager.Loaded")},_initPeoplePaneManager:function(){var u=this,t=u.rightRail;t.PeoplePaneManager||(u.rightRail.peoplePaneManager(new r.PeoplePaneManager(t.RightRailManager)),n.Cmd("updatepeoplepane").bubble(u)),i.Adbar&&t.adbar(new i.Adbar(t.RightRailManager))},refreshAds:function(n,t){var i=this;setTimeout(function(){i.rightRail.Adbar&&i.rightRail.Adbar.refresh(t,n||"")},0)},hideAds:function(){this.rightRail.Adbar&&this.rightRail.Adbar.hide()},maybeStartAds:function(){this.rightRail.Adbar&&this.rightRail.RightRailManager.isAdControlShowing()&&this.rightRail.Adbar.show()},hidePeoplePane:function(){this.rightRail.PeoplePaneManager&&this.rightRail.PeoplePaneManager.hide()},updatePeoplePane:function(n,t,i,u){var f={senderId:t.fromAddress?t.fromAddress:"",isContact:t.isSenderInContactList,isSelf:t.isSenderSelf,isSafe:u||!n.IsContentFiltered,fullName:t.icFullName?t.icFullName:"",contactID:t.icContactId?t.icContactId:"",hexContactId:t.hexContactId?t.hexContactId:"",senderCid:t.senderCid?t.senderCid:"",membershipInfo:null};!this.rightRail.PeoplePaneManager&&r.PeoplePaneManager&&this.rightRail.peoplePaneManager(new r.PeoplePaneManager(this.rightRail.RightRailManager)),this.rightRail.PeoplePaneManager&&this.rightRail.PeoplePaneManager.updatePeoplePane(n,f,i)},pageViewChanged:function(t){if(t.view===n.config.pageManager.manifests.Inbox.name){var i=this.rightRail.adbar();i&&i.resize()}},windowResize:function(i){var r=this.rightRail.RightRailManager,e=n.GetAppConfig("rightRailThreshold"),u=this.rightRail.adbar(),f;u&&u.resize(),r&&e>0&&(f=i.dimensions,f.width<=n.GetAppConfig("rightRailThreshold")?(r.isRightRailShowing()&&(this.rightRail.rightRailRemoved(!0),r.hideRightRail()),this.layout.isReadingPaneOrFullViewOn()&&t("#pageInbox").addClass("HideScrollbar")):(r.isRightRailShowing()||(this.rightRail.rightRailRemoved(!1),r.maybeShowRightRail()),t("#pageInbox").removeClass("HideScrollbar")))},updateRightRailVisibility:function(){var n=this;n.rightRail.canShowRightRail()?n.rightRail.RightRailManager.maybeShowRightRail():n.rightRail.RightRailManager.hideRightRail()},onAfterLink:function(){var r=this;r.rightRail.rightRailManager(new i.RightRailManager(r)),r._rightRailManagerSetupEvents(),n.init.NotifyLoad("App1").then(t.proxy(r._initPeoplePaneManager,r)),r.onPropertyChange=function(n,t){(t.path==="ReadingPaneMode"||t.path==="IsFullView"||t.path==="IsRightRailForcedOff")&&r.updateRightRailVisibility()},t.observable.simpleOn(r.layout,"propertyChange",this.onPropertyChange)},onDispose:function(){t.observable.simpleOff(this.layout,"propertyChange",this.onPropertyChange),n.Cmd("windowresize").unsubscribe(this._windowResizeProxy),n.Cmd("nav.complete").unsubscribe(this._pageViewChangedProxy)},onCmdBubble:function(){}};t.views.tags({rightRailControl:f})}(window.ol,window.originaljQuery||window.jQuery),function(n){"use strict";var t="searchBoxTemplate",i={templateId:t,template:n.templates("#"+t),attr:"html",init:function(n){var t=this,r=n.ctx;if(t.categoryList=r.categoryList,t.folderList=r.folderList,t.search=r.search,t.suggestedCategoryIds=[HM.FilterType.Photos,HM.FilterType.Document,HM.FilterType.ShippingNotification,HM.FilterType.FlaggedMessages],ol.config&&ol.config.search.searchBox){var u=t._getSearchBoxPlaceholder(),i=t._getSearchBoxQuery(),f=$B.IE&&$B.V<=11?i?i:u:i;ol.config.search.searchBox=ol.config.search.searchBox.replace(/_SearchBox_InitialTextAttributeEncoded_/g,f.encodeHtmlAttribute()),ol.config.search.searchBox=ol.config.search.searchBox.replace(/_SearchBox_PlaceholderTextAttributeEncoded_/g,u.encodeHtmlAttribute()),ol.config.search.searchBox=ol.config.search.searchBox.replace(/_SearchBox_InitialQueryExistsClass_/g,!!i),ol.config.search.searchBox=ol.config.search.searchBox.replace(/_SearchBox_SearchDisabledAttribute_/g,t.search.searchEnabled()?"":"disabled")}t.subscribeToCommands(),t.ControlNamespace=ol.createControlNamespace(t.tagName)},onDispose:function(){var t=this;t.unsubscribeFromCommands(),$SB.disposeAllSearchBoxes(),t.onCategoryListPropertyChange&&n.observable.simpleOff(t.categoryList,"propertyChange",t.onCategoryListPropertyChange),t.search.SelectedContainer&&t.onSelectedContainerPropertyChange&&n.observable.simpleOff(t.search.SelectedContainer,"propertyChange",t.onSelectedContainerPropertyChange),t.onSearchPropertyChange&&n.observable.simpleOff(t.search,"propertyChange",t.onSearchPropertyChange)},onAfterLink:function(){var t=this,i;$SBC.searchOrigin=HM.InstrumentationSearchOrigin,i=t.contents(".contentSearchBox"),$SB.bindAllSearchBoxes($SB.WindowsLiveProvider,i);i.on("mouseover."+t.ControlNamespace,function(){i.off("mouseover."+t.ControlNamespace),ol.init.Load("SearchFilters")});t.updateSearchBoxEnabledState(),t.updateSearchBoxQuery(),t.updatePlaceholder(),t.updateSearchModel(),t.updateSearchBoxCategoryMenu(),t.onCategoryListPropertyChange=function(n,i){i.path==="ContainerMap"&&t.updateSearchBoxCategoryMenu()},n.observable.simpleOn(t.categoryList,"propertyChange",t.onCategoryListPropertyChange),t.onSelectedContainerPropertyChange=function(n,i){i.path==="Name"&&t.updatePlaceholder()},t.search.SelectedContainer&&n.observable.simpleOn(t.search.SelectedContainer,"propertyChange",t.onSelectedContainerPropertyChange),t.onSearchPropertyChange=function(i,r){r.path==="SearchEnabled"&&(t.updateSearchBoxEnabledState(),t.updatePlaceholder()),(r.path==="From"||r.path==="To"||r.path==="Subject"||r.path==="Keywords"||r.path==="Categories")&&t.updateSearchBoxQuery(),(r.path==="Folders"||r.path==="Categories"||r.path==="Date"||r.path==="HasAttachments")&&t.updatePlaceholder(),(r.path==="From"||r.path==="To"||r.path==="Subject"||r.path==="Keywords"||r.path==="Folders"||r.path==="Categories"||r.path==="Date"||r.path==="DateRange"||r.path==="HasAttachments")&&t.updateSearchModel(),r.path==="SelectedContainer"&&(n.observable.simpleOff(r.oldValue,"propertyChange",t.onSelectedContainerPropertyChange),n.observable.simpleOff(r.value,"propertyChange",t.onSelectedContainerPropertyChange))},n.observable.simpleOn(t.search,"propertyChange",t.onSearchPropertyChange)},subscribeToCommands:function(){var t=this;t._proxied_handleViewAllFromSenderCommand=n.proxy(t._handleViewAllFromSenderCommand,t),t._proxied_handleViewAllInContainerCommand=n.proxy(t._handleViewAllInContainerCommand,t),ol.Cmd("viewallfromsender").subscribe(t._proxied_handleViewAllFromSenderCommand),ol.Cmd("viewallincontainer").subscribe(t._proxied_handleViewAllInContainerCommand)},unsubscribeFromCommands:function(){ol.Cmd("viewallfromsender").unsubscribe(this._proxied_handleViewAllFromSenderCommand),ol.Cmd("viewallincontainer").unsubscribe(this._proxied_handleViewAllInContainerCommand)},_handleViewAllFromSenderCommand:function(n){$SB.findAllFromSender($SBC.last,n.senderEmail)},_handleViewAllInContainerCommand:function(n){this.search.resetSearch();var t={};ol.data.isFolderId(n.containerId)?t.folders=[n.containerId]:ol.data.isCategoryId(n.containerId)&&(t.categories=[n.containerId]),this.search.commitSearchBox(t,HM.InstrumentationSearchOrigin.FindAllInContainer)},onCmdBubble:function(n,t,i){t.name==="commitsearchbox"&&this.search.commitSearchBox(i.searchBoxParamsChanges,i.searchOrigin)},updateSearchBoxEnabledState:function(){$SB.setAllSearchBoxesEnabled(this.search.searchEnabled())},updateSearchModel:function(){$SB.setAllSearchBoxesParams(this.search.getSearchBoxParams())},updateSearchBoxCategoryMenu:function(){$SB.updateMenuData($SBC.last,"CATEGORIES",{categoryList:this.categoryList,suggestedCategoryIds:this.suggestedCategoryIds})},updateSearchBoxQuery:function(){$SB.setAllSearchBoxesValue(this._getSearchBoxQuery())},updatePlaceholder:function(){$SB.setAllSearchBoxesDefaultText(this._getSearchBoxPlaceholder())},_getSearchBoxQuery:function(){var n="";return n+=this.search.from()?"from:("+this.search.from()+") ":"",n+=this.search.to()?"to:("+this.search.to()+") ":"",n+=this.search.subject()?"subject:("+this.search.subject()+") ":"",n=n?(this.search.keywords()?"("+this.search.keywords()+") ":"")+n:this.search.keywords()||"",n.trim()},_getSearchBoxPlaceholder:function(){var n="",t=!this.search.areFoldersDefault(),i=!this.search.areCategoriesDefault(),u=!this.search.areAttachmentsDefault(),f=!this.search.isDateDefault(),r=(t?1:0)+(i?1:0)+(u?1:0)+(f?1:0);return r===1&&(t||i)?t?n=this._getSearchBoxPlaceholderTextForSelectedContainers(this.search.folders(),this.folderList):i&&(n=this._getSearchBoxPlaceholderTextForSelectedContainers(this.search.categories(),this.categoryList)):n=r>=1?ol.GetString("Search.SearchWithFilters"):ol.GetString("Search.SearchAllMail"),n},_getSearchBoxPlaceholderTextForSelectedContainers:function(n,t){var r=n.length;if(r===1){var u=n[0],i=t.getContainerById(u),f=i?i.name():"";return ol.GetString("Search.SearchInContainer").format(f)}return ol.GetString("Search.SearchWithFilters")}};n.views.tags({searchBoxControl:i})}(window.originaljQuery||window.jQuery),function(n,t){"use strict";function i(n,t){return n?t?"bottom":"top":t?"right":"left"}function u(n){return n?"height":"width"}function o(n){return n?"offsetHeight":"offsetWidth"}function s(n){if(t(document).mouseup(this._onMouseUpAnonFn),t(document).mousemove(this._onMouseMoveAnonFn),this._$element.addClass("active"),this._firstElement&&this._secondElement){var r=i(this.isVertical,this.isDockingReversed);return this._origin={x:n.screenX,y:n.screenY,sizerPosition:parseInt(this._$element[0].style[r].replace("px","")),firstLength:this._firstElement[o(this.isVertical)]},!1}}function h(n){var f=i(this.isVertical,this.isDockingReversed),s=u(this.isVertical),r=this.isVertical?n.screenY-this._origin.y:n.screenX-this._origin.x;this.isDockingReversed&&(r=-1*r);var e=this.isVertical?t(this._parentElement).height():t(this._parentElement).width(),o=this._origin.firstLength+r,h=e-o;r<0&&o<this._firstMin?r=this._firstMin-this._origin.firstLength:r>0&&h<this._secondMin&&(r=e-this._secondMin-this._origin.firstLength),this._$element[0].style[f]=this._origin.sizerPosition+r+"px",this._firstElement.style[s]=this._origin.firstLength+r+"px",this._secondElement.style[f]=this._origin.sizerPosition+r+"px"}function c(){t(document).off("mousemove",this._onMouseMoveAnonFn),t(document).off("mouseup",this._onMouseUpAnonFn);var i=u(this.isVertical),r=parseInt(this._firstElement.style[i].replace("px",""));n.Cmd("sb.setsizerbarcookie").bubble(this,{size:r,key:this.key}),this._$element.removeClass("active"),this._sizerCallback&&this._sizerCallback(this._firstElement,this._secondElement,!1)}var r="sizerBarTemplate",f=t.templates(null,{markup:"#"+r,converters:{getSizerBarClass:function(n,t,i,r){var u=n?"sizerBarX "+t:"sizerBarY "+t;return u=i==="master"?"masterSizerBar "+u:u,(i==="rpRight"||i==="rpBottom")&&r&&(u+=" NoDisplay"),u}}}),e={isVertical:!1,isDockingReversed:!1,key:null,_$element:null,_origin:null,_firstElement:null,_secondElement:null,_onMouseDownAnonFn:null,_onMouseUpAnonFn:null,_onMouseMoveAnonFn:null,templateId:r,template:f,attr:"html",init:function(i){var r=this,u=i.ctx;r.isVertical=u.orientation==="horizontal",r.isDockingReversed=r.isVertical?!!u.dockToBottom:!n.config.Ltr,r.key=u.key,r.layout=u.layout,r.sutra=u.sutraLabel,r._onMouseDownAnonFn=t.proxy(s,r),r._onMouseUpAnonFn=t.proxy(c,r),r._onMouseMoveAnonFn=t.proxy(h,r),r._firstMin=i.props.firstMin||100,r._secondMin=i.props.secondMin||100,r._sizerCallback=typeof u.sizerCallback=="function"?u.sizerCallback:null},onAfterLink:function(){this._$element=this.contents().filter(".c-SizerBar").first(),this._$element.mousedown(this._onMouseDownAnonFn),this._firstElement=this._$element.prevAll().filter("div").first()[0],this._secondElement=this._$element.nextAll().filter("div").first()[0],this._parentElement=this._$element.parent()[0],this._sizerCallback&&this._sizerCallback(this._firstElement,this._secondElement,!0)},getSizerBarStyle:function(n,t,r){return i(n,t)+":"+r+"px;"}};t.views.tags({sizerBarControl:e})}(window.ol,window.originaljQuery||window.jQuery),function(n){"use strict";var i=window,t=i.ol,r=t.getContextObject,f=t.pages=t.pages||{},e=i.HM,u=i.wLive,o=u?u.Animations:null;f.Inbox=function(){function c(){return new t.vm.Inbox}function l(){return n.templates("#inboxPageTemplate")}function a(){f.updateToolbar(!0)}function v(){var t=window.alert;window.alert=function(r){var u,f,s,a,h,v,e,o;if(r?t(r):t(),u="",r){for(f=Math.floor(Math.random()*Number(Math.pow(2,31))),u="v1="+encodeURIComponent(f.toString()),s=[],a=0;f>0;)s[a++]=f&255,f=f>>8;for(h="",v=r.length<50?r.length:50,e=0;e<v;e++)h+=String.fromCharCode(r.charCodeAt(e)^s[e%4]);u+="&v2="+encodeURIComponent(h)}o=i&&i.readMessage(),o&&o.thread()&&o.thread().id&&(u+="&v3="+o.thread().id()),u+="&v4="+encodeURI(window.top.location.hash);var c=function(){y||(y=!0,l&&(clearTimeout(l),l=null),n(window).unbind("beforeunload",c),n.ajax({type:"POST",url:"/mail/Instrument.aspx",data:u,success:null})),event&&event.preventDefault()},y=!1,l=setTimeout(c,Math.floor(Math.random()*6+3)*1e3);n(window).bind("beforeunload",c)}}var u=this,h=null,s=null,i=null,f=null;u.render=function(){return l().render(c(),r())},u.initialize=function(n,u){var o,e,a;v(),h=n,i=c(),o=n.link(l(),i,r()),f=t.findChildTag(o.view(!0),"inboxControl")[0],e=t.config.keyboardShortcuts,a=new t.InboxActionsShortcuts({control:f}),e.enabled&&(s=new t.KeyboardHandler({handler:a,sequenceTree:e.inboxSequenceTree,timeout:e.timeout,ctrlAltOrFunctionKeyRequired:!1}),u.registerKeyboardHandler(s))},u.dispose=function(){s.dispose()},u.getOnBeforeUnloadString=function(){return f.getOnBeforeUnloadString()},u.getHistoryState=function(){var r=i.selectedContainer(),u=i.messageList(),t=u.activeGroup().query(),f=i.selectedThread(),o=i.layout(),s={tid:f&&o.isReadingPaneOrFullViewOn()?f.id():null,fv:o.isReadingPaneOn()&&f?o.isFullView()?1:0:null,fid:r.isFolder()?r.id():null,qvid:r.isQuickview()?r.id():null,fltid:t.filterId,so:t.sortType,sa:t.sortOrder===e.MessageListKeyQuerySortOrder.Ascending?1:0,paid:t.anchor,pad:t.anchorDate,pat:t.anchorType,pidx:u.pageNumber()},h;return u.isSearchResult()&&(h=i.search().getHistoryState(s),n.extend(s,h)),s},u.onRestoreFromHistory=function(n){f.setState(n)},u.onNavigateTo=function(n,i){n&&!i.isInitialPage&&(o.enterContent(h),setTimeout(function(){a(),i&&i.historyRestore||t.Dispatcher.fireCmd("refresh")},0))},u.onNavigateFrom=function(){f.hideToolbar()}}}(window.originaljQuery||window.jQuery),function(n){"use strict";function u(n){window.console&&console.log("Init: "+n)}var i=window,t=i.ol,f=i.Trace,e=i.HM,r=t.init=t.init||{};r.Load=function(i,r){var f=t.init.resources[i],o,e;return u("Loading set "+i),f.state||(r=r&&t.showLoading&&!t.config.serverRenderOnly,o=null,r&&(o=t.showLoading("load "+i)),e=f.deferred=f.deferred||n.Deferred(),f.state=e.state(),Loader.load(f,function(){r&&t.hideLoading(o),u("Loaded set "+i),e.resolve(),f.state=e.state()},function(){r&&t.hideLoading(o),u("Loader timed out on set "+i),e.reject(),f.state=e.state()})),f.deferred.promise()},r.NotifyLoad=function(i){var r=t.init.resources[i],u=r.deferred=r.deferred||n.Deferred();return u.promise()},r.LoadAll=function(i,r){var f=n.Deferred(),o,u,e,s;for(i instanceof Array||(i=n.makeArray(arguments)),r=r&&t.showLoading&&!t.config.serverRenderOnly,o=null,r&&(o=t.showLoading("loadall "+i.join("-"))),u=n.Deferred().resolve(),e=0;e<i.length;e++)s=i[e],function(n){u=u.pipe(function(){return t.init.Load(n,!1).done(function(){f.notify(n)})})}(s);return u.always(function(){r&&t.hideLoading(o)}),u.then(f.resolve,f.reject),f.promise()}}(window._ol_jQuery||jQuery),window.Silverlight||(window.Silverlight={}),Silverlight._SAFARI_BROWSER=1,Silverlight._CHROME_BROWSER=2,Silverlight._isInstalledCache={},Silverlight.isInstalled=function(n){var f,t,a,e,o,c,s,i,r,h,l,u;if(n=n==undefined?null:n,f=n==null?"default":n,this._isInstalledCache[f]!=undefined)return this._isInstalledCache[f];t=!1,a=null;try{if(e=null,o=!1,window.ActiveXObject)try{e=new ActiveXObject("AgControl.AgControl"),n===null?t=!0:e.IsVersionSupported(n)&&(t=!0),e=null}catch(v){o=!0}else o=!0;if(o&&(c=navigator.plugins["Silverlight Plug-In"],c))if(n===null)t=!0;else{for(s=c.description,s==="1.0.30226.2"&&(s="2.0.30226.2"),i=s.split(".");i.length>3;)i.pop();while(i.length<4)i.push(0);for(r=n.split(".");r.length>4;)r.pop();u=0;do h=parseInt(r[u]),l=parseInt(i[u]),u++;while(u<r.length&&h===l);h<=l&&!isNaN(h)&&(t=!0)}}catch(v){t=!1}return this._isInstalledCache[f]=t,t},Silverlight.supportedUserAgent=function(n,t,i){var u,s,h,r,c,f,e,o;try{return u=null,u=t?t:window.navigator.userAgent,s=!0,h=!0,i&&(i&Silverlight._CHROME_BROWSER&&(s=!1),i&Silverlight._SAFARI_BROWSER&&(h=!1)),r={OS:"Unsupported",Browser:"Unsupported"},u.indexOf("Windows NT")>=0||u.indexOf("Mozilla/4.0 (compatible; MSIE 6.0)")>=0?r.OS="Windows":u.indexOf("PPC Mac OS X")>=0?r.OS="MacPPC":u.indexOf("Intel Mac OS X")>=0&&(r.OS="MacIntel"),r.OS!="Unsupported"&&(u.indexOf("MSIE")>=0?parseInt(u.split("MSIE")[1])>=6&&(r.Browser="MSIE"):u.indexOf("Firefox")>=0?(f=u.split("Firefox/")[1].split("."),e=parseInt(f[0]),e>=2?r.Browser="Firefox":(c=parseInt(f[1]),e==1&&c>=5&&(r.Browser="Firefox"))):u.indexOf("Chrome")>=0&&s?(f=u.split("Chrome/")[1].split("."),e=parseInt(f[0]),e>=3&&(r.Browser="Chrome")):u.indexOf("Safari")>=0&&h&&(r.Browser="Safari")),o=!(r.OS=="Unsupported"||r.Browser=="Unsupported"||r.OS.indexOf("Windows")>=0&&r.Browser=="Safari"||r.OS.indexOf("Mac")>=0&&r.Browser=="MSIE"),n=="2.0"?o&&r.OS!="MacPPC":n=="1.0"?o&&u.indexOf("Windows NT 5.0")<0:o}catch(l){return!1}},Silverlight.getVersion=function(){var t="NoInst",r,i,u,n;try{for(r=new ActiveXObject("AgControl.AgControl"),t="unk",i=["4.0.50917.0","4.0.50826.0","4.0.50524.0","4.0.50401.0","4.0.50303.0","4.0.41108.0","3.0.50611.0","3.0.50106.0","3.0.40818.0","3.0.40723.0","3.0.40624.0","3.0.40307.0","2.0.40115.0","2.0.31005.0","2.0.30523.9","2.0.30523.8","2.0.30523.6","2.0.30226.2","1.0.30715.0","1.0.30401.0","1.0.30109.0","1.0.21115.0","1.1.20926.0","1.0.20816"],u=i.length,n=0;n<u;n++)if(r.IsVersionSupported(i[n])){t=i[n];break}}catch(f){try{t=navigator.plugins["Silverlight Plug-In"].description}catch(e){}}return t},registerNamespace("$SB"),function(n){var r;$SB=$SB||{},$SB.sbs=$SB.sbs||{};var u=$SB.renderModes=new $Enum("HOTMAIL","NOWORDWHEEL"),i="c_search_i",f="c_ms",t=!1;$SB.logEvent=function(n,i){$BSI.reportEvent("search.general",{SearchType:n+(i?"_"+i:""),SearchMethod:t?"enter":"click"}),t=!1},$SB.SearchBox=function(t,i,r,u,f,e,o){var s=this,y=n(o),tt=u+"f",a=y.find("."+tt),it=a[0],rt=u+"box",h=y.find("."+rt),c=h[0],ut=u+"go",v=y.find("."+ut),ft=v[0],et;var k=!($B.IE&&$B.V<=11),p="c_search_a",d="c_search_f",g=i?new Function("t","f","sub","searchBox",i):null,w=f,l=h.hasClass(p),b=!1,nt=!1;this.$menuDock=a,this.$inputBox=h,et=s.renderMode=t,this.searchBoxParams=null,this.searchEmailFunc=r?function(n,t){s.closeWordWheelMenu(),new Function("searchBoxParamsChanges","searchOrigin","targetEl",r)(n,t,c)}:null,this.searchFunc=function(n){n&&(s.searchEmailFunc&&s.searchEmailFunc({keywords:n},$SBC.searchOrigin?$SBC.searchOrigin.SearchBox:0),s.closeWordWheelMenu())},this.usesForm=e,this.statusId=u+"status",this.idPrefix=u,this.init=function(){if(s.usesForm)a.on("submit",s.onSubmit);else{h.on("keyup",s.onKeyUp);v.on("click",s.onSubmitButtonClick)}h.on("focus",s.onFocus);h.on("blur",s.onBlur)},this.dispose=function(){s.usesForm?a.off("submit"):(h.off("keyup",s.onKeyUp),v.off("click",s.onSubmitButtonClick)),h.off("focus"),h.off("blur")},this.onSubmit=function(n){if(l||h.val(""),s.getValue().trim()==="")return!1;if(typeof g=="function")try{return g(c,it,ft,s)}catch(t){}return typeof s.searchFunc=="function"?(s.searchFunc(s.getValue(),n),!1):!0},this.onKeyUp=function(n){if(n.keyCode===13)return s.searchFunc(s.getValue(),n),!1},this.onSubmitButtonClick=function(n){s.searchFunc(s.getValue(),n),n.preventDefault()},this.onFocus=function(){h.addClass(d);try{nt||$BSI.reportEvent("search.general",{SearchMethod:"focus"}),nt=!0}catch(n){}l||($B.IE&&setTimeout(function(){b&&c.select()},1),c.defaultValue="",s.setValue("",!0)),b=!0},this.onBlur=function(){h.removeClass(d),c.value===""&&s.resetDefault(),b=!1},this.setValue=function(n,t){c.value=n,t&&(h.addClass(p),l=!0)},this.getValue=function(){return l?c.value:""},this.setDisabled=function(n){h.prop("disabled",n),a.toggleClass("disabled",n)},this.setSearchBoxParams=function(n){s.searchBoxParams=n,s.resetWordWheelMenuCachedSuggestions()},this.resetDefault=function(){c.value=k?"":w,h.removeClass(p),l=!1},this.setDefaultText=function(n){w=n,h.attr("aria-label",n),k&&h.attr("placeholder",n),l||s.resetDefault()},this.getDefaultText=function(){return w},this.findAllFromSender=function(n){s.WordWheelMenu&&s.WordWheelMenu.provider&&typeof s.WordWheelMenu.provider.findAllFromSender=="function"&&s.WordWheelMenu.provider.findAllFromSender(n)||this.searchFunc(n)},this.updateMenuData=function(n,t){s.WordWheelMenu&&s.WordWheelMenu.provider&&typeof s.WordWheelMenu.provider.updateMenuData=="function"&&(s.WordWheelMenu.provider.updateMenuData(n,t),s.resetWordWheelMenuCachedSuggestions())},this.closeWordWheelMenu=function(){s.WordWheelMenu&&typeof s.WordWheelMenu.closeMenu=="function"&&s.WordWheelMenu.closeMenu()},this.resetWordWheelMenuCachedSuggestions=function(){s.WordWheelMenu&&typeof s.WordWheelMenu.resetCachedSuggestions=="function"&&s.WordWheelMenu.resetCachedSuggestions()},$Do.when("$f",0,function(){if($Utility.isHighContrast()){var t=document.createElement("img"),i=$B.rtl?"/sb/search_rtl.png":"/sb/search.png";t.src=$Config.imgsBase+i,t.className="c_search_go",v.hide().before(t),n(t).bind("click",s.onSubmit)}}),this.init()},r=function(r,u){function g(){c.bind("focus",y),c.bind("keyup",y),c.bind("input",y),n(window).bind("unload",h.dispose)}function nt(){b||s.initialize(ft),b=!0}function tt(i){var r;if(!w){w=!0;var u=$SBC.advSearch?!0:!1,f={offset:{x:-1,y:4},nofocus:1,eventType:"click",dockEl:o.$menuDock[0],parentEl:o.$menuDock[0],showOnEmptyInput:!0,allowClickOnEmptyInput:u};$menu.create(i,0,f),r=e.binding,r&&n(r).bind("EnterEvent",function(i,r){t=!0,r&&$BSI.navigateTo(n(r).attr("href"))})}}function it(){var t=_ce("ul"),r,i,u,n,f,e;for(t.className="c_m t_hovl c_search_menu",t.setAttribute("id",o.idPrefix+"menu"),t.setAttribute("sutra","searchboxdropdown"),r=s.getMenuSectionsConfig(),this.menuSectionHeaders=[],i=0,u=r.length;i<u;i++)n=r[i].header,f=rt(t,n.additionalClass,n.title,n.isVisibleWithoutMatches,n.onClickFunction,n.sutraTag),this.menuSectionHeaders.push(f),n.isVisibleWithoutMatches&&i<u-1&&(e=k(),p(e,f));return o.$menuDock.append(t),t}function rt(t,i,r,u,f,e){var s=_ce("li");return e&&s.setAttribute("sutra",e),s.innerHTML='<a href="javascript:;" class="'+(i?i+" ":"")+'c_search_heading" >'+r.encodeHtml()+"<\/a>",t.appendChild(s),n(s).bind("click",function(n){return typeof f=="function"&&(f(n,o.getValue(),o),h.closeMenu(),n.preventDefault()),!1}),u||n(s).hide(),s}function k(){var n=_ce("span");return n.className=f,n}function y(n){tt(n),nt(),ut()}function ut(){v===null?(v=setTimeout(function(){a!==null&&(d(a),a=null),v=null},$SBC.queryInterval),d(o.getValue())):a=o.getValue()}function d(n){n!==l&&(l=n,s.getMatches(n))}function ft(t,i){var h,v,r,e,a;if(l===i){for(ot(),h=s.getMenuSectionsConfig(),v=!1,r=0;r<t.length;r++){var u=t[r],o=this.menuSectionHeaders[r],c=h[r].header,f=o;for(e=0;e<u.length;e++)f=p(u[e],f,!0);u.length>0&&r<t.length-1&&(a=k(),f=p(a,f)),c.isVisibleWithoutMatches||c.isVisibleWithMatches&&u.length>0?n(o).show():n(o).hide()}et()}}function et(){e.binding.update()}function ot(){for(var r=0,u=e.childNodes,f=null,t;u.length>r;)t=u[r],f=t.className,f.indexOf(i)>-1?(n(t.firstChild).unbind(),e.removeChild(t),u=e.childNodes):r++}function p(n,t,r){var u=_ce("LI"),f;return r&&u.setAttribute("sutra","searchboxitem"),u.className=i,u.appendChild(n),f=t.nextSibling,f?e.insertBefore(u,t.nextSibling):e.appendChild(u),u}var h=this,o=r,c=r.$inputBox,w=!1,l=null,s=u,b=!1,v=null,a=null,e=it();this.provider=s,this.dispose=function(){for(var r=this.menuSectionHeaders?this.menuSectionHeaders.length:0,i,t=0;t<r;t++)n(this.menuSectionHeaders[t]).unbind();this.menuSectionHeaders=[],c.unbind(),i=e.binding,i&&(n(i).unbind(),i.dispose()),s&&(s.dispose(),s=null,h.provider=null),n(window).unbind("unload",h.dispose)},this.closeMenu=function(){var n=e.binding;n&&n.isOpen()&&n.hide()},this.resetCachedSuggestions=function(){l=null},g()},$SB.bindAllSearchBoxes=function(n,t){for(var i in $SBC.initConfigs)$SB.bindSearchBox(n,i,t)},$SB.bindSearchBox=function(n,t,i){var f=$SBC.initConfigs[t],e,o;if(f){if($SB.sbs[t]||($SB.sbs[t]=new $SB.SearchBox(f.renderMode,f.submitOverride,f.searchEmailFunc,f.idPrefix,f.defaultText,f.usesForm,i)),e=$SB.sbs[t],e.renderMode!==u.NOWORDWHEEL){if(!window.$SBC)return;e.WordWheelMenu=new r(e,new n(e))}$Config.isINT&&(o=_ge(e.statusId),o&&o.setAttribute("status","Ready"))}},$SB.setAllSearchBoxesEnabled=function(n){var t,i;for(t in $SB.sbs)i=$SB.sbs[t],i.setDisabled(!n)},$SB.setAllSearchBoxesParams=function(n){var t,i;for(t in $SB.sbs)i=$SB.sbs[t],i.setSearchBoxParams(n)},$SB.setAllSearchBoxesValue=function(n){for(var t in $SB.sbs)$SB.setSearchBoxValue(n,t)},$SB.setSearchBoxValue=function(n,t){var i=$SB.sbs[t];i&&(n?i.setValue(n,!0):i.resetDefault())},$SB.getSearchBoxValue=function(n){var t=$SB.sbs[n];return t?t.getValue():null},$SB.setAllSearchBoxesDefaultText=function(n){for(var t in $SB.sbs)$SB.setSearchBoxDefaultText(t,n)},$SB.setSearchBoxDefaultText=function(n,t){var i=$SB.sbs[n];i&&i.setDefaultText(t)},$SB.getSearchBoxDefaultText=function(n){var t=$SB.sbs[n];return t?t.getDefaultText():null},$SB.findAllFromSender=function(n,t){var i=$SB.sbs[n];return i?i.findAllFromSender(t):null},$SB.updateMenuData=function(n,t,i){var r=$SB.sbs[n];r&&r.updateMenuData(t,i)},$SB.disposeAllSearchBoxes=function(){for(var n in $SB.sbs)$SB.disposeSearchBox(n)},$SB.disposeSearchBox=function(n){var t=$SB.sbs[n];t&&(t.WordWheelMenu&&t.WordWheelMenu.dispose(),t.dispose(),delete $SB.sbs[n])},$Do.register("$SB")}(window.originaljQuery||jQuery),function(n){function g(n,t,i){var u={},f=[t,{canary:$SBC.canary,bicild:""}],r,e;switch(n){case y.documents:u.scope="documentsearch"}for(u.callback="$SB."+i,r=0;r<f.length;r++)for(e in f[r])u[e]=f[r][e];return $SBC.ufs+"?"+$Utility.serialize(u)}function f(n){return n?n.toLowerCase():""}function tt(n){var i=[],t=null,r=null;if(n)for(i.push(t=n.lTrim());(r=t.search(nt))!=-1;)i.push(t=t.substring(r+1).lTrim());return i}function h(t,i,r,f,e,o,s,h,c,l){var a=_ce("A");return o&&(a.className=o),a[u]("target",s?"_blank":"_top"),a[u]("href",i),n(a).bind("click",function(n){var t=r(n);return $menu.closeCurrent(),$SB.logEvent(h,a.sbindex||""),t}),f&&a.appendChild(f),a.appendChild(e),a.sbbinding=c,l&&(a.sbindex=l),a}function w(t,i,r,f,e){var o=new Image,s=ut(t,o,f);return n(o).bind("load",rt(o)),o.className="c_search_imgpad c_search_img"+(e?" "+e:""),o[u]("alt",i),o[u]("src",$ssl.ensureSSLImageUrl(it(t,r,f))),s&&n(o).bind("error",s),o}function it(n,t,i){return n.defaultImage?i:t||i}function rt(t){return function i(){t.style.visibility="inherit",n(t).unbind("load",i)}}function ut(t,i,r){function f(){n(i).unbind("error",f),t.defaultImage||(t.defaultImage=!0,i[u]("src",$ssl.ensureSSLImageUrl(r)))}return t.defaultImage?null:f}function c(n){var t=_ce("SPAN");return t.className="c_search_txt",t.innerHTML=n,t}function l(n){var t=_ce("SPAN");return t.className="c_search_sub_heading c-InformationRow",t.innerHTML=n,t}function k(n){n=n.toLowerCase();for(var t in b)n=n.replace(b[t],t);return n}function r(n,r,u){var f=a.match(n)?a.highlight(n,r):d(n,r,u);return f.encodeHtml().replace(new RegExp(e.encodeHtml(),"g"),t).replace(new RegExp(o.encodeHtml(),"g"),i)}function d(n,t,i){for(var a=[t].concat(t.split(" ")),u=new Array(n.length+2),w="(^|\\s"+(i?"|@":"")+(i?"":"|["+p.escapeRegex()+"]")+")",s,h,c,r=0;r<u.length;r++)u[r]=0;for(r=0;r<a.length;r++)for(var b=a[r],v=k(n).replace(new RegExp(w+"("+k(b).escapeRegex()+")","ig"),"$1"+e+"$2"+o),y=0,f=0,l=0;(y=v.indexOf(e,f))!=-1;)for(f=v.indexOf(o,f+1),l+=2,s=y-l+2;s<f-l+1;s++)u[s+1]=1;for(h=[],r=1;r<u.length;r++)u[r]!=u[r-1]&&h.push(r-1);for(c=0,r=0;r<h.length;r++)c=h[r]+r,n=n.substr(0,c)+(r%2?o:e)+n.substr(c);return n}var t='<strong class="t_rc">',i="<\/strong>",y=new $Enum("documents","picw"),u="setAttribute",s="javascript:;",p=" !\"#$%&'()*+,-./:;<=>?@[\\]^_`{|}~",nt=new RegExp("["+p.escapeRegex()+"]","ig"),b={a:/[\xE0-\xE4]/ig,e:/[\xE8-\xEB]/ig,i:/[\xED-\xEF]/ig,o:/[\xF3-\xF5]/ig,u:/[\xF9-\xFC]/ig,n:/\xF1/ig,y:/\xFF/ig,c:/\xE7/ig},e="",o="",a,ft,et,v;if($SB.MailQueryHelper=function(){var n={FROM:"from:",TO:"to:",SUBJECT:"subject:",FOLDER:"folder:",CATEGORY:"category:",HASATTACHMENTS:"hasattachments:",DATE:"date:"},t={FROM:$SBC.keywords.from,TO:$SBC.keywords.to,SUBJECT:$SBC.keywords.subject,FOLDER:$SBC.keywords.folder,CATEGORY:$SBC.keywords.category,HASATTACHMENTS:$SBC.keywords.hasattachments,DATE:$SBC.keywords.date},i=/^([a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?)$/i,r=/([a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?)/i,u=/^\[([^[]*?)\]$/gi,e=/\[([^[]*?)\]/gi;this.keywords=n,this.extractStartingKeywordCommand=function(n){for(var a=f(n),c=this.getKeywordCommandsInQuery(a),u,l,r=0;r<c.length;r++)if(u=c[r],u.keywordIndex===0){var v=u.keywordText,h=u.keywordCommand,t,i,e=n.substring(v.length).trim(),o=/^\((.*?)\)(.*)/i.exec(e),s=/^(\[.*?\])(.*)/i.exec(e);return o&&o.length>1?(t=o[1].trim(),i=o[2].trim(),{keywordCommand:h,keywordParams:t,remainingQuery:i}):s&&s.length>1?(t=s[1].trim(),i=s[2].trim(),{keywordCommand:h,keywordParams:t,remainingQuery:i}):(l=e.split(" "),t=l[0].trim(),i=e.substring(t.length).trim(),{keywordCommand:h,keywordParams:t,remainingQuery:i})}return null},this.getKeywordCommandsInQuery=function(i){var o=[],c=f(i),r,s,h;for(r in n){var u="",e="",l=c.indexOf(f(n[r]));l>=0?(u=n[r],e=n[r],o.push({keywordText:u,keywordCommand:e,keywordIndex:l})):(s=f(t[r]),s&&(h=c.indexOf(s),h>=0&&(u=t[r],e=n[r],o.push({keywordText:u,keywordCommand:e,keywordIndex:h}))))}return o},this.queryContainsContacts=function(n){return r.lastIndex=0,e.lastIndex=0,r.test(n)||e.test(n)},this.doesMatchSingleContactFormat=function(n){var f=n.trim(),t,r;return(i.lastIndex=0,t=i.exec(f),u.lastIndex=0,r=u.exec(f),t&&t.length>1)?t[1]:r&&r.length>1?r[1]:null}},a=new function(){function i(n){return String.fromCharCode(n)}function y(){var n=["(["],t;for(t in r)n.push(t);return n.push("])"),new RegExp(n.join(""),"g")}var n=this,u=new RegExp("([\\uAC00-\\uD7AF])","g"),c=44032,f=4352,s=4449,h=4519,p=e,t=o,r={"ㄱ":"ᄀ","ㄲ":"ᄁ","ㄴ":"ᄂ","ㄷ":"ᄃ","ㄸ":"ᄄ","ㄹ":"ᄅ","ㅁ":"ᄆ","ㅂ":"ᄇ","ㅃ":"ᄈ","ㅅ":"ᄉ","ㅆ":"ᄊ","ㅇ":"ᄋ","ㅈ":"ᄌ","ㅉ":"ᄍ","ㅊ":"ᄎ","ㅋ":"ᄏ","ㅌ":"ᄐ","ㅍ":"ᄑ","ㅎ":"ᄒ"},l=y(r),a=new RegExp("([\\u1100-\\u1112][\\u1161-\\u1175][\\u11A8-\\u11C2]{0,1})","g"),v=new RegExp("([\\u1100-\\u1112]"+t+"{0,1}[\\u1161-\\u1175]"+t+"{0,1}[\\u11A8-\\u11C2]{0,1})","g");n.expand=function(n){return n=n.replace(l,function(n){return r[n]}),n.replace(u,function(n){var t=n.charCodeAt(0)-c,r=Math.floor(t/588),e=Math.floor((t-r*588)/28),u=t%28;return i(r+f)+i(e+s)+(u?i(u+h):"")})},n.highlight=function(r,u){var e=d(n.expand(r),n.expand(u),0);return e.replace(v,function(n){return n.replace(t,"")+(n.match(t)?t:"")}).replace(a,function(n){var t=n.charCodeAt(0)-f,r=n.charCodeAt(1)-s,u=n.length>2?n.charCodeAt(2)-h:0;return i(t*588+r*28+u+44032)})},n.match=function(n){return n.match(u)}},ft=function(n,t,i){var r=this;r.key=n,r.weight=t,r.order=i},$SB.SmartSuggestionsMenu=function(n){function f(){return l($SBC.suggestions.header)}function e(n,t,i){return h(n.title,s,function(t){return o(n,t)},null,c(n.htmlText),null,!1,n.type,n,i)}function o(n,t){return u.searchEmailFunc(n.searchBoxParamsChanges,n.searchOrigin),t.preventDefault(),!0}var a=this,u=n,r=new $SB.MailQueryHelper;this.getMatches=function(n){var h=[],p,w,b;if(n){var e=n.trim(),o=r.extractStartingKeywordCommand(e),c=o?o.keywordCommand:"",s=o?o.keywordParams:"",k=o?o.remainingQuery:"",f=o?r.doesMatchSingleContactFormat(s):r.doesMatchSingleContactFormat(e),v=r.getKeywordCommandsInQuery(e).length>0,d=r.queryContainsContacts(e);if(u.searchBoxParams&&!u.searchBoxParams.mustHaveAttachments){var g=$SBC.suggestions.attach,l=e.encodeHtml(),a=t+e.encodeHtml()+i,y={mustHaveAttachments:!0,keywords:e};o&&o.remainingQuery===""?c==="subject:"?(l=$SBC.suggestions.subject.format(s.encodeHtml()),a=$SBC.suggestions.subject.format(t+s.encodeHtml()+i),y={mustHaveAttachments:!0,subject:s}):f&&(c==="from:"?(l=$SBC.suggestions.from.format(f.encodeHtml()),a=$SBC.suggestions.from.format(t+f.encodeHtml()+i),y={mustHaveAttachments:!0,from:s}):c==="to:"&&(l=$SBC.suggestions.to.format(f.encodeHtml()),a=$SBC.suggestions.to.format(t+f.encodeHtml()+i),y={mustHaveAttachments:!0,to:s})):!v&&f&&(l=f.encodeHtml(),a=t+f.encodeHtml()+i),h.push({title:$SBC.suggestions.attach.format(l),type:"HM_attachment",searchOrigin:$SBC.searchOrigin.SuggestionSmartAttachment,htmlText:$SBC.suggestions.attach.format(a),searchBoxParamsChanges:y})}f&&!k&&(v&&c!=="to:"||(p=$SBC.suggestions.from,h.push({title:p.format(f.encodeHtml()),type:"HM_from",searchOrigin:$SBC.searchOrigin.SuggestionSmartFrom,htmlText:p.format(t+f.encodeHtml()+i),searchBoxParamsChanges:{from:o?s:e,keywords:""}})),v&&c!=="from:"||(w=$SBC.suggestions.to,h.push({title:w.format(f.encodeHtml()),type:"HM_to",searchOrigin:$SBC.searchOrigin.SuggestionSmartSentTo,htmlText:w.format(t+f.encodeHtml()+i),searchBoxParamsChanges:{to:o?s:e,keywords:""}}))),v||d||(b=$SBC.suggestions.subject,h.push({title:b.format(e.encodeHtml()),type:"HM_subject",searchOrigin:$SBC.searchOrigin.SuggestionSmartSubject,htmlText:b.format(t+e.encodeHtml()+i),searchBoxParamsChanges:{subject:e,keywords:""}}))}return h},this.getHtml=function(n,t){var r=[],i;if(n.length>0)for(r.push(f()),i=0;i<n.length;i++)r.push(e(n[i],t,i));return r}},$SB.CategoriesMenu=function(n){function v(n){return n?l($SBC.categories.header):l($SBC.suggestedSearches.header)}function y(n,t,i){return h(n.title,s,function(t){return p(n,t)},null,c(n.htmlText),null,!1,n.type,n,i)}function p(n,i){return t.searchEmailFunc(n.searchBoxParamsChanges,n.searchOrigin),i.preventDefault(),!0}function w(){function i(n){return wLive.Search.Helpers.getSuffixStringsFor(n)}function r(n,t,r,u){for(var e=i(t),s=r.length-1,f=0,o=e.length;f<o;f++)n.push(new wLive.Search.RankSearchKeyWeight(e[f],r[Math.min(f,s)],u)),u++;return u}var n=this,t=[1,.75];n.matchField=function(n){return n.Name},n.getKeysAndWeights=function(n){var i=[],u=1;return u=r(i,n.Name,t,u),i},n.autoComplete=function(n){return n.Name},n.isValid=function(){return!0},n.compareParents=null,n.comparer=function(n,t){var r=n.Name.toLowerCase(),u=t.Name.toLowerCase(),i=0;return r>u?i=1:r<u&&(i=-1),i},n.finalSortFunction=function(n,t){var r=n.obj.Name.toLowerCase(),u=t.obj.Name.toLowerCase(),i=0;return r>u?i=1:r<u&&(i=-1),i}}var b=this,t=n,k=new $SB.MailQueryHelper,i=null,u=[],a=new w,e=null,o=!1;this.updateMenuData=function(n){var r,f,t,s;for(u=n.suggestedCategoryIds?n.suggestedCategoryIds:u,i=n.categoryList?n.categoryList:i,r=[],f=i.RootContainer.Items,t=0;t<f.length;t++)s=f[t],s.isSearchable()&&r.push(s);e=new wLive.Search.Indexer(a),e.initialize(r,!1,function(){o=!0})},this.getMatches=function(n){var v=[],c,l,a,s,h;if(o&&t.searchBoxParams&&(!t.searchBoxParams.categories||t.searchBoxParams.categories.length===0))if(c=n.trim(),c){var p=f(c),w=e.getMatches(p,$SBC.categories.max),y=w.result;for(l=0;l<y.length;l++)s=y[l],h=s.Name,v.push({title:h,type:"HM_category",searchOrigin:$SBC.searchOrigin.SuggestionCategory,htmlText:r(h,c),searchBoxParamsChanges:{categories:[s.Id]}})}else for(a=0;a<u.length;a++)s=i.getContainerById(u[a]),s&&(h=s.Name,v.push({title:h,type:"HM_suggestedsearch",searchOrigin:$SBC.searchOrigin.SuggestionPinnedCategory,htmlText:h.encodeHtml(),searchBoxParamsChanges:{categories:[s.Id]}}));return v},this.getHtml=function(n,t){var r=[],i;if(n.length>0)for(r.push(v(t)),i=0;i<n.length;i++)r.push(y(n[i],t,i));return r}},et=1,$SB.ContactsMenu=function(n){function rt(){$SB[a]=ut;var n=g(y.picw,{},a);$Network.fetchScript(n,function(){},null)}function ut(n){var i=ft(n);u=new wLive.ContactList.ViewModels.FlatContactsDataModel({picwEmails:i,includeGroups:!1,includeCategories:!1}),$Do.when("$pwc",0,function(){$pwc.callWhenReady(function(){t=new wLive.Search.Indexer(k),t.initialize(u.getMergedContacts(),!1,function(){f=!0})})})}function ft(n){for(var r=[],u=n&&n.SearchResponse&&n.SearchResponse.People?n.SearchResponse.People:[],f=u.length,i,t=0;t<f;t++)i=u[t],i.e&&r.push(i.e);return r}function et(n,i){for(var b=t.normalizeTerm(i),u,v,f,o,y,s,e,p,w,r=0,h=l.length;r<h;r++){var c=l[r],a=c.properties||[],k=c.type;if(k!==d.email)for(u=0,v=a.length;u<v;u++)if(f=a[u],o=n[f](),o&&f!=="sortName")for(y=t.normalizeTerm(o),s=tt(y),e=0,p=s.length;e<p;e++)if(w=s[e],w.startsWith(b))return f}return null}function v(n,t,i,r){return h(p(n),s,function(t){return st(n,r,t)},ht(n),lt(n,t,r),null,!1,"WW_contacts",n,i)}function p(n){var i=n.displayName(),t=n.email();return(i||t||"")+(i&&t?ot(t):"")}function ot(n){return $B.rtl?" - "+n:" ("+n+")"}function st(n,t){var r=e.extractStartingKeywordCommand(i.getValue()),u=r?r.keywordCommand:"",f=b(n,!!t,u);i.searchEmailFunc(f,$SBC.searchOrigin.SuggestionContact)}function b(n,t,i){var f=n.email(),e={},r,o;t&&(r=n.displayName(),r&&n.type()!==wLive.ContactList.ViewModels.ContactType.PicwEmail&&(f="["+r+"]",o=u.getEmailsOfPerson(n.id()),e[r]=o?o.join(" OR "):r));switch(i){case"to:":return{to:f,contactMappings:e};case"from:":return{from:f,contactMappings:e};default:return{keywords:f,contactMappings:e}}}function ht(n){return w(n,p(n),ct(n),o,"c_search_contact_img")}function ct(n){return n.userTile()||o}function lt(n,t,i){var f=n.displayName()||"",u=n.email(),s,e;return i&&(u="",i!=="firstName"&&i!=="lastName"&&i!=="displayName"&&i!=="name"&&i!=="sortName"&&(u=n[i]())),!f&&u&&(f=u,u=""),s=n.userTile()||o,e='<div class="c_search_contact">'+(f?' <div class="c_search_main_text">'+r(f,t)+"<\/div>":"")+(u?' <div class="c_search_sub_text">'+r(u,t,!0)+"<\/div>":"")+"<\/div>",c(e)}var at=this,f=!1,i=n,e=new $SB.MailQueryHelper,k=new wLive.ContactList.ViewModels.ContactsHelper,t=null,u=null,d=wLive.ContactList.ViewModels.SearchablePropertyTypes,l=wLive.ContactList.ViewModels.SearchableProperties,nt=10,o=$SBC.utfb,it=0,a="picwResultsCallback"+it++;this.getMatches=function(n){var r=[],i,u,o;return n&&(i=e.extractStartingKeywordCommand(n),u=i?i.remainingQuery?n:i.keywordParams:n,f&&(o=t.getMatches(u,$SBC.contacts.max*nt),r=o.result)),r},this.getHtml=function(n,t){for(var f=[],c={},o=0,l=$SBC.contacts.max,s=e.extractStartingKeywordCommand(t),h=s?s.remainingQuery?t:s.keywordParams:t,r,u,i=0;i<n.length&&o<l;i++)r=n[i],u=et(r,h),u?c[r.id()]||(f.push(v(r,h,i+1,u)),c[r.id()]=!0,o++):(f.push(v(r,h,i+1,u)),o++);return f},this.isInitialized=function(){return f},this.findAllFromSender=function(n){var t=u.getContactByEmail(n),r;t?(r=b(t,!0,"from:"),i.searchEmailFunc(r,$SBC.searchOrigin.FindAllFromSender)):i.searchEmailFunc({from:n},$SBC.searchOrigin.FindAllFromSender)},rt()},$SB.PeoplePickerMenu=function(n,t){function b(){o=new wLive.ContactList.ViewModels.FlatContactsDataModel({includeGroups:!1,includeCategories:!1,includePeopleWithoutEmails:!0}),$Do.when("$pwc",0,function(){$pwc.callWhenReady(function(){u=o.getMergedContacts(),i=new wLive.Search.Indexer(p),i.initialize(u,!1,function(){f=!0,a&&a()})})})}function k(n,t,i){return h(y(n),s,function(t){return g(n,t)},nt(n),it(n,t),null,!1,"WW_contacts",n,i)}function y(n){var i=n.displayName(),t=n.email();return(i||t||"")+(i&&t?d(t):"")}function d(n){return $B.rtl?" - "+n:" ("+n+")"}function g(n){e.contactOverride&&e.contactOverride(n)}function nt(n){return w(n,y(n),tt(n),l,"c_search_lg")}function tt(n){return n.userTile()||l}function it(n,t){var i=n.displayName()||"",e=n.email(),u="",f;return i&&(u=e),f=i?r(i,t):r(e,t,!0),f+=u&&!$B.rtl?' <span class="c_search_e">('+r(u,t,!0)+")<\/span>":"",c(f)}var rt=this,f=!1,e=n,p=new wLive.ContactList.ViewModels.ContactsHelper,i=null,o=null,l=$SBC.utfb,a=t,u=null,v=9999;this.getMatches=function(n){var t=[],r;return f&&(n?(r=i.getMatches(n,v),t=r.result):t=u),t},this.getHtml=function(n,t){for(var u=[],f={},e=0,r,i=0;i<n.length&&e<v;i++)r=n[i],f[r.id()]||(u.push(k(r,t,i+1)),f[r.id()]=!0,e++);return u},b()},v=function(n){var r=this,f=null,e=n,u=null,o=!1,s=$SB.renderModes,t={},i,h,c;e.renderMode===s.HOTMAIL&&(t.CONTACTS=new $SB.ContactsMenu(n),t.SMARTSUGGESTIONS=new $SB.SmartSuggestionsMenu(n),t.CATEGORIES=new $SB.CategoriesMenu(n)),i=[],e.renderMode===s.HOTMAIL&&(h={header:{title:"",sutraTag:"",isVisibleWithoutMatches:!1,isVisibleWithMatches:!1},subMenus:[t.CONTACTS,t.CATEGORIES,t.SMARTSUGGESTIONS]},i.push(h),c={header:{title:$SBC.advSearchText,sutraTag:"searchboxitem",isVisibleWithoutMatches:!0,isVisibleWithMatches:!0,onClickFunction:new Function("evt","query","searchBox",$SBC.advSearch)},subMenus:[]},i.push(c)),r.dispose=function(){},r.getMenuSectionsConfig=function(){return i},r.getMatches=function(n){var s,t,r,h,e;if(!o)return u=n,!1;for(s=[],t=0;t<i.length;t++){for(r=[],h=i[t],e=0;e<h.subMenus.length;e++){var c=h.subMenus[e],l=c.getMatches(n),a=c.getHtml(l,n);r=r.concat(a)}s.push(r)}return f(s,n),!0},r.initialize=function(n){f=n,o=!0,u&&(r.getMatches(u),u=null)},this.findAllFromSender=function(n){return t.CONTACTS&&typeof t.CONTACTS.findAllFromSender=="function"?(t.CONTACTS.findAllFromSender(n),!0):!1},this.updateMenuData=function(n,i){t[n]&&typeof t[n].updateMenuData=="function"&&t[n].updateMenuData(i)}},$SB.WindowsLiveProvider=v,$SB.bindAllSearchBoxes&&window.$SBC&&$SBC.autoBindSearchBoxes)try{$SB.bindAllSearchBoxes(v,document)}catch(ot){}}(window.originaljQuery||jQuery),function(){"use strict";var n=window.ol=window.ol||{};n.Attachments={GetDownloadUrlFromParams:function(n,t,i,r,u,f,e){var o="",s;return null!=i&&""!=i&&(o="/mail/ScanAttachment.aspx?messageid={0}&attindex={1}&cp={2}&attdepth={3}".format(n,i,t,r)),null!=u&&""!=u&&(o="{0}&blob={1}".format(o,u)),null!=f&&""!=f&&(o="{0}&entryPt={1}".format(o,f)),s=$Config.BSI.biciPrevious,s&&s!=""&&(o="{0}&biciPrevious={1}".format(o,s)),e&&(o="{0}//{1}{2}".format(window.location.protocol,window.location.hostname,o)),o},GetOfficePreviewUrlFromParams:function(t,i,r,u,f){var e="";return u&&f&&(e="/mail/ViewOfficePreview.aspx?messageid={0}&folderid={1}&attindex={2}&cp={3}&attdepth={4}&n={5}".format(t,i,u,r,f.encodeUrl(),n.DynamicNonce())),e}}}(),function(){"use strict";var n=window.ol=window.ol||{};n.bind=function(n,t){return function(){return n.apply(t,arguments)}}}(),function(){"use strict";var n=window.ol=window.ol||{},t=n.dom=n.dom||{};t.isNode=function(n){return window.Node&&typeof Node=="function"?n instanceof Node:n&&typeof n=="object"&&typeof n.nodeType=="number"&&typeof n.nodeName=="string"},t.isElement=function(n){return window.HTMLElement&&typeof HTMLElement=="function"?n instanceof HTMLElement:n&&typeof n=="object"&&n.nodeType===1&&typeof n.nodeName=="string"}}(),function(n){window.onClickUnsafeLink=function(t){var r=n.Event(t),i;return r.preventDefault(),r.stopPropagation(),i=t.currentTarget?t.currentTarget:t.srcElement,ol.Cmd("rm.unsafelinkclick").bubble(i,{srcElement:i}),!1}}(window.originaljQuery||window.jQuery),function(n){"use strict";function h(n,t,i){t&&typeof i!="undefined"&&(t+=":"+i);Qos.onUnhandledError(n,t,null)}function c(t){var u,r,i;try{u=$WebWatson.CB.IsIgnored,$WebWatson.CB.IsIgnored=function(){return!0},s(t),r=_$ge("c_watsonui"),r.length>0&&(i=r.children("div").last(),i.length>0&&i.children("#_ww_moreInfo").length===0&&n("<a id='_ww_moreInfo' href='#'>More Info<\/a>").on("click",function(i){n("<form action='/mail/JITErrorInfo.aspx' method='post' target='_blank'><\/form>").append(n("<input type='hidden' name='cst' />").attr("value",t.stack)).appendTo("body").submit().remove(),i.preventDefault()}).appendTo(i))}catch(t){}finally{$WebWatson.CB.IsIgnored=u}}function u(){i=!0,r.unbind("unload",u),t&&(clearInterval(t),t=0),e()}function l(){var t=Qos.getContext(),n=arguments[1]||arguments[0];return n.success=Qos.instrument(t,n.success),n.error=Qos.instrument(t,n.error),n.complete=Qos.instrument(t,n.complete),i&&n.url.indexOf("ScenarioQos")!==-1&&(n.async=!1),o.apply(this,arguments)}function f(n,t,i){return!t||!i}function a(n,t){return Qos.instrument(t,n)}function e(){var t=null,i=Qos.clearLogs(),r,n,u;for(r in i)i.hasOwnProperty(r)&&(n=i[r],u={api:n.id,dependent:n.partnerId,error:n.errorCode,errorType:n.errorType,stackTrace:n.stack},t||(t=$ScenarioQoS.startScenario("KahunaWeb_None","KahunaWeb")),wLive.ScenarioQoSStats.add(u,n.startTime,t,n.endTime-n.startTime));t&&$ScenarioQoS.stopScenario(t,!0)}var o=n.ajax,s=$WebWatson.submitFromException,t,i,r=n(window);n.ajax=l,$WebWatson.submitFromException=Qos.instrumentException,$WebWatson.CB.InstrumentDelegate=a,$WebWatson.CB.IsHidden=f,$WebWatson.CB.IsIgnored=f,!(window.$Config&&$Config.isQosEnabled)||$Config.Qos==null||$Config.Qos.flushInterval==null||(t=setInterval(e,$Config.Qos.flushInterval)),window.LiveUnit||(window.onerror=h),r.bind("unload",Qos.instrument(null,u)),Qos.registerDefaultErrorId("KahunaWeb_Internal_Unknown"),Qos.registerQosOnLogErrorId("KahunaWeb_Internal_QosOnQos_LogError"),Qos.displayErrorCallback=c}(window.originaljQuery||window.jQuery),function(){"use strict";var n=window.ol=window.ol||{},t=new RegExp("[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@((?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?)","i");n.String={removeSpaceDelimitedString:function(n,t){var i=" "+n.trim()+" ";return i.replace(" "+t+" "," ").trim()},isValidEmailSyntax:function(n){var i=n&&n.trim(),r=i&&t.exec(i);return!!r&&r.length>0&&r[0]===i},emailDomain:function(n){var i=null,r=n&&t.exec(n);return r&&(i=r[1]),i},addBidiRTLEntityMark:function(t){return n.config.LrmEntityMarkIfRtl+t}}}(),function(){"use strict";var u=window,f=u.ol=u.ol||{},i=f.TouchUtil={},n=null,r=null,t=window.navigator;i.PointerUp=function(){return n||(n=t.pointerEnabled?"pointerup":t.msPointerEnabled?"MSPointerUp":"mouseup"),n},i.supportsPointerUp=function(){return r===null&&(r=!!(t&&(t.msPointerEnabled||t.pointerEnabled))),r},i.isTap=function(n){return(n.type==="MSPointerUp"||n.type==="pointerup")&&n.pointerType&&n.pointerType===n.MSPOINTER_TYPE_TOUCH||n.type==="touchend"||n.mozInputSource&&n.mozInputSource===n.MOZ_SOURCE_TOUCH},i.isOrientationSupported=function(){return"onorientationchange"in document.documentElement}}(),function(){"use strict";var n=window.ol=window.ol||{};n.GetObservables=function(n){var r={},t,i;for(t in n)i=t.substr(0,1).toLowerCase(),i!==t.substr(0,1)&&(r[i+t.slice(1)]=n[t]);return r}}(),function(n){"use strict";var i=window.ol=window.ol||{},t=n.when();i.updateAnimPromise=function(n){t=i.deferredUtils.whenAll([t,n])},i.waitForAnimAndLayout=function(n,i){t.then(function r(){var u=t;setTimeout(function(){t!==u?(u=t,u.then(r)):n()},i?i:0)})}}(window.originaljQuery||window.jQuery),function(){"use strict";function f(){var n=_ce("input");return n.setAttribute("type","file"),n.disabled===!1}function e(){var n=!1,t=new XMLHttpRequest;return t.upload&&(n=!0),t=null,n}var t=window.ol=window.ol||{},i=navigator.userAgent.toLowerCase(),r=!!i.match(/webkit/)&&!i.match(/chrome/),u=r&&!!i.match(/windows/),n;t.BrowserCapabilities=t.BrowserCapabilities||{},n=t.BrowserCapabilities,n.asyncUploads=e(),n.fileSelect=f(),n.multiFileSelect=!u,n.fileReader=!!window.FileReader,n.blobBuilder=!!(window.BlobBuilder||window.MSBlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder),n.enableObjectResizing=!!$B.Firefox,n.useSilverlightUploading=!r,n.placeholder=!($B&&$B.IE&&$B.V<10),n.useSilverlightUploader=function(){var i=t.config.compose.slUploadControl.requiredSilverlightVersion;return(!n.asyncUploads||!n.multiFileSelect||!n.fileReader)&&t.compose.composeVm.InitContext.useSlUploader&&n.useSilverlightUploading&&Silverlight.supportedUserAgent(i,null)&&Silverlight.isInstalled(i)}}(),function(){"use strict";var n=window.ol=window.ol||{},t=n.CmdFilter=function(n){var u,t,i,f,r;u=this,t=n.cmdArg.split("."),n.notEquals!==undefined?(i=n.notEquals,f=!0):n.equals!==undefined?i=n.equals:n.test&&(r=n.test),u.test=function(n){for(var u,e=n.args[t[0]],o=1;o<t.length&&typeof e!="undefined";o++)e=e[t[o]];return r?u=r(e):(u=typeof e!="undefined",u&&typeof i!="undefined"&&(u=e===i),f&&(u=!u)),u}},i;t.makeFilters=function(n){for(var r=[],i=0;i<n.length;i++)r.push(new t(n[i]));return r},t.matches=function(n,t){for(var i=!0,r=0;r<t.length&&i;)i=t[r++].test(n);return i},i=n.CmdFilterCache=function(t){var r=this,i={};r.matches=function(r){var e=!1,f=r.settings&&r.settings[t],u;return f&&(u=i[r.name],!u&&f.filters&&(u=i[r.name]=n.CmdFilter.makeFilters(f.filters)),e=!u||n.CmdFilter.matches(r,u)),e}}}(window.originaljQuery||window.jQuery),function(n){"use strict";var t=window.ol=window.ol||{},i=function(){function o(){t.GetAppConfig("IsThrottleActionsEnabled")&&(f=new t.CmdFilterCache("throttle"),t.Cmd.registerExecutionStrategy(s),i=n.extend({},e),r=t.GetAppConfig("MaxThrottleActions"),u=t.GetAppConfig("ThrottleActionTime"))}function s(t){var e=null;if(f.matches(t)){var o=h(t),s=(new Date).getTime(),c=t.args.throttleActionTime||u,l=t.args.maxThrottleActions||r;i.name===t.name&&i.key===o&&s-i.initialTime<c?(i.count++,i.count>l&&(i.isThrottled||($WebWatson.submit("action throttled: "+t.name,null,null,null,null,null,null,!0),i.isThrottled=!0),e=n.Deferred(),e.reject(HM.createCommandResult({results:{},errors:["throttled"]})))):(i.name=t.name,i.key=o,i.count=1,i.initialTime=s,i.isThrottled=!1)}return e&&e.promise()}function h(n){var e,r=n.settings.throttle,u,i,t,f;if(r.keys){for(u=[],i=0;i<r.keys.length;i++)f=r.keys[i],f.cmdArg&&(t=n.args[f.cmdArg],t instanceof Array&&(t=t.join(""))),!t||u.push(t);e=u.join("|")}return e}var c=this,e={name:null,key:null,count:0,initialTime:0,isThrottled:!1},i,r,u,f;o()};t.CmdThrottle=new i}(window.originaljQuery||window.jQuery),function(n){"use strict";var t=window.ol=window.ol||{},i=function(){function f(){r=new t.CmdFilterCache("meter"),i={},t.Cmd.registerExecutionStrategy(e)}function e(t){var e=null,o,f;return r.matches(t)&&(o=t.settings.meter.groupName||t.name,f=i[o],e=n.Deferred(),f!==undefined?(clearTimeout(f.id),f.cancelled=!0,f.promise.reject()):t.settings.meter.ignoreFirst||e.resolve(),i[o]=f={cancelled:!1,promise:e},f.id=setTimeout(function(){f.cancelled?e.reject():(e.resolve(),delete i[o])},t.settings.meter.delay||u)),e}var r,i,u=200;f()};t.CmdMeter=new i}(window.originaljQuery||window.jQuery),function(){"use strict";function f(n){setTimeout(function(){u!==n&&(document.body.style.cursor=n?"progress":"auto",u=n)},0)}var t=window.ol=window.ol||{},e="li",o=0,n={},r=t.GetAppConfig("loadingIndicatorEnabled"),i=!1,u=!1;t.showLoading=function(u){if(r){u=u||e;var s=u+" ("+o+++")";return n[s]=setTimeout(function(){n[s]&&(i||(i=!0,$header.showLoading()),delete n[s])},t.GetAppConfig("loadingIndicatorDelay")),f(!0),s}},t.hideLoading=function(t){setTimeout(function(){r&&(n[t]&&(clearTimeout(n[t]),delete n[t]),i&&($header.hideLoading(),i=!1),f(!1))},0)}}(),function(){"use strict";var n=window.DemandLoadServices={};n.beginDemandLoad=function(n,t,i,r){HM.LFPP=function(){HM.DemandLoad(n,t,i,null,r||null)},HM.LFPP()}}(),function(n){"use strict";function r(n){for(var i=n.length-1;i>=0;i--)t.getContent(n[i])&&n.splice(i,1);return n}var t=window.DemandLoadHandler={},i={};t.clear=function(){i={}},t.getContent=function(n){return i[n]},t.demandLoadContent=function(t,u,f,e,o){function h(n){for(var t in n)n.hasOwnProperty(t)&&(i[HM.ContentId[t]]=n[t]);s.resolve()}var s=n.Deferred().then(u,f);return o||(t=r(t)),t.length>0?DemandLoadServices.beginDemandLoad(t,o,h,s.reject):s.resolve(),s.promise()}}(window.originaljQuery||window.jQuery),function(n){"use strict";function ii(t,i){return n.inArray(i,w(t).categories.contains)!==-1}function w(n){return n.cmd.args.msgInst||n.cmd.args.items[n.batchIndex].msgInst}function ft(n,t){var e="c_"+t,i=n.context[e],f,r,u,o;if(typeof i=="undefined"){if(i=0,f=n.cmd.args[t],f)for(r=f.split(wi),i=r.length,u=0;u<r.length;u++)o=r[u].trim(),o.length===0&&i--;n.context[e]=i}return i}function fi(n){return n&&n.length>0}function ei(t,i){return n.inArray(i,t&&t.apply)>-1?b.Added:n.inArray(i,t&&t.remove)>-1?b.Removed:b.NoChange}function oi(n){return!!d[n]}function vi(n){return n===et.trashFid||n===et.permDelFid}function bi(n){return n===""}var f=window.ol=window.ol||{},yi=f.config=f.config||{},p=f.config.sysCats,et=f.config.sysFldrs,pi=6e4,i=window.HM,ot=n.proxy(i.registerClass,i),o=n.proxy(i.registerEnum,i),st=n.proxy(i.registerFppClassDefaults,i),wi=/[,;](?=(?:[^"]*"[^"]*")*(?![^"]*"))/,ht,t,l,si,r,hi,u,ci,ri,li,a,it,h,e,rt,ui,bt,kt,v,ct,y,c,ai,lt,dt,gt,at,ni,s,vt,yt,pt,b,ut,k,ti,d;ot({name:"InstrumentationDatapoint",args:{name:"string",type:"string",values:"array",src:Function,ref:"string"}}),st("InstrumentationDatapoint",{name:[null,"string",!0],type:[null,"string",!0],values:[null,"array",!0],src:[null,"function",!0],ref:[null,"string",!0]}),ht=i.InstrumentationDatapoint,t=i.createInstrumentationDatapoint,o({name:"InstrumentationFireWhen",args:["Before","AfterSuccess","AfterFailure","AlwaysAfter"]}),l=i.InstrumentationFireWhen,ot({name:"InstrumentationCondition",args:{command:"string",filters:"array",datapoints:"array",when:l,batch:"string"}}),st("InstrumentationCondition",{command:["","string",!1],filters:[null,["object"],!0],datapoints:[null,[ht],!0],when:[l.Before,n.type(l.Before),!0],batch:[null,"string",!0]}),si=i.InstrumentationCondition,r=i.createInstrumentationCondition,ot({name:"InstrumentationAction",args:{conditions:"array",datapoints:"array"}}),st("InstrumentationAction",{conditions:[[],[si],!1],datapoints:[[],[ht],!0]}),hi=i.InstrumentationAction,u=i.createInstrumentationAction,ot({name:"InstrumentationSharedConfig",args:{types:"object",datapointCollections:"object"}}),st("InstrumentationSharedConfig",{types:[{},{key:"string",value:ht},!0],datapointCollections:[{},{key:"string",value:[ht]},!0]}),ci=i.InstrumentationSharedConfig,ri=i.createInstrumentationSharedConfig,ot({name:"InstrumentationConfiguration",args:{shared:ci,actions:"object"}}),st("InstrumentationConfiguration",{shared:[ri(),"object",!0],actions:[{},{key:"string",value:hi},!1]}),li=i.createInstrumentationConfiguration,o({name:"InstrumentationEntryPoint",args:["Canvas","MessagePartMenu","CommandBar","KeyboardShortcut","HoverMenu","ContextMenu","InstantAction","Notification","MessageBody","MessageList","LeftNav","RightRail","DragAndDrop","IdentityControl","RRU","Other"]}),a=i.InstrumentationEntryPoint,o({name:"InstrumentationView",args:["ReadingPane","ReadView","MessageList","Compose","OptionsPage","Other"]}),it=i.InstrumentationView,o({name:"InstrumentationFolder",args:["Inbox","Archive","Junk","Drafts","Sent","Deleted","MessagingHistory","Search","Custom","None"]}),h=i.InstrumentationFolder,o({name:"InstrumentationFilter",args:["Unread","Bills","Contacts","Documents","Family","Flagged","Groups","Important","Newsletters","Photos","ShippingUpdates","Shopping","SocialUpdates","Travel","EverythingElse","Custom","None"]}),e=i.InstrumentationFilter,o({name:"InstrumentationSort",args:["Date","From","Subject","Size","Conversation"]}),rt=i.InstrumentationSort,o({name:"InstrumentationSortDirection",args:["Ascending","Descending"]}),ui=i.InstrumentationSortDirection,o({name:"InstrumentationPriority",args:["High","Normal","Low"]}),bt=i.InstrumentationPriority,o({name:"InstrumentationReadingPaneMode",args:["Off","Right","Bottom"]}),kt=i.InstrumentationReadingPaneMode,o({name:"InstrumentationSearchOrigin",args:["Unknown","SearchBox","SuggestionContact","SuggestionCategory","SuggestionPinnedCategory","SuggestionSmartAttachment","SuggestionSmartFrom","SuggestionSmartSentTo","SuggestionSmartSubject","FilterBarAttachment","FilterBarCategory","FilterBarDate","FilterBarFolder","FilterBarReset","AdvancedSearch","FindAllFromSender","FindAllInContainer"]}),v=i.InstrumentationSearchOrigin,o({name:"InstrumentationSearchContext",args:["Unknown","Inbox","Folder","Category","SearchResults"]}),ct=i.InstrumentationSearchContext,o({name:"InstrumentationComposeAction",args:["NewMessage","Reply","Forward","ReplyAll","ResumeDraft","RRU","MeetingResponse"]}),y=i.InstrumentationComposeAction,o({name:"InstrumentationUndoAction",args:["Delete","Move","Archive","Junk","NotJunk","Flag","UnFlag","AddCategory","RemoveCategory","MarkRead","MarkUnread"]}),c=i.InstrumentationUndoAction,ai={newmessage:y.NewMessage,reply:y.Reply,forward:y.Forward,replyall:y.ReplyAll,resumedraft:y.ResumeDraft,accept:y.MeetingResponse,decline:y.MeetingResponse,tentative:y.MeetingResponse},o({name:"InstrumentationRTEMode",args:["RichText","PlainText"]}),lt=i.InstrumentationRTEMode,o({name:"InstrumentationComposeCancelAction",args:["Discard","Escape","Save"]}),dt=i.InstrumentationComposeCancelAction,o({name:"InstrumentationManageRulesAction",args:["MoveRuleUp","MoveRuleDown","DeleteRule"]}),gt=i.InstrumentationManageRulesAction,o({name:"InstrumentationEditRuleExitAction",args:["Cancel","CreateRule","CreateRuleAndRun","SaveExistingRule"]}),at=i.InstrumentationEditRuleExitAction,o({name:"CurtainStages",args:["NoSpinner","SpinnerNoText","SpinnerWithText"]}),ni=i.CurtainStages,o({name:"InstrumentationFormatAction",args:["Bold","RemoveBold","Italics","RemoveItalics","Underline","RemoveUnderline","FontType","FontSize","FontColor","Highlight","RemoveHighlight","NumberedList","RemoveNumberedList","BulletedList","RemoveBulletedList","IndentLeft","IndentRight","LeftAlign","CenterAlign","RightAlign","InsertLink"]}),s=i.InstrumentationFormatAction,o({name:"InstrumentationFlagAction",args:["Flag","Unflag"]}),vt=i.InstrumentationFlagAction,o({name:"InstrumentationWebImAction",args:["Collapse","Expand"]}),yt=i.InstrumentationWebImAction,o({name:"InstrumentationMarkAction",args:["MarkAsRead","MarkAsUnread"]}),pt=i.InstrumentationMarkAction,o({name:"InstrumentationCategoryChange",args:["NoChange","Added","Removed"]}),b=i.InstrumentationCategoryChange,ut=[b.NoChange,b.Added,b.Removed],o({name:"InstrumentationOptInState",args:["None","NewMetroSignup","ManualOptIn","OptInViaProtocols","OptInViaHotmail","OptInViaExternalLink","ForceMigrated","OptOutThenForceMigrated","OptOut"]}),k=i.InstrumentationOptInState,o({name:"InstrumentationOfficialLetterType",args:["None","WelcomeLetterForNewMetroUser","WelcomeLetterForOptInUser","WelcomeLetterForForceMigratedUser","SwitchCompletionLetter"]}),ti=i.InstrumentationOfficialLetterType,o({name:"InstrumentationPagingAction",args:["FirstPage","PreviousPage","NextPage","LastPage","GotoMenu"]});var wt=i.InstrumentationPagingAction,g={},nt=i.MessageActionType,tt=y;g[nt.None]=tt.NewMessage,g[nt.Reply]=tt.Reply,g[nt.Forward]=tt.Forward,g[nt.ReplyAll]=tt.ReplyAll,g[nt.ResumeDraft]=tt.ResumeDraft,g[nt.Accept]=tt.MeetingResponse,g[nt.Decline]=tt.MeetingResponse,g[nt.Tentative]=tt.MeetingResponse,d={},d[p.billsFltid]=!0,d[p.officeDocsFltid]=!0,d[p.familyFltid]=!0,d[p.importantFltid]=!0,d[p.photosFltid]=!0,d[p.shippingFltid]=!0,d[p.shoppingFltid]=!0,d[p.travelFltid]=!0,yi.instrumentation=li({shared:ri({types:{EntryPoint:t({values:[a.Canvas,a.MessagePartMenu,a.CommandBar,a.KeyboardShortcut,a.HoverMenu,a.ContextMenu,a.InstantAction,a.Notification,a.MessageBody,a.MessageList,a.LeftNav,a.RightRail,a.DragAndDrop,a.IdentityControl,a.RRU,a.Other]}),View:t({name:"dv",values:[it.ReadingPane,it.ReadView,it.MessageList,it.Compose,it.Other],src:function(n){return f.Instrumentation.query(n.queries,{type:"pageModel",key:"view"})}}),ReadingPaneMode:t({name:"drp",values:[kt.Off,kt.Right,kt.Bottom],src:function(n){return f.Instrumentation.query(n.queries,{type:"pageModel",key:"readingPaneMode"})}}),Folder:t({values:[h.Inbox,h.Archive,h.Junk,h.Drafts,h.Sent,h.Deleted,h.MessagingHistory,h.Search,h.Custom,h.None]}),TargetFolder:t({name:"dtf",values:[h.Inbox,h.Archive,h.Junk,h.Drafts,h.Sent,h.Deleted,h.MessagingHistory,h.Search,h.Custom]}),CurrentFolder:t({name:"do",type:"Folder",src:function(n){return f.Instrumentation.query(n.queries,{type:i.QueryType.MessageGroupQuery,containerType:i.ContainerType.Folders,key:"folder"})}}),FilterOrCategory:t({name:"df",values:[e.Unread,e.Bills,e.Contacts,e.Documents,e.Family,e.Flagged,e.Groups,e.Important,e.Newsletters,e.Photos,e.ShippingUpdates,e.Shopping,e.SocialUpdates,e.Travel,e.EverythingElse,e.Custom,e.None]}),TargetFilterOrCategory:t({name:"dta",values:[e.Unread,e.Bills,e.Contacts,e.Documents,e.Family,e.Flagged,e.Groups,e.Important,e.Newsletters,e.Photos,e.ShippingUpdates,e.Shopping,e.SocialUpdates,e.Travel,e.EverythingElse,e.Custom]}),CurrentFilter:t({type:"FilterOrCategory",src:function(n){return f.Instrumentation.query(n.queries,{type:i.QueryType.MessageGroupQuery,containerType:i.ContainerType.Folders,key:"filter"})}}),CurrentQuickView:t({name:"dq",type:"FilterOrCategory",src:function(n){return f.Instrumentation.query(n.queries,{type:"pageModel",key:"quickView"})}}),Sort:t({name:"ds",src:function(n){return f.Instrumentation.query(n.queries,{type:i.QueryType.MessageGroupQuery,containerType:i.ContainerType.Folders,key:"sort"})},values:[rt.Date,rt.From,rt.Subject,rt.Size,rt.Conversation]}),SortDirection:t({name:"dsd",src:function(n){return f.Instrumentation.query(n.queries,{type:i.QueryType.MessageGroupQuery,containerType:i.ContainerType.Folders,key:"sortDirection"})},values:[ui.Ascending,ui.Descending]}),Priority:t({name:"dy",values:[bt.High,bt.Normal,bt.Low]}),ComposeAction:t({name:"dca",values:[y.NewMessage,y.Reply,y.ReplyAll,y.Forward,y.ResumeDraft,y.RRU,y.MeetingResponse]}),UndoAction:t({name:"dau",values:[c.Delete,c.Move,c.Archive,c.Junk,c.NotJunk,c.Flag,c.UnFlag,c.AddCategory,c.RemoveCategory,c.MarkRead,c.MarkUnread,]}),AttachmentCount:t({name:"dac",type:"number",src:function(n){return n.cmd.args.attachmentIds?n.cmd.args.attachmentIds.length:0}}),RecipientCount:t({name:"drc",type:"number",src:function(n){return ft(n,"to")+ft(n,"cc")+ft(n,"bcc")}}),MessagePriority:t({type:"Priority",src:function(n){return f.Instrumentation.priorityFromImportance(n.cmd.args.priority)}}),MessageLength:t({name:"dml",type:"number",src:function(n){return n.cmd.args.messageLength}}),MessagePartIndex:t({name:"dmpi",type:"number"}),MessageListPage:t({name:"dp",type:"number",src:function(n){return f.Instrumentation.query(n.queries,{type:"pageModel",key:"messageListPage"})}}),ConversationThreadingState:t({name:"dn",type:"boolean",src:function(n){return f.Instrumentation.query(n.queries,{type:"pageModel",key:"conversationMode"})}}),SelectedMessageCount:t({name:"dc",type:"number",src:function(n){return f.Instrumentation.query(n.queries,{type:"pageModel",key:"selectionCount"})}}),UpsellEvent:t({name:"UpsellEvent",type:"number",src:function(n){return n.cmd.args.UpsellEvent},values:[i.UpsellEvent.Show,i.UpsellEvent.ExitNext,i.UpsellEvent.ExitDismiss,i.UpsellEvent.CreatedAlias,i.UpsellEvent.NotCreatedAlias]}),UpsellDomain:t({name:"UpsellDomain",type:"string",src:function(n){return n.cmd.args.UpsellDomain}}),IsInlineReply:t({name:"diir",type:"boolean",src:function(n){return!n.cmd.args.isFullCompose}})},datapointCollections:{Common:[t({type:"number",name:"dw",src:function(){return f.Instrumentation.windowWidth()}}),t({type:"number",name:"dh",src:function(){return f.Instrumentation.windowHeight()}}),t({type:"number",name:"di",src:function(n){var t=f.Instrumentation.query(n.queries,{type:"pageModel",key:"browserScreenUsage"});return t&&t.height}}),t({type:"number",name:"dg",src:function(n){var t=f.Instrumentation.query(n.queries,{type:"pageModel",key:"browserScreenUsage"});return t&&t.width}})],CommonUIWithoutView:[t({ref:"Common"}),t({type:"EntryPoint",name:"de",src:function(n){return n.cmd.args.entryPoint}})],CommonUI:[t({ref:"CommonUIWithoutView"}),t({type:"View"})],CommonMessageWithoutView:[t({ref:"CommonUIWithoutView"}),t({name:"da",type:"number",src:function(n){var i=0,t=w(n).timestampInMillisecondsSinceEpoch,r;return t!==null&&t!==undefined&&(t=f.data.canonicalizeDate(t),r=(new Date).getTime()-t,i=Math.round(r/pi)),i}}),t({type:"SelectedMessageCount"}),t({name:"dcc",type:"number",src:function(n){return w(n).count}}),t({name:"dcg",type:"boolean",src:function(n){return ii(n,p.mailingListgroupsFltid)}}),t({name:"dcn",type:"boolean",src:function(n){return ii(n,p.newslettersFltid)}}),t({name:"dcp",type:"boolean",src:function(n){for(var i=w(n).categories,t=0;t<i.length;t++)if(f.vm.Container.isPersonalCategory(i[t]))return!0;return!1}}),t({name:"dco",type:"boolean",src:function(n){for(var i=w(n).categories,t=0;t<i.length;t++)if(oi(i[t]))return!0;return!1}}),t({name:"dcs",type:"boolean",src:function(n){return ii(n,p.socialFltid)}}),t({name:"dfw",type:"boolean",src:function(n){return w(n).forwarded}}),t({name:"dha",type:"boolean",src:function(n){return w(n).hasAttachments}}),t({name:"dl",type:"boolean",src:function(n){return w(n).flagged}}),t({name:"dm",type:"boolean",src:function(n){return ii(n,p.contactsFltid)}}),t({type:"ConversationThreadingState"}),t({type:"CurrentQuickView"}),t({name:"dr",type:"boolean",src:function(n){return w(n).replied}}),t({type:"ReadingPaneMode"}),t({type:"Sort"}),t({type:"SortDirection"}),t({name:"dt",type:"boolean",src:function(n){return w(n).trustedSender}}),t({name:"du",type:"boolean",src:function(n){return!w(n).read}}),t({name:"dx",type:"number",src:function(n){return w(n).indexInList}}),t({type:"Priority",src:function(n){return w(n).priority}}),t({name:"dxs",type:"number",src:function(n){return w(n).indexInSection}}),t({type:"MessagePartIndex",src:function(n){return n.cmd.args.entryPoint==a.MessagePartMenu?w(n).partIndex:f.Instrumentation.datapointNotProvided()}}),t({type:"CurrentFolder"}),t({type:"CurrentFilter"}),t({type:"MessageListPage"})],CommonMessage:[t({ref:"CommonMessageWithoutView"}),t({type:"View"})],AttachmentInfo:[t({name:"dfx",type:"string",src:function(n){var i=n.cmd.args.files[n.batchIndex],t=i&&i.extension,r;return t||(t=i.name||"",r=t.lastIndexOf("."),t=r!=-1?t.substring(r+1):"&N&"),t}}),t({name:"dfs",type:"number",src:function(n){var t=n.cmd.args.files[n.batchIndex];return typeof(t&&t.size)=="undefined"?0:Math.ceil(t.size/1024)}}),t({name:"dns",type:"number",src:function(n){return n.cmd.args.numSelected}})],MessageSelection:[t({type:"CurrentFilter"}),t({type:"CurrentFolder"}),t({type:"CurrentQuickView"}),t({type:"MessageListPage"}),t({type:"ReadingPaneMode"}),t({type:"Sort"}),t({type:"SortDirection"}),t({type:"ConversationThreadingState"})]}}),actions:{"a.c":u({conditions:[r({command:"begincomposesession",filters:[{cmdArg:"action",equals:"newmessage"}],when:l.AlwaysAfter,datapoints:[t({ref:"CommonUIWithoutView"}),t({type:"View",src:function(n){return n.cmd.args.curView}})]}),r({command:"initiatecompose",filters:[{cmdArg:"entryPoint",equals:a.RRU}],when:l.AlwaysAfter,datapoints:[t({ref:"CommonUIWithoutView"})]}),r({command:"begincomposesession",filters:[{cmdArg:"action",notEquals:"newmessage"},{cmdArg:"msgInst"}],when:l.AlwaysAfter,datapoints:[t({ref:"CommonMessageWithoutView"}),t({type:"IsInlineReply"}),t({type:"View",src:function(n){return n.cmd.args.curView}})]})],datapoints:[t({type:"ComposeAction",src:function(n){return ai[n.cmd.args.action]}}),t({name:"ddl",type:"boolean",src:function(n){return!n.cmd.args.composeLoaded}})]}),Search:u({conditions:[r({command:"search"})],datapoints:[t({ref:"CommonUI"}),t({type:"ReadingPaneMode"}),t({name:"dso",src:function(n){return n.cmd.args.searchOrigin},values:[v.SearchBox,v.SuggestionContact,v.SuggestionCategory,v.SuggestionPinnedCategory,v.SuggestionSmartAttachment,v.SuggestionSmartFrom,v.SuggestionSmartSentTo,v.SuggestionSmartSubject,v.FilterBarAttachment,v.FilterBarCategory,v.FilterBarDate,v.FilterBarFolder,v.FilterBarReset,v.AdvancedSearch,v.FindAllFromSender,v.FindAllInContainer]}),t({name:"dsctx",src:function(n){return n.cmd.args.searchContext},values:[ct.Inbox,ct.Folder,ct.Category,ct.SearchResults]}),t({name:"dsid",type:"boolean",src:function(n){return!!n.cmd.args.searchIncludesDeleted}})]}),"ReadView.Messaging.Mail":u({conditions:[r({command:"nav.message",filters:[{cmdArg:"msgInst"}],when:l.AfterSuccess}),r({command:"instrument.readmessage"})],datapoints:[t({ref:"CommonMessage"}),t({name:"dic",type:"boolean",src:function(n){return!!n.inCache}})]}),"Send.Messaging.Mail":u({conditions:[r({command:"sendmessage",when:l.AfterSuccess})],datapoints:[t({ref:"CommonUI"}),t({type:"ComposeAction",src:function(n){return g[n.cmd.args.composeActionType]}}),t({type:"AttachmentCount"}),t({type:"RecipientCount"}),t({type:"MessagePriority"}),t({type:"MessageLength"}),t({type:"IsInlineReply"}),t({name:"dtc",type:"number",src:function(n){return ft(n,"to")}}),t({name:"dccc",type:"number",src:function(n){return ft(n,"cc")}}),t({name:"dbcc",type:"number",src:function(n){return ft(n,"bcc")}}),t({name:"diic",type:"number",src:function(n){return n.cmd.args.inlineImageCount}}),t({name:"dsdl",type:"number",src:function(n){return n.cmd.args.shareSkyDriveNumFiles}}),t({name:"ddtw",values:[lt.RichText,lt.PlainText],src:function(n){return n.cmd.args.sendByPlainText?lt.PlainText:lt.RichText}}),t({name:"dmd",type:"string",src:function(n){return n.cmd.args.sendAsMailDomain}})]}),"Log.SwitchUX.Event":u({conditions:[r({command:"log.importaccount"})],datapoints:[t({name:"SwEvent",type:"number",src:function(n){return n.cmd.args.SwEvent},values:[i.SwitchEvent.Enter,i.SwitchEvent.Exit,i.SwitchEvent.Error,i.SwitchEvent.Select]}),t({name:"SwEnterInfo",type:"number",src:function(n){return n.cmd.args.SwEnterInfo},values:[i.SwitchEnterInfo.NotApplicable,i.SwitchEnterInfo.NotConnected,i.SwitchEnterInfo.ConnectedImported,i.SwitchEnterInfo.ConnectedNotImported,i.SwitchEnterInfo.YahooAutoForwarding,i.SwitchEnterInfo.GmailAutoForwarding,i.SwitchEnterInfo.OtherAutoForwarding,i.SwitchEnterInfo.NoAutoForwarding]}),t({name:"SwSelectInfo",type:"number",src:function(n){return n.cmd.args.SwSelectInfo},values:[i.SwitchSelectInfo.NotApplicable,i.SwitchSelectInfo.Close,i.SwitchSelectInfo.Next,i.SwitchSelectInfo.Options,i.SwitchSelectInfo.External,i.SwitchSelectInfo.Gmail,i.SwitchSelectInfo.Imap,i.SwitchSelectInfo.Pop,i.SwitchSelectInfo.Mmt,i.SwitchSelectInfo.Yahoo,i.SwitchSelectInfo.Stop,i.SwitchSelectInfo.StatusDropdown,i.SwitchSelectInfo.StatusLetter]}),t({name:"SwExitInfo",type:"number",src:function(n){return n.cmd.args.SwExitInfo},values:[i.SwitchExitInfo.NotApplicable,i.SwitchExitInfo.ImportGmail,i.SwitchExitInfo.ConnectAdd,i.SwitchExitInfo.ConnectEdit,i.SwitchExitInfo.PopAgg,i.SwitchExitInfo.ImportImapBasic,i.SwitchExitInfo.ImportImapAdvanced,i.SwitchExitInfo.ImportYahoo,i.SwitchExitInfo.PopSuggestion,i.SwitchExitInfo.ImportClients,i.SwitchExitInfo.Congrats,i.SwitchExitInfo.StopConfirmation]}),t({name:"SwEventInfo",type:"string",src:function(n){return n.cmd.args.SwEventInfo}}),t({name:"SwState",type:"number",src:function(n){return n.cmd.args.SwState},values:[i.SwitchState.Unknown,i.SwitchState.ImportTop,i.SwitchState.CapacityLimit,i.SwitchState.ImportGmail,i.SwitchState.ConnectAdd,i.SwitchState.ConnectEdit,i.SwitchState.PopAgg,i.SwitchState.ImportImapBasic,i.SwitchState.ImportImapAdvanced,i.SwitchState.ImportYahoo,i.SwitchState.PopSuggestion,i.SwitchState.ImportClients,i.SwitchState.ImportGmailStart,i.SwitchState.CongratsPopup,i.SwitchState.StopPopup,i.SwitchState.StatusPopup,i.SwitchState.Inbox]}),t({name:"SwPrevState",type:"number",optional:!0,src:function(n){return n.cmd.args.SwPrevState},values:[i.SwitchState.Unknown,i.SwitchState.ImportTop,i.SwitchState.CapacityLimit,i.SwitchState.ImportGmail,i.SwitchState.ConnectAdd,i.SwitchState.ConnectEdit,i.SwitchState.PopAgg,i.SwitchState.ImportImapBasic,i.SwitchState.ImportImapAdvanced,i.SwitchState.ImportYahoo,i.SwitchState.PopSuggestion,i.SwitchState.ImportClients,i.SwitchState.ImportGmailStart,i.SwitchState.CongratsPopup,i.SwitchState.StopPopup,i.SwitchState.StatusPopup,i.SwitchState.Inbox]}),t({name:"SwEntryID",type:"number",optional:!0,src:function(n){return n.cmd.args.SwEntryID}})]}),"Log.UpsellAlias.Event":u({conditions:[r({command:"log.aliasupsell"})],datapoints:[t({name:"UpsellType",type:"number",src:function(n){return n.cmd.args.UpsellType},values:[i.UpsellType.AliasInterrupt,i.UpsellType.AliasSuperbar,i.UpsellType.SwitchDialog,i.UpsellType.SwitchSuperbarGmail,i.UpsellType.SwitchSuperbarGeneric]}),t({type:"UpsellEvent"}),t({type:"UpsellDomain"})]}),"Log.UpsellAutoForward.Event":u({conditions:[r({command:"log.upsellautoforward"})],datapoints:[t({type:"UpsellEvent"}),t({type:"UpsellDomain"})]}),"A.Spscn":u({conditions:[r({command:"curtaindown"})],datapoints:[t({name:"dsplscnt",type:"number",src:function(n){return n.cmd.args.state},values:[ni.NoSpinner,ni.SpinnerNoText,ni.SpinnerWithText]})]}),"DeleteRemove.Messaging.Mail":u({conditions:[r({command:"moveitems",filters:[{cmdArg:"destId",equals:"fltrash"}],batch:"items",when:l.AlwaysAfter})],datapoints:[t({ref:"CommonMessage"})]}),"a.afre":u({conditions:[r({command:"instrument.aliasdefaultfrom"})],datapoints:[t({name:"ddfc",type:"boolean",src:function(n){return n.cmd.args.defaultFrom}})]}),"a.armr":u({conditions:[r({command:"nav.managerules"})],datapoints:[t({ref:"CommonUIWithoutView"})]}),"a.armrc":u({conditions:[r({command:"instrument.managerulesaction"})],datapoints:[t({name:"daroa",values:[gt.MoveRuleUp,gt.MoveRuleDown,gt.DeleteRule],src:function(n){return n.cmd.args.userAction}})]}),"a.arent":u({conditions:[r({command:"createrule"}),r({command:"editrule"})],datapoints:[t({ref:"CommonUIWithoutView"}),t({type:"SelectedMessageCount"}),t({type:"CurrentFolder"})]}),"a.arene":u({conditions:[r({command:"instrument.canteditrule"})],datapoints:[]}),"a.gtp":u({conditions:[r({command:"ml.change",filters:[{cmdArg:"changeAction",notEquals:undefined}]})],datapoints:[t({ref:"CommonUI"}),t({name:"dpga",values:[wt.FirstPage,wt.PreviousPage,wt.NextPage,wt.LastPage,wt.GotoMenu],src:function(n){return n.cmd.args.changeAction}}),t({name:"ddtd",type:"number",src:function(n){var t=n.cmd.args.payload;return t||-1}})]}),"a.arex":u({conditions:[r({command:"instrument.editrule"})],datapoints:[t({name:"darea",values:[at.Cancel,at.CreateRule,at.CreateRuleAndRun,at.SaveExistingRule],src:function(n){return n.cmd.args.exitAction}}),t({name:"darcc",type:"number",src:function(n){return n.cmd.args.conditionCount}}),t({name:"darac",type:"number",src:function(n){return n.cmd.args.actionCount}})]}),"a.can":u({conditions:[r({command:"endcomposesession",filters:[{cmdArg:"messageSent",notEquals:!0}]}),r({command:"instrument.escapecancelcomposesession"})],datapoints:[t({ref:"CommonUI"}),t({type:"IsInlineReply"}),t({name:"dcan",values:[dt.Discard,dt.Save,dt.Escape],src:function(n){return n.cmd.args.cancelAction}})]}),"a.pri":u({conditions:[r({command:"instrument.changepriority"})],datapoints:[t({ref:"CommonUI"}),t({type:"IsInlineReply"}),t({name:"dny",type:"Priority",src:function(n){return n.cmd.args.newPriority}})]}),"a.ft":u({conditions:[r({command:"instrument.formattext"})],datapoints:[t({ref:"CommonUI"}),t({type:"IsInlineReply"}),t({name:"dfa",values:[s.Bold,s.RemoveBold,s.Italics,s.RemoveItalics,s.Underline,s.RemoveUnderline,s.FontType,s.FontSize,s.FontColor,s.Highlight,s.RemoveHighlight,s.NumberedList,s.RemoveNumberedList,s.BulletedList,s.RemoveBulletedList,s.IndentLeft,s.IndentRight,s.LeftAlign,s.CenterAlign,s.RightAlign,s.InsertLink],src:function(n){return n.cmd.args.formatAction}})]}),"a.ia":u({conditions:[r({command:"instrument.insertattachments",batch:"files"})],datapoints:[t({ref:"CommonUI"}),t({ref:"AttachmentInfo"}),t({type:"IsInlineReply"})]}),"a.isky":u({conditions:[r({command:"instrument.insertfromskydrive",batch:"files"})],datapoints:[t({ref:"CommonUI"}),t({ref:"AttachmentInfo"}),t({type:"IsInlineReply"})]}),"a.ii":u({conditions:[r({command:"instrument.insertinlineimages",batch:"files"})],datapoints:[t({ref:"CommonUI"}),t({ref:"AttachmentInfo"}),t({type:"IsInlineReply"})]}),"a.s":u({conditions:[r({command:"savedraft"})],datapoints:[t({ref:"CommonUI"}),t({type:"AttachmentCount"}),t({type:"RecipientCount"}),t({type:"MessagePriority"}),t({type:"MessageLength"}),t({type:"IsInlineReply"}),t({name:"das",type:"boolean",src:function(n){return n.cmd.args.isAutoSave}})]}),"a.spchk":u({conditions:[r({command:"instrument.spellcheck"})],datapoints:[t({ref:"CommonUI"}),t({type:"IsInlineReply"})]}),"a.ac":u({conditions:[r({command:"addcontacts"})],datapoints:[t({ref:"CommonUI"}),t({name:"dcad",type:"number",src:function(n){return n.cmd.args.contactsToAdd.length}})]}),"a.o":u({conditions:[r({command:"nav.container",filters:[{cmdArg:"dontInstrument",notEquals:!0},{cmdArg:"selectedContainer",test:function(n){return n.isFolder()}}],when:l.AlwaysAfter})],datapoints:[t({ref:"CommonUI"}),t({type:"TargetFolder",src:function(n){return f.Instrumentation.folderMapping(n.cmd.args.selectedContainer.Id)}})]}),"a.q":u({conditions:[r({command:"nav.container",filters:[{cmdArg:"dontInstrument",notEquals:!0},{cmdArg:"selectedContainer.IsQuickview",equals:!0}],when:l.AlwaysAfter})],datapoints:[t({ref:"CommonUI"}),t({type:"TargetFilterOrCategory",src:function(n){return f.Instrumentation.filterMapping(n.cmd.args.selectedContainer.Id)}})]}),"a.cc":u({conditions:[r({command:"addupdatedeletecategories",filters:[{cmdArg:"categoriesToAdd",test:fi}],batch:"categoriesToAdd"})],datapoints:[t({ref:"CommonUI"})]}),"a.cd":u({conditions:[r({command:"addupdatedeletecategories",filters:[{cmdArg:"categoriesToDelete",test:fi}],batch:"categoriesToDelete"})],datapoints:[t({ref:"CommonUI"})]}),"a.cr":u({conditions:[r({command:"addupdatedeletecategories",filters:[{cmdArg:"categoriesToUpdate",test:fi}],batch:"categoriesToUpdate"})],datapoints:[t({ref:"CommonUI"})]}),"a.fc":u({conditions:[r({command:"addfolder"})],datapoints:[t({ref:"CommonUI"}),t({name:"dnl",type:"number",src:function(n){return n.cmd.args.folderDepth}})]}),"a.fd":u({conditions:[r({command:"deletefolder"})],datapoints:[t({ref:"CommonUI"})]}),"a.fr":u({conditions:[r({command:"updatefolder",filters:[{cmdArg:"isRename",equals:!0}]})],datapoints:[t({ref:"CommonUI"})]}),"a.fo":u({conditions:[r({command:"movefolder"})],datapoints:[t({ref:"CommonUI"}),t({name:"dnlo",type:"number",src:function(n){return n.cmd.args.oldDepth}}),t({name:"dnln",type:"number",src:function(n){return n.cmd.args.newDepth}})]}),"a.p":u({conditions:[r({command:"instrument.print"})],datapoints:[t({ref:"CommonMessage"})]}),"a.vms":u({conditions:[r({command:"instrument.viewsource"})],datapoints:[t({ref:"CommonMessage"})]}),"a.f":u({conditions:[r({command:"instrument.filter"})],datapoints:[t({ref:"CommonUI"}),t({type:"CurrentFilter",src:function(n){return f.Instrumentation.filterMapping(n.cmd.args.fId)}})]}),"a.ec":u({conditions:[r({command:"instrument.webimexpandcollapse"})],datapoints:[t({ref:"CommonUI"}),t({name:"dexcl",values:[yt.Collapse,yt.Expand],src:function(n){return n.cmd.args.expanded?yt.Expand:yt.Collapse}})]}),"a.l":u({conditions:[r({command:"flagitems",batch:"items"})],datapoints:[t({ref:"CommonMessage"}),t({name:"dla",values:[vt.Flag,vt.Unflag],src:function(n){return n.cmd.args.asFlagged?vt.Flag:vt.Unflag}})]}),"a.mfbh":u({conditions:[r({command:"compromiseitems",batch:"items"})],datapoints:[t({ref:"CommonMessage"})]}),"a.j":u({conditions:[r({command:"junkitems",batch:"items"}),r({command:"moveitems",filters:[{cmdArg:"destId",equals:"fljunk"}],batch:"items"})],datapoints:[t({ref:"CommonMessage"})]}),"a.nj":u({conditions:[r({command:"unjunkitems",batch:"items"}),r({command:"moveitems",filters:[{cmdArg:"destId",notEquals:"fltrash"},{cmdArg:"items",test:function(n){if(n)for(var t=0;t<n.length;t++)if(n[t].viewId===f.config.sysFldrs.junkFid)return!0;return!1}}],batch:"items"})],datapoints:[t({ref:"CommonMessage"})]}),"a.k":u({conditions:[r({command:"markitems",filters:[{cmdArg:"dontInstrument",notEquals:!0}],batch:"items",when:l.AlwaysAfter})],datapoints:[t({ref:"CommonMessage"}),t({name:"dma",values:[pt.MarkAsRead,pt.MarkAsUnread],src:function(n){return n.cmd.args.asRead?pt.MarkAsRead:pt.MarkAsUnread}})]}),"a.ph":u({conditions:[r({command:"phishitems",batch:"items"})],datapoints:[t({ref:"CommonMessage"})]}),"a.a":u({conditions:[r({command:"moveitems",filters:[{cmdArg:"toArchive",equals:!0}],batch:"items",when:l.AlwaysAfter})],datapoints:[t({ref:"CommonMessage"})]}),"a.ca":u({conditions:[r({command:"categorizeitems",batch:"items"})],datapoints:[t({ref:"CommonMessage"}),t({name:"dnca",type:"number",src:function(n){var t=n.cmd.args.apply;return t?t.length:0}}),t({name:"dncr",type:"number",src:function(n){var t=n.cmd.args.remove;return t?t.length:0}}),t({name:"dccg",values:ut,src:function(n){return ei(n.cmd.args,i.FilterType.MailingList)}}),t({name:"dccn",values:ut,src:function(n){return ei(n.cmd.args,i.FilterType.Newsletters)}}),t({name:"dccp",values:ut,src:function(n){var r=n.cmd.args.apply,i,t;if(r&&r.length)for(t=0;t<r.length;t++)if(f.vm.Container.isPersonalCategory(r[t]))return b.Added;if(i=n.cmd.args.remove,i&&i.length)for(t=0;t<i.length;t++)if(f.vm.Container.isPersonalCategory(i[t]))return b.Removed;return b.NoChange}}),t({name:"dcco",values:ut,src:function(n){var r=n.cmd.args.apply,i,t,u;if(r&&r.length)for(t=0;t<r.length;t++)if(oi(r[t]))return b.Added;if(i=n.cmd.args.remove,i&&i.length)for(t=0;t<i.length;t++)if(u=i[t],oi(i[t]))return b.Removed;return b.NoChange}}),t({name:"dccs",values:ut,src:function(n){return ei(n.cmd.args,i.FilterType.SocialUpdates)}})]}),"a.m":u({conditions:[r({command:"moveitems",filters:[{cmdArg:"destId",notEquals:"fljunk"},{cmdArg:"toArchive",notEquals:!0},{cmdArg:"destId",notEquals:"fltrash"},{cmdArg:"items",test:function(n){var i=!0,t;if(n)for(t=0;t<n.length;t++)n[t].viewId===f.config.sysFldrs.junkFid&&(i=!1);return i}}],batch:"items"})],datapoints:[t({ref:"CommonMessage"}),t({type:"TargetFolder",src:function(n){return f.Instrumentation.folderMapping(n.cmd.args.destId)}})]}),"a.sa":u({conditions:[r({command:"sel.bulk"})],datapoints:[t({ref:"CommonUI"}),t({ref:"MessageSelection"})]}),"a.sp":u({conditions:[r({command:"ml.toggleselectallmessages",filters:[{cmdArg:"selectAllMessages",equals:!0}]})],datapoints:[t({ref:"CommonUI"}),t({ref:"MessageSelection"}),t({type:"SelectedMessageCount"})]}),"a.fe":u({conditions:[r({command:"emptyfolder",datapoints:[t({type:"TargetFolder",src:function(n){return f.Instrumentation.folderMapping(n.cmd.args.folderId)}})]}),r({command:"batchmoveitems",filters:[{cmdArg:"destId",test:vi},{cmdArg:"fromFid",notEquals:et.noneFid},{cmdArg:"batchInfo.SenderSearch",test:bi},{cmdArg:"quickViewId",equals:p.noneFltid}],datapoints:[t({type:"TargetFolder",src:function(n){return f.Instrumentation.folderMapping(n.cmd.args.fromFid)}})]})],datapoints:[t({ref:"CommonUI"})]}),"a.ce":u({conditions:[r({command:"batchmoveitems",filters:[{cmdArg:"destId",test:vi},{cmdArg:"quickViewId",notEquals:p.noneFltid},{cmdArg:"fromFid",equals:et.noneFid}]})],datapoints:[t({ref:"CommonUI"}),t({type:"TargetFilterOrCategory",src:function(n){return f.Instrumentation.filterMapping(n.cmd.args.quickViewId)}})]}),"a.fmr":u({conditions:[r({command:"batchmarkitems",filters:[{cmdArg:"batchInfo.FolderId",notEquals:et.noneFid},{cmdArg:"readState",equals:!0}]})],datapoints:[t({ref:"CommonUI"}),t({type:"TargetFolder",src:function(n){return f.Instrumentation.folderMapping(n.cmd.args.batchInfo.FolderId)}})]}),"a.cmr":u({conditions:[r({command:"batchmarkitems",filters:[{cmdArg:"batchInfo.QuickViewId",notEquals:p.noneFltid},{cmdArg:"readState",equals:!0}]})],datapoints:[t({ref:"CommonUI"}),t({type:"TargetFilterOrCategory",src:function(n){return f.Instrumentation.filterMapping(n.cmd.args.batchInfo.QuickViewId)}})]}),"a.undo":u({conditions:[r({command:"undomoveitems",when:l.AlwaysAfter,datapoints:[t({type:"UndoAction",src:function(n){return n.cmd.args.undoMoveInstrumentation}})]}),r({command:"undomarkitems",when:l.AlwaysAfter,datapoints:[t({type:"UndoAction",src:function(n){return n.cmd.args.asRead?c.MarkUnread:c.MarkRead}})]}),r({command:"undocategorizeitems",when:l.AlwaysAfter,datapoints:[t({type:"UndoAction",src:function(n){return n.cmd.args.apply.length>0?c.RemoveCategory:c.AddCategory}})]}),r({command:"undoflagitems",when:l.AlwaysAfter,datapoints:[t({type:"UndoAction",src:function(n){return n.cmd.args.asFlagged?c.UnFlag:c.Flag}})]}),r({command:"undojunkandunjunkitems",when:l.AlwaysAfter,datapoints:[t({type:"UndoAction",src:function(n){return n.cmd.args.jmrType===i.JmrType.NotJunk?c.Junk:c.NotJunk}})]})],datapoints:[t({ref:"CommonUI"}),t({name:"diau",type:"number",src:function(n){return n.cmd.args.items.length}})]}),"ReadView.WelcomeLetterOpen":u({conditions:[r({command:"instrument.readmessagebici",filters:[{cmdArg:"bici.OfficialLetterType"}]})],datapoints:[t({name:"OptInState",values:[k.None,k.NewMetroSignup,k.ManualOptIn,k.OptInViaProtocols,k.OptInViaHotmail,k.OptInViaExternalLink,k.ForceMigrated,k.OptOutThenForceMigrated,k.OptOut],src:function(n){return n.cmd.args.bici.OptInState}}),t({name:"WelcomeLetterType",values:[ti.WelcomeLetterForNewMetroUser,ti.WelcomeLetterForOptInUser,ti.WelcomeLetterForForceMigratedUser],src:function(n){return n.cmd.args.bici.OfficialLetterType}})]})}})}(window.originaljQuery||window.jQuery),function(n){"use strict";var t=window.ol=window.ol||{},r=t.data=t.data||{},i=function(){function lt(n,r){switch(r){case"sort":var u=HM.InstrumentationSort.Date;return n&&(u=n.sortType===HM.SortBy.Date?t.config.userPreferences.ConversationThreading?HM.InstrumentationSort.Conversation:HM.InstrumentationSort.Date:y[n.sortType]),u;case"sortDirection":return n?it[n.sortOrder]:HM.InstrumentationSortDirection.Descending;case"folder":return n?i.folderMapping(n.containerId):HM.InstrumentationFolder.Inbox;case"filter":return n?i.filterMapping(n.filterId===null?HM.FilterType.None:n.filterId):HM.InstrumentationFilter.None}}function et(n){var r,a,u,o,c,l,f;switch(n){case"view":return r=HM.InstrumentationView.Other,t.pages.pageManager.getCurrentView()===t.config.pageManager.manifests.Compose.name?r=HM.InstrumentationView.Compose:e&&(r=e.layout().IsFullView?HM.InstrumentationView.ReadView:e.layout().isReadingPaneOn()?HM.InstrumentationView.ReadingPane:HM.InstrumentationView.MessageList),r;case"readingPaneMode":return a=e&&e.layout().readingPaneMode(),u=p[a],typeof u=="undefined"&&(u=HM.InstrumentationReadingPaneMode.None),u;case"messageListPage":return o=e?e.messageList().getPageNumber():null,o===null?-1:o;case"browserScreenUsage":if(w===null){var v=i.windowWidth(),y=i.windowHeight(),s=screen.width,h=screen.height;ht&&(c=window.top,l=c.outerWidth/c.innerWidth,s=Math.round(s/l),h=Math.round(h/l)),w={width:Math.round(v/s*100),height:Math.round(y/h*100)}}return w;case"conversationMode":return t.config.userPreferences.ConversationThreading;case"quickView":return f=e?e.messageList().queryContainer():null,f!==null&&f.isQuickview()?i.filterMapping(f.id()):HM.InstrumentationFilter.None;case"selectionCount":return e?e.messageList().selectedItems().length:0}}function at(n){return t.config.appSettings.shouldUseLazyLinking&&n&&n.settings&&n.settings.isLazyLinkedAction}function ot(n){var t=n&&n.glassAlreadyRecorded,i=n&&n.cmd;t||$CSIPerf.addTTxEvent("g",(new Date).getTime()),at(i)?setTimeout(function(){$CSIPerf.addTTxEvent("f",(new Date).getTime()),$CSIPerf.fireCsiPerfBeacon()},0):($CSIPerf.addTTxEvent("f",(new Date).getTime()),$CSIPerf.fireCsiPerfBeacon())}var i=this,e,w=null,vt=window.matchMedia||window.msMatchMedia,ft=!1,l=null,a=null,ht=$B.RE_WebKit,v=n(window.top),ct={},b,c;v.on("resize",function(){l=null,a=null,w=null});t.init&&t.init.NotifyLoad("App0").then(function(){setTimeout(function(){l=v.height(),a=v.width()},50)}),t.init&&t.init.resources&&t.init.resources.Compose0&&t.init.NotifyLoad("Compose0").then(function(){ft=!0}),i.getThreadInstrumentation=function(n){var t=n.categories();return{id:n.id(),categories:t!=null?t.slice(0):[],timestampInMillisecondsSinceEpoch:n.timestampInMillisecondsSinceEpoch(),count:n.count(),forwarded:n.forwarded(),hasAttachments:n.hasAttachments(),flagged:n.isFlagged(),read:n.isRead(),replied:n.replied(),trustedSender:n.isTrustedSender(),priority:i.priorityFromImportance(n.importance()),indexInSection:n.indexInSection(),indexInList:n.indexInList(),partIndex:n.partIndex()}},i.priorityFromImportance=function(n){return tt[n]},i.folderMapping=function(n){var t=o[n];return typeof t=="undefined"&&(t=HM.InstrumentationFolder.Custom),t},i.updateArchiveFolderId=function(n){b!==n&&(b&&delete o[b],n&&(o[n]=HM.InstrumentationFolder.Archive),b=n)},i.filterMapping=function(n){var t=r[n];return typeof t=="undefined"&&(t=HM.InstrumentationFilter.Custom),t},i.pagingMapping=function(n){return c[n]},i.currentView=function(){return et("view")},i.composeLoaded=function(){return ft},i.query=function(n,t){var f,i,r,u;switch(t.type){case HM.QueryType.MessageGroupQuery:for(i=null,r=0;r<n.length;r++)u=n[r],u.type===HM.QueryType.MessageGroupQuery&&t.containerType===u.containerType&&(i=u);i||(i=e?e.messageList().activeGroup().query():null),f=lt(i,t.key);break;case"pageModel":f=et(t.key)}return f},i.windowWidth=function(){return a===null&&(a=v.width()),a},i.windowHeight=function(){return l===null&&(l=v.height()),l},i.datapointNotProvided=function(){return ct},i.setVm=function(n){e=n},i.cancelCSIPerfScenario=function(n){var t=n.cmd;$CSIPerf.addCsd("TR","canceled."+t.name),$CSIPerf.dontFireOnLoad(),$BSI.informPVHead(),$BSI.informLoaded(),$CSIPerf.fireCsiPerfBeacon()},i.startCSIPerfScenario=function(n){i._pendingCSIPerfDeferred&&(i._pendingCSIPerfDeferred.reject(),i._pendingCSIPerfDeferred=null),t.Cmd("nav.cancelpendingcsiperfscenario").fire();var f=n.performanceId,r=n.tr,u=n.deferred;t.SetPerformanceId(f),i._pendingCSIPerfDeferred=u,u.then(function(){$CSIPerf.addCsd("TR",r),n.automaticallyEndScenario&&(i.endCSIPerfScenario(),i._pendingCSIPerfDeferred=null)},function(){i.cancelCSIPerfScenario({cmd:{name:r}}),i._pendingCSIPerfDeferred=null})},i.endCSIPerfScenario=function(n){var t=n&&n.cmd,r=n&&n.glassAlreadyRecorded,i;$CSIPerf.dontFireOnLoad(),$BSI.informPVHead(),$BSI.informLoaded(),i=t&&t.settings&&t.settings.renderDelay,i?setTimeout(function(){ot(n)},i):ot(n)};var o={},s=HM.InstrumentationFolder,h=t.config.sysFldrs;o[h.inboxFid]=s.Inbox,o[h.junkFid]=s.Junk,o[h.draftsFid]=s.Drafts,o[h.sentFid]=s.Sent,o[h.trashFid]=s.Deleted,o[h.chatsFid]=s.MessagingHistory,o[h.searchFid]=s.Search,c={},c["nav.firstpage"]=HM.InstrumentationPagingAction.FirstPage,c["nav.prevpage"]=HM.InstrumentationPagingAction.PreviousPage,c["nav.nextpage"]=HM.InstrumentationPagingAction.NextPage,c["nav.lastpage"]=HM.InstrumentationPagingAction.LastPage,c.gotopickerinitiatejump=HM.InstrumentationPagingAction.GotoMenu;var r={},u=HM.FilterType,f=HM.InstrumentationFilter;r[u.None]=f.None,r[u.UnreadMessages]=f.Unread,r[u.Bills]=f.Bills,r[u.FromContacts]=f.Contacts,r[u.Document]=f.Documents,r[u.Family]=f.Family,r[u.FlaggedMessages]=f.Flagged,r[u.MailingList]=f.Groups,r[u.Important]=f.Important,r[u.Newsletters]=f.Newsletters,r[u.Photos]=f.Photos,r[u.ShippingNotification]=f.ShippingUpdates,r[u.Shopping]=f.Shopping,r[u.SocialUpdates]=f.SocialUpdates,r[u.Travel]=f.Travel,r[u.Other]=f.EverythingElse;var y={},k=HM.SortBy,d=HM.InstrumentationSort;y[k.Sender]=d.From,y[k.Size]=d.Size,y[k.Subject]=d.Subject,y[k.Date]=d.Date;var it={},li=HM.MessageListKeyQuerySortOrder,st=HM.InstrumentationSortDirection;it[HM.MessageListKeyQuerySortOrder.Ascending]=st.Ascending,it[HM.MessageListKeyQuerySortOrder.Descending]=st.Descending;var p={},g=HM.InstrumentationReadingPaneMode,nt=HM.ReadingPaneLocation;p[nt.Off]=g.Off,p[nt.Right]=g.Right,p[nt.Bottom]=g.Bottom,p[nt.None]=g.Off;var tt={},rt=HM.ImportanceType,ut=HM.InstrumentationPriority;tt[rt.HIGH]=ut.High,tt[rt.NORMAL]=ut.Normal,tt[rt.LOW]=ut.Low};t.Instrumentation=new i}(window.originaljQuery||window.jQuery),function(){"use strict";var n=window.ol=window.ol||{},t=n.instrumentationUtils=n.instrumentationUtils||{};t.filterOutCircularReferences=function(n){var u,f,i,r,e,o,h;if(typeof n!="object"&&typeof n!="array")return function(){};for(u=[],f=[[n,[n]]];f.length>0;){var c=f.pop(),t=c[0],s=c[1];for(i in t)if(t.hasOwnProperty(i)&&typeof t[i]=="object"){for(r=t[i],e=!1,o=0;o<s.length&&!e;o++)e=s[o]===r;e?(t[i]="circular reference detected",function(n,t,i){u.push(function(){n[t]=i})}(t,i,r)):(h=s.slice(0),h.push(r),f.push([r,h]))}}return function(){while(u.length>0)u.pop()()}}}(),function(n){"use strict";var t=window.ol=window.ol||{},i=t.KeyboardHandler=function(i){function g(n){var u,e,o,h,i,c,a;return ft()?(n.ctrlKey||n.metaKey)&&n.altKey?(f(),!0):(u="",e=!1,n.ctrlKey||n.metaKey?(u="CTRL",e=!0):n.altKey&&(u="ALT",e=!0),n.shiftKey&&(u=u+"SHIFT"),o=n.keyCode,(o>=112&&o<=123||o===27)&&(e=!0),h=u+o,!it(e,n))?(f(),!0):(i=p(h),i==r.NOMATCH&&(c=s.length>1,f(),c&&(i=p(h),i==r.NOMATCH&&f())),i==r.MATCH?v&&(a=t.DismissNotifications(t.NotificationDismissalType.keyboard),v({e:n,event:n.originalEvent,name:l,srcElement:n.target,entryPoint:HM.InstrumentationEntryPoint.KeyboardShortcut,notificationsDismissed:a})&&(i=r.NOMATCH),f(),l=null):i==r.POTENTIALMATCH&&nt(),i==r.NOMATCH?!0:(n.stopPropagation(),n.preventDefault(),!1)):!0}function p(n){return s.push(n),w(y,0)}function w(n,t){return null==n?r.NOMATCH:"string"==typeof n?(l=n,r.MATCH):t>=s.length?r.POTENTIALMATCH:w(n[s[t]],t+1)}function nt(){u&&(clearTimeout(u),u=0),u=setTimeout(tt,e.timeout)}function tt(){f()}function f(){s=[],u&&(clearTimeout(u),u=0)}function it(n,t){return n||!e.ctrlAltOrFunctionKeyRequired&&!rt(t.srcElement)}function rt(n){var t=n.tagName?n.tagName.toUpperCase():"";return k.indexOf(["",t,""].join(","))>=0||"INPUT"==t&&ut(n)||n.isContentEditable||"on"==n.designMode||"HTML"==t&&n.document&&"on"==n.document.designMode}function ut(n){var t=n.type?n.type.toUpperCase():"";return d.indexOf(["",t,""].join(","))<0}function ft(){return a&&b()}var h=this,e=n.extend({},{handler:null,enabled:!1,sequenceTree:null,timeout:1e3,ctrlAltOrFunctionKeyRequired:!1},i);var b=e.handler.keyShortcutsEnabled,v=e.handler.onKeyShortcut,k=",BUTTON,SELECT,TEXTAREA,",d=",CHECKBOX,RADIO,",r=new $Enum("NOMATCH","MATCH","POTENTIALMATCH"),y=n.parseJSON(e.sequenceTree),l=null,u=0,c=$CD(h,g),o=[],s=[],a=e.enabled;f(),n(_d).bind("keydown",c),h.dispose=function(){for(var i,t=0;t<o.length;t++)i=o[t],i&&n(i).unbind("keydown.khb");o=[],c&&(n(_d).unbind("keydown",c),c=null),y=u=l=s=null},h.detachFromIframe=function(t){for(var r,i=0;i<o.length;i++)o[i]===t&&(r=t.contentWindow.document,n(r).unbind("keydown.kbh"))},h.attachToIframe=function(t){if(t&&t.contentWindow&&t.contentWindow.document){var i=t.contentWindow.document;n(i).bind("keydown.kbh",c),o.push(i)}},h.enabled=function(n){if(n===undefined)return a;a=n}};i.GetTooltip=function(n,i){if(!t.config.keyboardShortcuts.enabled)return n;var r=t.GetString("KeyboardShortcuts.{0}.{1}.Description".format(t.config.keyboardShortcuts.mode,i));return r?t.GetString("KeyboardShortcuts.Tooltip.Format").format(n,r):n}}(window.originaljQuery||window.jQuery),function(){"use strict";var n=window.ol=window.ol||{},t=n.KeyboardHandlerManager=function(){function i(t){var i=n[t];i&&(i.dispose(),delete n[t])}var t=this,n=[];t.dispose=function(){for(var t=0;t<n.length;t++)i(t);n=null},t.registerHandler=function(t,i){n[i]=t},t.unRegisterHandler=function(n){i(n)},t.enableHandler=function(t,i){var r=n[t];r&&r.enabled(i)},t.getHandler=function(t){return n[t]}}}(window.originaljQuery||window.jQuery),function(n){function tt(n,t){for(var i in n)typeof n[i]=="string"&&(t[i]=0)}function a(t,u){n(i).trigger(u,{eventName:u,item:t})}function c(t){n(i).trigger(t,{eventName:t})}function lt(n,i){var f,e,u;if(n&&i){for(n.action=i,f=-1,e=t.length,u=0;u<e;u++)if(!r.compare(n,t[u])){t.splice(u,0,n),f=u;break}f==-1&&t.push(n)}}function at(){var n=o.lifetime;t.length>n.maxLength&&(n.maxLength=t.length),n.totalItems++,t.length==1&&(e.timeEmpty+=new Date-e.lastEmptyBeginTime,e.lastEmptyBeginTime="invalid"),p&&c(f.onqueueuseractivitywhileconnectivitylost)}function w(n){var t=!1;return!h&&u.isWaiting(n.state)&&!n.isCancelled&&r.areDependentsDone(n)&&(y<nt?t=!0:y<ht&&(t=s.isView(n.actionType)||n.dependentView&&!n.dependentView.isCancelled&&u.isWaiting(n.dependentView.state))),t}function it(n){var t,i;w(n)&&(y++,n.state=u.executing,e.totalExecuted++,t=new Date-n.beginTime,e.totalWaitTime+=t,i=o.lifetime,t>i.maxWait&&(i.maxWait=t),i.avgWait=e.totalWaitTime/e.totalExecuted,a(n,f.onactionbeginexecution),setTimeout(function(){try{n.timeoutId=setTimeout(function(){u.isExecuting(n.state)&&(et(n,!1,!0),ft())},ct),n.action()}catch(t){(function(){st(n,!1,arguments)})();throw t;}},0))}function rt(){t.length==0&&(e.lastEmptyBeginTime=new Date,c(f.onqueueempty))}function ut(){for(var i,n=t.length-1;n>=0;n--)if(i=t[n],u.isWaiting(i.state)){if(!w(i))break;it(i)}}function vt(i){var o,e,s;return o=!1,e=i?i.item:null,e&&u.isCancellable(e.state)&&!e.isCancelled&&(s=n.inArray(e,t),s!=-1&&(u.isWaiting(e.state)&&t.splice(s,1),e.isCancelled=!0,a(e,f.onactioncancelled),rt(),o=!0)),o}function ft(){i.pause();var t=new g,r=g.Events;n(t).bind(r.onConnectivityLost,function(){p=!0,c(f.onqueueconnectivitylost)}),n(t).bind(r.onConnectivityFound,function(){p&&(p=!1,c(f.onqueueconnectivityrecovered)),i.resume()}),t.startCheck(k)}function et(i,e,s){var h=n.inArray(i,t);h!=-1&&(t.splice(h,1),rt()),u.isExecuting(i.state)&&(y--,s&&(i.state=u.abandoned,o.lifetime.abandoned++,a(i,f.onactionabandoned))),s||(i.timeoutId&&clearTimeout(i.timeoutId),i.state=u.done,i.success=e,o.lifetime.errors+=e?0:1,a(i,f.onactionendexecution)),i.timeoutId=null}function ot(n,t,i,u){i&&setTimeout(function(){i.apply(null,u)},0)}function yt(n,t,i){t&&ot(n,"callback",t,i),ut()}function pt(n,t,i){t&&ot(n,"error callback",t,i),ft()}function st(n,t,i){t=t&&!k,et(n,t,!1),t?yt(n,n.clientCallback,i):pt(n,n.clientErrorCallback,i)}var v=window,l,d,i,f;if(v.ActionQueue===undefined){l=v.ActionQueueTypes,d=v.ActionQueueUtils;var s=l.ActionType,u=l.QueueItemState,r=l.QueueItem,b=l.ActionQueueToken,g=d.NetChecker;i=v.ActionQueue={Events:new $Enum("onactionbeginexecution","onactionendexecution","onactionqueued","onactioncancelled","onactionabandoned","onqueueempty","onqueuepaused","onqueueresumed","onqueueconnectivitylost","onqueueconnectivityrecovered","onqueueuseractivitywhileconnectivitylost")},f=i.Events,i.$=n(i);var nt=1,ht=nt+1,ct=1e4,t=[],y=0,h=!1,p=!1,k=0,o={lifetime:{maxLength:0,totalItems:0,totalTime:0,percentEmpty:100,maxWait:0,avgWait:0,errors:0,abandoned:0},current:{queueLength:0,categories:{byType:{},byState:{}}}},e={beginTime:new Date,lastEmptyBeginTime:new Date,timeEmpty:0,totalExecuted:0,totalWaitTime:0};i.getToken=function(n,t,i,u,f){var e=null;return s.isOfType(t)&&(e=new r(n,t,i,u,f)),new b(e,st,vt)},i.addToken=function(i,u){var e=i?i.item:null;e&&!e.action&&n.inArray(e,t)==-1&&(lt(e,u),at(),w(e)?it(e):a(e,f.onactionqueued))},i.pause=function(){h||(h=!0,c(f.onqueuepaused))},i.isPaused=function(){return h},i.resume=function(){h&&(h=!1,c(f.onqueueresumed),ut())},i.each=function(n,i){if(n)for(var r=t.length-1;r>=0;r--)n(i,r,t[r])},i.injectErrors=function(n){k=n},i.hasPending=function(){for(var i,n=t.length-1;n>=0;n--)if(i=t[n],!s.isPrefetch(i.actionType)&&u.isWaiting(i.state))return!0;return!1},i.statistics=function(){var h=new Date,i=o.lifetime,v=e.timeEmpty+(e.lastEmptyBeginTime==="invalid"?0:h-e.lastEmptyBeginTime),r,f,n;i.totalTime=h-e.beginTime,i.percentEmpty=v/i.totalTime*100,r=o.current,r.queueLength=t.length;var c=r.categories,l=c.byType={},a=c.byState={};for(tt(s,l),tt(u,a),n=t.length-1;n>=0;n--)f=t[n],l[f.actionType]++,a[f.state]++;return o},i.dispose=function(){}}}(window.originaljQuery||window.jQuery),function(n){function a(){function b(){var t=r.Controls.Notifications;n=t.createModalDialog({title:ol.GetString("ConnectivityLossUi.Title"),content:ol.config.connectivityLossUiHtml}),y=!0,n.show()}function p(){n&&(n.dismiss(),n=null)}function k(n,t){t&&t.item&&t.item.action&&(HM.LFPP=t.item.action)}function d(){i=!0}function w(n){i=n.type!="keydown"||n.which==13?!tt(n.srcElement):!0}function g(){if(i&&u.hasPending()){v=!0;return event.returnValue=ol.GetString("ActionQueue.PendingWarning")}i=!0}function nt(){var i=u.statistics(),n=i.lifetime,t=c.statistics(),r={wrnShwn:v,cnLsShwn:y,aAbndQLn:i.current.queueLength,aMxLn:n.maxLength,aTtl:n.totalItems,aTtlTm:n.totalTime,aMpty:n.percentEmpty,aMxWt:n.maxWait,aAvgWt:n.avgWait,aErr:n.errors,aAbnd:n.abandoned,cTtl:t.total,cMx:t.max,cNvld:t.numInvalidates,cPrn:t.numPrunes,cAdd:t.numAdds,cRd:t.numReads,cMss:t.numNotFounds};$BSI.reportEvent(l,r)}function tt(n){for(var t,i,r,u;n&&n.tagName!="A";)n=n.parentElement;return t=!1,n&&n.tagName=="A"&&(n.protocol!="http:"&&n.protocol!="https:"?t=!0:(i=n.href.length,i>0&&n.href.substr(i-1)=="#"&&(r=n.href.substr(0,i-1),u=document.location.href.replace(/#$/,""),r==u&&(t=!0)))),t}var a=this,n=null,i=!0,v=!1,y=!1;a.dispose=function(){nt(),s.unbind(t),h.unbind(t),e.unbind(t),o.unbind(t),p(),a=null},a.initialize=function(){s.bind(f.onqueueconnectivityrecovered+t,p).bind(f.onqueueuseractivitywhileconnectivitylost+t,b).bind(f.onactionendexecution+t,k),h.bind("mousedown"+t,w).bind("keydown"+t,w),o.bind("mouseleave"+t,d),e.bind("beforeunload"+t,g)}}var i=window,e=n(i),o=n(document.body),r=i.wLive;r.Hotmail=r.Hotmail||{},r.Hotmail.ActionQueueUiMgr=a;var u=i.ActionQueue,s=u.$,v=i.ActionQueueTypes.ActionType,c=i.Cache,f=u.Events,y=i.Page,h=n(document),t=".ActionQueueUiMgr",l="Close.Dialog.Hotmail"}(window.originaljQuery||window.jQuery),function(n){"use strict";HM.createFolderWithData=function(n,t){var i=HM.createFolder(n);return HM.createContainerData(t).addContainer(i)},HM.createCategoryWithData=function(n,t){var i=HM.createCategory(n);return HM.createContainerData(t).addContainer(i)},HM.ContainerPoolData.prototype.addContainer=function(t){var i=null;switch(t.containerType){case HM.ContainerType.Folders:i=t.folderId;break;default:i=t.categoryId}return this.containerMap=this.containerMap||{},this.containerList=this.containerList||[],this.containerMap[i]=t,this.containerList.push(i),this},HM.ContainerPoolData.prototype.addContainerData=function(t){var r=t.container,i=null;switch(r.containerType){case HM.ContainerType.Folders:i=r.folderId;break;default:i=r.categoryId}return this.containerMap=this.containerMap||{},this.containerList=this.containerList||[],this.containerMap[i]=t,this.containerList.push(i),this},HM.ContainerData.prototype.addContainer=function(n){return this.container=n,this},HM.ContainerResult.prototype.addContainerPoolData=function(n){return this.containerTable=n.containerMap,this.containerIds=n.containerList,this},HM.MessageGroupResult.prototype.addRollup=function(n){return this.itemsTable=this.itemsTable||{},this.itemIds=this.itemIds||[],this.itemsTable[n.itemId]=n,this.itemIds.push(n.itemId),this},HM.MessageGroupResult.prototype.addRollupData=function(n){var t=n.rollup;return this.addRollup(t)};var t=n.proxy(HM.createMessageData,HM);HM.createMessageData=function(n){var u,i,f,r;if(n=n||{},u=t(n),i=u.message,n.allMessageIds){for(f=[],r=0;r<n.allMessageIds.length;r++)f.push({id:n.allMessageIds[r],folderId:n.allFolderIds&&n.allFolderIds[r]||i.folderId,isRead:n.allReadStates&&n.allReadStates[r]||i.isRead,isFlagged:n.allFlaggedStates&&n.allFlaggedStates[r]||i.isFlagged,categories:n.allCategoryIdLists&&n.allCategoryIdLists[r]||i.categories.slice(0)});u.allHeaders=f}else u.allHeaders.length===0&&(u.allHeaders=[{id:i.messageId,folderId:i.folderId,isRead:i.isRead,isFlagged:i.isFlagged,categories:i.categories.slice(0)}]);return u},HM.MessageData.prototype.addMessage=function(n){return this.message=n,this},HM.Rollup.prototype.addMessageData=function(t){var r,i;return this.__messageData=this.__messageData||[],this.messageIds=this.messageIds||[],r=t.message.messageId,this.messageIds.push(r),this.count+=1,i=t.message,i.isRead||(this.unreadCount+=1),i.conversationId=this.itemId,i.subject=this.subject,this.__messageData.push(t),this},HM.RollupData.prototype.addRollup=function(n){return this.rollup=n,this},HM.ItemListData.prototype.addRollupData=function(n){return this.rollupData=n,this.itemList=this.itemList||[],this.itemList.push(n.rollup.conversationId),this.itemMap=this.itemMap||{},this.createItemMap(n),this},HM.ItemListData.prototype.addItemMap=function(t){return this.itemMap=n.extend(!0,this.itemMap,t),this},HM.ItemListData.prototype.createItemMap=function(t){var i={};return t.rollup.__messageData&&(n.each(t.rollup.__messageData,function(n,t){i[t.message.messageId]=t}),this.itemMap=n.extend(!0,this.itemMap,i)),this},HM.ItemListData.prototype.addRollupDataForMessageList=function(n){return this.itemList=this.itemList||[],this.itemList.push(n.rollup.itemId),this.itemMap=this.itemMap||{},this.itemMap[n.rollup.itemId]=n,this.duplicateItemMap=this.duplicateItemMap||{},this.duplicateItemMap[n.rollup.itemId]=HM.deepCopy(n),this},HM.ItemListResult.prototype.addRollup=function(n){return this.rollup=n,this.messages=this.messages||{},this.createItemMap(n),this},HM.ItemListResult.prototype.createItemMap=function(t){var i={};return t.__messageData&&(n.each(t.__messageData,function(n,t){i[t.message.messageId]=t.message}),this.messages=n.extend(!0,this.messages,i)),this},HM.ItemResponseInfo.prototype.addItemListData=function(n){return this.itemListData=n,this},HM.MessageGroupQuery.prototype.isInvalidationTypeSet=HM.MessageGroupQueryInvalidationResult.prototype.isInvalidationTypeSet=function(n){return!!(this.invalidationType&n)},HM.MessageGroupQuery.prototype.setInvalidationType=function(n){var t=this;return t.invalidationType=t.invalidationType|n,t}}(window.originaljQuery||window.jQuery),function(){"use strict";var n=window.ol=window.ol||{},t=n.data=n.data||{},i=t.FppUtilsClass=function(){var n=this;n.parseQueryTypesFromServerRequestQueries=function(n){var i={serverMessagesQueries:[],containerQueries:[],messageGroupQueries:[],itemListQueries:[],optionsQueries:[],rulesQueries:[]},t;if(n)for(t=0;t<n.length;t++){n[t].dataHash=null;switch(n[t].type){case HM.QueryType.MessageGroupQuery:i.messageGroupQueries.push(n[t]);break;case HM.QueryType.ItemListQuery:i.itemListQueries.push(n[t]);break;case HM.QueryType.ContainerQuery:i.containerQueries.push(n[t]);break;case HM.QueryType.ServerMessageQuery:i.serverMessagesQueries.push(n[t]);break;case HM.QueryType.OptionsQuery:i.optionsQueries.push(n[t]);break;case HM.QueryType.RulesQuery:i.rulesQueries.push(n[t])}}return i},n.getMessageAndConversationQueries=function(n){var i,t;if(n===null||n.length===0)return null;for(i=[],t=0;t<n.length;t++)n[t].type===HM.QueryType.ItemListQuery&&(n[t].containerType===HM.ItemListQueryContainerType.Message||n[t].containerType===HM.ItemListQueryContainerType.Conversation)&&i.push(n[t]);return i},n.getMessageQueries=function(n){var i,t;if(n===null||n.length===0)return null;for(i=[],t=0;t<n.length;t++)n[t].type===HM.QueryType.ItemListQuery&&n[t].containerType===HM.ItemListQueryContainerType.Message&&i.push(n[t]);return i},n.getConversationQueries=function(n){var i,t;if(n===null||n.length===0)return null;for(i=[],t=0;t<n.length;t++)n[t].type===HM.QueryType.ItemListQuery&&n[t].containerType===HM.ItemListQueryContainerType.Conversation&&i.push(n[t]);return i},n.getOptionsQueries=function(n){var i,t;if(n===null||n.length===0)return null;for(i=[],t=0;t<n.length;t++)n[t].type===HM.QueryType.OptionsQuery&&i.push(n[t]);return i}};window.ol.data.FppUtils=new t.FppUtilsClass}(),function(n){"use strict";function f(n){var i="";switch(n.Status){case HM.FppStatus.ERR_HTTP_CONNECT_FAILURE:i=t.GetString("Error.Global.NoInternetConnectivity");break;case HM.FppStatus.ERR_HTTP_TIMEOUT:i=t.GetString("Error.TaskNotCompleted");break;case HM.FppStatus.ERR_HTTP_PARSE_FAILURE:case HM.FppStatus.ERR_FPP_PROTOCOL:case HM.FppStatus.ERR_HTTP_MISCONFIGURATION:i=t.GetString("Error.Global.InternalError");break;case HM.FppStatus.ERR_SERVER_UNCAUGHT:case HM.FppStatus.ERR_APP_SPECIFIC:default:i=t.GetString("Error.Browser.JavaScript")}return i}function e(n,t){var u=l(),f=h(),e=c(),a=s(),v=o(n),y=n.HttpResponseText||"",i="",r="";switch(n.Status){case HM.FppStatus.ERR_HTTP_CONNECT_FAILURE:i="FPP Connection Failure";break;case HM.FppStatus.ERR_HTTP_TIMEOUT:i="FPP Time Out";break;case HM.FppStatus.ERR_HTTP_PARSE_FAILURE:case HM.FppStatus.ERR_FPP_PROTOCOL:case HM.FppStatus.ERR_HTTP_MISCONFIGURATION:i="FPP Internal Error",r="Status:{0}<br>\r\nStatus Text:{1}<br>\r\n".format(n.Proxy.status,n.Proxy.statusText)}var p="Exception Details:<br>\r\nmsg = [Silent Error] {0} {1} {2}.{3}<br>\r\nuseragent = {4}<br>\r\nhostname = {5}<br>\r\nurl = {6}<br>\r\nSL = {7}<br>\r\nDetails = {8}<br>\r\nHTTP response text = {9}<br>\r\n{10}".format(i,n.ErrorCode,t.className,t.methodName,u,f,e,a,v,y,r),w=n.Status!==HM.FppStatus.ERR_FPP_PROTOCOL&&n.ErrorObj!=="wrappedFAE"&&(!!n.Message||!!(n.Error&&n.Error.Message));return{detailedMessage:p,displayErrorMessage:w?n.Error?n.Error.Message:n.Message:null}}function o(n){var u="",t,r,i;try{if(t=n.Error||n,t){r=[];for(i in t)t.hasOwnProperty(i)&&r.push(i+" : "+t[i]);u=r.join(",<br>\r\n")}}catch(f){}return u}function s(){var n="CantDetect",t=$B.IE&&$B.V>=11;if(window.Silverlight&&!t)try{n=Silverlight.getVersion()}catch(i){}return n}function h(){var n="can't get location.hostname";try{n=location.hostname}catch(t){try{n=n+"; document.domain = "+document.domain}catch(i){}}return n}function c(){var n="can't get url";try{n=location.href}catch(t){}return n}function l(){var n="cant get user agent";try{n=navigator.userAgent}catch(t){}return n}var t=window.ol=window.ol||{},u=t.data=t.data||{},i=u.fpp=u.fpp||{},r=i.FppErrorManagerClass=function(){var r=this;r.onFppError=function(n,t){var i;if(i=t.FppMethod,i.methodName!=="ReportError"){var f=t&&t.Context&&t.Context.cmd,e=r.getFppErrorUiFromFppErrorForCommand(t,f),u=t&&t.Context&&t.Context.deferred,o=HM.createFppErrorWrapper({fppError:t});t.fppErrorUi=e,u&&u.reject([o])}},r.getFppErrorUiFromFppErrorForCommand=function(u,o){var l=u.FppMethod||{methodName:i.FppEngine.getSafeFppCommandConfig(o).fppMethod,className:t.config.HMNamespace},s=e(u,l);r.isServerSideAppException(u)||HM.ReportError(s.detailedMessage,n.noop);var h=u.ErrorObj||u.Error&&u.Error.ErrorObj,a=u.Error&&u.Error.ErrorCode||u.ErrorCode||null,c=new HM.FppErrorUi(HM.DLReturnType.FppErrorUi,"0",r.isServerSideAppException(u)?"1":"0",s.detailedMessage,s.displayErrorMessage?s.displayErrorMessage:f(u),h?h.IsBlocking:!1,a);return c.type=HM.DLReturnType.FppErrorUi,c}};r.prototype.isServerSideAppException=function(n){return n.Status==HM.FppStatus.ERR_SERVER_UNCAUGHT||n.Status==HM.FppStatus.ERR_APP_SPECIFIC},r.prototype.serverResultsContainUpgradeError=function(n){var t,i,r,u;if(n)for(t=0;t<n.length;t++)if(i=n[t],i&&i.type===HM.DLReturnType.FppError&&(r=i.fppError,u=r.Error&&r.Error.ErrorCode||r.ErrorCode,u==="00000002"))return!0;return!1},r.prototype.resultsContainGeneralError=function(n){var t,i;if(n)for(t=0;t<n.length;t++)if(i=n[t],i&&i.Error&&i.Error.ErrorCode==="00000001")return!0;return!1},i.FppErrorManager=new i.FppErrorManagerClass,$Network.Events.onerror.attach($CD(i.FppErrorManager,i.FppErrorManager.onFppError))}(window.originaljQuery||window.jQuery),function(n){"use strict";var i=window.ol=window.ol||{},t=i.data=i.data||{},r=t.fpp=t.fpp||{},u=window.ActionQueue,f=window.ActionQueueTypes.ActionType,e=t.BulkActionsManagerClass=function(){function i(i,f,e){var o,a,s;o=f.cmd,a=o.args,o.fppProgress([HM.createBulkActionCountUpdate({progressCount:i.ProcessedCount,completed:!!e,sender:i.SenderSearch||""})]);var y=a.actions,c=y&&y.MoveActions,l=null;if(c)for(s=c.length-1;s>=0;s--)if(c[s].DeferredActionType===HM.DeferredMailActionType.Count){l=c[s];break}f.isFirstBatch&&l&&(l.DeferredActionAge=0,f.isFirstBatch=!1),e&&(l.DeferredActionAge=1,f.isFirstBatch=!0,i.SenderSearch=a.batchLoopSenders.pop(),i.AnchorDate="",i.AnchorId="",i.ProcessedCount=0,i.IsLastBatch=!1);var v=f.queries,p=f.fppCommandConfig,h=f.tokenConfig,w=f.cmdArgsToNull,b=n.type(h.actionType)==="function"?h.actionType(o,v):h.actionType,k=u.getToken(h.friendlyName,b,h.getTokenKeys(o,v),t.handleBulkActionsResponse,r.FppEngine.onFppError);r.FppCommandExecutor.addCommandToActionQueue(p,k,o,v,i,w,f)}var t=this;t.handleBulkActionsResponse=function(n,t){var u,i,r,f;for(u=t.results||[],i=null,r=0;r<n.length;r++)n[r]&&n[r].type&&n[r].type===HM.DLReturnType.BatchInfo?i=n[r]:u.push(n[r]);i?(f=t.cmd.args,i.IsLastBatch?f.batchLoopSenders&&f.batchLoopSenders.length&&!i.CancelBulkAction?(u=[],t.bulkCallback&&(t.results=u,t.bulkCallback(i,t,!0))):t.finalBulkCallBack&&t.finalBulkCallBack(u,i.ProcessedCount,i.SenderSearch,i.CancelBulkAction):t.bulkCallback&&(f.interruptCallback&&f.interruptCallback()&&(i.CancelBulkAction=!0),t.results=u,t.bulkCallback(i,t))):t.finalBulkCallBack&&t.finalBulkCallBack(u,0,"",!0)},t.maybeModifyCommandForBatchLoop=function(n){var i=n.args,u=i.actions,t,r;if(u&&(t=i.batchInfo.SenderSearch,t&&(t=t.split(","),t.length>1)))for(r=u.length-1;r>=0;r--)u[r].DeferredActionType===HM.DeferredMailActionType.Count&&(i.batchLoopSenders=t,i.batchInfo.SenderSearch=i.batchLoopSenders.pop())},t.getFppSuccessCallback=function(n,r,u,f,e,o){var s,h,c;return u&&e?(h=e.tokenConfig,c=e.cmdArgsToNull,s=function(u,e){e.tokenConfig=h,e.cmdArgsToNull=c,e.bulkCallback=i,e.fppCommandConfig=f,e.cmd=n,e.isFirstBatch=!0,e.queries=r,e.finalBulkCallBack=function(t,i,r,u){n.fppProgress([HM.createBulkActionCountUpdate({progressCount:i,completed:!0,sender:r||""})]).always(function(){u?o.reject(t):o.resolve(t)})},t.handleBulkActionsResponse(u,e)}):s=function(n){o.resolve(n)},s}};t.BulkActionsManager=new t.BulkActionsManagerClass}(window.originaljQuery||window.jQuery),function(n){"use strict";var r=window.ol=window.ol||{},t=r.data=r.data||{},i=t.fpp=t.fpp||{},u=window.ActionQueue,e=window.ActionQueueTypes.ActionType,f=t.BulkActionsManager,o=i.FppCommandExecutorClass=function(){function o(t,r,o,s,h,c){var l=t.tokenConfig,a=f.getFppSuccessCallback(o,s,h,t,r,c),v=n.type(l.actionType)==="function"?l.actionType(o,s):l.actionType;return h&&o.args.actions&&f.maybeModifyCommandForBatchLoop(o),u.getToken(l.friendlyName,h?e.blocking:v,l.getTokenKeys(o,s),a,i.FppEngine.onFppError)}var r=this;r.executeCommand=function(n,i,u,f){var u,h,c;u=t.FppUtils.parseQueryTypesFromServerRequestQueries(u);var l=n.fppMethod,a=n.tokenConfig,v=n.cmdArgs,e=n.bulkActionsConfig||null,s=e!=null&&(i.args.isBulk||!1);h=s?i.args.batchInfo:null,c=o(n,e,i,u,s,f),r.addCommandToActionQueue(n,c,i,u,h,null,{queries:u,cmd:i,deferred:f})},r.addCommandToActionQueue=function(n,t,i,r,f,e,o){var c,h,l,v;var y=n.fppMethod,a=n.cmdArgs,s=[];for(c=0;c<a.length;c++)h=a[c],e&&e.indexOf(h.name)>-1?s.push(null):(h.name==="getAffectedHeaders"&&i.args[h.name]===undefined&&(i.args[h.name]=!!ol.config.features.undo),s.push(i.args[h.name]));l=null,l=n.useCompatibleQueryContainer?new HM.createCompatibleQueryMarshallingContainer(r):new HM.createQueryMarshallingContainer(r),s.push(l),n.bulkActionsConfig&&s.push(f),s.push(t.getSuccessCallback()),s.push(o),s.push(t.getFailureCallback()),v=function(){window.HM[n.fppMethod].apply(this,s)},u.addToken(t,v)}};i.FppCommandExecutor=new i.FppCommandExecutorClass}(window.originaljQuery||window.jQuery),function(n){"use strict";function i(i,r,u,f){var e=n.Deferred(),o;return t.commandName=r,t.args=u,t.promise=e,o=n("<iframe><\/iframe>"),o.css("display","none"),o.prop("src",ol.config.fppConfig.SHbiRequestUrl),i.append(o),setTimeout(function(){e.isResolved()||e.isRejected()||e.reject(HM.createCommandResult({results:{statusText:"abort"}}))},f),e}var t=ol.SHbiFppLoader={};t.commandName={},t.args={},t.promise={},t.loadFppRequest=function(t,r,u,f){var e=n.Deferred();return i(t,r,u,f).then(function(n,t){e.resolve(n,t)},function(n,t){var u=ol.data.fpp.FppEngine.getFppConfigs(),f=u[r].suppressServerErrors,i;if(!f&&t!=null)for(i=0;i<t.length;i++)if(t[i].type==HM.DLReturnType.FppErrorUi){ol.Dispatcher.fireCmd("setfpperrormessage",{fppErrorUi:t[i]});break}else if(t[i].type==HM.DLReturnType.ServerErrorMessage){ol.Dispatcher.fireCmd("setservererrormessage",{serverErrorMessage:t[i]});break}e.reject(n,t)}),e}}(window.originaljQuery||window.jQuery),define(["ol"],function(){"use strict";var n=window.ol=window.ol||{},t=n.data=n.data||{},i=t.QueryUtils;HM.ServerInvalidationQuery.prototype.key=HM.ServerMessagesQuery.prototype.key=i.defaultKey,HM.ServerInvalidationQuery.prototype.getCommandKeys=HM.ServerMessagesQuery.prototype.getCommandKeys=function(){return[]}}),define(["ol"],function(n){"use strict";var t=n.data=n.data||{},i=t.QueryUtils;HM.UndoQuery.prototype.key=i.defaultKey,HM.UndoQuery.prototype.getCommandKeys=function(){return[]}}),function(n,t){"use strict";var r=n.data=n.data||{},i=r.InstrumentationModel=function(r){function l(t){var i=t.config,r,f;if(i){for(r in i.actions)f=i.actions[r],u.registerAction(r,f,i);e=i}h=n.Instrumentation.datapointNotProvided()}function a(t){for(var r,i=0;i<t.length;i++)r=t[i],r.type===HM.ChangeType.ArchiveFolderId&&n.Instrumentation.updateArchiveFolderId(r.id)}function c(n,t,i,r){for(var f=t.action,h=t.name,e=t.condition,o=f.datapoints.length>0?{}:null,c={},u=0;u<f.datapoints.length;u++)s(f.datapoints[u],n,i,h,o,c,r);if(e.datapoints)for(u=0;u<e.datapoints.length;u++)s(e.datapoints[u],n,i,h,o,c,r);v(t.name,o)}function s(n,t,i,r,u,o,c){var k,v,p,w,d,a,g,b,nt,l;if(n.ref)for(k=e.shared.datapointCollections[n.ref],v=0;v<k.length;v++)s(k[v],t,i,r,u,o,c);else{a=n,g=!1;do w=w||a.src,d=d||a.values,p=p||a.name,b=y(a.type),nt=null,b===f.Custom?nt=e.shared.types[a.type]:b!==f.None&&(g=b===f.Boolean),a=nt;while(a&&(!w||!d));l=w({cmd:t,queries:i,context:o,batchIndex:c}),l!==h&&typeof l!="undefined"&&l!==null&&(g&&(l=l?"1":"0"),u[p]=l)}}function v(n,t){$BSI.reportEvent(n,t)}function y(n){var t;if(n)switch(n){case"number":t=f.Number;break;case"boolean":t=f.Boolean;break;case"string":t=f.String;break;default:t=f.Custom}else t=f.None;return t}function p(t){var f=w(t),r,u,i;f&&(r={cmd:t,instrumentation:f},u=t.args&&t.args.msgInst||null,u&&u.id&&(r.checkCache=u.id),i=f.condition,i.when===HM.InstrumentationFireWhen.Before?n.Dispatcher.fireCmd("instrumentthis",r):((i.when===HM.InstrumentationFireWhen.AfterFailure||i.when===HM.InstrumentationFireWhen.AlwaysAfter)&&t.deferred.fail(function(){n.Dispatcher.fireCmd("instrumentthis",r)}),(i.when===HM.InstrumentationFireWhen.AfterSuccess||i.when===HM.InstrumentationFireWhen.AlwaysAfter)&&t.deferred.done(function(){n.Dispatcher.fireCmd("instrumentthis",r)})))}function w(t){var e=null,f=o.commands[t.name],u,i,r;if(f)for(u=0;u<f.length;u++)if(i=f[u],r=i.cachedFilters,!r&&i.condition.filters&&(r=i.cachedFilters=n.CmdFilter.makeFilters(i.condition.filters)),!r||n.CmdFilter.matches(t,r)){e=i;break}return e}var u=this,o={commands:[],types:{},query:null},e,f=new $Enum("None","Custom","Boolean","Number","String"),h;u.register=function(t){t.register("IN",u),n.Cmd.registerExecutionStrategy(p),i.instance=u},u.formatResults=t.noop,u.endCommand=function(n){var i,r,u,t;if(i=n.serverResults,i)for(r=0;r<i.length;r++)u=i[r],u&&(t=u.biciConfig,t&&(t=JSON.parse(t),$Utility.updateObject($Config,t.$Config)))},u.begin_instrumentthis=function(n){var e=n.command,i=e.args.cmd,r=e.args.instrumentation,u,f,o,t;if(a(n.changes),u=r.condition.batch,u!==null)for(f=i.args[u],o=f&&f.length||0,t=0;t<o;t++)c(i,r,n.queries,t);else c(i,r,n.queries)},u.registerAction=function(n,t){for(var u,r,i=0;i<t.conditions.length;i++)u=t.conditions[i],r=u.command,o.commands[r]||(o.commands[r]=[]),o.commands[r].push({name:n,action:t,condition:u});e&&(e.actions[n]=t)},l(r)}}(window.ol,window.originaljQuery||window.jQuery),function(n){"use strict";var u=window.ol=window.ol||{},t=u.data=u.data||{},i=t.QueryUtils=t.QueryUtils||{},r=t.fpp=t.fpp||{},f=t.ServerMessageModelClass=function(){function e(n,t){if(n)switch(n.type){case HM.DLReturnType.FppErrorUi:u.fppErrorUi=n,u.fppErrorUi.errorId=f++;break;case HM.DLReturnType.ServerErrorMessage:u.serverErrorMessage=n,u.serverErrorMessage.errorId=f++;break;case HM.DLReturnType.NotificationInfo:u.notificationInfo=n,u.notificationInfo.errorId=f++;break;case HM.DLReturnType.NewMailNotification:u.newMailNotification=n,u.newMailNotification.errorId=f++;break;case HM.DLReturnType.BulkActionCountUpdate:u.bulkActionCountUpdate=n,u.bulkActionCountUpdate.errorId=f++;break;case HM.DLReturnType.SuperBar:u.superBar=n,u.superBar.errorId=f++;break;case HM.DLReturnType.FppError:u.fppErrorUi=r.FppErrorManager.getFppErrorUiFromFppErrorForCommand(n.fppError,t),u.fppErrorUi.errorId=f++}}function o(n){switch(n){case HM.ServerMessageType.FppErrorUi:u.fppErrorUi=null;break;case HM.ServerMessageType.ServerErrorMessage:u.serverErrorMessage=null;break;case HM.ServerMessageType.NotificationInfo:u.notificationInfo=null;break;case HM.ServerMessageType.NewMailNotification:u.newMailNotification=null;break;case HM.ServerMessageType.BulkActionCountUpdate:u.bulkActionCountUpdate=null;break;case HM.ServerMessageType.SuperBar:u.superBar=null;break;case HM.ServerMessageType.UnsatisfiedQueryError:break;default:throw new Error("Unrecognized serverMessageType: "+n);}}function s(n){var t=null;switch(n.serverMessageType){case HM.ServerMessageType.FppErrorUi:t=u.fppErrorUi?{fppErrorUi:u.fppErrorUi}:null;break;case HM.ServerMessageType.ServerErrorMessage:t=u.serverErrorMessage?{serverErrorMessage:u.serverErrorMessage}:null;break;case HM.ServerMessageType.NotificationInfo:t=u.notificationInfo?{notificationInfo:u.notificationInfo}:null;break;case HM.ServerMessageType.NewMailNotification:t=u.newMailNotification?{newMailNotification:u.newMailNotification}:null;break;case HM.ServerMessageType.BulkActionCountUpdate:t=u.bulkActionCountUpdate?{bulkActionCountUpdate:u.bulkActionCountUpdate}:null;break;case HM.ServerMessageType.SuperBar:t=u.superBar?{superBar:u.superBar}:null;break;case HM.ServerMessageType.UnsatisfiedQueryError:break;default:throw new Error("Unrecognized serverMessageType: "+serverMessageType);}return t}function h(i){for(var o,h,r,e={},f=0;f<i.length;f++)i[f].type===HM.QueryType.ServerMessageQuery?(o=i[f],r=s(o),r=HM.createServerMessageResult(n.extend(r||{},{query:o,type:HM.ResultType.ServerMessage,status:HM.Status.Complete})),r.dataHash=t.hashResult(r),e[i[f].key()]=r):i[f].type===HM.QueryType.ServerInvalidationQuery&&(h=i[f],r=u.serverInvalidQueryResult,r.query=h,r.status=HM.Status.Complete,r.dataHash=null,r.dataHash=t.hashResult(r),e[h.key()]=r);return e}function c(n,t){for(var r=HM.ServerInvalidQueryType.None,o,e=0;e<n.length;e++)if(o=n[e],o&&o.type===HM.DLReturnType.ServerInvalidQuery)switch(o.serverInvalidQueryType){case HM.ServerInvalidQueryType.ConversationNotFound:i.invalidateAllItemListQueries(t),r|=HM.ServerInvalidQueryType.ConversationNotFound;break;case HM.ServerInvalidQueryType.MessageNotFound:i.invalidateAllItemListQueries(t),r|=HM.ServerInvalidQueryType.MessageNotFound;break;case HM.ServerInvalidQueryType.QueryMessagesFolderNotFound:i.invalidateAllMessageGroupQueries(t,HM.MessageGroupQueryInvalidationType.ContainerRemoval),r|=HM.ServerInvalidQueryType.QueryMessagesFolderNotFound;break;case HM.ServerInvalidQueryType.QueryMessagesAnchorMessageNotFound:i.invalidateAllAnchoredMessageGroupQueries(t,HM.MessageGroupQueryInvalidationType.AnchorChange),r|=HM.ServerInvalidQueryType.QueryMessagesAnchorMessageNotFound}u.serverInvalidQueryResult=HM.createServerInvalidationResult({serverInvalidQueryType:r,errorId:f++})}var u=this,f=0;u.fppErrorUi=null,u.serverErrorMessage=null,u.notificationInfo=null,u.newMailNotification=null,u.bulkActionCountUpdate=null,u.superBar=null,u.serverInvalidQueryResult=HM.createServerInvalidationResult(),u.endCommand=u.middleCommand=function(n){var o,f,i,t,u;if(o=r.FppEngine.shouldSuppressServerErrors(n.command),n.serverResults){for(f=!1,i=0;i<n.serverResults.length;i++)t=n.serverResults[i],t&&(u=t.type===HM.DLReturnType.FppError&&t.fppError&&r.FppErrorManager.isServerSideAppException(t.fppError),u=u||t.type===HM.DLReturnType.ServerErrorMessage,o&&u||e(t,n.command),f|=t.type===HM.DLReturnType.ServerInvalidQuery);f&&c(n.serverResults,n.queries)}},u.formatResults=function(n){var i=n.queries,r=h(i);t.uniqueExtend(n.results,r)},u.register=function(n){n.register("SM",this)},u.begin_dismissservermessage=function(n){for(var r,i=n.parameters.dismissalTypes,t=0;t<i.length;t++)r=i[t],o(r)},u.begin_setfpperrormessage=function(n){e(n.parameters.fppErrorUi,n.command)},u.begin_setservererrormessage=function(n){HM.assertServerErrorMessage(n.parameters.serverErrorMessage),e(n.parameters.serverErrorMessage,n.command)}};t.ServerMessageModel=new t.ServerMessageModelClass}(window.originaljQuery||window.jQuery),function(){"use strict";var i=window.ol=window.ol||{},t=i.data=i.data||{},u=t.fpp=t.fpp||{},r=t.UndoModel=function(){var n=this;n.MAX_UNDO_STACK_DEPTH=1,n._undoStack=[],n._undoData={},n.nextUndoId=1,n.undoCmdMapping={moveitems:"undomoveitems",flagitems:"undoflagitems",markitems:"undomarkitems",categorizeitems:"undocategorizeitems",junkitems:"undojunkandunjunkitems",unjunkitems:"undojunkandunjunkitems"}},n=r.prototype;n.register=function(n){n.register("UM",this)},n._pushCmdData=function(n){var t=this,r,i;t._undoStack.length>=t.MAX_UNDO_STACK_DEPTH&&(r=t._undoStack.shift(),delete t._undoData[r]),i=t.nextUndoId++,n.args.undoId=i,t._undoStack.push(i),t._undoData[i]=HM.createUndoStackData({origCmd:n,affectedHeaders:null})},n._popStackData=function(){var n=this,t=n._peekStackData();return!t||(n._undoStack.pop(),delete n._undoData[t.undoId]),t},n._removeItemWithUndoId=function(n){for(var i=this,t=0;t<i._undoStack.length;t++){i._undoStack[t]===n&&i._undoStack.splice(t,1);break}delete i._undoData[n]},n._peekStackData=function(){var n=this,r=null,t,i;return n._undoStack.length>0&&(t=n._undoStack[n._undoStack.length-1],i=n._undoData[t],HM.assertUndoStackData(i),r={undoId:t,undoData:i}),r},n._clearUndoStack=function(){var n=this;n._undoStack=[],n._undoData={}},n.formatResults=function(n){var o=this,r=o._peekStackData(),u,f,i,e,s;if(n.serverRequest.blockFpp&&r&&r.undoData&&r.undoData.origCmd&&r.undoData.origCmd.id===n.parameters.cmdId&&(this._removeItemWithUndoId(n.parameters.undoId),r=null),n.queries)for(u=0;u<n.queries.length;u++)f=n.queries[u],f.type===HM.QueryType.UndoQuery&&(e=null,r&&(e={nameForUndoCmd:o.undoCmdMapping[r.undoData.origCmd.name],argsForUndoCmd:{undoId:r.undoId},undoableCmd:r.undoData.origCmd}),i=HM.createUndoResult({undoData:e,status:HM.Status.Complete}),i.undoData?(s=i.undoData.undoableCmd,i.undoData.undoableCmd=!!i.undoData.undoableCmd,i.dataHash=t.hashResult(i),i.undoData.undoableCmd=s):i.dataHash=t.hashResult(i),n.results[f.key()]=i)}}(),function(){"use strict";var i=window.ol=window.ol||{},r=i.data=i.data||{},u=r.fpp=r.fpp||{},n=r.UndoModel.prototype,t=i.config.sysFldrs;n.begin_clearundo=function(){var n=this;n._clearUndoStack()},n._generalUndoCmdValidation=function(n){var t=this._peekStackData();return t&&t.undoId&&n.command.args.undoId&&n.command.args.undoId===t.undoId},n._generalEndUndoCmd=function(){this._popStackData()},n._generalBeginUndoableCmd=function(n){n.parameters.getAffectedHeaders=!0,n.parameters.cmdId=n.command.id,this._pushCmdData(n.command)},n._generalEndUndoableCmd=function(n){var r,s,t,h,u,f,i,e,o;if(r=n.serverResults,s=n.command.args.undoId,t=this._undoData[s],t){if(HM.assertUndoStackData(t),h=[],r)for(u=0;u<r.length;u++)if(f=r[u],f&&f.type===HM.DLReturnType.AffectedHeaders)for(i=f.affectedHeaders,e=0;e<i.itemList.length;e++)o=i.itemMap[i.itemList[e]],o.lastUpdatedTimestamp||(o.lastUpdatedTimestamp=i.lastUpdatedTimestamp),h.push(o);t.affectedHeaders=h,t.affectedHeaders.length==0&&this._removeItemWithUndoId(s)}},n._doCommonBeginUndoWork=function(n,t,i,r){for(var e=this,f=[],u=0;u<t.length;u++)f[u]=HM.createUndoCmdItemArgs({itemId:t[u].rollup.itemId,viewId:r,lastUpdatedTimestamp:t[u].lastUpdatedTimestamp,item:t[u]});n.items=f,n.getAffectedHeaders=!1},n._isUndoableMove=function(n){for(var i=n.destId!==t.permDelFid,f=n.destId===t.trashFid,u,r=0;i&&r<n.items.length;r++){if(u=n.items[r],!u.msgInst){i=!1;break}if(f&&u.viewId===t.trashFid){i=!1;break}}return i},n.validate_undomoveitems=n._generalUndoCmdValidation,n.begin_undomoveitems=function(n){var o=this,i=n.parameters,e,u,f,s,r,h,c;for(e=o._peekStackData().undoData,HM.assertUndoStackData(e),u=e.origCmd,f=e.affectedHeaders,i.includeDuplicates=u.args.includeDuplicates,i.blockIfDelete=!1,i.skipFocus=u.args.skipFocus,s=u.args.destId,o._doCommonBeginUndoWork(i,f,e,s),r=0;r<f.length;r++)h=f[r].rollup.isFlagged&&u.args.unpinOnMove,c=!f[r].rollup.isRead&&u.args.markMessagesAsRead,i.items[r].toFolderId=f[r].rollup.folderId,i.items[r].pinOnMove=h?HM.ActionOnMove.Set:HM.ActionOnMove.None,i.items[r].readOnMove=c?HM.ActionOnMove.Unset:HM.ActionOnMove.None;if(i.destId===t.trashFid&&i.items[0].viewId===t.trashFid)throw new Error("Should not be permadeleted.");if(i.destId===t.permDelFid)throw new Error("Should not handle permadelete.");},n.end_undomoveitems=n._generalEndUndoCmd,n.begin_moveitems=function(n){var t=this;n.parameters.isUndoableMove=t._isUndoableMove(n.parameters),n.parameters.isUndoableMove?t._generalBeginUndoableCmd(n):t.begin_clearundo(n)},n.end_moveitems=function(n){var t=this;n.parameters.isUndoableMove&&t._generalEndUndoableCmd(n)},n.validate_undoflagitems=n._generalUndoCmdValidation,n.begin_undoflagitems=function(n){var r=this,u=n.parameters,t,f,i;t=r._peekStackData().undoData,HM.assertUndoStackData(t),f=t.origCmd,i=t.affectedHeaders,u.asFlagged=!f.args.asFlagged,r._doCommonBeginUndoWork(u,i,t,i[0].rollup.folderId)},n.end_undoflagitems=n._generalEndUndoCmd,n.begin_flagitems=n._generalBeginUndoableCmd,n.end_flagitems=n._generalEndUndoableCmd,n.validate_undomarkitems=n._generalUndoCmdValidation,n.begin_undomarkitems=function(n){var r=this,u=n.parameters,t,f,i;t=r._peekStackData().undoData,HM.assertUndoStackData(t),f=t.origCmd,i=t.affectedHeaders,u.asRead=!f.args.asRead,r._doCommonBeginUndoWork(u,i,t,i[0].rollup.folderId)},n.end_undomarkitems=n._generalEndUndoCmd,n.begin_markitems=n._generalBeginUndoableCmd,n.end_markitems=n._generalEndUndoableCmd,n.validate_undocategorizeitems=n._generalUndoCmdValidation,n.begin_undocategorizeitems=function(n){var f=this,i=n.parameters,r,t,u;r=f._peekStackData().undoData,HM.assertUndoStackData(r),t=r.origCmd,u=r.affectedHeaders,t.args.apply.length>0&&t.args.remove.length===0?(i.remove=t.args.apply,i.apply=[]):t.args.remove.length>0&&t.args.apply.length===0&&(i.apply=t.args.remove,i.remove=[]),f._doCommonBeginUndoWork(i,u,r,u[0].rollup.folderId)},n.end_undocategorizeitems=n._generalEndUndoCmd,n.begin_categorizeitems=n._generalBeginUndoableCmd,n.end_categorizeitems=n._generalEndUndoableCmd,n.validate_undojunkandunjunkitems=n._generalUndoCmdValidation,n.begin_undojunkandunjunkitems=function(n){var e=this,i=n.parameters,r,u,f;r=e._peekStackData().undoData,HM.assertUndoStackData(r),u=r.origCmd,f=r.affectedHeaders,u.args.jmrType===HM.JmrType.Junk?(i.fid=t.junkFid,i.jmrType=HM.JmrType.NotJunk):u.args.jmrType===HM.JmrType.NotJunk&&(i.fid=t.inboxFid,i.jmrType=HM.JmrType.Junk),i.enableJmrReporting=!1,i.suppressListTransition=u.args.suppressListTransition,e._doCommonBeginUndoWork(i,f,r,f[0].rollup.folderId)},n.end_undojunkandunjunkitems=n._generalEndUndoCmd,n.begin_junkitems=n._generalBeginUndoableCmd,n.end_junkitems=n._generalEndUndoableCmd,n.begin_unjunkitems=n._generalBeginUndoableCmd,n.end_unjunkitems=n._generalEndUndoableCmd}(),function(n){"use strict";var i=window,n=i.ol=i.ol||{},t=n.InboxActions={},r=wLive.Controls.Notifications;t.showEmptyContainerConfirmation=function(t,i){var u=n.GetString(i?"ContextMessage.EmptyFolder":"QuickView.ContextMenu.EmptyQuickView");return r.createFlyout({title:"",content:n.GetString(i?"MessageList.PermanentlyDeleteConfirmation.Scope.Folder":"MessageList.PermanentlyDeleteConfirmation.Scope.View"),anchor:t,buttons:{action:u}}).show()},t.emptyContainer=function(n,i,r){t.showEmptyContainerConfirmation(n,i.isFolder()).then(function(n){n.buttonClicked==="action"&&i.emptyContainer(r)})}}(window.ol,window.originaljQuery||window.jQuery),function(){var t=window.wLive||{},n=window.ol=window.ol||{};n.ContainerPickerEnums={MenuType:{Categorize:"Categorize",MoveTo:"MoveTo",ContainerSelector:"ContainerSelector"}}}(),function(n){function u(i,r,u,e){for(var h=[],p=t.config.userInformation.userEmail,s,c,o=0;o<i.length;o++)for(c=i[o].getSenderData(!1,r),s=0;s<c.length;s++){var l=c[s],a=l.email||l,w=t.String.isValidEmailSyntax(a),v=a===p,y=f(l),b=(!v||v&&!u)&&(!e||e&&w)&&n.inArray(y,h)===-1;b&&h.push(y)}return h}function f(t){var i=t||"";return n.type(t)!=="string"&&(i=r.format(t.name,t.displayEmail||t.email)),i}var e=window.wLive||{},t=window.ol=window.ol||{},i,r;t.SelectionUtil={},i=t.SelectionUtil,r=t.GetString("UnifiedInbox.UnresolvedSenderEmail.FriendlyEmailDisplayNameFormat"),i.getSenderIds=function(n,t,i){return u(n,!0,t,i)},i.getFriendlySenders=function(n,t){return u(n,!1,t)}}(window.originaljQuery||window.jQuery),function(n){"use strict";var t=ol.InboxActionsShortcuts=function(t){function w(){ol.Cmd("print").subscribe(i.printMsg),ol.Cmd("markasread").subscribe(i.markAsRead),ol.Cmd("markasunread").subscribe(i.markAsUnread),ol.Cmd("markasflagged").subscribe(i.markAsFlagged),ol.Cmd("markasunflagged").subscribe(i.markAsUnflagged),ol.Cmd("deletemsg").subscribe(i.deleteMsg),ol.Cmd("archive").subscribe(i.archive),ol.Cmd("createrule").subscribe(i.createRule),ol.Cmd("editrule").subscribe(i.editRule),ol.Cmd("viewsource").subscribe(i.viewSource),ol.Cmd("showcategorize").subscribe(i.showCategoriesMenu),ol.Cmd("showmoveto").subscribe(i.moveToFolder),ol.Cmd("junk").subscribe(i.markAsJunk),ol.Cmd("notjunk").subscribe(i.markAsNotJunk),ol.Cmd("phish").subscribe(i.markAsPhish),ol.Cmd("compromised").subscribe(i.markAsCompromised),ol.Cmd("unsubscribe").subscribe(i.unsubscribe),ol.Cmd("tryemptycontainer").subscribe(i.emptyContainer),ol.Cmd("togglethreadexpandcollapsestate").subscribe(i.toggleThreadExpandCollapseState)}function o(n){var e=ol.config.sysFldrs,i=r.selectedContainer().isFolder()?r.selectedContainer().id():ol.config.sysFldrs.noneFid,f=r.getSelectedThreads(),t=!0;typeof n.extraCondition!="undefined"&&(t=n.extraCondition),(r.isBulkSelected()||f.length>0)&&t&&ol.controlHelpers.SafetyUI.create().maybeShowFre({jmrType:n.jmrType,anchor:n.cmdArgs.anchor||(n.cmdArgs.e||n.cmdArgs.event).target}).done(function(t){if(r.isBulkSelected())ol.Cmd("bulkactionbycontainer").fire({action:"junk",jmrType:n.jmrType,enableJmrReporting:t?t.enableJmrReporting:!1,entryPoint:n.entryPoint});else{var f=ol.vm.MessageThread.performActionOnThreads(n.actionOnThreadsToPerform,r.getSelectedThreads(),{folderId:i,enableJmrReporting:t?t.enableJmrReporting:!1,srcCtl:u,entryPoint:n.cmdArgs.entryPoint});n.actOnPromiseDelegate&&n.actOnPromiseDelegate(f)}})}function b(t){return n.inArray(t,y)!==-1||n.inArray(t,l)!==-1&&ol.getActiveElement()===document.body?u.messageListControl:n.view(ol.getActiveElement()).ctx&&n.view(ol.getActiveElement()).ctx.tag}function e(n,t,i){var u,f;r.isBulkSelected()?(u={action:n,entryPoint:i},u[c[n]]=t,ol.Cmd("bulkactionbycontainer").fire(u)):(f=a[n][t?1:0],ol.vm.MessageThread.performActionOnThreads(f,r.getSelectedThreads(),{entryPoint:i}))}function s(n){ol.Cmd("selectcontainer").fire({id:n,entryPoint:HM.InstrumentationEntryPoint.KeyboardShortcut})}var i=this,v=n.extend({},{control:null},t),u=v.control,r=u.data,l=["openMsg","openMsg2","nextMsg","prevMsg","nextMsg2","prevMsg2","multiNextMsg","multiPrevMsg","focusNextMsg","focusPrevMsg","focusNextMsg2","focusPrevMsg2"],y=["openMsg","nextMsg","prevMsg"],p={none:0,newMsg:1,newMsg2:1,sendMsg2:3,reply:4,replyAll:5,forward:6,openMsg:8,openMsg2:8,nextMsg:9,nextMsg2:9,prevMsg:10,prevMsg2:10,searchMail:11,closeFullViewMsg:12,deleteMsg:13,archive:16,markAsJunk:19,moveToFolder:20,newFolder:21,showCategoriesMenu:22,newCategory:23,removeCategory:24,markAsRead:25,markAsUnread:26,toggleFlag:27,printMsg:28,multiNextMsg:31,multiPrevMsg:32,focusNextMsg:33,focusNextMsg2:33,focusPrevMsg:34,focusPrevMsg2:34,selectAll:35,selectNone:36,refreshInbox:40,refreshInbox2:40,goToInbox:41,goToFlagged:42,goToDrafts:43,goToSent:44,goToPeople:46,showHelp:47,toggleThreadExpandCollapseState:53,undo:66},h=[],f=null,c,a;i.onKeyShortcut=function(t){var o=p[t.name]||0,r,u,s,e;return o&&(h.push(o),f||(f=setInterval(function(){h.length>0?$BSI.reportEvent("KB.Actions",{Shortcut:h.shift()}):f&&(clearInterval(f),f=null)},100))),r=!0,n.inArray(t.name,l)!==-1?(u=b(t.name),u&&(s=ol.Cmd("sel.keyboardshortcut").bubble(u,{name:t.name,srcElement:ol.getActiveElement(),entryPoint:t.entryPoint}),s.deferred.then(function(){r=!1}))):(e=i[t.name],t.triggeredByExternalEvent=!0,r=e?e(t):!0),r},i.undo=function(){ol.Cmd("undoaction").fire({entryPoint:HM.InstrumentationEntryPoint.KeyboardShortcut})},i.keyShortcutsEnabled=function(){return u.keyShortcutsEnabled()},i.newMsg=i.newMsg2=function(){ol.Cmd("begincomposesession").fire({action:"newmessage",entryPoint:HM.InstrumentationEntryPoint.KeyboardShortcut,curView:ol.Instrumentation.currentView(),numParticipants:0,priority:HM.InstrumentationPriority.Normal,composeLoaded:ol.Instrumentation.composeLoaded(),isFullCompose:!0})},i.reply=i.replyAll=i.forward=function(n){var t=r.getSelectedThreads(),i;t&&t.length===1&&(i=n.name.toLowerCase(),ol.Cmd(i).fire({action:i,thread:t[0],entryPoint:HM.InstrumentationEntryPoint.KeyboardShortcut}))},i.searchMail=function(){var t=n(".c_search_psb_box")[0];if(t)try{t.focus(),t.blur(),t.focus()}catch(i){}},i.closeFullViewMsg=function(){var n=r.readMessage().thread();n&&ol.Cmd("closeview").bubble(u,{thread:n})},i.deleteMsg=function(n){if(r.isBulkSelected()){var t=n&&n.srcElement?n.srcElement:null,i=r.MessageList.isQuickViewFilterOrSearch();ol.InboxActions.showEmptyContainerConfirmation(t,!i).then(function(t){t.buttonClicked==="action"&&ol.Cmd("bulkactionbycontainer").fire({action:"delete",entryPoint:n.entryPoint})})}else ol.vm.MessageThread.performActionOnThreads("deletemsg",r.getSelectedThreads(),n)},i.archive=function(n){var i,r,t;ol.GetAppConfig("IsArchiveEnabled")&&(i=u.getArchiveControl(),r=u.messageListControl&&u.messageListControl.shouldUnflagOnMove(),i&&(t=u.data,i.beginArchiveFlow({folderList:n&&n.folderList||t.folderList(),selectedThreads:n&&n.selectedThreads||t.getSelectedThreads(),unflag:n&&n.unflag||r,isBulkSelected:n&&n.isBulkSelected||t.isBulkSelected(),entryPoint:n.entryPoint,isMessagePartAction:n.isMessagePartAction})))},i.createRule=function(n){var i=u.getEditRuleControl(),t,f;i&&(t=u.data,f=n&&n.threads!==undefined?n.threads:r.getSelectedThreads(),i.createRule({autofillData:ol.RuleUtil.getAutofillData(f,r.categoryList()),actionsFolderList:t.folderList(),actionsCategoryList:t.categoryList()}))},i.editRule=function(n){var i=u.getEditRuleControl(),t;i&&(t=u.data,i.editRule({rule:n.rule,actionsFolderList:t.folderList(),actionsCategoryList:t.categoryList()}))},i.emptyContainer=function(n){ol.InboxActions.emptyContainer(n.senderElement,n.container||r.selectedContainer(),n.entryPoint)},i.markAsJunk=function(t){var i=ol.config.sysFldrs,u=[i.junkFid,i.sentFid,i.draftsFid],f=r.selectedContainer().isFolder()?r.selectedContainer().id():ol.config.sysFldrs.noneFid;t&&t.e&&t.event||(t=t||{},t.anchor=n("#MarkAsJunk").get(0)),o({cmdArgs:t,jmrType:HM.JmrType.Junk,actionOnThreadsToPerform:"markasjunk",extraCondition:u.indexOf(f)<0})},i.markAsNotJunk=function(t){t&&t.e&&t.event||(t=t||{},t.anchor=n("#MarkAsNotJunk").get(0)),o({cmdArgs:t,jmrType:HM.JmrType.NotJunk,actionOnThreadsToPerform:"markasnotjunk"})},i.markAsCompromised=function(n){o({cmdArgs:n,jmrType:HM.JmrType.Compromised,actionOnThreadsToPerform:"markascompromised",actOnPromiseDelegate:function(n){n.done(function(){ol.controlHelpers.SafetyUI.create().showSafetyNotificationWithNavigationButton({message:ol.GetString("Inbox.Safety.Notifications.Compromised.Message")})})}})},i.markAsPhish=function(n){o({cmdArgs:n,jmrType:HM.JmrType.Phish,actionOnThreadsToPerform:"markasphish",actOnPromiseDelegate:function(n){n.done(function(){ol.controlHelpers.SafetyUI.create().showSafetyNotificationWithNavigationButton({message:ol.GetString("Inbox.Safety.Notifications.Phishing.Message")})})}})},i.unsubscribe=function(n){var t=r.getSelectedThreads(),i=t[0].items().length>0?t[0].items()[0]:t[0];ol.controlHelpers.SafetyUI.create().showUnsubscribeConfirmation({anchor:n.event.target,activeMessageThread:i,folderName:r.selectedContainer().name()}).done(function(n){n.sweep&&ol.Cmd("bulkactionbysender").fire({action:"unsubscribe",entryPoint:HM.InstrumentationEntryPoint.MessageBody}),i.unsubscribe()})},i.moveToFolder=function(n){var e=n&&n.event,t=r.getSelectedThreads(),i=r.selectedContainer().id(),f=ol.config.sysFldrs,o=i===f.sentFid||i===f.draftsFid,s=u.messageListControl&&u.messageListControl.shouldUnflagOnMove();t.length>0&&ol.CommandBarWrapper.showMoveTo(e,t,s,r.isBulkSelected(),o,n.entryPoint,n.triggeredByExternalEvent)},i.newFolder=function(){r.LeftNav.ContainerLists[HM.ContainerType.Folders].RootContainer.newItem({editEntryPoint:HM.InstrumentationEntryPoint.KeyboardShortcut})},i.showCategoriesMenu=function(n){var f=n&&n.event,t=r.getSelectedThreads(),i=r.selectedContainer().id(),u=ol.config.sysFldrs,e=i===u.sentFid||i===u.draftsFid;t.length>0&&ol.CommandBarWrapper.showCategorize(f,t,r.isBulkSelected(),e,n.entryPoint,n.triggeredByExternalEvent)},i.newCategory=function(){r.LeftNav.ContainerLists[HM.ContainerType.Categories].RootContainer.newItem(ol.vm.Container.createDefaultCategoryOptions({editEntryPoint:HM.InstrumentationEntryPoint.KeyboardShortcut}))},i.removeCategory=function(){var o=r.isBulkSelected(),i=o?r.messageList().getAllVisibleThreads():r.getSelectedThreads(),u,n,t,e;if(i&&i.length){var s={},f=[],h=r.categoryList();for(u=0;u<i.length;u++)if(n=i[u].categories(),n)for(t=0;t<n.length;t++)e=h.getContainerById(n[t]),e&&e.isCategorizable()&&!s[n[t]]&&(s[n[t]]=!0,f.push(n[t]));f.length&&ol.vm.MessageThread.categorizeThreads(i,{remove:f,apply:[]},HM.InstrumentationEntryPoint.KeyboardShortcut,o)}},c={mark:"readState",flag:"flagState"},a={mark:["markasunread","markasread"],flag:["markasunflagged","markasflagged"]},i.markAsRead=function(n){e("mark",!0,n.entryPoint)},i.markAsUnread=function(n){e("mark",!1,n.entryPoint)},i.markAsFlagged=function(n){e("flag",!0,n.entryPoint)},i.markAsUnflagged=function(n){e("flag",!1,n.entryPoint)},i.toggleFlag=function(n){var t=[],f,i,o,u;if(r.isBulkSelected())for(f=r.messageList().items(),i=0;i<f.length;i++)t=t.concat(f[i].items());else t=r.getSelectedThreads();for(o=!1,u=0;u<t.length;u++)if(!t[u].isFlagged()){o=!0;break}e("flag",o,n.entryPoint)},i.toggleThreadExpandCollapseState=function(n){ol.CommandBarWrapper.toggleThreadExpandCollapseState(n.e)},i.viewSource=function(n){var t=r.getSelectedThreads(),i;t&&t.length===1&&(i=r.selectedContainer().isFolder()?r.selectedContainer().id():ol.config.sysFldrs.noneFid,t[0].viewSource(i,n.entryPoint))},i.printMsg=function(n){var t=r.getSelectedThreads2();if(t.length===1){var i=t[0],e=i.id(),o=i.viewId(),u=new ol.vm.ReadMessage,f=ol.vm.MessageThread.openPrintWindow();u.setThreadById(e,o,!1).then(function(){ol.vm.MessageThread.printThread(u.thread(),f.printWindow,f.printWindowLoaded,n.entryPoint)})}return!1},i.selectAll=function(n){var t=u.messageListControl,i;t&&(i=t.data.items()[t.data.activeGroupIndex()],i&&i.items().length>0&&ol.Cmd("ml.toggleselectallmessages").bubble(t,{selectAllMessages:!0,entryPoint:n.entryPoint}))},i.selectNone=function(){u.messageListControl&&ol.Cmd("ml.toggleselectallmessages").bubble(u.messageListControl,{selectAllMessages:!1})},i.refreshInbox=i.refreshInbox2=function(){u.refreshInbox()},i.goToInbox=function(){s(ol.config.sysFldrs.inboxFid)},i.goToFlagged=function(){s(ol.config.sysCats.flaggedFltid)},i.goToDrafts=function(){s(ol.config.sysFldrs.draftsFid)},i.goToSent=function(){s(ol.config.sysFldrs.sentFid)},i.goToPeople=function(){return $BSI.navigateTo("/mail/contacts.mvc?n="+ol.DynamicNonce()),!1},i.showHelp=function(){function t(){var t=DemandLoadHandler.getContent(HM.ContentId.KeyboardShortcutsHelp),i=wLive.Controls.Notifications.createModalDialog({content:t.dialog,notificationArea:t.link,buttons:{action:t.close},options:{moreCss:"kbsh_dialog"}});n(i).on("aftershow.kbsh",function(t,i){n(i.content()).on("keydown.kbsh",function(n){n.shiftKey&&n.which===191&&i.dismiss()})}).on("beforedismiss.kbsh",function(t,i){n(i.content()).unbind(".kbsh"),n(i).unbind(".kbsh")});i.show();var r=n(i.content()).closest(".kbsh_dialog"),o=r.find(".UserContent"),f=r.find(".UserArea"),e=o.height(),u=f.height();if(e>u){var s=n(window).height()-r.height(),h=e-u,c=u+Math.min(s,h);f.css("max-height",c+"px")}}DemandLoadHandler.demandLoadContent([HM.ContentId.KeyboardShortcutsHelp],[t])},i.printNextMessage=n.noop,w()}}(window.originaljQuery||window.jQuery),function(){"use strict";var u=window.ol=window.ol||{},n=ol.data=ol.data||{},t=n.fpp=n.fpp||{},i=t.FppEngine,f=window.ActionQueue,r=window.ActionQueueTypes.ActionType;i.registerFppConfig("addcontacts",{fppMethod:"AddContacts",tokenConfig:{friendlyName:"AddContacts",actionType:r.async,getTokenKeys:function(n){return n.args.queryAddingContactFrom&&n.args.queryAddingContactFrom.containerId?[n.args.queryAddingContactFrom.containerId]:[null]}},cmdArgs:[{name:"contactsToAdd",type:Array},{name:"queryAddingContactFrom",type:Object},{name:"messageQueriesToFetch",type:Array}]})}(),function(){"use strict";var u=window.ol=window.ol||{},n=ol.data=ol.data||{},t=n.fpp=n.fpp||{},i=t.FppEngine,f=window.ActionQueue,r=window.ActionQueueTypes.ActionType;i.registerFppConfig("addfolder",{fppMethod:"AddFolder",tokenConfig:{friendlyName:"AddFolder",actionType:r.async,getTokenKeys:function(){return[null]}},cmdArgs:[{name:"folderName",type:String},{name:"parentFolderId",type:String},{name:"isArchive",type:Boolean}],returnServerResults:!0,suppressServerErrors:!0})}(),function(){"use strict";var u=window.ol=window.ol||{},n=ol.data=ol.data||{},t=n.fpp=n.fpp||{},i=t.FppEngine,f=window.ActionQueue,r=window.ActionQueueTypes.ActionType;i.registerFppConfig("addupdatedeletecategories",{fppMethod:"AddUpdateDeleteCategories",tokenConfig:{friendlyName:"AddUpdateDeleteCategories",actionType:r.async,getTokenKeys:function(){return[null]}},cmdArgs:[{name:"categoriesToAdd",type:Array},{name:"categoriesToUpdate",type:Array},{name:"categoriesToDelete",type:Array},{name:"categorySettings",type:Object}],returnServerResults:!0,suppressServerErrors:!0})}(),function(){"use strict";var f=window.ol=window.ol||{},n=ol.data=ol.data||{},t=n.fpp=n.fpp||{},i=t.FppEngine,e=window.ActionQueue,r=window.ActionQueueTypes.ActionType,u={fppMethod:"BlockSenders",tokenConfig:{friendlyName:"BlockSenders",actionType:r.async,getTokenKeys:function(){return[null]}},cmdArgs:[{name:"senders",type:Array}]};i.registerFppConfig("blocksenders",u)}(),function(){"use strict";var u=window.ol=window.ol||{},n=ol.data=ol.data||{},t=n.fpp=n.fpp||{},i=t.FppEngine,f=window.ActionQueue,r=window.ActionQueueTypes.ActionType;i.registerFppConfig("emptyfolder",{fppMethod:"ClearFolder",tokenConfig:{friendlyName:"ClearFolder",actionType:r.async,getTokenKeys:function(n){return[n.args.folderId]}},cmdArgs:[{name:"folderId",type:String}]})}(),function(){"use strict";var u=window.ol=window.ol||{},n=ol.data=ol.data||{},t=n.fpp=n.fpp||{},i=t.FppEngine,f=window.ActionQueue,r=window.ActionQueueTypes.ActionType;i.registerFppConfig("createmoverule",{fppMethod:"CreateMoveRule",tokenConfig:{friendlyName:"CreateMoveRule",actionType:r.async,getTokenKeys:function(){return[null]}},cmdArgs:[{name:"ruleNoun",type:String},{name:"matchingString",type:String},{name:"fid",type:String},{name:"folderName",type:String}]})}(),function(){"use strict";var u=window.ol=window.ol||{},n=ol.data=ol.data||{},t=n.fpp=n.fpp||{},i=t.FppEngine,f=window.ActionQueue,r=window.ActionQueueTypes.ActionType;i.registerFppConfig("deletefolder",{fppMethod:"DeleteFolder",tokenConfig:{friendlyName:"DeleteFolder",actionType:r.async,getTokenKeys:function(n){return[n.args.folderId]}},cmdArgs:[{name:"folderId",type:String},{name:"folderType",type:Number}],returnServerResults:!0})}(),function(){"use strict";var f=window.ol=window.ol||{},i=ol.data=ol.data||{},u=i.fpp=i.fpp||{},n=u.FppEngine,e=window.ActionQueue,r=window.ActionQueueTypes.ActionType,t={fppMethod:"MarkMessagesFlagState",tokenConfig:{friendlyName:"flagitems",actionType:r.async,getTokenKeys:function(n){return n&&n.args&&n.args.messagesParam?n.args.messagesParam:null}},cmdArgs:[{name:"flagState",type:Boolean},{name:"messages",type:Array},{name:"auxData",type:Array},{name:"viewInfos",type:Array},{name:"getAffectedHeaders",type:Boolean}],bulkActionsConfig:{tokenConfig:{friendlyName:"MarkMessagesFlagStateLoop",actionType:r.blocking,getTokenKeys:function(){return null}},cmdArgsToNull:["messages","auxData","viewInfos"]}};n.registerFppConfig("undoflagitems",jQuery.extend({},t,{suppressServerErrors:!0})),n.registerFppConfig("flagitems",t),n.registerFppConfig("batchflagitems",t)}(),function(){"use strict";var f=window.ol=window.ol||{},i=ol.data=ol.data||{},u=i.fpp=i.fpp||{},n=u.FppEngine,e=window.ActionQueue,r=window.ActionQueueTypes.ActionType,t={fppMethod:"MarkMessagesForJmr",tokenConfig:{friendlyName:"MarkMessagesForJmr",actionType:r.async,getTokenKeys:function(n,t){var r=i.FppUtils.getConversationQueries(t.itemListQueries),u;return r!==null&&r.length===1&&r[0].senderEmail&&(u=r[0].senderEmail),n&&n.args&&n.args.messagesParam?[n.args.fid,u].concat(n.args.messagesParam):null}},cmdArgs:[{name:"fid",type:String},{name:"messagesParam",type:Array},{name:"auxData",type:Array},{name:"jmrType",type:Number},{name:"enableJmrReporting",type:Boolean},{name:"removeFromList",type:Number},{name:"suppressListTransition",type:Boolean},{name:"markSenderAsSafe",type:Boolean},{name:"viewInfos",type:Array},{name:"getAffectedHeaders",type:Boolean}],bulkActionsConfig:{tokenConfig:{friendlyName:"MarkMessagesForJmrLoop",actionType:r.blocking,getTokenKeys:function(){return null}},cmdArgsToNull:["messagesParam","auxData","viewInfos"]}};n.registerFppConfig("undojunkandunjunkitems",jQuery.extend({},t,{suppressServerErrors:!0})),n.registerFppConfig("junkitems",t),n.registerFppConfig("unjunkitems",t),n.registerFppConfig("markassafe",t),n.registerFppConfig("batchjunkitems",t),n.registerFppConfig("batchunjunkitems",t),n.registerFppConfig("compromiseitems",t),n.registerFppConfig("phishitems",t),n.registerFppConfig("unsubscribeitems",t)}(),function(){"use strict";var f=window.ol=window.ol||{},i=ol.data=ol.data||{},u=i.fpp=i.fpp||{},n=u.FppEngine,e=window.ActionQueue,r=window.ActionQueueTypes.ActionType,t={fppMethod:"MarkMessagesReadState",tokenConfig:{friendlyName:"markmessagesreadstate",actionType:r.async,getTokenKeys:function(n){return n&&n.args&&n.args.messagesParam?n.args.messagesParam:null}},cmdArgs:[{name:"readState",type:Boolean},{name:"messagesParam",type:Array},{name:"auxData",type:Array},{name:"viewInfos",type:Array},{name:"getAffectedHeaders",type:Boolean}],bulkActionsConfig:{tokenConfig:{friendlyName:"MarkMessagesReadStateLoop",actionType:r.blocking,getTokenKeys:function(){return null}},cmdArgsToNull:["messagesParam","auxData","viewInfos"]}};n.registerFppConfig("undomarkitems",jQuery.extend({},t,{suppressServerErrors:!0})),n.registerFppConfig("markitems",t),n.registerFppConfig("batchmarkitems",t),n.registerFppConfig("getandmarkasread",t)}(),function(){"use strict";var u=window.ol=window.ol||{},n=ol.data=ol.data||{},t=n.fpp=n.fpp||{},i=t.FppEngine,f=window.ActionQueue,r=window.ActionQueueTypes.ActionType;i.registerFppConfig("movefolder",{fppMethod:"MoveFolder",tokenConfig:{friendlyName:"MoveFolder",actionType:r.async,getTokenKeys:function(n){return[n.args.folderId]}},cmdArgs:[{name:"folderId",type:String},{name:"newParentFolderId",type:String}],returnServerResults:!0})}(),function(){"use strict";var f=window.ol=window.ol||{},n=ol.data=ol.data||{},u=n.fpp=n.fpp||{},t=u.FppEngine,e=window.ActionQueue,i=window.ActionQueueTypes.ActionType,r={fppMethod:"MoveMessagesToFolder",tokenConfig:{friendlyName:"MoveMessagesToFolderFromMessage",actionType:i.async,getTokenKeys:function(n){return[n.args.folderId]}},cmdArgs:[{name:"toFid",type:String},{name:"msgs",type:Array},{name:"mads",type:Array},{name:"viewInfos",type:Array},{name:"blockIfDelete",type:Boolean},{name:"unpinOnMove",type:Boolean},{name:"markMessagesAsRead",type:Boolean},{name:"getAffectedHeaders",type:Boolean}],bulkActionsConfig:{tokenConfig:{friendlyName:"MoveMessagesToFolderLoop",actionType:i.blocking,getTokenKeys:function(){return null}},cmdArgsToNull:["msgs","mads","viewInfos"]},suppressServerErrors:function(n){for(var e=n.args.destId,o=ol.data.ConversationPool.viewFromContainerId(e),i=n.args.items,r,u,f,t=0;t<i.length;t++)if(r=i[t].itemId,ol.data.isConversationId(r)&&(u=i[t].viewId,f=ol.data.ConversationPool.viewFromContainerId(u),o===f))return!0;return!1}};t.registerFppConfig("moveitems",r),t.registerFppConfig("batchmoveitems",r)}(),function(){"use strict";var n=window.ol=window.ol||{},t=n.data=n.data||{},i=t.fpp=t.fpp||{},r=i.FppEngine,e=window.ActionQueue,u=window.ActionQueueTypes.ActionType,f={fppMethod:"MultiMoveMessagesToFolder",tokenConfig:{friendlyName:"MoveMessagesToFolderFromMessage",actionType:u.async,getTokenKeys:function(){return[null]}},cmdArgs:[{name:"moveInfos",type:Array}],suppressServerErrors:!0};r.registerFppConfig("undomoveitems",f)}(),function(){"use strict";var u=window.ol=window.ol||{},n=ol.data=ol.data||{},t=n.fpp=n.fpp||{},i=t.FppEngine,f=window.ActionQueue,r=window.ActionQueueTypes.ActionType;i.registerFppConfig("restorehiddentrash",{fppMethod:"RestoreHiddenTrash",tokenConfig:{friendlyName:"RestoreHiddenTrash",actionType:r.view,getTokenKeys:function(){return[null]}},cmdArgs:[],returnServerResults:!0})}(),function(){"use strict";var u=window.ol=window.ol||{},n=ol.data=ol.data||{},t=n.fpp=n.fpp||{},i=t.FppEngine,f=window.ActionQueue,r=window.ActionQueueTypes.ActionType;i.registerFppConfig("setconversationmode",{fppMethod:"SetConversationMode",tokenConfig:{friendlyName:"setconversationmode",actionType:r.blocking,getTokenKeys:function(){return null}},cmdArgs:[{name:"conversationSetting",type:Boolean}]})}(),function(){"use strict";var u=window.ol=window.ol||{},n=ol.data=ol.data||{},t=n.fpp=n.fpp||{},i=t.FppEngine,f=window.ActionQueue,r=window.ActionQueueTypes.ActionType;i.registerFppConfig("svmfeedback",{fppMethod:"SvmFeedback",tokenConfig:{friendlyName:"SvmFeedback",actionType:r.blocking,getTokenKeys:function(){return[null]}},cmdArgs:[{name:"svmUrl",type:String},{name:"svmMsgId",type:String}]})}(),function(){"use strict";var u=window.ol=window.ol||{},n=ol.data=ol.data||{},t=n.fpp=n.fpp||{},i=t.FppEngine,f=window.ActionQueue,r=window.ActionQueueTypes.ActionType;i.registerFppConfig("undosendermovetoblocklist",{fppMethod:"UndoSenderMoveToBlockList",tokenConfig:{friendlyName:"UndoSenderMoveToBlockList",actionType:r.async,getTokenKeys:function(n){return[n.args.senderAddress]}},cmdArgs:[{name:"senderAddress",type:String},{name:"isRetry",type:Boolean}]})}(),function(){"use strict";var u=window.ol=window.ol||{},n=ol.data=ol.data||{},t=n.fpp=n.fpp||{},i=t.FppEngine,f=window.ActionQueue,r=window.ActionQueueTypes.ActionType;i.registerFppConfig("updatefolder",{fppMethod:"UpdateFolder",tokenConfig:{friendlyName:"UpdateFolder",actionType:r.async,getTokenKeys:function(n){return[n.args.folderId]}},cmdArgs:[{name:"folderId",type:String},{name:"newFolderName",type:String},{name:"isArchive",type:Boolean}],returnServerResults:!0,suppressServerErrors:!0})}(),function(n,t){"use strict";function u(i,u,o){var b=i.itemIdsWithDuplicates,g=i.viewIdsWithDuplicates,a,v,c,s,h,l,y,w;for(a=!1,v=!1,c=0;c<b.length;c++){if((s=b[c],h=g[c],r.isTemporaryId(s))||(l=u._getConversationFromId(s),!l))return!1;if(y=f.viewFromContainerId(h),r.isConversationId(s)){if(v=!0,!l.rollups[y])return!1}else if(r.isMessageId(s)||r.isMessageAsConversationId(s)){var k=r.getMid(s),nt=r.makeMessageAsConversation(k),d=l.messages[k],p=l.messageRollups[nt];if(!(p||d))return!1;if(w=p?p.rollup.folderId:e(s,d),h!==n.config.sysFldrs.noneFid)if(r.isFolderId(h)&&h!==n.config.sysFldrs.searchFid){if(t.inArray(s,i.itemIds)!==-1&&w!==h)return!1}else if(y!==HM.ConversationView.Normal)return!1;o&&o!==w&&(a=!0)}else return!1}return o&&!(a||v)?!1:!0}function e(n,t){for(var r,i=0;i<t.allHeaders.length;i++)if(r=t.allHeaders[i],r.id===n)return r.folderId;return null}var r=n.data=n.data||{},f=r.ConversationPool,i;i=f.prototype,i.validate_unjunkitems=function(t){for(var r=this._getIndicatedIds(t),f=r.viewIds,i=0;i<f.length;i++)if(f[0]!==n.config.sysFldrs.junkFid)return!1;return u(r,this,n.config.sysFldrs.inboxFid)},i.validate_moveitems=function(t){var e=t.command,r=this._getIndicatedIds(t),f=r.viewIdsWithDuplicates,i;if(t.parameters.destId===n.config.sysFldrs.trashFid)for(i=0;i<f.length;i++)if(f[i]===n.config.sysFldrs.trashFid)return!1;return u(r,this,t.parameters.destId)},i.validate_getandmarkasread=function(n){return n.parameters.allowUnknownItems||this.validate_markitems(n)},i.validate_markassafe=function(n){n.parameters.items=[n.parameters.item];var t=this._getIndicatedIds(n);return u(t,this)},i.validate_junkitems=i.validate_categorizeitems=i.validate_compromiseitems=i.validate_phishitems=i.validate_unsubscribeitems=i.validate_markitems=function(n){var t=this._getIndicatedIds(n);return u(t,this)},i.validate_flagitems=function(n){for(var s=n.command,i=this._getIndicatedIds(n),r=i.viewIdsWithDuplicates,e,o,t=0;t<r.length;t++)if(e=r[t],o=f.viewFromContainerId(e),o!==HM.ConversationView.Normal)return!1;return u(i,this)}}(window.ol,window.originaljQuery||window.jQuery),define(["ol"],function(n){"use strict";function f(n,t){return!!t._getContainerById(n)}function i(t,i){return r.isFolderId(t)&&(t===n.config.sysFldrs.noneFid||t===n.config.sysFldrs.searchFid||f(t,i))}function e(n,t){return r.isCategoryId(n)&&f(n,t)}function o(n,t){if(n)for(var i=0;i<n.length;i++)if(!e(n[i],t))return!1;return!0}function s(n,t){if(n)for(var i=0;i<n.length;i++)if(!e(n[i].categoryId,t))return!1;return!0}function l(t,i){if(r.isFolderId(t)){var u=i._getContainerById(t);if(u)return u.container.parent===n.config.sysFldrs.noneFid}return!1}function a(n,t){if(r.isFolderId(n)){var i=t._getContainerById(n);if(i)return!!i.container.isArchive}return!1}function u(n,t){if(r.isFolderId(n)){var i=t._getContainerById(n);if(i)return i.container.folderType===HM.FolderType.USER_DEFINED||i.container.folderType===HM.FolderType.AGGREGATED}return!1}function h(n){for(var i=n._containers,t=0;t<i.length;t++)if(i[t].container.isArchive)return!0;return!1}function v(n){return!(n!==null&&n!==""&&n!==undefined)}var r=n.data=n.data||{},c=r.ContainerModel,t;t=c.prototype,t.validate_moveitems=t.validate_batchmoveitems=function(n){var t=n.parameters;return r.isSystemFolderId(t.destId)||i(t.destId,this)},t.validate_categorizeitems=function(n){var t=n.parameters;return o(t.apply,this)&&o(t.remove,this)},t.validate_emptyfolder=t.validate_expandfolder=t.validate_collapsefolder=function(n){return i(n.parameters.folderId,this)},t.validate_addfolder=function(n){var t=n.parameters;return i(t.parentFolderId,this)?t.isArchive&&h(this)?!1:!0:!1},t.validate_deletefolder=function(n){var t=n.parameters;return i(t.folderId,this)&&u(t.folderId,this)},t.validate_updatefolder=function(n){var t=n.parameters;return i(t.folderId,this)?u(t.folderId,this)?t.isArchive&&(h(this)||!l(t.folderId,this))?!1:!0:!1:!1},t.validate_movefolder=function(n){var t=n.parameters;return i(t.folderId,this)&&i(t.newParentFolderId,this)&&u(t.folderId,this)&&!a(t.folderId,this)},t.validate_addupdatedeletecategories=function(n){var t=n.parameters;return s(t.categoriesToDelete,this)&&s(t.categoriesToUpdate,this)},t.validate_createmoverule=function(n){var t=n.parameters;return i(t.fid,this)&&!v(t.folderName)},t.validate_createrecipientmoverule=function(n){var t=n.parameters;return i(t.folderId,this)||t.folderName!=null},t.validate_junkitems=t.validate_batchjunkitems=t.validate_phishitems=t.validate_compromiseitems=t.validate_unsubscribeitems=function(n){return i(n.parameters.fid,this)}}),function(){"use strict";function r(t){return{key:"",title:"",initialSelection:null,isMultiSelect:!1,containerList:null,editingContainer:null,toolTip:"",actions:[],menuTag:"",itemsTag:"",titleClass:"",menuAnchorClass:"",menuChevClass:"ExcoOpenSmall",filterFn:null,menuType:t?null:n.ContainerPickerEnums.MenuType.ContainerSelector,clearSelectionItemTemplate:"",clearSelectionItemText:"",showSelectionState:!0,entryPoint:-1}}var n=window.ol=window.ol||{},i=n.vm=n.vm||{},f=n.Accessor,t=n.vm.Container.ContainerSelection,u=i.ContainerSelector=function(r){function o(t){return t||(t=u.getSelection()),!n.Array.areEquivalent(u.initialSelection(),t)}function f(n,i){if(n.selectionState()===t.ON)i.push(n.id());else if(n.items())for(var r=0;r<n.items().length;r++)f(n.items()[r],i)}function e(n){n||(n=u.getSelection()),u.selectionIsEmpty(!(n&&n.length))}function s(){u.isMultiSelect()&&u.actions().push(new i.MenuItem({text:n.GetString("ContainerSelector.Apply"),sutraTag:"applyselection",cssClass:"cs_apply",template:"#containerPickerActionButtonTemplate"}))}var u=this;u.initAccessorValues(r),u.selectionIsEmpty=function(t){return n.Accessor(this,"SelectionIsEmpty",t)},u.clearSelection=function(){return u.setSelection(u.containerList().rootContainer(),t.OFF)},u.setSelection=function(n,i){var u=i===t.OFF?t.OFF:t.PARENT_ON,r;return n.setSelectionRecursively(i,u),r=this.getSelection(),e(r),o(r)},u.initializeSelection=function(){var r,i,f,n;if(u.clearSelection(),u.initialSelection())if(u.isMultiSelect())for(r=u.initialSelection(),i=0;i<r.length;i++)f=r[i],n=u.containerList().getContainerById(f),n.setSelectionRecursively(t.ON,t.PARENT_ON);else n=u.containerList().getContainerById(u.initialSelection()),n.selectionState(t.ON);e(u.initialSelection())},u.getSelection=function(){var n=[];return f(u.containerList().rootContainer(),n),n},s()};n.AddOptionsAccessorAndInitFunctions(u.prototype,r)}(window.originaljQuery||window.jQuery),function(n){"use strict";function u(n){return{containerList:n?null:new t.vm.ContainerList({title:t.GetString("MessageList.Categorize"),type:HM.ContainerType.Categories,newItemLabel:t.GetString("Categories.Menu.AddNewInlineCategory")}),editingContainer:null,actions:[],params:null,loc:1,menuTag:"CategorizeMenu",itemsTag:"CategoriesItems",selectedMsgs:[],bulkSelected:!1,filterFn:n?null:function(n){return n.isCategory()&&n.isCategorizable()||n.IsEditing},menuType:n?null:t.ContainerPickerEnums.MenuType.Categorize,hasApplicableInitialCategory:!1,showSelectionState:!0,entryPoint:-1,isMessagePart:!1}}var t=window.ol=window.ol||{},r=t.vm=t.vm||{},e=t.Accessor,i=t.vm.Container.ContainerSelection,f=r.CategorizeMenu=function(u){function s(n){var i=f.containerList(),t;for(n.applyNames=[],t=0;t<n.apply.length;t++)n.applyNames.push(i.getContainerById(n.apply[t]).name());for(n.removeNames=[],t=0;t<n.remove.length;t++)n.removeNames.push(i.getContainerById(n.remove[t]).name())}function h(t){var r=[],u=[];return n.each(t,function(n,t){var f=e[n];t===i.ON?r.push(parseInt(n)):t===i.OFF&&f!==undefined&&f!==t&&u.push(parseInt(n))}),{apply:r,remove:u}}function o(){var t={};return n.each(f.containerList().rootContainer().items(),function(n,i){i&&i.isCategorizable()&&(t[i.id()]=i.selectionState())}),t}function c(){t.GetAppConfig("IsBulkActionsEnabled")&&f.actions().push(new r.MenuItem({text:t.GetString("Categories.Menu.ApplyCategoryToSenders"),title:t.GetString("Categories.Menu.ApplyCategoryToSenders"),sutraTag:"CategorizeAllFrom",id:"CategorizeAllFrom",cssClass:"cm_apply cm_sender",template:"#containerPickerActionLinkTemplate"}))}var f=this,e;f.initAccessorValues(u),e={},f.getInitialCategorySelection=function(n,r,u){var l,s,h,v,y,p,a,c;if(f.hasApplicableInitialCategory(!1),l=f.containerList().rootContainer().items(),s=0,r&&!u)for(s=0;s<l.length;s++)h=l[s],h&&h.isCategorizable()&&h.selectionState(i.MIXED);else{for(s=0;s<l.length;s++)h=l[s],h&&h.isCategorizable()&&h.selectionState(i.OFF);for(v=t.vm.MessageThread.getCurrentCategorySelection(n),y=v.all,s=0;s<y.length;s++)a=y[s],c=f.containerList().getContainerById(a),c&&c.isCategorizable()&&(c.selectionState(i.ON),f.hasApplicableInitialCategory(!0));for(p=v.some,s=0;s<p.length;s++)a=p[s],c=f.containerList().getContainerById(a),c&&c.isCategorizable()&&c.selectionState(i.MIXED)}e=o()},f.hasSelectionChanged=function(){var r=o(),t=!1;return n.each(r,function(n,r){var u=e[n];return u=u===undefined?i.OFF:u,r!==u?(t=!0,!1):void 0}),t},f.getSingleSelectionChange=function(n){var t=[],r=[];return n.selectionState()===i.ON?t.push(n.id()):n.selectionState()===i.OFF&&r.push(n.id()),{apply:t,remove:r}},f.getSelectionChanges=function(n){var t=h(o());return n&&s(t),t},c()};t.AddOptionsAccessorAndInitFunctions(f.prototype,u)}(window.originaljQuery||window.jQuery),function(){"use strict";function i(t){return{containerList:t?null:new n.vm.ContainerList({title:n.GetString("FolderList.Header.Label"),newItemLabel:n.GetString("MoveTo.Folder.NewFolder"),type:HM.ContainerType.Folders,rootContainer:new n.vm.Container({id:n.config.sysFldrs.noneFid,depth:0})}),actions:[],menuTag:"",itemsTag:"",selectedMsgs:[],unflag:!1,bulkSelected:!1,filterFn:t?null:function(t){return t.id()!==n.config.sysFldrs.searchFid},editingContainer:null,menuType:t?null:n.ContainerPickerEnums.MenuType.MoveTo,showSelectionState:!1,entryPoint:-1}}var n=window.ol=window.ol||{},t=n.vm=n.vm||{},u=n.Accessor,r=t.MoveToMenu=function(i){function u(){n.GetAppConfig("IsBulkActionsEnabled")&&r.actions().push(new t.MenuItem({text:n.GetString("MoveAllFromSender.Generic"),title:n.GetString("MoveAllFromSender.Generic"),id:"MoveAllFrom",cssClass:"mtm_moveAllFrom",sutraTag:"MoveAllFrom",template:"#containerPickerActionLinkTemplate"}))}var r=this;r.initAccessorValues(i),u()};n.AddOptionsAccessorAndInitFunctions(r.prototype,i)}(),function(){"use strict";function i(){return{title:"",menuItems:[],params:null}}var n=window.ol=window.ol||{},t=n.vm=n.vm||{},u=n.Accessor,r=t.LeftNavContextMenu=function(n){var t=this;t.initAccessorValues(n)};n.AddOptionsAccessorAndInitFunctions(r.prototype,i)}(),function(){"use strict";function i(){return{layout:null,messageList:null}}var n=window.ol=window.ol||{},t=n.vm=n.vm||{},u=n.Accessor,r=t.Instrumentation=function(t){function r(){n.Instrumentation.setVm(i)}var i=this;i.initAccessorValues(t),r()};n.AddOptionsAccessorAndInitFunctions(r.prototype,i)}(),function(){"use strict";function i(){return{sendMenuItems:[],messageMenuItems:[],senderMenuItems:[],senderName:"",senderEmail:"",messageMenuTitle:"",senderMenuTitle:"",params:null,messageRow:null,isSenderMenu:!1}}var n=window.ol=window.ol||{},t=n.vm=n.vm||{},u=n.Accessor,r=t.MessageListContextMenu=function(n){function i(n){var i=[];switch(n){case"send":i=t.SendMenuItems;break;case"message":i=t.MessageMenuItems;break;case"sender":i=t.SenderMenuItems}return i}var t=this;t.initAccessorValues(n),t.setMenuItemStyle=function(n,t,r){for(var f=i(n),e=f.length,u=0;u<e;u++)if(t===f[u].Key){f[u].cssClass(r);return}},t.containsMenuItem=function(n,t){for(var u=i(n),f=u.length,r=0;r<f;r++)if(t===u[r].Key)return!0;return!1}};n.AddOptionsAccessorAndInitFunctions(r.prototype,i)}(),function(n){"use strict";function u(){return{thread:null,viewId:null,showActionMenu:!0}}var t=window.ol=window.ol||{},r=t.vm=t.vm||{},f=t.Accessor,i=r.ReadMessage=function(i){function a(n){for(var f=!1,e=n.items(),o,i,r,u,t=0;t<e.length;t++)if(o=e[t],!o.isDraft()){f=!0;break}if(f&&(i=parseInt(n.messageBodySize())+parseInt(n.inlineAttachmentsSize()),r=i+parseInt(n.regularAttachmentsSize()),!isNaN(i)&&!isNaN(r)))return u=102.4,{SZB:Math.ceil(i/u),SZT:Math.ceil(r/u)}}function v(){var n=r.getQueriedMessage();n&&n.requestBody().then(function(){n.isBodyExpanded(!0)})}function o(n,i,u,e){var s=null,o;return f&&(r.thread()&&r.thread().unregisterAllBodies(),t.Dispatcher.unregister(r.apply,r)),f=n,f&&(t.Dispatcher.register([n],r.apply,r,r.handleInvalidQueries),u||(o=[],o.push({itemId:n.containerId,viewId:i}),s=t.Dispatcher.fireCmd("getandmarkasread",{items:o,asRead:!0,throttleActionTime:c,maxThrottleActions:l,shouldThrottle:!0,dontInstrument:!0,allowUnknownItems:e}))),s}var r=this,f=null;r.initAccessorValues(i);var u=null,c=200,l=1,s,h,e;r.apply=function(n,i){var c=null,e,o,s,h;return f&&f.key()in i&&(e=i[f.key()],e.status===HM.Status.Complete&&(o=r.applyImpl(e),c=o.promise,s=f.containerId,h=t.data.getMappedIdIfNecessary(s,e.idMapping),s!==h&&r.setThreadById(h,r.viewId(),!0),u&&(u.resolve(o.sizes),u=null))),c},r.handleInvalidQueries=function(n,t){var i=f&&t[f.key()];i&&i.isQueryInvalidationChange&&(u&&(u.reject(),u=null),o(null))},r.applyImpl=function(i){var e,u=r.thread(),o,h;if(u&&i.rollup&&t.data.isSameThread(u.id(),i.rollup.itemId,i.idMapping)){var s={addedThreads:[],removedThreads:[],addedThreadsMap:{},removedThreadsMap:{}},f=u.updateFromResult(i,!1,{changes:s}),c=t.Cmd("rp.precommit").fire(s);f=t.deferredUtils.whenAll([f,c]),f.then(n.proxy(u.commit,u)),e={promise:f}}else i.rollup.viewId=r.viewId(),o=t.vm.MessageThread.createFromResult(i),r.thread(o),h=a(o),e={promise:n.when(),sizes:h};return v(),e},r.setThreadById=function(i,f,e,s){var h,l,c;return r.viewId(f),h=null,u&&(u.reject(),u=null),i?(l=u=n.Deferred(),c=o(HM.createItemListQuery({containerId:i,containerType:HM.ItemListQueryContainerType.Conversation,folderId:t.data.isFolderId(f)?f:t.config.sysFldrs.inboxFid}),f,e,s),c?(c.deferred.then(function(){t.Cmd("rm.messageloaded").fire()},function(){u&&(u.reject(),u=null)}),h=l.promise()):h=n.when()):(o(null),r.thread(null),h=n.when()),h},r.getQueriedMessage=function(){var i=r.thread(),n=f&&f.containerId,u,o;if((n!==s||i!==h)&&(s=n,h=i,e=null,n=n&&t.data.isMessageAsConversationId(n)?t.data.getMidFromMessageAsConversation(n):null,n&&i&&i.Items.length>1))for(u=0;u<i.Items.length;u++)if(o=i.Items[u],o.id()===n||o.AllIds[n]){e=o;break}return e},r.getActionableMsgPart=function(){return r.thread().getActionableMessageThread()},r.serverError=function(n){t.Dispatcher.fireCmd("setservererrormessage",{serverErrorMessage:n})}};t.AddOptionsAccessorAndInitFunctions(i.prototype,u),i.prototype.thread=function(n,i){var r=this;return r.Thread&&n!==undefined&&r.Thread.dispose(),t.AccessorWithOptions(r,"Thread",n,i)}}(window.originaljQuery||window.jQuery),function(n){"use strict";function f(){return{dataForCallingUndo:null,undoableCmd:null,undoTooltip:"",leftNav:null}}var t=window.ol=window.ol||{},u=t.vm=t.vm||{},i=function(){return!0},r={"nav.container":i,deletefolder:i,bulkactionbycontainer:function(n){return n.action==="delete"},emptyfolder:i,addfolder:i,movefolder:i,moveitems:function(n){return n.destId===t.config.sysFldrs.permDelFid},phishitems:i,compromiseitems:i,unsubscribeitems:i,"nav.inbox":i,"nav.compose":i,"nav.options":i,"nav.managecategories":i,"ml.change":i,updatefolder:i,bulkactions:i,batchmoveitems:i,batchmarkitems:i,batchflagitems:i,batchjunkitems:i,batchunjunkitems:i,begincomposesession:i,endcomposesession:i,refresh:i},e=u.Undo=function(i){function h(n,i){var f=n.args,r=i.args.items.length,u=r>1;return f.asRead?u?t.GetString("Undo.Items.Marked.Read.Multiple").format(r):t.GetString("Undo.Items.Marked.Read.Single"):u?t.GetString("Undo.Items.Marked.UnRead.Multiple").format(r):t.GetString("Undo.Items.Marked.UnRead.Single")}function o(n,i,r,f){for(var s=null,h,o,e=0;e<n.length;e++)h=n[e],o=u.leftNav().getContainerNameById(h),o&&(s=f>1?t.GetString(i).format(o,f):t.GetString(r).format(o));return s}function c(n,t){var i=s[n.name];if(i)return i.genStrFnc(n,t)}function l(){u.initAccessorValues(i);for(var n in r)r.hasOwnProperty(n)&&t.Cmd(n).subscribe(u.clearUndoStack);e=HM.createUndoQuery(),t.Dispatcher.register([e],u.apply,u),t.Dispatcher.fireCmd("get")}var u=this,e,f,s;u.apply=function(n,t){var r,f,i;for(r in t)e.key()===r&&(f=t[r],f.status===HM.Status.Complete&&(i=f.undoData,i?(u.undoableCmd(i.undoableCmd),u.dataForCallingUndo({nameForUndoCmd:i.nameForUndoCmd,argsForUndoCmd:i.argsForUndoCmd})):u.dataForCallingUndo(null)))},s={undomoveitems:{genStrFnc:function(n,i){var f=n.args,l,e,s,c,h,r;if(l=i.args.items.length,e=null,f){var o=l,a=!1,v=f.moveInfos[0].toFolderId;for(s=0;s<f.moveInfos.length;s++)if(f.moveInfos[s].toFolderId!==v){a=!0;break}if(c=f.moveInfos[0].toFolderId,a)r=t.GetString("Undo.Items.MoveItems.Inbox.Multiple"),e=r.format(o);else if(c===t.config.sysFldrs.inboxFid)h=o>1?"Undo.Items.MoveItems.Inbox.Multiple":"Undo.Items.MoveItems.Inbox.Single",r=t.GetString(h),e=r.format(o);else{var h=o>1?"Undo.Items.MoveItems.Multiple":"Undo.Items.MoveItems.Single",r=t.GetString(h),y=u.leftNav().getContainerNameById(c);e=r.format(y,o)}}return e}},undojunkandunjunkitems:{genStrFnc:function(n,i){var f=n.args,r=i.args.items.length,e=r>1,u=null;return f.jmrType===HM.JmrType.Junk?u=e?t.GetString("Undo.Items.Marked.Junk.Multiple").format(r):t.GetString("Undo.Items.Marked.Junk.Single"):f.jmrType===HM.JmrType.NotJunk&&(u=e?t.GetString("Undo.Items.Marked.NotJunk.Inbox.Multiple").format(r):t.GetString("Undo.Items.Marked.NotJunk.Inbox.Single")),u}},undomarkitems:{genStrFnc:h},undoflagitems:{genStrFnc:function(n,i){var f=n.args,r=i.args.items.length,u=r>1;return f.asFlagged?u?t.GetString("Undo.Items.Flagged.Multiple").format(r):t.GetString("Undo.Items.Flagged.Single"):u?t.GetString("Undo.Items.UnFlagged.Multiple").format(r):t.GetString("Undo.Items.UnFlagged.Single")}},undocategorizeitems:{genStrFnc:function(n,t){var i=n.args,r=t.args.items.length,f=r>1,u=null;return i&&(i.remove&&i.remove.length?u=o(i.remove,"Undo.Items.RemoveCategory.Multiple","Undo.Items.RemoveCategory.Single",r):i.apply&&i.apply.length&&(u=o(i.apply,"Undo.Items.ApplyCategory.Multiple","Undo.Items.ApplyCategory.Single",r))),u}}},u.displayUndoNotification=function(n,t){var i=c(n,t),r;i&&(r="<div class='undoBottomBar'>{0}<\/div>".format(i),wLive.Controls.Notifications.createBottomBar({content:r,dismissalMode:wLive.Controls.Notifications.BarDismissalMode.Implicit,options:{moreCss:"SuperBar WithTitle"}}).show())},u.updateToolTip=function(n){var r=t.GetString("Undo.Items.Tooltip.InActive"),i=u.undoableCmd()&&u.undoableCmd().args||{},f=i.items?i.items.length:"";switch(n){case"undomoveitems":r=i.destId&&i.destId===t.config.sysFldrs.trashFid?t.GetString("Undo.Items.Tooltip.Active.Delete"):i.toArchive?t.GetString("Undo.Items.Tooltip.Active.Archive"):t.GetString("Undo.Items.Tooltip.Active.Move");break;case"undojunkandunjunkitems":r=i.jmrType===HM.JmrType.Junk?t.GetString("Undo.Items.Tooltip.Active.Junk"):t.GetString("Undo.Items.Tooltip.Active.NotJunk");break;case"undomarkitems":r=i.asRead?t.GetString("Undo.Items.Tooltip.Active.Read"):t.GetString("Undo.Items.Tooltip.Active.Unread");break;case"undoflagitems":r=i.asFlagged?t.GetString("Undo.Items.Tooltip.Active.Flag"):t.GetString("Undo.Items.Tooltip.Active.Unflag");break;case"undocategorizeitems":r=t.GetString("Undo.Items.Tooltip.Active.Categorize");break;default:u.undoTooltip(r);return}u.undoTooltip(r.format(f))},u.dataForCallingUndo=function(n){var i=this,r=i.DataForCallingUndo,u;return n!==r&&(r=t.Accessor(i,"DataForCallingUndo",n),i.updateToolTip(r?r.nameForUndoCmd:""),t.Cmd("enableundoaction").fire({enabled:i.canUndo(),tooltip:i.undoTooltip()}),t.config.userPreferences.HasUndoFreSeen||(t.config.userPreferences.HasUndoFreSeen=!0,_ge("crm_bubble")||(u=[t.GetAppConfig("BubbleScriptUrl")],Loader.load({js:u},i._createBubble)))),r},u._createBubble=function(){var u=window,r=n("#c_hiconu"),i={content:"<div>"+t.GetString("Undo.FreBubble.Text")+"<\/div>",buttons:{action:t.GetString("Undo.FreBubble.Button.Text")},id:"undo_bubble",targetId:"#c_hiconu",title:"",type:"Bubble"};u.$Bubble&&r.length>0&&(i.showcb="wLive.$Crm.startGracePeriod",i.hidecb="wLive.$Crm.cancelGracePeriod",r.bubble("init",i)),t.writeOptionToServer("UndoFreSeenStateWriter",!0)},u.canUndo=function(){return u.DataForCallingUndo!==null},u.undoLastAction=function(i){var o=n.when(),r=u.dataForCallingUndo(),e;if(!f&&r){if(e=r.argsForUndoCmd,n.extend(e,i),r.nameForUndoCmd==="undomoveitems"){var s=u.undoableCmd(),c=u.leftNav().containerLists()[0],h=c.getArchiveFolder();e.undoMoveInstrumentation=h&&h.id()===s.args.destId?HM.InstrumentationUndoAction.Archive:t.config.sysFldrs.trashFid===s.args.destId?HM.InstrumentationUndoAction.Delete:HM.InstrumentationUndoAction.Move}f=t.Dispatcher.fireCmd(r.nameForUndoCmd,e),o=f.deferred.then(function(){u.undoableCmd()&&u.displayUndoNotification(f,u.undoableCmd())},function(n){var i=t.GetString("Undo.Errors.Generic");n.errors.length&&n.errors[0].Error&&!t.data.fpp.FppErrorManager.resultsContainGeneralError(n.errors)&&(i=n.errors[0].Error.Message),wLive.Controls.Notifications.createTopBar({content:i,dismissalMode:wLive.Controls.Notifications.BarDismissalMode.Timeout}).show()}).always(function(){f=null})}return o},u.clearUndoStack=function(i){var e=n.when(),f=this.name;if(r&&r.hasOwnProperty(f)&&r[f](i))return u.dataForCallingUndo(null),t.Dispatcher.fireCmd("clearundo").deferred.promise()},l(),window.undo=u.undoLastAction};t.AddOptionsAccessorAndInitFunctions(e.prototype,f)}(window.originaljQuery||window.jQuery),function(n,t){"use strict";var i="containerPickerTemplate",r=t.templates(null,{markup:"#"+i}),n=window.ol=window.ol||{},u=n.c=n.c||{},f=u.containerPickerControl={templateId:i,template:r,attr:"html",init:function(n){this.data=n.props.data},render:function(){return this.tagCtx.render(this.data)},onAfterLink:function(){var n=this,i=this.contents();n._$menuElt=i.parent(),n._$listContainer=n._$menuElt.find(".cp_list");i.on("click",t.proxy(n._onMenuClick,n))},onCmdBubble:function(n,t,i){var r=this;return t.name==="el.completed"?(n.data.completeEdit(i.text).then(function(){r._onEditCompleted()}),!1):t.name==="el.canceled"?(n.data.cancelEdit(),r.data.editingContainer(null),!1):void 0},getEditingContainerClass:function(n,t){var i="t_hovl c_m";return n?i+=" cp_editingNew":this.data.containerList().NewItemLabel||t.length!==0||(i+=" DisplayNone"),i},_onEditCompleted:function(){var t=this,i=t.data.editingContainer(),r;i&&!i.error()&&(r=t.data.containerList().getTopLevelContainerByName(i.pendingName()),r&&n.Cmd("cp.menu.newcontainer").bubble(t,{newContainer:r}),t.data.editingContainer(null))},show:function(n,i,r,u,f){var e=this,o,s;i.focus(),o={},s=6,r?(o={noDockCache:!0,parentEl:i,sourceEl:i,menuEl:e._$menuElt.get(0),eventType:"click"},s=0):(o={alt:1,eventType:"click",sourceEl:i,defaultLoc:0},f&&(o.menuEl=e._$menuElt.get(0))),t.extend(o,u),e.isBoundTo(i,n)?u&&u.edgeOffsets?$menu.create(n,s,o):f&&e._wlMenuBinding.toggleState():(e._wlMenuBinding&&(e._wlMenuBinding.dispose(),e._wlMenuBinding=null),$menu.create(n,s,o),e._wlMenuBinding=i.menu,e._wlMenuBinding.addStateListener(t.proxy(e._onMenuStateChange,e)),e._$listContainer.scrollTop(0))},hide:function(){this._wlMenuBinding.hide()},_onMenuStateChange:function(){if(this._wlMenuBinding){var n=this.data;!this._wlMenuBinding.isOpen()&&n.editingContainer()&&(n.editingContainer().cancelEdit(),n.editingContainer(null))}},isBoundTo:function(n){return n&&this._wlMenuBinding&&this._wlMenuBinding===n.menu},_onMenuClick:function(t){var i=this,u=i.data.editingContainer(),r;if(u){if(r=i.contents().find(".editableLabel.readwrite"),t.target===r[0])return;u.completeEdit(r.val()).then(function(){i._onEditCompleted()})}else n.Cmd("cp.menu.click").bubble(this,{$event:t});t.stopImmediatePropagation(),t.preventDefault()},onAddNewClick:function(t,i){var r=this,u=r.data.containerList(),f={isEditing:!0,isUncommitted:!0,parentContainer:u.rootContainer(),editEntryPoint:i},e,o;u.type()===HM.ContainerType.Categories?(e=new n.vm.Container(n.vm.Container.createDefaultCategoryOptions(f)),r.data.editingContainer(e),r.startEditingContainer()):u.type()===HM.ContainerType.Folders&&(o=new n.vm.Container(f),r.data.editingContainer(o),r.startEditingContainer()),t.stopImmediatePropagation(),t.preventDefault()},isOpen:function(){return this._wlMenuBinding&&this._wlMenuBinding.isOpen()},startEditingContainer:function(){$B.IE&&$B.V>=10&&this.contents().find(".editableLabel.readwrite").closest(".menuLinkItem[href='#']").removeAttr("href")}};t.views.tags({containerPickerControl:f}),t.templates("#containerPickerActionLinkTemplate"),t.templates("#containerPickerActionButtonTemplate")}(window.ol,window.originaljQuery||window.jQuery),function(n,t){"use strict";var r="containerPickerItemTemplate",i=n.vm.Container.ContainerSelection,u=10,f=15,e=t.templates(null,{markup:"#"+r,converters:{getCheckHtml:function(t,r,u){var e="",o=n.ContainerPickerEnums.MenuType,f=null;return t===i.MIXED?f=$menu.chevronTypes.SquareDark:t!==i.ON&&t!==i.OFF&&(r!==o.Categorize||u)?t===i.PARENT_ON&&(f=$menu.chevronTypes.SmallCheckDisabled):f=$menu.chevronTypes.SmallCheckDark,f&&(e=$menu.createChevron(f,!0)),e},getClasses:function(n){var t="";return n===i.ON?t="Selected":n===i.MIXED?t="Mixed":n===i.PARENT_ON&&(t="ParentSelected"),t},getMenuItemClasses:function(n){var t="menuLinkItem";return n&&(t+=" Editing"),t},getPadding:function(t){var i=(t-1)*u+f;return(n.config.Ltr?"padding-left:":"padding-right:")+i+"px"}}}),n=window.ol=window.ol||{},a=n.c=n.c||{},o={templateId:r,template:e,attr:"html",init:function(t){var i=this;i.data=t.props.data,i.menuType=t.ctx.menuType,i.filterFn=t.ctx.filterFn,i.showSelectionState=t.ctx.showSelectionState,i.ControlNamespace=n.createControlNamespace(i.tagName),i.ErrorId=n.createControlNamespace(i.tagName+"Error")},render:function(){return this.tagCtx.render(this.data)},itemTag:function(){var t="",i=n.ContainerPickerEnums.MenuType;if(this.data.containerType()===HM.ContainerType.Categories&&this.menuType===i.Categorize)t="CategoryItem";else if(this.data.containerType()===HM.ContainerType.Folders&&this.menuType===i.MoveTo){t="MenuItemLink";switch(this.data.id()){case n.config.sysFldrs.inboxFid:t="MoveToInbox";break;case n.config.sysFldrs.junkFid:t="MoveToJunk";break;case n.config.sysFldrs.draftsFid:t="MoveToDrafts";break;case n.config.sysFldrs.sentFid:t="MoveToSent";break;case n.config.sysFldrs.trashFid:t="MoveToDeleted"}}else this.menuType===i.ContainerSelector&&(t="ContainerItem");return t},shouldShowItem:function(n){var t=this.filterFn;return t?t(n):!0}};t.views.tags({containerPickerItemControl:o})}(window.ol,window.originaljQuery||window.jQuery),function(n,t){"use strict";var r="containerSelectorTemplate",n=window.ol=window.ol||{},u=n.c=n.c||{},i=n.vm.Container.ContainerSelection,f=t.templates(null,{markup:"#"+r,converters:{getClearSelectionCheckHtml:function(){return $menu.createChevron($menu.chevronTypes.SmallCheckDark,!0)},getClearSelectionClasses:function(n){var t="cs_clearSelection";return n&&(t+=" Selected"),t}}}),e=u.containerSelectorControl={templateId:r,template:f,attr:"html",init:function(n){this.data=n.args[0]},render:function(){return this.tagCtx.render(this.data)},onAfterLink:function(){var t=this,i;t.containerPickerControl=n.findChildTag(t,"containerPickerControl")[0],i=this.contents(),t.$menuElt=i.filter(".c_m"),t.$menuLabelElt=i.filter(".c_ml"),t.$menuLabelElt.click(function(n){return t.data.initializeSelection(),t._enableApplyButton(!1),t.containerPickerControl.show(n.originalEvent,t.$menuLabelElt[0]),!1})},onCmdBubble:function(n,i,r){var f=this;switch(i.name){case"cp.menu.click":var e=r.$event,u=t(e.target),o=u.closest(".cp_list .menuLinkItem").get(0),s=u.is("input[type=button]")||u.is("a");if(o)f._onItemClick(e,o);else if(u.closest(".cp_list .cs_clearSelection").get(0))f._onClearSelectionClick(e);else if(u.closest("LI.cs_apply").get(0)&&s)f._onApplyClick(e);else if(u.closest("LI .cp_addNew").get(0)&&s)f.containerPickerControl.onAddNewClick(e,this.data.entryPoint());return!1;case"cp.menu.newcontainer":return f._selectContainer(r.newContainer),!1}},_selectContainer:function(t,r){var u=this,f,e;t.isEditing()||(u.data.isMultiSelect()?t.isParentSelected()||(f=t.selectionState()===i.ON?i.OFF:i.ON,e=u.data.setSelection(t,f),u._enableApplyButton(e)):r&&(u.containerPickerControl.hide(),n.Cmd("cs.select").bubble(r,{key:u.data.key(),selection:t.id()})))},_onItemClick:function(n,i){var r=t(i).view().data;this._selectContainer(r,i),n.stopImmediatePropagation()},_onClearSelectionClick:function(t){if(this.data.isMultiSelect()){var i=this.data.clearSelection();this._enableApplyButton(i),t.stopImmediatePropagation()}else this.containerPickerControl.hide(),n.Cmd("cs.select").bubble(this,{key:this.data.key(),selection:null});t.preventDefault()},_onApplyClick:function(t){this.containerPickerControl.hide(),n.Cmd("cs.select").bubble(t.target,{key:this.data.key(),selection:this.data.getSelection()})},_enableApplyButton:function(n){t(".cs_apply input",this.$menuElt).attr("disabled",!n)},isOpen:function(){return this.containerPickerControl.isOpen()}};t.views.tags({containerSelectorControl:e}),t.templates("#containerPickerActionLinkTemplate"),t.templates("#containerPickerActionButtonTemplate")}(window.ol,window.originaljQuery||window.jQuery),function(n,t){"use strict";var i=function(){function tt(){t(document.body).addClass(u),o=u}function h(n){n&&n.removeClass("dragdrophover")}function e(t){if(t&&t.toolTipObject){var i=5,r=n.config.Ltr?i:-(t.toolTipObject.offsetWidth+i);ut(t.mouseMoveEvent,r)}}function it(n,i){i?n.toolTipObject?p(i):(n.toolTipObject=ft(i),r=t(n.toolTipObject),f=$("#dndHtml").first()):b(n),e(n)}function p(n){f&&s!==n&&(f.html(n),s=n)}function rt(n){n&&n.parentNode&&(r.remove(),r=null,f=null,s=null)}function ut(n,t){r&&r.css({top:n.clientY-5,left:n.clientX+t,cursor:"pointer"})}function ft(i){i=n.String.addBidiRTLEntityMark(i);var r=t('<div class="DragNDrop"><div id="dndHtml" class="Content">'+i+"<\/div><\/div>");return r.appendTo(document.body),r[0]}function w(){t(document.body).removeClass(v+" "+u+" "+y)}function c(n){n!==o&&(o=n,w(),t(document.body).addClass(n))}function et(n,t){$B.IE&&$B.V<9?c(y):(it(n,n.tooltip),t.target.id!=="dndHtml"&&c(n.cursor))}function ot(n,t){var i=0,r=0;return i=t.x-n.x,i=i*i,r=t.y-n.y,r=r*r,Math.sqrt(i+r)}function b(n){rt(n.toolTipObject),n.toolTipObject=null}function k(n,t,i){var r;return r=t&&t.getControlsForStyling(n),n.currentTargetElem&&n.currentTargetElem.length&&r&&r.length&&n.currentTargetElem[0]!==r[0]||!n.currentTargetElem||!r?(n.currentHoverControl!==null&&(h(n.currentTargetElem),n.currentHoverControl=null),n.currentHoverControl=t,n.currentTargetElem=r,r&&(n.cursor=u,t.getTooltipMessageAndCursor(n),i&&r.addClass(i),et(n,n.mouseMoveEvent))):e(n),n.currentTargetElem}function i(n){n&&(n.stopPropagation(),n.stopImmediatePropagation(),n.cancelBubble=!0,n.preventDefault?n.preventDefault():n.returnValue=!1,d(n))}function d(t){(t.type==="click"||t.type==="mouseup")&&window.removeEventListener&&(window.removeEventListener("click",i,!0),n.TouchUtil.supportsPointerUp()&&(window.removeEventListener("pointerup",i,!0),window.removeEventListener("MSPointerUp",i,!0)))}function st(){window.addEventListener&&(window.addEventListener("click",i,!0),n.TouchUtil.supportsPointerUp()&&(window.addEventListener("pointerup",i,!0),window.addEventListener("MSPointerUp",i,!0)))}function ht(t,i,r){var e=!0,o=r&&r.length&&r[0].tagName,u,f;return t.target!==i.target&&(u=n.GetControlFromEvent(t,o),f=n.GetControlFromEvent(i,o),e=(u&&u.ControlNamespace)===(f&&f.ControlNamespace)),e}var v="noopCursor",u="pointerCursor",y="moveCursor",o=null,nt=n.GetAppConfig("dragAndDropThreshold"),r=null,f=null,s=null,ct=n.DragSource=function(n){var t=this;n&&(t.sourceControl=n.sourceControl,t.controlNamespace=n.controlNamespace),t.attachMouseHandlers()},l=ct.prototype,g,a;l.attachMouseHandlers=function(){var i=this,u=i.sourceControl.getDraggableDomArea(),r=i.controlNamespace;u.on("mousedown."+r,".Draggable",function(u){var o,f,s;if(u.which===1&&i.sourceControl.isDraggable(u)){f={activeDragInSession:!1,sourceControl:i.sourceControl,dragType:i.sourceControl.tagName,currentHoverControl:null,toolTipObject:null,draggableItems:i.sourceControl.getDragControls(u),mouseDownEvent:u,mouseMoveEvent:null,isOverDropTarget:!1,defaultTooltipString:null},s={x:u.clientX,y:u.clientY};t(document).on("mousemove."+r,function(t){var h={x:t.clientX,y:t.clientY},r;if(f.activeDragInSession||!(ot(s,h)<nt))return f.activeDragInSession||(f.activeDragInSession=!0,f.draggableItems=i.sourceControl.refreshChildren(u),f.defaultTooltipString=i.sourceControl.getDefaultTooltipString(f),f.sourceControl.preDragSetup&&f.sourceControl.preDragSetup(),i.applyStyleToSource(f),tt(),st()),f.mouseMoveEvent=t,o!==t.target&&t.target.id!=="dndHtml"?(o=t.target,n.Cmd("dragdrop.move").bubble(t.target,f),f.isOverDropTarget?f.isOverDropTarget=!1:(r=k(f,i.sourceControl),r||(t.target.id!=="dndHtml"&&c(v),f.defaultTooltipString&&p(f.defaultTooltipString),e(f)))):e(f),!1});t(document).one("mouseup."+r,function(e){return f.activeDragInSession&&((!$B.IE||ht(u,e,f.draggableItems))&&($B.IE||u.target===e.target)||d(e),i.resetSourceStyle(f),h(f.currentTargetElem),b(f),f.sourceControl.postDropSetup&&f.sourceControl.postDropSetup(),n.Cmd("dragdrop.up").bubble(e.target,f)),w(),t(document).off("mousemove."+r),!1});return!1}})},l.applyStyleToSource=function(n){var t,i;if(t=n.draggableItems,t!==null)for(i=0;i<t.length;i++)t[i].contents().first().addClass("DraggedControl")},l.resetSourceStyle=function(n){var t,i;if(t=n.draggableItems,t!==null)for(i=0;i<t.length;i++)t[i].contents().first().removeClass("DraggedControl")},g=n.DropTarget=function(n){var t=this;t.TargetControl=n&&n.targetControl},a=g.prototype,a.activateMove=function(n){var t=this;t.TargetControl.canAcceptDrop(n)&&(n.isOverDropTarget=!0,k(n,t.TargetControl,"dragdrophover"))},a.activateUp=function(n){var t=this;t.TargetControl.canAcceptDrop(n)&&n.currentHoverControl!==null&&(t.TargetControl.handleDrop(n),h(n.currentTargetElem),n.currentHoverControl=null)}};n.DragDropManager=new i}(window.ol,window.originaljQuery||window.jQuery),function(n,t){"use strict";var i=n.ContextMenu=function(){function e(){t(i.menuOwner).removeClass("MenuOpen"),i.menuOwner=null}function u(n,t,i,u){if(!n[u]){var e=setTimeout(function(){r.remove(n[u]),n[u]=null,t()},i),f={owner:n,timer:e,type:u};n[u]=f,r.push(f)}}function f(n,t){n[t]&&(clearTimeout(n[t].timer),r.remove(n[t]),n[t]=null)}var i=this,r;i.menuOwner=null,r=[],i.cancelTimers=function(){r&&(t.each(r,function(n,t){clearTimeout(t.timer),t.owner[t.type]=null}),r=[])},i.handleMouseOverMenu=function(){i.menuOwner&&i.cancelHoverOffTimer(i.menuOwner)},i.handleMouseOutMenu=function(){var r,u;i.isHoverMenu&&i.menuOwner&&!i.menuOwner.hoverOff&&(r=i.menuOwner.getAttribute&&i.menuOwner.getAttribute("email")?n.config.contextMenu.sndOffDelay:n.config.contextMenu.menuOffDelay,u=i.menuOwner,i.createHoverOffTimer(u,$CC(t.proxy(i.hide,i)),r))},i.handleContextMenuClick=function(){event.returnValue=!1,event.cancelBubble=!0,Control.invoke("Menu","_buttonOnClick",event,Control.lookup(event.srcElement,"key"))},i.handleContextMenuInMenu=function(n){n.stopPropagation(),n.preventDefault()},i.show=function(n,r,u,f,e){i.cancelTimers(),$BSI.reportEvent("SelectClick.MailMenu",{ContextMenuType:f}),i.menuOwner=r,i.isHoverMenu=e,t(i.menuOwner).addClass("MenuOpen"),$menu.create({},0,u),n.binding&&(i._menu=n.binding,n.binding.addStateListener(function(){i.onMenuStateChange(n.binding)}))},i.onMenuStateChange=function(n){n.isOpen()||e()},i.hide=function(){i._menu&&i._menu.hide()},i.reposition=function(){i._menu&&i._menu.update()},i.getMenuEventPosition=function(n){return t.event.mouseHooks.filter(n,n),{left:n.pageX,top:n.pageY,right:n.pageX,bottom:n.pageY}},i.createHoverOnTimer=function(n,t,i){u(n,t,i,"hoverOn")},i.createHoverOffTimer=function(n,t,i){u(n,t,i,"hoverOff")},i.cancelHoverOnTimer=function(n){f(n,"hoverOn")},i.cancelHoverOffTimer=function(n){f(n,"hoverOff")}};n.ContextMenu.isFocusOnContextMenu=function(){var n=document.activeElement;return t(n).hasClass("cm")}}(window.ol,window.originaljQuery||window.jQuery);/*@cc_on@*/(function(n){"use strict";var t=window.ol=window.ol||{},i=t.controlHelpers=t.controlHelpers||{};i.RightRailManager=function(i){function e(){r._rightRailControl.maybeStartAds()}function o(){r._rightRailControl.hideAds()}function s(n){n?h():setTimeout(h,0)}function h(){f===u.BecomingVisible?(n("#RightRailContainer").removeClass("DisplayNone"),n(".ContentRight").addClass("WithRightRail"),e(),f=u.Visible):f===u.BecomingHidden&&(n("#RightRailContainer").addClass("DisplayNone"),n(".ContentRight").removeClass("WithRightRail"),o(),f=u.Hidden)}var r=this,f=null,u={Visible:0,Hidden:1,BecomingVisible:2,BecomingHidden:3};r._rightRailControl=i,r.hideRightRail=function(n){f=u.BecomingHidden,s(n)},r.maybeShowRightRail=function(n){r._rightRailControl.rightRail.canShowRightRail()&&(f=u.BecomingVisible,s(n))},r.setPeoplePane=function(){n("#RadAd_Skyscraper").addClass("DisplayNone"),n("#PeoplePaneContainer").removeClass("DisplayNone"),o()},r.setAdControl=function(){n("#RadAd_Skyscraper").removeClass("DisplayNone"),n("#PeoplePaneContainer").addClass("DisplayNone"),e()},r.isRightRailShowing=function(){return f===u.BecomingVisible||f===u.Visible},r.isPeoplePaneSet=function(){var t=n("#PeoplePaneContainer");return t.length>0&&!t.hasClass("DisplayNone")},r.isPeoplePaneShowing=function(){return r.isRightRailShowing()&&r.isPeoplePaneSet()},r.isAdControlSet=function(){var t=n("#RadAd_Skyscraper");return t.length>0&&!t.hasClass("DisplayNone")},r.isAdControlShowing=function(){return r.isRightRailShowing()&&r.isAdControlSet()},r.onSidebarOpenedEventCallback=function(){r.hideRightRail(!0)},r.onSidebarClosedCompletedEventCallback=function(){t.pages.pageManager&&t.pages.pageManager.getCurrentView()!==t.config.pageManager.manifests.Inbox.name||r.maybeShowRightRail(!0)},f=n("#RightRailContainer").hasClass("DisplayNone")?u.Hidden:u.Visible}})(window.originaljQuery||window.jQuery),function(n,t){"use strict";var r="categorizeMenuTemplate",n=window.ol=window.ol||{},f=n.c=n.c||{},i=n.vm.Container.ContainerSelection,u=f.categorizeMenuControl={templateId:r,template:t.templates("#"+r),attr:"html",init:function(n){this.data=n.args[0]},render:function(){return this.tagCtx.render(this.data)},onAfterLink:function(){var t=this,i=this.contents();t._$menuElt=i.parent(),t._$applyAllElt=i.find(".cm_apply"),t.containerPickerControl=n.findChildTag(t,"containerPickerControl")[0]},onCmdBubble:function(n,t,i){switch(t.name){case"cp.menu.click":return this._onMenuClick(i.$event),!1;case"cp.menu.newcontainer":return this._onNewCategoryCommited(i.newContainer),!1}},show:function(n){this.data.selectedMsgs(n.selectedMsgs),this.data.getInitialCategorySelection(n.selectedMsgs,n.bulkSelected,n.selectedMsgRow),this.data.entryPoint(n.entryPoint),this.data.isMessagePart(n.isMessagePart),this._disableBulkApply=n.disableBulkApply,this._selectedMsgRow=n.selectedMsgRow,this.data.bulkSelected(n.bulkSelected),this._toggleApplyMode(!1),this.containerPickerControl.show(n.ev,n.sourceEl,n.sourceOffMenuElt,n.extraMenuParams,n.triggeredByExternalEvent),this._sourceEl=n.sourceEl},_onMenuClick:function(i){var r=this,u=t(i.target),f=null,e;if(f=u.closest(".cp_list .menuLinkItem").get(0))r._onCategoryListClick(i,f);else if(u.closest("LI .cp_addNew").length)r.containerPickerControl.onAddNewClick(i,r.data.entryPoint());else u.closest("LI .cm_apply").length&&!r._$applyAllElt.hasClass("Disabled")&&(r.containerPickerControl.hide(),e=r._selectedMsgRow?[r._selectedMsgRow]:null,n.Cmd("bulkactionbysender").fire({action:"categorize",selection:e,categoryChanges:r.data.getSelectionChanges(!0),entryPoint:r.data.entryPoint(),sourceEl:r._sourceEl}));i.stopPropagation(),i.preventDefault()},_onCategoryListClick:function(r,u){var e=t(u).view().data,o=this,f=o.data,s;e.isEditing()||(s=e.selectionState()===i.ON?i.OFF:i.ON,e.selectionState(s),o._toggleApplyMode(f.hasSelectionChanged()),n.vm.MessageThread.categorizeThreads(f.selectedMsgs(),f.getSingleSelectionChange(e),f.entryPoint(),f.bulkSelected(),f.isMessagePart()))},_onNewCategoryCommited:function(t){var u=this,r=u.data;t.selectionState(i.ON),u._toggleApplyMode(r.hasSelectionChanged()),n.vm.MessageThread.categorizeThreads(r.selectedMsgs(),r.getSingleSelectionChange(t),r.entryPoint(),!1,r.isMessagePart())},_toggleApplyMode:function(n){this._$applyAllElt.toggleClass("Disabled",this._disableBulkApply||!n&&!this.data.hasApplicableInitialCategory())}};u.initializeCategorize=function(i){var r=new n.vm.CategorizeMenu,u=t.templates("{^{categorizeMenuControl #data/}}"),f=i.link(u,r,n.getContextObject());return n.findChildTag(f.view(!0),"categorizeMenuControl")[0]},t.views.tags({categorizeMenuControl:u}),t.templates("#categorizeMenuPlaceHolderTemplate"),t.templates("#containerPickerActionLinkTemplate"),t.templates("#containerPickerActionButtonTemplate")}(window.ol,window.originaljQuery||window.jQuery),function(n,t){"use strict";var i="moveToMenuTemplate",n=window.ol=window.ol||{},u=n.c=n.c||{},r=u.moveToMenuControl={templateId:i,template:t.templates("#"+i),attr:"html",init:function(n){var t=this;t.data=n.args[0]},render:function(){var n=this;return n.tagCtx.render(n.data)},onAfterLink:function(){var i=this;i.containerPickerControl=n.findChildTag(i,"containerPickerControl")[0],i._$moveAllFromSender=t("#MoveAllFrom").parent()},onCmdBubble:function(n,t,i){switch(t.name){case"cp.menu.click":return this._onMenuClick(i.$event),!1;case"cp.menu.newcontainer":return this._onNewFolderCommited(i.newContainer),!1}},_onMenuClick:function(i){var u=t(i.target),f=null,r=this;if(f=u.closest(".cp_list .menuLinkItem").get(0))r._onFolderListClick(i,f);else if(u.closest("LI .cp_addNew").get(0))r.containerPickerControl.onAddNewClick(i,r.data.entryPoint());else u.closest("LI .mtm_moveAllFrom").get(0)&&(r.containerPickerControl.hide(),n.Cmd("bulkactionbysender").fire({action:"move",event:i.originalEvent,entryPoint:r.data.entryPoint()}));i.stopPropagation(),i.preventDefault()},_onFolderListClick:function(i,r){var f=t(r).view().data,u=this.data;f.isEditing()||(u.bulkSelected()?n.Cmd("bulkactionbycontainer").fire({action:"move",destId:f.id(),entryPoint:u.entryPoint()}):n.vm.MessageThread.performActionOnThreads("movemsg",u.selectedMsgs(),{folderId:f.id(),unflag:u.unflag(),skipFocus:!0,toArchive:f.isArchive(),entryPoint:u.entryPoint()}),this.containerPickerControl.hide())},_onNewFolderCommited:function(t){var r=this,i=r.data;n.vm.MessageThread.performActionOnThreads("movemsg",i.selectedMsgs(),{folderId:t.id(),unflag:i.unflag(),skipFocus:!0,toArchive:t.isArchive(),entryPoint:i.entryPoint()}),r.containerPickerControl.hide()},show:function(n,t,i,r,u,f,e,o,s){var c=this,h=c.data;h.selectedMsgs(i),h.unflag(r),h.bulkSelected(u),h.entryPoint(o),c._$moveAllFromSender.toggleClass("NoDisplay",f||u),c.containerPickerControl.show(n,t,!1,e,s)}};r.initializeMoveTo=function(i){var r=new n.vm.MoveToMenu,u=t.templates("{^{moveToMenuControl #data/}}"),f=i.link(u,r,n.getContextObject());return n.findChildTag(f.view(!0),"moveToMenuControl")[0]},t.views.tags({moveToMenuControl:r}),t.templates("#containerPickerActionLinkTemplate"),t.templates("#containerPickerActionButtonTemplate")}(window.ol,window.originaljQuery||window.jQuery),function(n){"use strict";function u(n,t){n&&n.length&&(c=!0,n.toggleClass("NoDisplay",!t))}function i(n,t){n&&n.length&&n.toggleClass("NoDisplay",!t)}function y(n){var y=h=n.inboxControl,a=n.selectedThread,tt=n.numSelected,w=n.selectedContainer,ct,p,nt;if(t.pages.pageManager.getCurrentView()===t.config.pageManager.manifests.Inbox.name){var b=w.isFolder()?w.id():t.config.sysFldrs.noneFid,vt=y.data.isBulkSelected(),k=t.config.sysFldrs,et=b===k.sentFid,it=b===k.draftsFid,v=b===k.junkFid,ot=b===k.trashFid,yt=w.isArchive(),pt=!et&&!it,d=et||it,g=v||ot,wt=!!n.isReadingFullView,st=a&&a.showCompromisedReporting(),rt=y.data.Layout.isReadingPaneOrFullViewOn(),bt=w.totalCount()===0,l=tt>0||!!a,ht=!1,s=this;if(a&&(ht=a.count()>1),ct=t.GetUserConfig("ConversationThreading"),u(s.$newMsg,!0),p=!v&&!it&&tt===1,u(s.$reply,p),i(s.$replyAll,p),i(s.$forward,p),s._selectedMessageThread=a,s._checkedThreads=n.checkedThreads,u(s.$deleteMsg,l),t.GetAppConfig("IsArchiveEnabled")&&u(s.$archive,l&&!yt),!t.GetUserConfig("IsManagedRestricted")){var lt=pt&&l,ut=lt&&!v,ft=lt&&v,at=!1;p&&a&&rt&&(at=a.items()[0].showUnsubscribeLink()),u(s.$junk,ut),u(s.$notJunk,ft),i(s.$phish,ut),i(s.$phishNotJunk,ft),i(s.$compromised,st&&ut),i(s.$compromisedNotJunk,st&&ft),i(s.$unsubscribe,at)}i(s.$createRule,l),i(s.$print,tt===1),i(s.$read,l),i(s.$unread,l),i(s.$markAsFlagged,!g&&!d&&l),i(s.$markAsUnflagged,!g&&!d&&l),o=ht&&a&&rt,f=o&&!a.isAllExpanded(),e=o&&a.isAllExpanded(),i(s.$expandAll,f),i(s.$collapseAll,e),i(s.$viewSource,a&&rt&&!ct),t.GetAppConfig("IsBulkActionsEnabled")&&(nt=(!g||!ot)&&(!wt||!d)&&l&&!vt,u(s.$sweep,nt),nt&&i(s.$sweep,!d&&!v&&l),i(s.$blockAllFromSender,nt&&v&&l)),y.data.undo()&&r.updateUndoIcon(y.data.undo().canUndo(),y.data.undo().undoTooltip()),u(s.$moveTo,l),u(s.$categorize,l),u(s.$emptyFolder,g&&!bt),r.invalidateMenuPosition(s.$moveToMenu),u(s.$more,!0),(c||n.forceRelayout)&&(setTimeout(function(){$CommandBar.render()},0),c=!1)}}function p(n){var e=n.target.id||n.target.parentElement.id,r=this,i,u,f;return e&&(i=null,u=null,h&&h.data&&(u=h.data.getSelectedThreads2())&&(i=u[0]),i=i||r._selectedMessageThread||(r._checkedThreads&&r._checkedThreads.length===1?r._checkedThreads[0]:null),i&&(f=e.toLowerCase(),$menu.closeCurrent(),t.Cmd(f).fire({action:f,thread:i,entryPoint:HM.InstrumentationEntryPoint.CommandBar}))),!1}function l(n,u){var s=u?"setexpandedmessagequeries":"collapseall",h=t.Cmd(s).fire({event:n.originalEvent}),o;u&&(o=t.Dispatcher.fireCmd("get"),o.deferred.always(function(){t.Cmd("expandall").fire({event:n.originalEvent})})),n.preventDefault(),i(r.$expandAll,!u),i(r.$collapseAll,!!u),f=!u,e=!!u}var a=window,t=a.ol=a.ol||{},r=t.CommandBarWrapper={},c=!1,f=!1,e=!1,o=!1,s=null,v=13,h=null;r.initialize=function(){var i=this,r=HM.InstrumentationEntryPoint.CommandBar,f,e,o,u;i.$undo=n("#c_hiconu");i.$undo.on("click",function(){t.Cmd("undoaction").fire({entryPoint:r})});i.$newMsg=n("#NewMessage").parent();i.$newMsg.on("click",function(n){if(!t.isOpenNewTabClick(n))return t.Cmd("newmessage").fire({action:"newmessage",entryPoint:r}),!1});i.$deleteMsg=n("#DeleteMessages").parent();i.$deleteMsg.on("click",function(n){return t.Cmd("deletemsg").fire({srcElement:n.originalEvent.srcElement,entryPoint:r}),!1});if(t.GetAppConfig("IsArchiveEnabled")){i.$archive=n("#Archive").parent();i.$archive.on("click",function(n){return t.Cmd("archive").fire({event:n.originalEvent,entryPoint:r}),!1})}f=n.proxy(p,i),e=t.GetUserConfig("replyAllDefaultEnabled"),i.$reply=n(e?"#ReplyAll":"#Reply").parents("li");i.$reply.on("click",f);i.$replyAll=n(e?"#Reply":"#ReplyAll").parent();i.$replyAll.on("click",f);i.$forward=n("#Forward").parent();i.$forward.on("click",f);if(!t.GetUserConfig("IsManagedRestricted")){i.$junk=n("#MarkAsJunk").parent();i.$junk.find("#MarkAsJunk").on("click",function(n){t.Cmd("junk").fire({e:n.originalEvent,entryPoint:r}),n.preventDefault()});i.$junkMenu=i.$junk.find("ul").first(),i.$notJunk=n("#MarkAsNotJunk").parent();i.$notJunk.find("#MarkAsNotJunk").on("click",function(n){t.Cmd("notjunk").fire({e:n.originalEvent,entryPoint:r}),n.preventDefault()});i.$notJunkMenu=i.$notJunk.find("ul").first(),i.$phish=n("#MarkAsPhish").parent();i.$phish.on("click",function(n){t.Cmd("phish").fire({e:n.originalEvent,entryPoint:r}),n.preventDefault()});i.$phishNotJunk=n("#MarkNotJunkAsPhish").parent();i.$phishNotJunk.on("click",function(n){t.Cmd("phish").fire({e:n.originalEvent,entryPoint:r}),n.preventDefault()});i.$compromised=n("#MarkAsCompromised").parent();i.$compromised.on("click",function(n){t.Cmd("compromised").fire({e:n.originalEvent,entryPoint:r}),n.preventDefault()});i.$compromisedNotJunk=n("#MarkNotJunkAsCompromised").parent();i.$compromisedNotJunk.on("click",function(n){t.Cmd("compromised").fire({e:n.originalEvent,entryPoint:r}),n.preventDefault()});i.$unsubscribe=n("#Unsubscribe").parent();i.$unsubscribe.on("click",function(n){t.Cmd("unsubscribe").fire({event:n.originalEvent}),n.preventDefault()});i.$junkMenu.click($menu.closeCurrent),i.$notJunkMenu.click($menu.closeCurrent)}if(t.GetAppConfig("IsBulkActionsEnabled")){i.$sweep=n("#Sweep").parent();i.$sweep.on("click",function(){return t.Cmd("bulkactionbysender").fire({action:"sweep",entryPoint:r}),!1});i.$blockAllFromSender=n("#BlockAllFromSender").parent();i.$blockAllFromSender.on("click",function(){return t.Cmd("bulkactionbysender").fire({action:"block",entryPoint:r}),!1})}o=_$ge("MoveTo"),i.$moveTo=o.parent(),i.$moveToMenu=i.$moveTo.find("ul"),i.$moveToMenu.attr("id","MoveTo_dropdown"),i.$moveToMenu.addClass("c-ContainerPicker mtm_menu");o.on("keyup",function(n){if(n.which===v)return t.Cmd("showmoveto").fire({event:n.originalEvent,entryPoint:r}),!1}).on("mousedown",function(n){return t.Cmd("showmoveto").fire({event:n.originalEvent,entryPoint:r}),!1});i.$categorize=n("#Categorize").parent(),i.$categorizeMenu=i.$categorize.find("ul"),i.$categorizeMenu.attr("id","Categorize_dropdown"),i.$categorizeMenu.addClass("cm_menu c-ContainerPicker");i.$categorize.on("click",function(n){return t.Cmd("showcategorize").fire({event:n.originalEvent,entryPoint:r}),!1});i.$more=n(".c_cmore"),i.$moreMenu=i.$more.find("ul"),i.$emptyFolder=n("#EmptyFolderButton").parent();i.$emptyFolder.on("click",function(n){return t.Cmd("tryemptycontainer").fire({senderElement:n.srcElement,entryPoint:r}),!1});i.$createRule=n("#CreateRule").parent();i.$createRule.on("click",function(n){t.Cmd("createrule").fire({event:n.originalEvent,entryPoint:r})});i.$print=n("#PrintMessages").parent();i.$print.on("click",function(n){t.Cmd("print").fire({event:n.originalEvent,entryPoint:r}),n.preventDefault()});i.$read=n("#MarkAsRead").parent();i.$read.on("click",function(n){t.Cmd("markasread").fire({event:n.originalEvent,entryPoint:r}),n.preventDefault()});i.$unread=n("#MarkAsUnread").parent();i.$unread.on("click",function(n){t.Cmd("markasunread").fire({event:n.originalEvent,entryPoint:r}),n.preventDefault()});i.$markAsFlagged=n("#MarkAsFlagged").parent();i.$markAsFlagged.on("click",function(n){t.Cmd("markasflagged").fire({event:n.originalEvent,entryPoint:r}),n.preventDefault()});i.$markAsUnflagged=n("#MarkAsUnflagged").parent();i.$markAsUnflagged.on("click",function(n){t.Cmd("markasunflagged").fire({event:n.originalEvent,entryPoint:r}),n.preventDefault()});i.$expandAll=n("#ExpandAll").parent(),i.$collapseAll=n("#CollapseAll").parent();i.$expandAll.on("click",function(n){l(n,!0)});i.$collapseAll.on("click",function(n){l(n)});i.$viewSource=n("#ViewSource").parent();i.$viewSource.on("click",function(n){t.Cmd("viewsource").fire({event:n.originalEvent,entryPoint:r}),n.preventDefault()});i.$moreMenu.click(function(t){n(t.target).closest("li").hasClass("c_mcp")||$menu.closeCurrent()}),u=[i.$newMsg,i.$reply,i.$deleteMsg,i.$archive,i.$moveTo,i.$categorize,i.$emptyFolder,i.$more,i.$createRule,i.$print,i.$read,i.$unread,i.$markAsFlagged,i.$markAsUnflagged,i.$expandAll,i.$collapseAll,i.$viewSource],t.GetAppConfig("IsBulkActionsEnabled")&&(u.push(i.$sweep),u.push(i.$blockAllFromSender)),t.GetUserConfig("IsManagedRestricted")||(u.push(i.$junk),u.push(i.$notJunk)),i.$CommandBarWrapperItems=n(u),t.Cmd("rrutocompose").subscribe(function(){i.hideItems()}),t.Cmd("enableundoaction").subscribe(function(n){i.updateUndoIcon(n.enabled,n.tooltip)})},r.updateToolbar=function(n){s&&clearTimeout(s),s=setTimeout(function(){s=null,y.call(r,n)},0)},r.hideItems=function(){var t=this;t.$CommandBarWrapperItems.each(function(n,t){u(t,!1)}),t.moreButton||(t.moreButton=n(".c_cmore")),t.moreButton.css("display","none")},r.initCategorizeMenu=function(){this.categorizeMenuControl=t.c.categorizeMenuControl.initializeCategorize(this.$categorizeMenu)},r.toggleThreadExpandCollapseState=function(n){o&&l(n,f||!e)},r.updateUndoIcon=function(n,t){this.$undo.toggleClass("c_ud",!n),this.$undo.attr("title",t),this.$undo.blur()},r.showMoreMenu=function(n){var t=this.$more.children("a")[0];t&&t.menu?t.menu.toggleState():$menu.create(n,6,{defaultLoc:0,bindEnterKey:!0,eventType:"click",menuEl:this.$moreMenu[0],sourceEl:t})},r.showCategorize=function(t,i,r,u,f,e){this.categorizeMenuControl||this.initCategorizeMenu(),e&&n(this.$categorizeMenu).closest(this.$moreMenu).length>0&&this.showMoreMenu(t),this.categorizeMenuControl.show({ev:t,sourceEl:n("#Categorize").get(0),selectedMsgs:i,disableBulkApply:r||u,bulkSelected:r,entryPoint:f,extraMenuParams:{bindEnterKey:!0},triggeredByExternalEvent:e})},r.initMoveToMenu=function(){this.moveToMenuControl=t.c.moveToMenuControl.initializeMoveTo(this.$moveToMenu)},r.showMoveTo=function(t,i,r,u,f,e,o){this.moveToMenuControl||this.initMoveToMenu();var s=_ge("MoveTo");o&&n(this.$moveToMenu).closest(this.$moreMenu).length>0&&this.showMoreMenu(t),this.moveToMenuControl.show(t,s,i,r,u,f,{bindEnterKey:!0},e,o)},r.invalidateMenuPosition=function(n){var t=n.binding;t&&t.invalidatePosition()}}(window.originaljQuery||window.jQuery),function(n,t){"use strict";var i="draftMessageBarTemplate",r={templateId:i,template:t.templates("#"+i),attr:"html",init:function(n){this.data=n.props.thread},render:function(){return this.tagCtx.render(this.data)},onAfterLink:function(){var i=this.contents(),t=this;if(this.data.isDraft())i.on("click",".draftMessage",function(){return n.Cmd("resumedraft").fire({action:"resumedraft",thread:t.data,entryPoint:HM.InstrumentationEntryPoint.Other}),!1}).on("click",".delete",function(){return n.Cmd("deletedraft").fire({thread:t.data,entryPoint:HM.InstrumentationEntryPoint.Other}),!1})}};t.views.tags({draftMessageBarControl:r})}(window.ol,window.originaljQuery||window.jQuery),function(n,t){"use strict";var i="hmLiveViewWrapperTemplate",r={templateId:i,template:t.templates("#"+i),attr:"html",init:function(t){var i=this;i.data=t.props.thread,i.ControlNamespace=n.createControlNamespace(i.tagName)},wireUpLiveViews:function(){var i=this,f,r,u;i.hmlvContainer||(f=i.contents(),r=t(f).filter(".HMLV")[0],r&&(u=i.data,i.hmlvContainer=new n.lv.LiveViewContainerControl(r,u.id(),u.codePage())))},render:function(){return this.tagCtx.render(this.data)},onAfterLink:function(){var n=this;n.disposeContainer(),n.data.isBodyExpanded()&&n.wireUpLiveViews(),t.observable.simpleOn(n.data,"propertyChange."+n.ControlNamespace,function(t,i){i.path==="IsBodyExpanded"&&i.value&&n.wireUpLiveViews()})},onDispose:function(){var n=this;n.disposeContainer(),t.observable.simpleOff(n.data,"propertyChange."+n.ControlNamespace)},disposeContainer:function(){var n=this;n.hmlvContainer&&n.hmlvContainer.dispose(),n.hmlvContainer=null}};t.views.tags({hmLiveViewWrapperControl:r})}(window.ol,window.originaljQuery||window.jQuery),function(n,t){"use strict";var i="meetingRequestBarTemplate",r={templateId:i,template:t.templates("#"+i),attr:"html",init:function(n){this.data=n.props.thread},render:function(){return this.tagCtx.render(this.data)},onAfterLink:function(){var i=this;i.contents().on("click",".iibBttn",function(){var r=t(this).attr("aId"),f,u;if(r!==undefined){switch(r){case"accept":case"decline":case"tentative":n.Cmd(r).fire({action:r,thread:i.data,entryPoint:HM.InstrumentationEntryPoint.MessageBody});break;case"cancel":f=n.vm.MessageThread.performActionOnThreads("deletemsg",[i.data],{entryPoint:HM.InstrumentationEntryPoint.Other},!0),u=i.data.meetingRequestInfo()&&i.data.meetingRequestInfo().calendarActionUrl,u&&f.then(function(){$BSI.navigateTo(u,null)})}return!1}})}};t.views.tags({meetingRequestBarControl:r})}(window.ol,window.originaljQuery||window.jQuery),function(n){"use strict";var u=window,f=u.ol=u.ol||{},r=u.ol.lv=u.ol.lv||{},i=r.LiveViewContainerControl=function(n,t,i){this.elt=n,this.messageId=t,this.codePage=i,f.waitForAnimAndLayout($CD(this,this._initialize))},t;i._ICON_SIZE=30,i._MINIMUM_TITLE_SIZE=150,i._MAX_ICONS_ON_UPPER_BAR=5,i.prototype={},t=i.prototype,t._initialize=function(){var ii,currentHmlvData;if(this.elt&&_ge(this.elt.id)){if(this.hmlvData=eval(this.elt.getAttribute("hmlv")),this.hmlvData&&this.hmlvData.length>0)for(ii=0;ii<this.hmlvData.length;ii++)currentHmlvData=this.hmlvData[ii],currentHmlvData.provider=currentHmlvData[0],currentHmlvData.type=currentHmlvData[1],currentHmlvData.subType=currentHmlvData[2],currentHmlvData.icon=currentHmlvData[3],currentHmlvData.loadingTitle=currentHmlvData[4],currentHmlvData.data=currentHmlvData[5],currentHmlvData.extraData=currentHmlvData[6],currentHmlvData.container=_ge(this.elt.id+"_"+ii)||n(this.elt).find(".TabSelected").get(0),currentHmlvData.registered=!1,currentHmlvData.containerControl=this,currentHmlvData.hasBeenSelected=!1,currentHmlvData.messageId=this.messageId,currentHmlvData.codePage=this.codePage;this.collapseExpandControl=_ge(this.elt.id+"_ce"),this.upperIconBar=_ge(this.elt.id+"_uib"),this.lowerIconBar=_ge(this.elt.id+"_lib"),this.brandingArea=_ge(this.elt.id+"_brand"),this.selectedIndex=-1,this._setCollapseState(this.elt.getAttribute("c")=="true",!0),this._clickHandler=$CD(this,this._onIconClick),n(this.upperIconBar).bind("click",this._clickHandler),n(this.lowerIconBar).bind("click",this._clickHandler),this._toggleExpandHmlvHandler=$CD(this,this.toggleExpandHmlv),n(this.brandingArea).bind("click",this._toggleExpandHmlvHandler),this.titleBar=_ge(this.elt.id+"_title"),n(this.titleBar).bind("click",this._toggleExpandHmlvHandler),this._resizeHandler=$CD(this,this._onResize),this._pageViewChangeHandler=$CD(this,this._onPageViewChange),n(window).bind("resize",this._resizeHandler),f.Cmd("nav.complete").subscribe(this._pageViewChangeHandler),this._buildIcons(),this._createIconBar(),this._createLoadingUI(),this._selectHmlv(0)}},t.dispose=function(){this.isCollapsed&&$BSI.reportEvent("lv.collapse",null),n(window).unbind("click",this._clickHandler);var t=0;this.hmlvData&&(this.hmlvData.forEach(function(n){n&&(n.hasBeenSelected&&t++,n.binding&&n.binding.dispose(),n.iconControl&&(n.iconControl.onclick=null),n.binding=null,n.container=null,n.containerControl=null,n.iconControl=null)},null),this.hmlvData.length>1&&$BSI.reportEvent("lv.tab.click",{tabClicks:t,totalTabs:this.hmlvData.length})),n(this.upperIconBar).unbind("click",this._clickHandler),n(this.lowerIconBar).unbind("click",this._clickHandler),n(this.brandingArea).unbind("click",this._toggleExpandHmlvHandler),n(this.titleBar).unbind("click",this._toggleExpandHmlvHandler),n(window).unbind("resize",this._resizeHandler),f.Cmd("nav.complete").unsubscribe(this._pageViewChangeHandler),this._clickHandler=this._toggleExpandHmlvHandler=this._resizeHandler=this.elt=this.collapseExpandControl=this.titleBar=this.upperIconBar=this.lowerIconBar=this.brandingArea=null},t._buildIcons=function(){for(var n,i,t=0;t<this.hmlvData.length;t++)n=_ce("a"),n.href="#",n.onclick=function(){return!1},n.className="IconContainer",n.setAttribute("iconIndex",t+1),r.LiveViews.hmlvIconSutraLabel&&n.setAttribute("sutra",r.LiveViews.hmlvIconSutraLabel),i=_ce("div"),i.style.backgroundImage="url("+this.hmlvData[t].icon+")",i.className="Icon",n.appendChild(i),this.hmlvData[t].iconControl=n},t._createIconBar=function(t){var s,h,u,e,r,f,o,c;if(this.elt.style.width="auto",s=this.lowerIconBar.offsetWidth,h=n("#"+this.elt.id+"_title"),this.hmlvData.length<=i._MAX_ICONS_ON_UPPER_BAR&&this.hmlvData.length*i._ICON_SIZE<s-this.brandingArea.offsetWidth-i._MINIMUM_TITLE_SIZE){if(this._usesUpperBar&&t)return;for(this._usesUpperBar=!0;this.upperIconBar.childNodes.length;)this.upperIconBar.removeChild(this.upperIconBar.childNodes[0]);while(this.lowerIconBar.childNodes.length)this.lowerIconBar.removeChild(this.lowerIconBar.childNodes[0]);for(r=0;r<this.hmlvData.length;r++)this.upperIconBar.appendChild(this.hmlvData[r].iconControl);h.addClass("TitleWithUpper")}else{if(u=Math.floor(s/i._ICON_SIZE),u==0)return;if(e=Math.ceil(this.hmlvData.length/u),!this._usesUpperBar&&u==this._iconsPerRow&&e==this._numRows&&t)return;for(this._usesUpperBar=!1,this._iconsPerRow=u,this._numRows=e;this.upperIconBar.childNodes.length;)this.upperIconBar.removeChild(this.upperIconBar.childNodes[0]);while(this.lowerIconBar.childNodes.length)this.lowerIconBar.removeChild(this.lowerIconBar.childNodes[0]);for(r=0;r<e;r++){for(f=_ce("div"),f.style.height=i._ICON_SIZE+"px",o=0;o<u;o++)c=r*u+o,c<this.hmlvData.length&&f.appendChild(this.hmlvData[c].iconControl);this.lowerIconBar.appendChild(f),f=null}h.removeClass("TitleWithUpper")}},t._callSelectedHmlvFunction=function(n){var i=this,t;i.selectedIndex>=0&&(t=i.hmlvData[i.selectedIndex],t&&t.registered&&i.isCollapsed&&t.binding&&t.binding[n]&&t.binding[n]())},t._onResize=function(){var n=this;n._createIconBar(!0),n._callSelectedHmlvFunction("onResize")},t._onPageViewChange=function(n){n.view===f.config.pageManager.manifests.Inbox.name&&this.updateLayout()},t.updateLayout=function(){var n=this;n._createIconBar(!1),n._callSelectedHmlvFunction("updateLayout")},t._selectHmlv=function(n){if(this.selectedIndex!=n){this.selectedIndex>=0&&($css.swap(this.hmlvData[this.selectedIndex].container,"TabSelected","Tab"),this.hmlvData.length>1&&$css.swap(this.hmlvData[this.selectedIndex].iconControl,"IconContainerSelected","IconContainer")),this.selectedIndex=n;var t=this.hmlvData[this.selectedIndex];t&&($css.swap(t.container,"Tab","TabSelected"),this.hmlvData.length>1&&$css.swap(t.iconControl,"IconContainer","IconContainerSelected"),this.isCollapsed||(t.hasBeenSelected=!0),t.registered||this.isCollapsed?t.binding&&t.binding.onHmlvSelect&&t.binding.onHmlvSelect():this._registerHmlv(t),this.setTitle())}},t.setTitle=function(){var t=this.hmlvData[this.selectedIndex],i="";i=t.binding&&t.binding.hmlvTitle?t.binding.hmlvTitle:t.loadingTitle,n("#"+this.elt.id+"_title").text(i)},t._onIconClick=function(t){var r=t.target||t.srcElement,i=n(r).closest("[iconIndex]").get(0);return i&&(this.isCollapsed&&this._setCollapseState(!1),this._selectHmlv(i.getAttribute("iconIndex")-1)),!1},t.toggleExpandHmlv=function(t){var i=t.target||t.srcElement;return i&&n(i).hasClass("SubBrand")?!0:(this._setCollapseState(!this.isCollapsed),!1)},t._setCollapseState=function(t,i){var u,r;this.isCollapsed=t,u=_ge(this.elt.id+"_c"),this.isCollapsed?($css.swap(this.collapseExpandControl,"Expanded","Collapsed"),i?$css.swap(u,"Content","ContentCollapsed"):wLive.Animations.collapse(n(u)).then(function(){$css.swap(u,"Content","ContentCollapsed")})):($css.swap(this.collapseExpandControl,"Collapsed","Expanded"),$css.swap(u,"ContentCollapsed","Content"),i||wLive.Animations.expand(n(u))),r=this.hmlvData[this.selectedIndex],r&&!this.isCollapsed&&(r.registered?r.binding&&r.binding.onHmlvSelect&&r.binding.onHmlvSelect():this._registerHmlv(r))},t._registerHmlv=function(n){r.LiveViews.registerHmlv(r.LiveViews.createHmlvRequest(n),n)},t._createLoadingUI=function(){n(".ProgressIndicator").each(function(){if($f){var t=n(this),i=t.text(),r=$f.createLoading({width:"20px",height:"20px",text:i});t.html(r)}})},t.onHmlvLoaded=function(){this.setTitle()}}(window.originaljQuery||window.jQuery),function(n){var i=window,u=i.ol=i.ol||{},r=i.ol.lv=i.ol.lv||{},t;r.LiveViews||(r.LiveViews=n.extend({Providers:{}},u.config.LiveViewsConfig)),t=r.LiveViews,t._started=!1,t._pendingRegistration=[],t.QueueState=new $Enum("NotSent","Waiting","Done"),t.Kind=new $Enum("Hotmail","External"),t.HmlvTypes=new $Enum("Photo","Video"),t._delayRegistration=function(n,i){var u=t._pendingRegistration,r=u[n];r||(r=[],r.kind=n,u.push(r),u[n]=r),r.push(i)},t.getHmlvDataElem=function(t){return n(t).closest("[hmlv]").get(0)},t.createHmlvRequest=function(n){var i=new HM.HMLiveViewRequestObject;return i.Id=n.container.id,i.Sender=t.senderName,i.Type=n.type,i.SubType=n.subType,i.Data=n.data,i.ExtraData=n.extraData,n.registered=!0,i},t.registerHmlv=function(n,i){t._delayRegistration(t.Kind.Hotmail,[n,i])}}(window.originaljQuery||window.jQuery),function(n,t){"use strict";function i(t,i,r,f){return new n.vm.MenuItem({template:u,text:i,key:t,cssClass:f||"",eventData:{srcCtl:r}})}var r="leftNavContextMenuTemplate",u=t.templates("#leftNavMenuItemTemplate"),f={templateId:r,template:t.templates("#"+r),attr:"html",init:function(t){this.inboxContextMenu=t.props.inboxContextMenu,this.data=this.contextMenu=new n.vm.LeftNavContextMenu({loc:1,menuItems:[]})},render:function(){return this.tagCtx.render(this.data)},onAfterLink:function(){var i=this.contents(),r,u;this.$lncm=t("#lncm"),this.menuElt=i.find(".c_m").get(0),r={sourceEl:this.$lncm.get(0),parentEl:this.$lncm.get(0),forceDispose:!0,disableAnimations:!0},this.data.params(r);i.on("mouseover",this.inboxContextMenu.handleMouseOverMenu);i.on("mouseout",this.inboxContextMenu.handleMouseOutMenu);i.on("contextmenu",t.proxy(this.inboxContextMenu.handleContextMenuInMenu,this));u=this;i.on("click",".ContextMenuItem",function(){var i=t(this).view().data,r=t.extend({key:i.Key,srcCtl:i.eventData().srcCtl},{senderElt:u._senderElt});return n.Cmd("ln.menu.click").bubble(this,r),$menu.closeCurrent(),!1})},onCmdBubble:function(i,r){function o(r){n.Cmd("accessibility.suppressrestorefocus").bubble(s);var u=t.when();f.isCollapsed()&&(u=i.toggleExpandCollapse()),u.then(r)}var s=this,i,f,u,e;if(r.name==="ln.menu.click"){i=r.args.srcCtl,f=i.data,u=HM.InstrumentationEntryPoint.ContextMenu,e={editEntryPoint:u};switch(r.args.key){case"rename":i.edit({entryPoint:u});break;case"newSubfolder":i.newSubfolder(e);break;case"delete":i.deleteContainer({entryPoint:u});break;case"newFolder":o(function(){f.RootContainer.newItem(e)});break;case"newCategory":o(function(){f.RootContainer.newItem(n.vm.Container.createDefaultCategoryOptions(e))});break;case"manageCategories":n.Cmd("nav.managecategories").fire();break;case"manageRules":n.Cmd(n.GetAppConfig("IsAdvancedRulesEnabled")?"nav.managerules":"nav.managerulesold").fire({entryPoint:u});break;case"emptyFolder":case"emptyView":i.emptyContainer(u);break;case"markAllAsRead":i.markAllAsRead(u)}}},show:function(r,u){var e=u.data,f=[],s,h,c,l,a,o;e.RootContainer?(this.contextMenu.title(""),e.Type===HM.ContainerType.Folders?(f.push(i("newFolder",n.GetString("FolderList.Actions.AddFolder"),u)),f.push(i("manageRules",n.GetString("FolderList.Actions.ManageRules"),u))):(f.push(i("newCategory",n.GetString("QuickView.Header.ContextMenu.NewCategory"),u)),f.push(i("manageCategories",n.GetString("QuickView.Header.ContextMenu.ManageCategories"),u)),f.push(i("manageRules",n.GetString("FolderList.Actions.ManageRules"),u)))):(e.isChildAllowed()&&f.push(i("newSubfolder",n.GetString("FolderList.ContextMenu.NewSubfolder"),u)),s=e.isFolder()?n.GetString("FolderList.ContextMenu.Rename"):n.GetString("QuickView.ContextMenu.Rename"),f.push(i("rename",s,u,e.isRenameAllowed()?"":"NoDisplay")),h=e.isFolder()?n.GetString("FolderList.ContextMenu.Delete"):n.GetString("QuickView.ContextMenu.Delete"),f.push(i("delete",h,u,e.isDeleteAllowed()?"":"NoDisplay")),f.push(i("markAllAsRead",n.GetString("FolderList.ContextMenu.MarkAsRead"),u)),e.isEmptyAllowed()&&(c=e.isFolder()?i("emptyFolder",n.GetString("FolderList.ContextMenu.EmptyFolder"),u):i("emptyView",n.GetString("QuickView.ContextMenu.EmptyQuickView"),u),f.push(c)),e.isCategory()&&f.push(i("manageCategories",n.GetString("QuickView.ContextMenu.ManageCategories"),u))),t.observable(this.contextMenu.MenuItems).refresh(f),l=this.inboxContextMenu.getMenuEventPosition(r),this.inboxContextMenu.cancelTimers(),a=t.extend({targetLoc:l},this.data.Params),o=u.contents().get(0),this.inboxContextMenu.show(this.menuElt,o,a,"LeftNav",!1),this.inboxContextMenu.createHoverOffTimer(o,this.inboxContextMenu.hide,n.config.contextMenu.menuOffDelay)}};t.views.tags({leftNavContextMenuControl:f})}(window.ol,window.originaljQuery||window.jQuery),function(n,t){"use strict";var i="instantActionsFloatingTemplate",r;n.c=window.ol.c||{},n.c.InstantActionsFloatingControl={},n.c.InstantActionsFloatingControl.showControlDelay=0,n.c.InstantActionsFloatingControl.showControlDelayAfterClick=200,n.c.InstantActionsFloatingControl.hideControlDelay=0,r={templateId:i,template:t.templates("#"+i),attr:"html",init:function(t){var i=this,r=t.ctx;i.ControlNamespace=n.createControlNamespace(i.tagName),i.data=null},render:function(){return this.tagCtx.render(this.data)},onDispose:function(){var i=this;i._clearTimers(),i._previousMsgRow&&t.observable.simpleOff(i._previousMsgRow,"propertyChange."+i.ControlNamespace),i._$floatingInstantActionsElt.off("."+i.ControlNamespace),n.c.InstantActionsControl.detachEvents(i._$floatingInstantActionsElt),n.Cmd("ml.precommit").unsubscribe(i._onMessageListPreCommitProxy),i._onMessageListPreCommitProxy=i._$iaElements=i._handleMouseOverProxy=i._handleMouseOutProxy=i._$floatingInstantActionsElt=i.instantActionsControl=null},onAfterLink:function(){var i=this;i.instantActionsControl=n.findChildTag(i,"instantActionsControl")[0],i._$floatingInstantActionsElt=t(_ge(i.ControlNamespace)),i._$iaElements=i._$floatingInstantActionsElt.find(".ia_iw"),i.isDisabled=!1,i._handleMouseOverProxy=t.proxy(i.handleMouseOver,i),i._handleMouseOutProxy=t.proxy(i.handleMouseOut,i);i._$floatingInstantActionsElt.on("mouseover."+i.ControlNamespace,i._handleMouseOverProxy);i._$floatingInstantActionsElt.on("mouseout."+i.ControlNamespace,i._handleMouseOutProxy);n.c.InstantActionsControl.attachEvents(i._$floatingInstantActionsElt),i._onMessageListPreCommitProxy=t.proxy(i._onMessageListPreCommit,i),n.Cmd("ml.precommit").subscribe(i._onMessageListPreCommitProxy)},getContainerCssClasses:function(){return n.c.InstantActionsControl.getMessageListCssClasses(this.tagCtx.ctx.messageList.QueryContainer)},handleMouseOver:function(){var i=this;i._clearTimers(),i.isShowingIA=!0,i._showTimer=setTimeout(t.proxy(i._showInstantActions,i),n.c.InstantActionsFloatingControl.showControlDelay)},handleMouseOut:function(){var i=this;i._clearTimers(),i.isHidingIA=!0,i._hideTimer=setTimeout(t.proxy(i._hideInstantActions,i),n.c.InstantActionsFloatingControl.hideControlDelay)},_onMessageListPreCommit:function(n){var f=n.cmd,t=this,r=n.removedThreads,u,i;if(t._currentMsgRow&&t._currentMsgRow.data&&r.length>0)for(u=t._currentMsgRow.data.id(),i=0;i<r.length;i++)if(r[i].id()===u){t._clearTimers(),t.isHidingIA=!0,t.wasIAHiddenAfterClick=!0,t._hideInstantActions();break}},handleMouseOverRow:function(i){var r=this;r._currentMsgRow=n.GetControlFromEvent(i,"messageRowControl"),r._clearTimers(),r.isShowingIA=!0,r._showTimer=setTimeout(t.proxy(r._showInstantActions,r),r.wasIAHiddenAfterClick?n.c.InstantActionsFloatingControl.showControlDelayAfterClick:n.c.InstantActionsFloatingControl.showControlDelay)},handleMouseOutRow:function(){var i=this;i._clearTimers(),i.isHidingIA=!0,i.wasIAHiddenAfterClick=!1,i._hideTimer=setTimeout(t.proxy(i._hideInstantActions,i),n.c.InstantActionsFloatingControl.hideControlDelay)},_clearTimers:function(){var n=this;n.isHidingIA=!1,n.isShowingIA=!1,clearTimeout(n._showTimer),clearTimeout(n._hideTimer)},handleInstantActionsDisable:function(){var n=this;n.isHidingIA=!0,n._hideInstantActions(),n.isDisabled=!0},handleInstantActionsEnable:function(){var n=this;n.isDisabled=!1,n._clearTimers()},_showInstantActions:function(){var n=this,r,u,i,f,e;n.isShowingIA&&!n.isDisabled&&n._currentMsgRow&&(n._currentMsgRow!==n._previousMsgRow&&(r=n._currentMsgRow.data,u=n._currentMsgRow.ctx.groupConfig,n.instantActionsControl.updateThreadAndGroupConfig(r,u),n._previousMsgRow&&t.observable.simpleOff(n._previousMsgRow,"propertyChange."+n.ControlNamespace),t.observable.simpleOn(n._currentMsgRow,"propertyChange."+n.ControlNamespace,function(t,i){var r=i.path;(r==="Selected"||r==="Focused")&&n._updateCssToMatchRowSelectionState()}),n._previousMsgRow=n._currentMsgRow),i=t(n._currentMsgRow.getElement()),i.length>0&&(f=i.closest(".messageListContainer"),e=i[0].offsetTop-f.scrollTop()+51,n._$floatingInstantActionsElt.css("top",e),n._updateCssToMatchRowSelectionState(),n._$floatingInstantActionsElt.removeClass("NoDisplay")))},_hideInstantActions:function(){var n=this;n.isHidingIA&&!n.isDisabled&&n._$floatingInstantActionsElt.addClass("NoDisplay")},_updateCssToMatchRowSelectionState:function(){var n=this,t=!!n._currentMsgRow.selected(),r=!!n._currentMsgRow.focused(),i=t||r,u=!t&&r;n._lastRowSelected!==t&&(n._lastRowSelected=t,n._$floatingInstantActionsElt.toggleClass("mlSel",n._lastRowSelected),n._$iaElements.toggleClass("t_sel",n._lastRowSelected)),n._lastRowFocusedAndNotSelected!==u&&(n._lastRowFocusedAndNotSelected=u,n._$floatingInstantActionsElt.toggleClass("mlFoc",n._lastRowFocusedAndNotSelected)),n.isSelectedOrFocused!==i&&(n.isSelectedOrFocused=i,n._$floatingInstantActionsElt.toggleClass("mlNotSelOrFoc",!i))},attachMouseEvents:function(i){var r=this;n.c.MessageRowControl.attachMouseOverEvents(i,t.proxy(r.handleMouseOutRow,r),t.proxy(r.handleMouseOverRow,r))}},t.views.tags({instantActionsFloatingControl:r})}(window.ol,window.originaljQuery||window.jQuery),function(n,t){"use strict";function r(t,i,r){return t&&!i&&n.GetAppConfig("IsBulkActionsEnabled")&&r}var i="messageCountTemplate",u=t.templates(null,{markup:"#"+i,converters:{readingOptionsUrl:function(){return"/mail/options.aspx?subsection=13&amp;n="+n.DynamicNonce()}}}),f={templateId:i,template:u,attr:"html",init:function(t){var i=this,r=t.ctx;i.data=r.messageList,i.layout=r.layout,i.ControlNamespace=n.createControlNamespace(i.tagName),n.UpdateProperty(i,"MessageCountClass",!0),i.linksTabIndex=n.getTabIndex("msgListHeader",i.layout.isReadingPaneOn()?6:1)},render:function(){return this.tagCtx.render(this.data)},onAfterLink:function(){var i=this,r=i.contents();r.on("click",".clearAllCk",function(t){n.Cmd("sel.clearall").bubble(i,{}),t.preventDefault()});r.on("click",".selAll",function(t){i.data.bulkSelected(!0),n.Cmd("sel.bulk").bubble(i,{entryPoint:HM.InstrumentationEntryPoint.Canvas}),t.preventDefault()});t.observable.simpleOn(i.data,"propertyChange."+i.ControlNamespace,function(t,r){var u=r.path;i.data.ShowMessageCount&&(u==="SelectedMessageCount"||u==="CheckAllChecked"||u==="BulkSelected"||u==="ShowMessageCount")&&n.UpdateProperty(i,"MessageCountClass")})},onDispose:function(){t.observable.simpleOff(this.data,"propertyChange."+this.ControlNamespace)},getMessageCountClass:function(){var n=this.data,t="c-MessageCount",i=r(n.CheckAllChecked,n.BulkSelected,n.hasMoreThanOnePage());return t+=this.layout.isReadingPaneOn()?" RPOnMessageCount":" NoRP TextSizeSmall",t+(i?" SelPrompt":n.SelectedMessageCount===0?" NoSel":" Sel")},numItemsSelectedString:function(t,i){var r="",u;return i?(u=this.data.isQuickViewFilterOrSearch()?n.GetString("MessageList.Selection.GenericView"):n.GetString("MessageList.Selection.GenericFolder"),r=n.GetString("MessageList.AllSelected").format(u)):r=t>1?n.GetString("MessageList.MultipleSelected").format(t):n.GetString("MessageList.OneSelected"),r},getSelAllPrompt:function(t,i){var e="",h=this.data.hasMoreThanOnePage(),c=r(t,i,h),u,f,o,s;if(c){this.data.isQuickViewFilterOrSearch()?u=n.GetString("MessageList.Selection.GenericView"):(f=this.data.queryContainer(),o=f.name(),s=f.id()===n.config.sysFldrs.inboxFid?n.GetString("MessageList.BulkSelectAllPrompt.Inbox"):n.GetString("MessageList.BulkSelectAllPrompt.Folder"),u=s.format(o));var l=n.GetString("MessageList.BulkSelectAllPrompt.LinkText"),a='<a tabindex="{0}" sutra="bulkselectall" href="#">{1}<\/a>'.format(this.linksTabIndex,l),e=n.GetString("MessageList.BulkSelectAllPrompt").format(a,u)}return e}};t.views.tags({messageCountControl:f})}(window.ol,window.originaljQuery||window.jQuery),function(n,t){"use strict";var i="messageListContextMenuTemplate",u=n.vm,r={templateId:i,template:t.templates("#"+i),attr:"html",init:function(n){this.data=n.args[0],this.inboxContextMenu=n.props.inboxContextMenu},render:function(){return this.tagCtx.render(this.data)},onDispose:function(){var n=this;n._expandLink&&t(n._expandLink).off(".mlcm"),t(n.contents()).off(".mlcm"),t(n.contents()).find(".cm_focus[onclick]").each(function(n,t){t.onclick=null}),n.$mlcm=n.menuElt=n._expandLink=n._$senderDiv=n._$messageDiv=n._$headingDiv=null},onAfterLink:function(){var i=this,r=i.contents(),u,f,e;if(i._trackedSenders=[],i.$mlcm=t("#mlcm"),i.menuElt=r.find(".c_m").get(0),i._$senderDiv=r.find("#mlcm_sender"),i._$messageDiv=r.find("#mlcm_message"),i._$headingDiv=r.find("#mlcm_heading"),i._$senderDiv){u=i._$senderDiv.find("div.MenuItemGroupTitle"),f=u.find("span.SenderTitle"),i._expandLink=f[1].parentNode;t(i._expandLink).on("click.mlcm",t.proxy(i._expandSenderItems,i))}e={sourceEl:i.$mlcm.get(0),parentEl:i.$mlcm.get(0),forceDispose:!0,disableAnimations:!0},i.data.params(e);r.on("mouseover.mlcm",t.proxy(i.inboxContextMenu.handleMouseOverMenu,i));r.on("mouseout.mlcm",t.proxy(i.inboxContextMenu.handleMouseOutMenu,i));r.on("contextmenu.mlcm",t.proxy(i.inboxContextMenu.handleContextMenuInMenu,i));r.on("click.mlcm",".ContextMenuItem",function(r){var u=t(this).view().data,f={key:u.Key,senderElt:i._senderElt,srcElement:this,isSenderMenu:i.data.isSenderMenu(),event:r.originalEvent};return $menu.closeCurrent(),n.Cmd("ml.menu.click").bubble(this,f),r.preventDefault(),!1})},onCmdBubble:function(){},handleContextMenuInRow:function(n,t,i,r,u){var f=this.inboxContextMenu.getMenuEventPosition(n);this._showMessageMenu(f,t,i,r,u),n.stopPropagation(),n.preventDefault()},handleMouseOverRow:function(i,r,u){var o=i.target,s=r&&r.getElement(),h=o.getAttribute("email"),c=u===n.config.sysFldrs.sentFid||u===n.config.sysFldrs.draftsFid,l=c||!n.GetAppConfig("EnableCtxMenuSenderActions"),f,e,a;if(this.inboxContextMenu.menuOwner&&this.inboxContextMenu.menuOwner==s&&this.inboxContextMenu.cancelHoverOffTimer(s),h&&!l&&(f=o,f.hoverOff&&this.inboxContextMenu.menuOwner==f&&this.inboxContextMenu.cancelHoverOffTimer(f),!f.hoverOn&&(!this.inboxContextMenu.menuOwner||this.inboxContextMenu.menuOwner!=f))){e={},e.$event=i,a=this,f.mouseMoveHandler=function(n){e.$event=n};t(f).on("mousemove",f.mouseMoveHandler);this._trackedSenders.push(f),this.inboxContextMenu.createHoverOnTimer(f,$CC(t.proxy(this._showSenderMenu,this),[f,e,!0,r,u]),n.config.contextMenu.sndOnDelay)}},handleMouseOutRow:function(i,r){var e=i.target,o=e.getAttribute("email"),f=r&&r.getElement(),u;this.inboxContextMenu.menuOwner&&this.inboxContextMenu.menuOwner==f&&(f.hoverOff||this.inboxContextMenu.createHoverOffTimer(f,$CC(this.inboxContextMenu.hide),n.config.contextMenu.menuOffDelay)),o&&(u=e,u.hoverOn&&(t(u).off("mousemove",u.mouseMoveHandler),u.mouseMoveHandler=null,this._trackedSenders.remove(u),this.inboxContextMenu.cancelHoverOnTimer(u)),this.inboxContextMenu.menuOwner&&this.inboxContextMenu.menuOwner==u&&!u.hoverOff&&this.inboxContextMenu.createHoverOffTimer(u,$CC(this.inboxContextMenu.hide),n.config.contextMenu.sndOffDelay))},_showMessageMenu:function(n,t,i,r,u){var f=this;f.data.isSenderMenu(!1),f._showCtxMenu(n,t,i,r,u,null,!1)},_showSenderMenu:function(i,r,u,f,e){var s=this,o,h;if(!f||!f.data){this.inboxContextMenu.cancelTimers();return}s.data.isSenderMenu(!0),o=s.inboxContextMenu.getMenuEventPosition(r.$event),i.mouseMoveHandler&&(t(i).off("mousemove",i.mouseMoveHandler),i.mouseMoveHandler=null,s._trackedSenders.remove(i)),o&&(u&&(h=n.config.contextMenu.sndOffsetX,document.documentElement.dir=="rtl"?(o.left-=h,o.right-=offset):(o.left+=h,o.right+=h),o.top+=n.config.contextMenu.sndOffsetY,o.bottom+=n.config.contextMenu.sndOffsetY),s._showCtxMenu(o,f,null,!1,e,i,!0))},menusCreated:function(t){return n.Accessor(this,"MenusCreated",t)},_showCtxMenu:function(i,r,u,f,e,o,s){var h,rt,et,ot,k,ut,w,tt,st,ft,ht,ct;this.menusCreated(!0),this.data.messageRow(r);var lt=r.contents(n.c.MessageRowControl.selectorClassName)[0],y=n.config.sysFldrs,b=e===y.junkFid,d=e===y.draftsFid,at=e===y.sentFid,l=null,a=null,c=!1,g=!1,nt=!1,it=!1,v=!1,p=u&&u.length===1;this.inboxContextMenu.cancelTimers(),h=this.data,o?(c=!1,this._senderElt=o,l=r,a=l.getSenderDataByElt(o),g=l.data.isRead()&&!l.data.isVoicemail(),nt=!l.data.isRead()&&!l.data.isVoicemail(),it=l.data.Count>1):(c=!0,this._senderElt=null,f?(g=!0,nt=!0,v=!0):(p?(l=u[0],a=l.getSenderData(!0),a=a.length?a[0]:null,it=l.data.Count>1):v=!0,t.each(u,function(n){var t=u[n].data;t.isVoicemail()||(t.isRead()?g=!0:nt=!0)}))),rt=this._$headingDiv,rt&&(rt.toggleClass("NoDisplay",!o),a&&(et=a.name,ot=a.displayEmail||a.email,h.senderName(et),h.senderEmail(ot))),k=this._$senderDiv,ut=!1,k&&(k.toggleClass("DisableMenuItems",!o),k.find("div.MenuItemGroupTitle").toggleClass("NoDisplay",!!o),w=y.sentFid===e||y.draftsFid===e||!a&&!v,h.setMenuItemStyle("sender","sendemailtosender",!v&&!w?"":"NoDisplay"),h.setMenuItemStyle("sender","viewallfromsender",!v&&!w?"":"NoDisplay"),tt=!(e===y.junkFid||e===y.trashFid),n.GetAppConfig("IsBulkActionsEnabled")&&(h.setMenuItemStyle("sender","deleteallfromsender",!f&&tt&&!w?"":"NoDisplay"),h.setMenuItemStyle("sender","moveallfromsender",!f&&tt&&!w?"":"NoDisplay")),ut=!w&&(!v||n.GetAppConfig("IsBulkActionsEnabled")&&!f&&tt),k.toggleClass("NoDisplay",!ut),st=v?n.GetString("MessageList.ContextMenu.ForTheseSenders"):n.GetString("MessageList.ContextMenu.ForThisSender"),h.senderMenuTitle(st)),ft=this._$messageDiv,ft&&(ft.toggleClass("NoDisplay",!!o),h.setMenuItemStyle("send","reply",c&&p&&!d&&!b?"":"NoDisplay"),h.setMenuItemStyle("send","replyall",c&&p&&!d&&!b?"":"NoDisplay"),h.setMenuItemStyle("send","forward",c&&p&&!d&&!b?"":"NoDisplay"),h.setMenuItemStyle("message","markasread",c&&nt?"":"NoDisplay"),h.setMenuItemStyle("message","markasunread",c&&g?"":"NoDisplay"),h.setMenuItemStyle("message","movetopopup",c?"":"NoDisplay"),h.containsMenuItem("message","markasjunk")&&h.setMenuItemStyle("message","markasjunk",c&&!b&&!d&&!at&&!0?"":"NoDisplay"),h.setMenuItemStyle("message","markasnotjunk",c&&b?"":"NoDisplay"),h.setMenuItemStyle("message","deletemsg",c?"":"NoDisplay"),h.setMenuItemStyle("message","viewsource",c&&p?"":"NoDisplay"),this.contents().find("#mlcm_sep").toggleClass("c_ms",p),ht=v?n.GetString("MessageList.ContextMenu.ForTheseMessages"):it?n.GetString("MessageList.ContextMenu.ForThisConversation"):n.GetString("MessageList.ContextMenu.ForThisMessage"),h.messageMenuTitle(ht)),ct=t.extend({targetLoc:i},h.Params),this.inboxContextMenu.show(this.menuElt,o?o:lt,ct,"MessageList",s)},_expandSenderItems:function(i){var r=this._$senderDiv,u,f;r&&(r.hasClass("DisableMenuItems")&&r.toggleClass("DisableMenuItems",!1),n.callFocus(t("ul A",r)[0])),u=r.find(".MenuItems"),f=this,wLive.Animations.expand(u).then(function(){f.inboxContextMenu.reposition()}),i.stopPropagation(),i.preventDefault()}};t.views.tags({messageListContextMenuControl:r})}(window.ol,window.originaljQuery||window.jQuery),function(n,t){"use strict";function f(n){var f=t("#c_header"),e=t(".c-PageFooter"),o=t(".v-ReadMessageContainer"),s=t(".v-MessageListContainer"),i={top:0,bottom:0},r,h,u;return f&&e&&o&&s&&(h=e.filter(":visible")[0].offsetHeight,u=f.height(),r=o.scrollTop(),i.bottom=h-r,n&&n.readingPaneMode()===HM.ReadingPaneLocation.Bottom&&(u+=s.height()),i.top=u+r),i}t.templates("#categorizeMenuPlaceHolderTemplate");var i="readMessageTemplate",r=t.templates(null,{markup:"#"+i,converters:{fullViewBtnClass:function(n){return"rmFull "+(n?"NoDisplay":"")},closeBtnClass:function(n){return"rmClose "+(n?"":"NoDisplay")},nextImgClass:function(n){return n?"i_rm_n":"i_rm_n_d"},prevImgClass:function(n){return n?"i_rm_p":"i_rm_p_d"},readMessageClass:function(n){var t="c-ReadMessage";return n||(t+=" NoDisplay"),t}}}),u={templateId:i,template:r,attr:"html",show:function(t){return n.Accessor(this,"Show",t)},hasNext:function(t){return n.Accessor(this,"HasNext",t)},hasPrevious:function(t){return n.Accessor(this,"HasPrevious",t)},showEditableSubject:function(t){return n.Accessor(this,"ShowEditableSubject",t)},containsCompose:function(t){return n.Accessor(this,"ContainsCompose",t)},init:function(t){var i=this,r=t.ctx;i.data=r.readMessage,i.layout=r.layout,i._ReadMessageControl$setExpandedMessageQueriesCallback=function(){i.setExpandedMessageQueries.apply(i),this.deferred.resolve()},n.Cmd("setexpandedmessagequeries").subscribe(i._ReadMessageControl$setExpandedMessageQueriesCallback),i._ReadMessageControl$preCommitCallback=function(n){var t=n.addedThreads;t.length===0?this.deferred.resolve():i.animateMoveMessages().then(this.deferred.resolve)},n.Cmd("rp.precommit").subscribe(i._ReadMessageControl$preCommitCallback),i.show(!0)},animateMoveMessages:function(){var e=[],r=[],i,u,f;if(wLive.Animations.Enabled){for(r=this.contents().find(".c-ReadMessagePart").not(".NoDisplay.animatable, .NoDisplay .animatable").toArray(),i=0;i<r.length;i++)u=r[i],f=n.GetControlFromDOMElement(u,"readMessagePartControl"),f&&f.data.preparedToAdd()&&e.push(u);return wLive.Animations.expand(e)}return t.when()},_unbindLastContents:function(){t(".v-ReadMessageContainer").off(".readMessage"),this._$lastContents&&(this._$lastContents.off(".readMessage",".rmFull").off(".readMessage",".rmClose").off(".readMessage",".rmNext").off(".readMessage",".rmPrev").off(".readMessage").find(".attachmentDownloadIframe").off(".readMessage"),this._$lastContents=null)},onDispose:function(){var t=this;t._unbindLastContents(),n.Cmd("setexpandedmessagequeries").unsubscribe(t._ReadMessageControl$setExpandedMessageQueriesCallback),n.Cmd("rp.precommit").unsubscribe(t._ReadMessageControl$preCommitCallback),t._ReadMessageControl$setExpandedMessageQueriesCallback=null,t._ReadMessageControl$preCommitCallback=null},performAnimations:function(){return wLive.Animations.enterContent(".v-ReadMessageContainer",undefined,undefined,!0)},render:function(){return this.tagCtx.render(this.data,{calculateEdgeOffsets:f})},onAfterLink:function(){var i=this,r;i._unbindLastContents(),r=i.contents(),i.$categorizeMenu=r.find(".cm_menu"),i.categorizeMenuControl=null;r.on("click.readMessage",".rmFull",function(t){n.Cmd("fullview").bubble(i,{thread:i.data.thread(),dontInstrument:!0,forceCloseRightRail:!0}),t.preventDefault()});r.on("click.readMessage",".rmClose",function(t){n.Cmd("closeview").bubble(i,{thread:i.data.thread()}),t.preventDefault()});r.on("click.readMessage",".rmNext",function(t){i.hasNext()&&n.Cmd("sel.next").bubble(i),t.preventDefault()});r.on("click.readMessage",".rmPrev",function(t){i.hasPrevious()&&n.Cmd("sel.prev").bubble(i),t.preventDefault()});r.on("click.readMessage",function(){n.Cmd("accessibility.focus").bubble(i,{focusTo:"readMessageControl"})});r.find(".attachmentDownloadIframe").on("load.readMessage",function(){var n;try{n=null,n=$B.IE?this.contentWindow.document.parentWindow:this.contentWindow,n.serverErrorMessage!=null&&i.data.serverError(n.serverErrorMessage)}catch(t){return}});r.on("click.readMessage",".rmSubject",function(t){i.composeControl&&i.composeControl.thread.isComposeDataReady().then(function(){return i.showEditableSubject(!0),n.findChildTag(i,"watermarkedInputControl")[0].focus(),t.stopPropagation(),!1})});t(".v-ReadMessageContainer").on("keydown.readMessage",function(n){var r=20,t=i._$lastContents&&i._$lastContents.find(".rmMessages");t&&t.length>0&&(n.which===38?t[0].scrollTop-=r:n.which===40&&(t[0].scrollTop+=r))});i._$lastContents=r},getCloseViewTitle:function(){return n.FormatShortcutString(n.GetString("MessageList.BackTo").format(n.GetString("MessageList.BackTo.Messages")),"closeFullViewMsg")},messageMode:function(){return n.Accessor(this,"MessageMode",value)},setExpandedMessageQueries:function(){for(var r=this.data.Thread.Items,i,t=0;t<r.length;t++)i=r[t],i instanceof n.vm.MessageThread&&i.requestBody(!0)},onShowCategorize:function(t,i,r){this.categorizeMenuControl||(this.categorizeMenuControl=n.c.categorizeMenuControl.initializeCategorize(this.$categorizeMenu)),this.categorizeMenuControl.show({ev:r.$event.originalEvent,sourceEl:r.sourceEl,selectedMsgs:[t.data],isMessagePart:!0,disableBulkApply:r.inSentOrDraftss,sourceOffMenuElt:!0,extraMenuParams:r.extraMenuParams,entryPoint:HM.InstrumentationEntryPoint.MessageBody})},onCmdBubble:function(t,i,r){var u=this,s,f,e,o;switch(i.name){case"downloadattachment":s=this.contents(),r.newWindow?window.open(r.url):(f=s.find(".attachmentDownloadIframe").get(0),null!==f&&undefined!==f&&(f.src=r.url));break;case"viewofficepreview":r.newWindow?window.open(r.url):$BSI.navigateTo(r.url,"_blank");break;case"messagepartclicked":case"showunsafebody":r.conversationThread=u.data.Thread;break;case"rm.showcategorize":u.onShowCategorize(t,i,r);break;case"rm.markassafe":e=r.activeMessageThread,e.markAsSafe({enableJmrReporting:r.enableJmrReporting,entryPoint:r.entryPoint}).done(function(){var t=e.senderDetails(),i=t.fromPraAddress||t.fromAddress;wLive.Controls.Notifications.createBottomBar({content:n.GetString("ReadMessage.AllowSender.MultipleMessagesAllowedInfo").format(i),dismissalMode:wLive.Controls.Notifications.BarDismissalMode.Timeout}).show(),n.Cmd("messagepartclicked").bubble(u,{activeMessageThread:e})});break;case"rm.unsubscribe":r.activeMessageThread.unsubscribe({enableJmrReporting:r.enableJmrReporting}).done(function(){r.sweep?n.Cmd("bulkactionbysender").fire({action:"unsubscribe",entryPoint:HM.InstrumentationEntryPoint.MessageBody}):wLive.Controls.Notifications.createBottomBar({content:n.GetString("ReadMessage.Alert.UnsubscribeAndBlockNotice"),dismissalMode:wLive.Controls.Notifications.BarDismissalMode.Timeout}).show()});break;case"compose.controlready":u.composeControl=t,u.containsCompose(!0),u.showEditableSubject(!1),u.data.showActionMenu(!1),u._$lastContents.find(".rmButtons").addClass("NoDisplay"),r.animationPromise.then(function(){var n=u._$lastContents.find(".rmMessages"),i;u.data.thread().items()[0]===t.thread?n.scrollTop(0):(i=r.$element[0].offsetTop-u._$lastContents.find(".rmTop").outerHeight()+1,n.scrollTop(i))});break;case"compose.controldisposed":case"compose.hiding":u.containsCompose(!1),u.showEditableSubject(!1),u.composeControl=null,u._$lastContents.find(".rmButtons").removeClass("NoDisplay"),u.data.showActionMenu(!0);break;case"compose.clickaway":r.args.control&&r.args.control.data.id()===u.data.thread().id()||u._$lastContents.addClass("NoDisplay");break;case"compose.updatingthread":o=n.findChildTag(u,"watermarkedInputControl"),o&&o[0]&&o[0].triggerChangeEvent()}}};n.c=window.ol.c||{},n.c.readMessageControl={},n.c.readMessageControl.isFocusOnReadingPaneHeader=function(){var n=document.activeElement;return n&&t(n).parent().closest(".rmButtons").length>=1},t.views.tags({readMessageControl:u})}(window.ol,window.originaljQuery||window.jQuery),function(n){"use strict";var t=window.ol=window.ol||{},f=t.c=t.c||{},r=f.Entity=function(n){var t=this;t.EntityText=n.EntityText},i=r.prototype,u=r.EntityType={Url:"Url",Email:"Email"},e;r.isSupported=function(n){return!!u[n]},e=f.EntityFactory={},e.createEntity=function(n,i){switch(i){case u.Url:return new t.c.UrlEntity(n);case u.Email:return new t.c.EmailEntity(n)}},i.createLink=function(t){var r=this,i=document.createElement("A");if(i.href=r._getLinkHref(),i.target=r._shouldOpenLinkInNewTab()?"_blank":"",i.className=r._getLinkClassName(),i.appendChild(document.createTextNode(t)),typeof r._onLinkClick=="function")n(i).on("click",function(n){return r._onLinkClick(n)});return i},i._getLinkHref=function(){return"#"},i._getLinkClassName=function(){return"eeoEntity"},i._shouldOpenLinkInNewTab=function(){return!1}}(window.originaljQuery||window.jQuery),function(){"use strict";var t=window.ol=window.ol||{},i=t.c=t.c||{},r=i.Entity,u=i.UrlEntity=function(n){r.call(this,n)},n;t.extendClass(r,u),n=u.prototype,n._getLinkHref=function(){return this.EntityText.indexOf("www.")===0?"http://"+this.EntityText:this.EntityText},n._getLinkClassName=function(){return""},n._shouldOpenLinkInNewTab=function(){return!0}}(window.originaljQuery||window.jQuery),function(){"use strict";var n=window.ol=window.ol||{},u=n.c=n.c||{},i=n.c.Entity,r=u.EmailEntity=function(n){i.call(this,n)},t;n.extendClass(i,r),t=r.prototype,t._getLinkHref=function(){return"mailto:"+this.EntityText},t._onLinkClick=function(){}}(window.originaljQuery||window.jQuery),function(n,t){"use strict";var u=n.vm,i="readMessagePartTemplate",r={templateId:i,template:t.templates("#"+i),attr:"html",collapsible:function(t){return n.Accessor(this,"Collapsible",t)},updateAllExpanded:function(n){this.data.updateAllExpanded(n)},init:function(t){var i=this;i.data=t.props.thread,i.ControlNamespace=n.createControlNamespace(i.tagName)},onDispose:function(){var t=this;t._$element&&(n.c.InstantActionsControl.detachEvents(t._$element),t._$element=null),t._collapseProxy&&(n.Cmd("collapseall").unsubscribe(t._collapseProxy),t._collapseProxy=null),t._expandProxy&&(n.Cmd("expandall").unsubscribe(t._expandProxy),t._expandProxy=null)},render:function(){return this.tagCtx.render(this.data)},onAfterLink:function(){var i=this;i._expandProxy||(i._expandProxy=t.proxy(i.expand,i),i._collapseProxy=t.proxy(i.collapse,i),n.Cmd("expandall").subscribe(i._expandProxy),n.Cmd("collapseall").subscribe(i._collapseProxy)),i._$element=t(_ge(i.ControlNamespace)),n.c.InstantActionsControl.attachEvents(i._$element);i._$element.on("click",".toggleExpandMessage",function(){n.getTextSelection(i._$element[0])||(i.data.isBodyExpanded()?i.collapse():i.expand())});i._$element.on("click",".AttachmentContainer .DownloadAttachment a, .AttachmentContainer .DownloadAllLink a, .HMLV .DownloadAllLinkContainer a",function(t){return n.Cmd("clickattachment").bubble(i,{event:t.originalEvent}),!1});i._$element.click(function(){i.data.requestBody().then(function(){n.Cmd("messagepartclicked").bubble(i,{activeMessageThread:i.data})})})},expand:function(){var n=this,i;n.data.requestBody().then(function(){i=n.animateBody(!0),i&&i.then(t.proxy(function(){n.updateAllExpanded(!0)},n))})},collapse:function(){var n=this;n.animateBody(!1).then(t.proxy(function(){n.updateAllExpanded(!1)},n))},animateBody:function(n){var r=this.contents(),t=r.find(".c-ReadMessagePartBody"),i;return n?(t.removeClass("NoDisplay"),i=wLive.Animations.expand(t)):i=wLive.Animations.collapse(t).then(function(){t.addClass("NoDisplay"),t.attr("style","")}),i},getHeaderCssClass:function(n,t,i,r){var u="c-ReadMessagePart ReadMsgContainer HasLayout ClearBoth HideShadows";return u+=n?" SinglePart":" FullPart",u+=" NoHistory",u+=t?" Read":" Unread",i&&(u+=" Draft"),r&&(u+=" TrustedSender"),u+" RmIc"},onCmdBubble:function(i,r,u){var f=this,p=f.data,b,y,s;switch(r.name){case"clickattachment":var o=u.event,k=o.target||o.srcElement,e=t(k).closest("[aIdx]").get(0);if(e){var h=e.getAttribute("aIdx"),c=e.getAttribute("aDepth"),w=e.getAttribute("aBlob"),d=e.getAttribute("wacScenario")=="View",l=f.data.id(),a,v=!1,r;d?(a=n.Attachments.GetOfficePreviewUrlFromParams(l,f.data.folderId(),f.data.codePage(),h,c),v=o.shiftKey||o.ctrlKey,r="viewofficepreview"):(b=e.getAttribute("entryPt"),a=n.Attachments.GetDownloadUrlFromParams(l,f.data.codePage(),h,c,w,b),r="downloadattachment",v=!!e.getAttribute("aNewWin")),n.Cmd(r).bubble(f,{url:a,newWindow:v,mid:l,aIdx:h,aDepth:c,aBlob:w})}break;case"rm.unsafelinkclick":y=t(u.srcElement),s=wLive.Controls.Notifications.createFlyout({anchor:u.srcElement,content:n.GetString("ReadMessage.BlockedContentDialog"),buttons:{action:n.GetString("ReadMessage.BlockedContentDialog.Button")}}),t(s).bind("aftershow.unsafe",function(){t(s.content()).find("BUTTON").click(function(){var n=y.attr("href");n&&n!=="#"&&$BSI.navigateTo(n,y.attr("target"))})}),s.show().done(function(t){t.buttonClicked==="action"&&(p.showUnsafe(),n.Cmd("showunsafebody").bubble(f,{activeMessageThread:p}))})}}};t.views.tags({readMessagePartControl:r})}(window.ol,window.originaljQuery||window.jQuery),function(n,t){"use strict";function o(t){for(var i=t,s=[],l=[],a="",f=0,h=0,v=n.GetAppConfig("EeoMaxChars"),c,o;i&&f<=v;){if(i.nodeType===e&&(c=i.data.replace("\r\n","\n"),h=f+c.length,l.push({start:f,end:h,node:i}),a+=c,f=h),o=i.firstChild,o){if(s.push(i),i=o,r(o))continue}else if(i===t)break;for(i=u(i);!i&&s.length>1;)i=s.pop(),i=u(i)}return{text:a,nodes:l}}function r(n){return n.nodeName!=="A"&&n.nodeName!=="STYLE"}function u(n){do n=n.nextSibling;while(n&&!r(n));return n}function s(t,i){for(var o=i.nodes,w=i.text,b=[],v,f,y,h,p,e,s=0;s<t.length;s++){v=t[s];for(f in v)if(n.c.Entity.isSupported(f))for(y=v[f],h=0;h<y.length;h++)for(var k=n.c.EntityFactory.createEntity(y[h],f),l=k.EntityText.replace("\r\n","\n"),u=w.indexOf(l),a=u+l.length;u!==-1;){if(p=c(u,o),p!==-1)for(e=p;e<o.length&&o[e].start<a;e++){var r=o[e],d=Math.max(u-r.start,0),g=Math.min(a-r.start,r.end-r.start);b.push({node:r.node,start:d,end:g,nodeStart:r.start,nodeEnd:r.end,entityControl:k,type:f})}u=w.indexOf(l,a),a=u+l.length}}return b}function h(n){var i,r,u,t,f,o,e;for(n.sort(function(n,t){return n.nodeStart+n.start-(t.nodeStart+t.start)}),i=document.createDocumentFragment(),r=0,u=0;u<n.length;u++)t=n[u],f=t.node.data,t.start>=r&&(i.appendChild(document.createTextNode(f.substring(r,t.start))),o=t.entityControl.createLink(f.substring(t.start,t.end)),i.appendChild(o),r=t.end),e=n[u+1],e&&e.node===t.node||(i.appendChild(document.createTextNode(f.substring(r))),t.node.parentNode.replaceChild(i,t.node),r=0,i=document.createDocumentFragment())}function c(n,t){for(var u=0,f=t.length,i,r;u<=f;){if(i=Math.floor((u+f)/2),r=t[i],r.start<=n&&r.end>n)return i;r.start>n?f=i-1:u=i+1}return-1}function l(n){var u={CC:"",BCC:"",To:"",Subject:"",MessageBody:""},a=n.substr("mailto:".length),l,o,s,r,f;if(a){var v=a.split("?"),y=v[0],p=v[1],e=[],h=[],c=[];if(y&&(e=i(decodeURIComponent(y))),p)for(l=p.split("&"),o=0;o<l.length;o++)if(s=l[o].split("="),s.length>1)if(r=s[0].toLowerCase(),f=decodeURIComponent(s[1]),r==="to"||r==="cc"||r==="bcc")switch(r){case"to":t.merge(e,i(f));break;case"cc":h=i(f);break;case"bcc":c=i(f)}else r==="body"?u.MessageBody=f.encodeHtml():r==="subject"&&(u.Subject=f);e.length>0&&(u.To=e.join(";")),h.length>0&&(u.CC=h.join(";")),c.length>0&&(u.BCC=c.join(";"))}return u}function i(t){for(var u=[],f=t.split(","),r,i=0;i<f.length;i++)r=f[i],n.String.isValidEmailSyntax(r)&&u.push(r);return u}var f=n.c=n.c||{},a=f.readMessagePartBodyEEOs={renderEEOsAsLinks:function(n,t){var i=o(t),r=s(n,i);h(r)},redirectMailToLinksToCompose:function(i){for(var f=i.getElementsByTagName("a"),u,r=0;r<f.length;r++)if(u=f[r],u.href&&u.href.indexOf("mailto:")===0)t(u).addClass("mailToLink").on("click",function(t){t.preventDefault();var i=t.currentTarget&&t.currentTarget.href,r=l(i);n.Cmd("begincomposesession").fire({action:"newmessage",composeData:r,entryPoint:HM.InstrumentationEntryPoint.MessageBody,curView:n.Instrumentation.currentView(),numParticipants:0,priority:HM.InstrumentationPriority.Normal,composeLoaded:n.Instrumentation.composeLoaded(),isFullCompose:!0})})}},e=document.TEXT_NODE||3}(window.ol,window.originaljQuery||window.jQuery),function(n,t){"use strict";var u=n.c=n.c||{},i=t.views.sub.onBeforeInsert,r="readMessagePartBodyTemplate",f=t.templates(null,{markup:"#"+r,allowCode:!0,converters:{getClass:function(n){return"c-ReadMessagePartBody"+(n?"":" NoDisplay")}}}),e=u.readMessagePartBodyControl={templateId:r,template:f,attr:"html",cssClasses:function(n,t){return"ExternalClass MsgBodyContainer"+(n?" PlainTextMessageBody":"")+(t?" ContentFiltered":"")},onBodyClick:function(t){var e=!1,i=t.originalEvent,s,h,u,f;if(i&&i.srcElement&&i.srcElement.__box__)return!0;if(this.isSvmLinkClick(i)&&(s=this.data,h=i.srcElement.href,s.submitSvmFeedback(h),i.returnValue=!1,i.cancelBubble=!0,e=!0),i&&i.srcElement&&!n.IsNavigatingLink(i.srcElement)){try{if(u=i.srcElement,(u.tagName=="A"||u.tagName=="AREA")&&(f=u.href,$U.isLinkABookmark(f))){var c=f.substr(f.indexOf("#")+1),l=this.contents().find(".readMsgBody"),o=l.find('a[name="'+c+'"], *[id="'+c+'"]').get(0);if(o){for(var a=l.closest(".rmMessages").get(0),v=o.offsetTop,r=o.offsetParent,y=20;r&&r!=a&&y>0;)v+=r.offsetTop,r=r.offsetParent,y--;a.scrollTop=v}}}catch(p){}e=!0}return e&&t.preventDefault(),!0},isSvmLinkClick:function(n){var i=!1,t;return this.data.isSvmMail()&&"A"==n.srcElement.tagName&&(t=n.srcElement.href,t&&(t.match(/cgi-bin\/feedback/i)||t.match(/mail\/SvmFeedback.aspx/i))&&(i=!0)),i},init:function(t){var i=this;i.data=t.props.thread,i.folderList=t.ctx.folderList,i.ControlNamespace=n.createControlNamespace(i.tagName),i.BodyId="body"+i.ControlNamespace},render:function(){var t=this;return t.data.isPrint()||t.data.isComposeSession()||(t.onBeforeInsert=function(r){var u=r.getElementById&&r.getElementById(t.BodyId)||r.querySelector&&r.querySelector("#"+t.BodyId),f;u&&(i.remove(t.onBeforeInsert),t.onBeforeInsert=undefined,f="",$B.IE&&$B.V===8&&(f="<div style='display:none'>&nbsp;<\/div>"),u.innerHTML=f+t.data.Body,t.data.Eeos&&t.data.Eeos.Entities&&n.c.readMessagePartBodyEEOs.renderEEOsAsLinks(t.data.Eeos.Entities,u),n.config.appSettings.IsMailToRedirectEnabled&&n.c.readMessagePartBodyEEOs.redirectMailToLinksToCompose(u))},i.add(t.onBeforeInsert)),t.tagCtx.render(t.data)},onAfterLink:function(){var i=this,r=this.contents(),u;r.on("click",".readMsgBody",function(n){i.onBodyClick(n)});r.on("click",".sfUnsubscribe",function(t){var f=i.data,r,u;r=null,i.ctx&&i.ctx.root&&(r=i.ctx.root.SelectedContainer),u=r?r.name():i.folderList.getContainerById(f.folderId()).name(),n.controlHelpers.SafetyUI.create().showUnsubscribeConfirmation({anchor:t.target,activeMessageThread:i.data,folderName:u}).done(function(r){n.Cmd("rm.unsubscribe").bubble(t.currentTarget,{activeMessageThread:i.data,sweep:r.sweep,enableJmrReporting:r.enableJmrReporting})}),t.preventDefault()});r.on("click",".sfUnjunkItems",function(t){n.Cmd("notjunk").fire({e:t.originalEvent,entryPoint:HM.InstrumentationEntryPoint.CommandBar}),t.preventDefault()});r.on("click",".sfMarkAsSafe",function(t){n.controlHelpers.SafetyUI.create().maybeShowFre({anchor:t.target,jmrType:HM.JmrType.NotJunk}).done(function(r){n.Cmd("rm.markAsSafe").bubble(t.currentTarget,{activeMessageThread:i.data,enableJmrReporting:r?r.enableJmrReporting:!1,entryPoint:HM.InstrumentationEntryPoint.MessageBody})}),t.preventDefault()});r.on("click",".sfShowUnsafe",function(t){return i.data.showUnsafe(),n.Cmd("showunsafebody").bubble(i,{activeMessageThread:i.data}),t.preventDefault(),!1});u=_ge(i.BodyId),t.observable.simpleOn(i.data,"propertyChange."+i.ControlNamespace,function(n,t){t.path==="Body"&&(u.innerHTML=t.value)})},onDispose:function(){var n=this;t("#"+n.BodyId+" [onclick]").each(function(n,t){t.onclick=null}),t.observable.simpleOff(n.data,"propertyChange."+n.ControlNamespace),n.onBeforeInsert&&(i.remove(n.onBeforeInsert),n.onBeforeInsert=undefined)}};t.views.tags({readMessagePartBodyControl:e})}(window.ol,window.originaljQuery||window.jQuery),function(){function i(n){return n=n.replace(/(&#8220;)|(&#8221;)|[“”\u8220\u8221]/g,'"'),n.replace(/(&#8216;)|(&#8217;)|[‘’\u8216\u8217]/g,"'")}function r(n){return(n.charAt(0)==='"'||n.charAt(0)==="'")&&n.charAt(0)===n.charAt(n.length-1)&&(n=n.substring(1,n.length-1)),n}function u(){return $pwc.names.isLastNameFirst()}function f(n){var t=n.First;return n.First=n.Last,n.Last=t,n}var e=window.wLive||{},n=window.ol=window.ol||{},t;n.ContactsUtil={},t=n.ContactsUtil,t.getFirstLastNames=function(n){var t=n.DisplayName,e,o;return t=i(t),t=r(t),e={First:"",Last:""},t&&(t!=n.PreferredEmail&&(o=t.indexOf(" "),o!==-1?(e.First=t.substr(0,o),e.Last=t.substr(o+1)):e.First=t),u()&&f(e)),e}}(),function(n,t){"use strict";function h(){var i,t;if(!r)for(i=n.GetAppConfig("codePages"),r={},t=0;t<i.length;t++)r[i.codePage]=t;return r}var u="readMessagePartHeaderTemplate",f="ReadMessageContact",i=n.vm,e=n.ContactsUtil,r,o=t.templates(null,{markup:"#"+u,allowCode:!0,converters:{getIcFullName:function(n){var t=n.icFullName||n.displayName||n.fromName||n.fromAddress;return t.encodeHtml()},getFromAddress:function(t){var r=t.fromAddress,i="";return r&&(i=n.config.RlmEntityMarkIfRtl+"("+t.fromAddress.encodeHtml()+n.config.RlmEntityMarkIfRtl+")"),i},getDisplayName:function(n){return n.senderDetails},getDraftStr:function(t){return t?n.GetString("MessageHeader.Saved"):n.GetString("MessageHeader.Sent")},getClass:function(n,t){return(t||"")+(n?"":" NoDisplay")},snippetClass:function(n,t){var i="Snippet ClearLeft";return n&&(i+=" NoDisplay"),t&&(i+=" FakeSnippet"),i},menuContainerClass:function(n,t){var i="c_mcp";return n===HM.BodyHistoryType.History&&(i+=" IsShowingHistory"),t&&(i+=" IsShowingDetails"),i},fromContainerClass:function(n,t){return"t_hov MsgHover MsgPartGradient ia_hc"+(n?" Expanded":" Collapsed")+(t?" toggleExpandMessage":"")},renderICControl:function(t,i){var u=null,r,e;return(t.senderCid==="0"?$Do.iff("$pwc",0,function(){var n=$pwc.getPersonsByEmail(t.fromAddress);u=n.length>0&&n[0].getId()}):u=t.senderCid,r=i?n.config.appSettings.safeUserTileUrl:t.icUserTileUrl,window.$icm&&(i||t.icImageTileType!=="PWN"||(r=null),e=null,e=u?$icm.createICForPerson(f,u,{userTileUrl:r,email:t.fromAddress,showICCard:!0}):$icm.createNonContactIC(f,t.fromAddress,{userTileUrl:r,name:t.icFullName,email:t.fromAddress}),e))?e.render():"<img style='height:60px;width:60px;' src='{0}' id='rmic1_usertile' class='c_ic_tile' />".format(r)},selectedAttr:function(n){return n?' selected="selected"':""}}}),s={templateId:u,template:o,attr:"html",expanded:function(t){return n.Accessor(this,"Expanded",t)},icInstance:function(t){return n.Accessor(this,"ICInstance",t)},actionsMenu:function(t){return n.Accessor(this,"ActionsMenu",t)},isConversationThreadingOn:function(){return n.GetUserConfig("ConversationThreading")},toggleExpandHeader:function(){this.expanded(!this.expanded())},init:function(t){var i=this,r=t.ctx,u=i.data=t.props.thread;i.categoryList=r.categoryList,i.layout=r.layout,i.expanded(u.showExpandedHeaders()),i.ControlNamespace=n.createControlNamespace(i.tagName),u.isBodyExpanded()&&i.createActionsMenu()},render:function(){return this.tagCtx.render(this.data)},onAfterLink:function(){function u(n){var t=parseInt(n.target.value,10)||i.data.codePage();i.data.selectCodePage(t)}var i=this,r=i.contents();i.findAndActivateIC(),i.data.isContentFiltered()&&t.observable.simpleOn(i.data,"propertyChange."+i.ControlNamespace,function(n,t){if(t.path==="IsContentFiltered"&&!t.value){var r=i.icInstance();r&&window.$icm&&$icm.removeIC(r),i.findAndActivateIC()}});r.on("click",".ReadMsgHeaderDetail",function(n){n.stopPropagation()});r.on("click",".toggleExpandHeader",function(){var n=r.find(".ReadMsgHeaderDetail"),u;return i.expanded()&&i.data.isBodyExpanded()?u=wLive.Animations.collapse(n).then(function(){n.addClass("NoDisplay")}):(n.removeClass("NoDisplay"),u=wLive.Animations.expand(n)),u.then(function(){t.proxy(i.toggleExpandHeader(),i)}),!1});r.on("click",".AttachmentContainer .DownloadAllLink, .AttachmentContainer .DownloadAttachment",function(t){return n.Cmd("rm.unsafelinkclick").bubble(t.target,{srcElement:t.target}),!1});r.on("click",".AddContact",function(){if(i.data.EditContactUrl)return $BSI.navigateTo(i.data.EditContactUrl,"_top"),!1;var t=i.data.senderDetails(),r=e.getFirstLastNames({DisplayName:t.fromName,PreferredEmail:t.fromAddress}),u=HM.createContactToAdd({FirstName:r.First,LastName:r.Last,EmailAddress:t.fromAddress});return n.Dispatcher.fireCmd("addcontacts",{contactsToAdd:[u],queryAddingContactFrom:HM.createItemListQuery({containerId:i.data.id(),containerType:HM.ItemListQueryContainerType.Message,folderId:i.data.folderId()}),messageQueriesToFetch:[HM.createItemListQuery({containerId:i.data.id(),containerType:HM.ItemListQueryContainerType.Message})],entryPoint:HM.InstrumentationEntryPoint.MessageBody}).deferred.done(function(){n.Cmd("messagepartclicked").bubble(i,{activeMessageThread:i.data})}),!1});r.on("click",".t_atc.ICName",function(n){return t(n.target).closest(".ReadMsgFrom").find(".c_ic_frame_clip").click(),n.preventDefault(),!1});r.on("click",".Categories.MessageHeaderItem",function(t){var f={edgeOffsets:i.ctx.calculateEdgeOffsets(i.layout),noDockCache:!0},r=i.data.folderId(),u=n.config.sysFldrs,e=r===u.sentFid||r===u.draftsFid;return n.Cmd("rm.showcategorize").bubble(this,{$event:t,inSentOrDrafts:e,sourceEl:this,extraMenuParams:f}),!1});r.on("change",".codePageMenu",u).on("keydown",".codePageMenu",function(n){var t=n.keyCode;(t===13||t!==38&&t!==40&&t!==9)&&u(n)});i.data.isBodyExpanded()?i.createActionsMenu():t.observable.simpleOn(i.data,"propertyChange."+i.ControlNamespace,function(n,t){t.path==="IsBodyExpanded"&&t.value&&i.createActionsMenu()})},onDispose:function(){var n=this.icInstance();n&&window.$icm&&($icm.removeIC(n),this.icInstance(null)),t.observable.simpleOff(this.data,"propertyChange."+this.ControlNamespace),this.categoryList=this.layout=null},onCmdBubble:function(t,i,r){var s,h,o;if(i.name==="menu.click"){var e=r.key,u=this,f=HM.InstrumentationEntryPoint.MessagePartMenu;switch(e){case"reply":case"replyall":case"forward":return n.Cmd(e).fire({action:e,thread:u.data,entryPoint:f}),!1;case"markasjunk":case"markasnotjunk":return s=HM.JmrType[e==="markasjunk"?"Junk":"NotJunk"],n.controlHelpers.SafetyUI.create().maybeShowFre({jmrType:s,anchor:t.$menuElt.get(0)}).done(function(t){n.vm.MessageThread.performActionOnThreads(e,[u.data],{folderId:u.data.folderId(),enableJmrReporting:t?t.enableJmrReporting:!1,srcCtl:u,entryPoint:f},!0)}),!1;case"deletemsg":return n.vm.MessageThread.performActionOnThreads(e,[u.data],{entryPoint:f},!0),!1;case"viewsource":u.data.viewSource(u.data.folderId(),f);break;case"printmessage":u.data.print(f);break;case"createrule":return n.Cmd("createrule").fire({threads:[u.data],entryPoint:f}),!1;case"markasread":return u.data.markReadUnread(!0,f,!0),!1;case"markasunread":return u.data.markReadUnread(!1,f,!0),!1;case"showhistory":return u.data.showHistoryBody(),!1;case"hidehistory":return u.data.hideHistoryBody(),!1;case"showdetails":return u.expanded(!0),!1;case"hidedetails":return u.expanded(!1),!1;case"deleteallfromsender":n.Cmd("bulkactionbysender").fire({action:"sweep",selection:[u.data],entryPoint:f});break;case"unsubscribe":h=u.ctx.root.selectedContainer().name(),o=r.targetElement,n.controlHelpers.SafetyUI.create().showUnsubscribeConfirmation({anchor:o,activeMessageThread:u.data,folderName:h}).done(function(t){n.Cmd("rm.unsubscribe").bubble(o,{activeMessageThread:u.data,sweep:t.sweep,enableJmrReporting:t.enableJmrReporting})})}}},getCategories:function(n){var i=this.categoryList,t;return i&&n&&n.length>0&&(t=i.getSortedCategoryNamesFromIds(n)),t&&t.length>0?t.join(", "):""},showActionsMenuCss:function(n,t){return"mp0_aph"+(n&&this.isConversationThreadingOn()&&t?"":" NoDisplay")},findAndActivateIC:function(){var r=this,f=r.contents(),u=f.find(".c_ic"),t,i;u.length>0&&window.$icm&&(t=$icm.getICById(u.attr("id")),t&&(r.icInstance(t),t.activate(u),i=t.getPresence(),i&&i.actions&&i.actions.se&&(i.actions.se.performAction=function(){n.Cmd("sendemailtosender").fire({action:"sendemailtosender",senderEmail:r.data.senderDetails().fromAddress,entryPoint:HM.InstrumentationEntryPoint.IdentityControl})})))},createActionsMenu:function(){var u=this,r=u.data,s=r.isDraft();if(!s&&!u.actionsMenu()){var e=r.folderId(),h=r.isVoicemail(),o=r.containsChatHistoryItems(),c=r.showUnsubscribeLink(),f=e===n.config.sysFldrs.junkFid,l=e===n.config.sysFldrs.sentFid,a=e===n.config.sysFldrs.trashFid,t=[];f||o||(t.push(new i.MenuItem({text:n.GetString("ReadMessage.Reply"),key:"reply",keyboardShortcutAction:"reply",sutraTag:"replyMenuItem"})),t.push(new i.MenuItem({text:n.GetString("ReadMessage.ReplyAll"),key:"replyall",keyboardShortcutAction:"replyAll",sutraTag:"replyAllMenuItem"})),t.push(new i.MenuItem({text:n.GetString("ReadMessage.Forward"),key:"forward",keyboardShortcutAction:"forward",sutraTag:"forwardMenuItem"}))),t.push(new i.MenuItem({text:n.GetString("ReadMessage.Delete"),key:"deletemsg",keyboardShortcutAction:"deleteMsg",sutraTag:"deleteMessageMenuItem"})),f&&t.push(new i.MenuItem({text:n.GetString("ReadMessage.MarkAsNotJunk"),key:"markasnotjunk",keyboardShortcutAction:"markAsNotJunk",titleResource:"ContextMessage.NotJunk.Tooltip",sutraTag:"markAsNotJunkMenuItem"})),f||l||o||n.config.userPreferences.IsManagedRestricted||t.push(new i.MenuItem({text:n.GetString("ReadMessage.MarkAsJunk"),key:"markasjunk",sutraTag:"markAsJunkMenuItem"})),t.push(new i.MenuItem({template:"#menuSeparatorTemplate"})),h||(t.push(new i.MenuItem({text:n.GetString("ContextMessage.MarkUnread"),key:"markasunread",titleResource:"ContextMessage.MarkUnread",cssClass:"MarkUnreadButton",sutraTag:"markAsUnreadMenuItem"})),t.push(new i.MenuItem({text:n.GetString("ContextMessage.MarkRead"),key:"markasread",titleResource:"ContextMessage.MarkRead",cssClass:"MarkReadButton",sutraTag:"markAsReadMenuItem"}))),c&n.GetAppConfig("IsBulkActionsEnabled")&&t.push(new i.MenuItem({text:n.GetString("ReadMessage.SafetyBar.Unsubscribe"),key:"unsubscribe",titleResource:"ReadMessage.SafetyBar.Unsubscribe",sutraTag:"unsubscribeMenuItem"})),f||a||!n.GetAppConfig("IsBulkActionsEnabled")||t.push(new i.MenuItem({text:n.GetString("ReadMessage.DeleteAllFromSender"),key:"deleteallfromsender",sutraTag:"deleteAllFromSenderMenuItem"})),t.push(new i.MenuItem({template:"#menuSeparatorTemplate"})),n.GetAppConfig("IsAdvancedRulesEnabled")&&t.push(new i.MenuItem({text:n.GetString("ContextMessage.CreateRule"),key:"createrule",sutraTag:"createRuleMenuItem"})),t.push(new i.MenuItem({text:n.GetString("ReadMessage.PrintMessage"),key:"printmessage",sutraTag:"printMessageMenuItem"})),t.push(new i.MenuItem({text:n.GetString("ContextMessage.ViewSource"),key:"viewsource",sutraTag:"viewSourceMenuItem"})),r.isConversationPart()&&(t.push(new i.MenuItem({text:n.GetString("ReadMessage.ShowMessageHistory"),key:"showhistory",cssClass:"ShowHistoryButton",sutraTag:"showHistoryMenuItem"})),t.push(new i.MenuItem({text:n.GetString("ReadMessage.HideMessageHistory"),key:"hidehistory",cssClass:"HideHistoryButton",sutraTag:"hideHistoryMenuItem"}))),t.push(new i.MenuItem({text:n.GetString("ReadMessage.ShowSenderDetails"),key:"showdetails",cssClass:"ShowDetailsButton",sutraTag:"showDetailsMenuItem"})),t.push(new i.MenuItem({text:n.GetString("ReadMessage.HideSenderDetails"),key:"hidedetails",cssClass:"HideDetailsButton",sutraTag:"hideDetailsMenuItem"})),u.actionsMenu(new i.Menu({title:n.GetString("ReadMessage.Actions"),edgeOffsetFunction:u.ctx.calculateEdgeOffsets,loc:1,items:t,layout:u.layout,sutraTag:"messagePartActionsDropdownMenu"}))}},getCodePages:function(){for(var o={separator:!0},e=n.GetAppConfig("codePages"),l=h(),s=this.data.detectedCodePages()||[],i=[{codePage:-1,name:n.GetString("CodePage.AutoSelect")},o],c,u,f,r=0;r<s.length;r++)u=s[r],f=l[u],c=f>=0&&f<e.length?e[f]:{codePage:u,name:n.GetString("CodePage.Unknown").format(u)},i.push(c);return i.push(o),t.merge(i,e),i},isCurrentCodePage:function(n){return n===this.data.codePage()},shouldShowFlag:function(){var t=this,i=t.data,u=t.ctx&&t.ctx.root&&t.ctx.root.selectedContainer?t.ctx.root.selectedContainer():null,r=u?u.id():i.folderId(),f=r===n.config.sysFldrs.junkFid||r===n.config.sysFldrs.trashFid||r===n.config.sysFldrs.sentFid;return i.isFlaggable()&&!i.isDraft()&&!f&&n.config.appSettings.IsInstantActionsEnabled&&n.config.instantActionsSettings}};t.views.tags({readMessagePartHeaderControl:s})}(window.ol,window.originaljQuery||window.jQuery),function(n){"use strict";var t=ol.vm,i={template:"",attr:"html",init:function(n){var t=this;t.data=n.ctx.layout,t.ControlNamespace=ol.createControlNamespace(t.tagName),t._initialized=!1},render:function(){return this.tagCtx.render(this.data)},onAfterLink:function(){var i=this;n("#c_hiconc").on("click."+i.ControlNamespace,function(){if(!i._initialized){var r=[new t.MenuItem({key:HM.ReadingPaneLocation.Off,sutraTag:"ReadingPaneOff",text:ol.GetString("Options.MailAndJunk.ReadingPaneConfiguration.Off")}),new t.MenuItem({key:HM.ReadingPaneLocation.Right,sutraTag:"ReadingPaneRight",text:ol.GetString("Options.MailAndJunk.ReadingPaneConfiguration.Right")}),new t.MenuItem({key:HM.ReadingPaneLocation.Bottom,sutraTag:"ReadingPaneBottom",text:ol.GetString("Options.MailAndJunk.ReadingPaneConfiguration.Bottom")})];n("#rpMode").link(n.templates("#readingPaneMenuTemplate"),{Items:r},i.ctx).on("click",".rp",function(t){return i.data.applySizerBarCookie(),ol.Cmd("switchreadingpanemode").fire({value:n(this).view().data.key()}),$menu.closeCurrent(),t.preventDefault(),!1});i._initialized=!0}return!1})},chevronHtml:function(){return $menu.createChevron($menu.chevronTypes.LargeDotDark,!0)}};n.views.tags({readingPaneMenuControl:i})}(window.originaljQuery||window.jQuery),function(n){"use strict";var t=window.ol=window.ol||{},u=t.controlHelpers=t.controlHelpers||{},i,f=[HM.JmrType.Junk,HM.JmrType.Phish,HM.JmrType.Unsubscribe],r=u.SafetyUI=function(){var i=this,r,u=function(t){var i,u,f;return i=n.Deferred(),u=null,t.condition&&(!r||r.isResolved())?(f=t.getNotificationParams(),u=wLive.Controls.Notifications["create"+t.experienceType](f),r=u.show(),r.fail(function(){i.reject({})})):i.resolve(null),{deferred:i,notification:u,notificationPromise:r}};i.maybeShowFre=function(n){var r=f.indexOf(n.jmrType)>=0,i=u({experienceType:"Flyout",condition:r&&!t.config.userPreferences.HasSeenJmrReportFre,getNotificationParams:function(){return{content:t.GetString("ReadMessage.Junk.AllowReportingJunkQuestion"),anchor:n.anchor,buttons:{action:t.GetString("Options.Button.Ok")}}}});return i.notification&&i.notificationPromise.done(function(n){n.buttonClicked==="action"&&(t.config.userPreferences.HasSeenJmrReportFre=!0,i.deferred.resolve({enableJmrReporting:!0}))}),i.deferred.promise()},i.maybeShowJunkSenderExperience=function(i){var f,r=u({experienceType:"ModalDialog",condition:t.config.appSettings.isJunkSenderEnabled&&(i.isSenderInContactList||i.isSenderInWhiteList&&i.isSenderPinned),getNotificationParams:function(){var r,u,o,e,s;return r={},u={title:t.GetString("ReadMessage.MarkAsJunk.Title"),Cmsg:t.GetString("ReadMessage.MarkAsJunk.SenderInContactList"),Cremove:t.GetString("ReadMessage.MarkAsJunk.SenderInContactList.RemoveFromContacts"),Ckeep:t.GetString("ReadMessage.MarkAsJunk.SenderInContactList.KeepInContacts"),WLmsg:t.GetString("ReadMessage.MarkAsJunk.SenderInWhiteList"),WLremove:t.GetString("ReadMessage.MarkAsJunk.SenderInWhiteList.RemoveFromSafeList"),WLkeep:t.GetString("ReadMessage.MarkAsJunk.SenderInWhiteList.KeepInSafeList"),CMPmsg:t.GetString("ReadMessage.MarkAsJunk.SenderCompromised"),CMPcbx:t.GetString("ReadMessage.MarkAsJunk.SenderCompromised.CheckBox")},f=i.isSenderInContactList?"C":"WL",o=r.title=i.showCompromisedReporting&&!i.isSenderInContactList?"CMPmsg":f+"msg",e=i.senderEmailAddress,e.indexOf(";via")!==-1&&i.senderDisplayName&&(e=i.senderDisplayName),s=n.templates("#junkSenderDialogTmpl").render({message:u[o].format(e),checkbox:i.showCompromisedReporting?u.CMPcbx:null},{sutra:t.getSutra,contentSutra:function(n){return t.getSutra(r[n])}}),r.action=f+"keep",r.alternate=f+"remove",{options:{automationOptions:{action:r.action,alternate:r.alternate},moreCss:"SafetyUI"},title:u.title,content:s,buttons:{action:u[r.action],alternate:u[r.alternate]}}}});if(r.notification)n(r.notification).on({"buttonclick.dialog":function(t,u,e){n(r.notification).off(".dialog");var o=HM.RemoveSenderFromListOption,s=o.None,h=i.showCompromisedReporting?n(r.notification.content()).find("#cmpCbx")[0].checked:!1;e==="alternate"?(s=f==="C"?o.RemoveContact:o.RemoveSafeSender,$BSI.reportEvent("SelectClick.Messaging.Mail.JunkPrompt",{PromptType:"Block"})):e==="action"&&(s=f==="C"?o.KeepContact:o.KeepSafeSender),s!==o.None?r.deferred.resolve({removeFromList:s,accountIsCompromised:h}):r.deferred.reject()}});return r.deferred.promise()},i.showSafetyNotificationWithNavigationButton=function(n){n.button=n.button||{caption:t.GetString("Inbox.Safety.Notifications.LearnMoreButton.Text"),navigateTo:t.config.appSettings.safetyLearnMoreButtonNavigateTo},wLive.Controls.Notifications.createBottomBar({content:"<span>"+n.message.encodeHtml()+"<\/span>",dismissalMode:wLive.Controls.Notifications.BarDismissalMode.Timeout,buttons:{action:n.button.caption}}).show().then(function(t){t.buttonClicked==="action"&&n.button.navigateTo&&$BSI.navigateTo(n.button.navigateTo)})},i.showUnsubscribeConfirmation=function(r){var u=n.Deferred();return i.maybeShowFre({anchor:r.anchor,jmrType:HM.JmrType.Unsubscribe}).then(function(i){var o=function(){var u=r.activeMessageThread,f=u.senderDetails()||(u.sendersDetails().length>0?u.sendersDetails()[0]:null),n={buttons:{}},i,o,e,c,s,h;return i=f?f.displayName:null,i||(i=t.GetString("ReadMessage.Newsletters.UnsubscribeDialog.UnsubscribeBodyMissingFromName")),o=t.GetString("ReadMessage.Newsletters.UnsubscribeDialog.SweepOptionTextFormat").format(i,r.folderName),f.hasUnsubscribeInfo?(n.title=t.GetString("ReadMessage.Newsletters.UnsubscribeDialog.UnsubscribeHeader"),n.buttons.action=t.GetString("ReadMessage.Newsletters.UnsubscribeDialog.UnsubscribeButton"),e=u.unsubscribeLink(),e?(c="<a href='{0}' target='_blank'>{1}<\/a>",s="<a href='{0}' target='_blank'>{1}<\/a>".format(e.encodeHtml(),t.GetString("ReadMessage.Newsletters.UnsubscribeDialog.UnsubscribeBodyLinkFormat.LinkText")),n.content=t.GetString("ReadMessage.Newsletters.UnsubscribeDialog.UnsubscribeBodyLinkFormat").format(i.encodeHtml(),s)):n.content=t.GetString("ReadMessage.Newsletters.UnsubscribeDialog.UnsubscribeBodyEmailFormat").format(i)):(h=f.fromAddress,n.title=t.GetString("ReadMessage.Newsletters.UnsubscribeDialog.BlockHeader"),n.content=t.GetString("ReadMessage.Newsletters.UnsubscribeDialog.UnsubscribeBodyMissingFormat").format(i,h),n.buttons.action=t.GetString("ReadMessage.Newsletters.UnsubscribeDialog.BlockButton")),n.content+="<br/><br/><input type='checkbox' name='sweepCheck' id='sweepCheck'"+t.getSutra("Checkbox")+"/><label for='sweepCheck'>"+o+"<\/label>",n},e=o(),f;e.anchor=r.anchor,f=wLive.Controls.Notifications.createFlyout(e);n(f).on("beforedismiss",function(){f.sweepCheck=n(f.content()).find(".UserContent input[type=checkbox]")[0].checked});f.show().then(function(n){n.buttonClicked==="action"?u.resolve({sweep:f.sweepCheck,enableJmrReporting:i?i.enableJmrReporting:!1}):u.reject()},function(){u.reject()})},function(){u.reject()}),u}};r.create=function(){return i||(i=new r),i}}(window.originaljQuery||window.jQuery),function(n){"use strict";var u=n.vm;n.c=window.ol.c||{};var t=[{text:"ExactDate",value:HM.SearchDateRange.ExactDate},{text:"OneDay",value:HM.SearchDateRange.OneDay},{text:"ThreeDays",value:HM.SearchDateRange.ThreeDays},{text:"OneWeek",value:HM.SearchDateRange.OneWeek},{text:"TwoWeeks",value:HM.SearchDateRange.TwoWeeks},{text:"OneMonth",value:HM.SearchDateRange.OneMonth},{text:"ThreeMonths",value:HM.SearchDateRange.ThreeMonths},{text:"SixMonths",value:HM.SearchDateRange.SixMonths},{text:"OneYear",value:HM.SearchDateRange.OneYear},{text:"AndEarlier",value:HM.SearchDateRange.AndEarlier},{text:"AndLater",value:HM.SearchDateRange.AndLater}],i=[{text:"AnyAttachment",value:HM.SearchHasAttachments.AnyAttachments},{text:"HasAttachment",value:HM.SearchHasAttachments.HasAttachments},{text:"DoesNotHaveAttachment",value:HM.SearchHasAttachments.DoesNotHaveAttachments}],r={getDateRangeTitle:function(i){for(var u=n.GetString("Search.DateRange."+t[0].text)||"",r=0;r<t.length;r++)i===t[r].value&&(u=n.GetString("Search.DateRange."+t[r].text));return u},getDateRangeMenuData:function(){return t},getAttachmentTitle:function(t){for(var u=n.GetString("Search.Attachments."+i[0].text)||"",r=0;r<i.length;r++)t===i[r].value&&(u=n.GetString("Search.Attachments."+i[r].text));return u},getAttachmentMenuData:function(){return i},getContainerSelectorTitle:function(t,i,r,u){var f=n.GetString(r),e=t?t.length:0;return e===1?f=i.getContainerById(t[0]).name():e>1&&(f=n.GetString(u).format(e)),f}};n.c.searchBaseControl=r}(window.ol,window.originaljQuery||window.jQuery),function(n,t){"use strict";var i="watermarkedInputTemplate",r={templateId:i,template:t.templates("#"+i),attr:"html",init:function(t){var i=t.ctx;this.ClassName=(i.className||"")+" WatermarkedInput",this.data=i.data,this.PropertyName=i.propertyName,this.ControlNamespace=i.id||n.createControlNamespace(this.tagName)},render:function(){return this.tagCtx.render(this.data)},onAfterLink:function(){var i=this,r=_$ge(i.ControlNamespace),u,f;if(r.length===0&&(r=i.contents("#"+i.ControlNamespace)),!n.BrowserCapabilities.placeholder){r.length===0&&(r=i.contents(".WatermarkedInputContainer").find("#"+i.ControlNamespace)),u=i._$watermark=t(i.contents().find(".Watermark")[0]),f=t.proxy(i.toggleWatermark,i);u.on("click",function(){r.focus()});r.on("focus",function(){var n=t(this);u.addClass("DisplayNone")}).on("blur",function(){var n=t(this);n.val()||u.removeClass("DisplayNone")}).on("change",f);t.observable.simpleOn(i.data,"propertyChange."+i.ControlNamespace,f),r.change()}r.on("change",function(){t.observable(i.data).setProperty(i.PropertyName,this.value)});r.on("click",function(n){n.stopPropagation()})},toggleWatermark:function(n,t){var i=this;t&&t.path!==i.PropertyName||(i.data[i.PropertyName]?i._$watermark.addClass("DisplayNone"):i._$watermark.removeClass("DisplayNone"))},triggerChangeEvent:function(){_$ge(this.ControlNamespace).change()},onDispose:function(){var n=this;t.observable.simpleOff(n.data,"."+n.ControlNamespace),n._$watermark=null},focus:function(){var n=_$ge(this.ControlNamespace);n.focus()}};t.views.tags({watermarkedInputControl:r})}(window.ol,window.originaljQuery||window.jQuery),function(n){"use strict";function s(i){var o=t.config.pageManager,f=t.init.pages,r=f.initialPage,e,u,s;if(i)return t.pages.PageManager.renderPage(r,o,f.contexts[r]);e=t.pages.pageManager=new t.pages.PageManager("#pageContent",o,t.config.defaultStateJson,t.config.defaultStateJsonTypes),u=t.config.pageManager.manifests.Inbox?t.config.pageManager.manifests.Inbox.name:null,s=u!=null&&r!==u?e.loadAndInitializeView(u,f.contexts[u]):n.when(),s.always(function(){e.initialize(r,f.contexts[r])})}function h(){t.init.NotifyLoad("App1").then(function(){setTimeout(function(){t.markControlAsLoaded("App1")},1e3);var n=t.config,i=n.appSettings.delayedInit;setTimeout(function(){t.init.Load("Compose0")},i.compose),f.NotifyLoad("Compose0").then(function(){t.pages.pageManager.loadAndInitializeView(n.pageManager.manifests.Compose.name),t.init.LoadAll.call(t.init,n.compose.secondaryResourceSets)}),setTimeout($ScenarioQoS.postDeferredScenarios,i.scenarioQos),n.adbar.renderAd?($Do.when("$Adbar.TriedDependencies",0,function(){o()}),setTimeout(o,Math.max(i.webimMax-i.webim,0))):o(),n.mkTgUrl&&setTimeout(function(){var t=document.createElement("iframe");t&&(t.src=n.mkTgUrl,t.style.display="none",document.body.appendChild(t))},50)})}function o(){e||(setTimeout(function(){var n={};t.config.appSettings.isWebIMLeftNavModuleEnabled&&(n.messagingModule={containerClassName:"webIMMessagingSnippet",tabIndex:t.getTabIndex("leftnav",2)}),$Do.when("wlxim",0,function(){$WLXIM.init(window,n)})},t.config.appSettings.delayedInit.webim),e=!0)}var u=window,t=u.ol,r=u.Trace,i=u.HM,f=t.init=t.init||{},e;f.initializeApp=function(u){var v,o,y,l,b,k,d,p,c,a,w,e,f,g;for(v=t.config.fppConfig,t.Fpp=i.initializeEx(v.Url,v),t.config.shouldEnableTraceWindow&&t.init.NotifyLoad("App1").then(function(){n.observable(t.config).setProperty("enableTraceWindow",!0)}),t.config.shouldEnableLess&&(t.LessGetVal=function(n){return n.toString()},t.init.NotifyLoad("App1").then(function(){window.less={env:"development",dumpLineNumbers:"comments"},t.init.LoadAll("lessCss","lessJs").then(function(){n(".glassCss").remove()})})),t.setupTouchDetection(),t.setupLazyLinkClickBlocking(),t.removeJQueryFixup(),t.debugData={},o=t.debugData.commandEngine=new t.data.CommandEngine,y=t.debugData.messageListModel=new t.data.MessageListModel,y.register(o),l=t.debugData.conversationPool=new t.data.ConversationPool,l.register(o),b=t.debugData.validationModel=new t.data.ValidationModel,b.register(o),k=t.debugData.getKeysModel=new t.data.GetKeysModel,k.register(o),t.initialDataJSON=t.initialData(),e=0;e<t.initialDataJSON.length;e++)f=t.initialDataJSON[e],f&&f.type===i.DLReturnType.MessageListData&&(y.addMessageListData(f),l.addMessageList(f,[]));if(!t.config.serverRenderOnly){for(e=0;e<t.initialDataJSON.length;e++)f=t.initialDataJSON[e],f&&f.type===i.DLReturnType.ConversationListData&&l.addItem(f);t.data.ServerMessageModel.register(o),d=new t.data.InstrumentationModel({config:t.config.instrumentation}),d.register(o),t.CommandBarWrapper.initialize(),h()}for(p={FoldersExcoState:0,FoldersModelHash:0,excofl:0,excoqv:0,excowebim:0},t.config.serverRenderOnly?(c=t.config.permCookie,c||(c=t.config.permCookie={},c.cookieSettings=t.Cookies.serialize(p,"&"))):(c=t.Cookies.get(t.config.cookies.pdCookie),(!c||n.isEmptyObject(c))&&t.Cookies.setPermanent(t.config.cookies.pdCookie,p)),a=t.debugData.containerPool=new t.data.ContainerModel,a.register(o),e=0;e<t.initialDataJSON.length;e++)f=t.initialDataJSON[e],f&&(f.type===i.DLReturnType.ContainerPoolData?a.addListData(f,f.containerType):f.type===i.DLReturnType.FoldersHash&&a._updateExcoFieldsFromCookie(f.foldersHash));for(w=t.debugData.rulesModel=new t.data.RulesModel,w.register(o),e=0;e<t.initialDataJSON.length;e++)f=t.initialDataJSON[e],f&&f.type===i.DLReturnType.Rules&&(w._rules=f.rules);return t.config.features.undo&&!t.config.serverRenderOnly&&(g=t.debugData.undoModel=new t.data.UndoModel,g.register(o)),t.data.commandEngine=o,t.config.serverRenderOnly||(t.actionQueueUiMgr=new wLive.Hotmail.ActionQueueUiMgr,t.actionQueueUiMgr.initialize()),s(u)},e=!1,f.initializeFppLoader=function(){var n=t.config.fppConfig,r;return t.Fpp=i.initializeEx(n.Url,n),t.debugData={},r=t.debugData.commandEngine=new t.data.CommandEngine,t.data.commandEngine=r,s(!1)}}(window.originaljQuery||window.jQuery)