function _silverlightSlideshowCloseCallback(){SilverlightSlideshow._closeSlideshow()}function _silverlightSlideshowOnLoadCallback(){setTimeout("_setSlideshowFocus();",1e3)}function _setSlideshowFocus(){try{_ge("sl_slideshow").focus()}catch(n){}}function GetSlideshowAssetList(){return SilverlightSlideshow._assetList}function GetSlideshowStartIndex(){return SilverlightSlideshow._startIndex}var SilverlightSlideshow,SilverlightUpsell,_hasOlderSLVersionInstalled;(function(n){"use strict";var s=window,e=s.ol=s.ol||{},o=s.ol.lv=s.ol.lv||{},t=o.LiveViewMediaControl=function(n,t,i){this.elt=n,this.messageId=t,this.codePage=i,this.initialize()},i=t,f,r,h;typeof o.LiveViewMediaControlScriptData=="undefined"&&(o.LiveViewMediaControlScriptData={});var u=o.LiveViewMediaControlScriptData,y=e.config.appSettings.requiredSilverlightVersion,c=Silverlight.supportedUserAgent(y),l=Silverlight.isInstalled(y),a=e.GetAppConfig("SilverlightEnabled"),v=a&&l&&c;i._ITEM_NAME=0,i._ITEM_TYPE=1,i._ITEM_MEDIA_STRIP_THUMB_URL=2,i._ITEM_SLIDESHOW_MAIN_ASSET_URL=3,i._ITEM_SLIDESHOW_MAIN_ASSET_WIDTH=4,i._ITEM_SLIDESHOW_MAIN_ASSET_HEIGHT=5,i._ITEM_SLIDESHOW_THUMB_URL=6,i._ITEM_SLIDESHOW_THUMB_WIDTH=7,i._ITEM_SLIDESHOW_THUMB_HEIGHT=8,i._ITEM_ATTACHMENT_DOWNLOAD_SIZE=9,i._ITEM_ATTACHMENT_INDEX=10,i._ITEM_ATTACHMENT_DEPTH=11,i._ITEM_ATTACHMENT_STATE=12,i._ITEM_ATTACHMENT_BLOB=13,i._ITEM_ATTACHMENT_THUMB_COLOR=14,i._ITEM_ATTACHMENT_AUDIO_TYPE=15,i._MAX_THUMB_WIDTH=220,i._MAX_THUMB_HEIGHT=160,i._MIN_THUMB_WIDTH=90,i._MIN_THUMB_HEIGHT=40,i._ITEM_TYPE_PHOTO="Photo",i._ITEM_TYPE_VIDEO="Video",i._ITEM_TYPE_AUDIO="Audio",i._ITEM_TYPE_OFFICEDOC="OfficeDoc",i._ITEM_TYPE_GENERICFILE="GenericFile",i._ATTACHMENT_STATE_NONE="None",i._ATTACHMENT_STATE_BLOCKED="Blocked",i._ATTACHMENT_STATE_BROWSER_DISPLAY_ALLOWED="BrowserDisplayAllowed",i._ATTACHMENT_STATE_BROWSER_DISPLAY_DISALLOWED="BrowserDisplayDisallowed",i._CLICK_MORE="more",i._CLICK_GO_TO="go_to",i._CLICK_SLIDESHOW="slideshow",i._CLICK_DOWNLOAD_ALL="download_all",i._CLICK_ITEM="item",i._CLICK_DOWNLOAD_ITEM="download",i._CLICK_FILENAME="filename",i._CLICK_THUMBNAIL="thumbnail",i._CLICK_PLAY_AUDIO="play",i._CLICK_VIEW_DOC="wac",i._DISTANCE_BETWEEN_ITEMS=6,i._IMG_LOADER_TIMEOUT=50,i._MAX_TRIES=10,i._LOADING_STATE_NOT_LOADED=0,i._LOADING_STATE_LOADED_FAILED=1,i._LOADING_STATE_LOADED_SUCCESSFUL=2,i._PHOTO_ADDITIONAL_WIDTH=4,i._TNAIL_TYPE_NOT_INITIALIZED=0,i._TNAIL_TYPE_ALL_LINK=1,i._TNAIL_TYPE_ALL_DATAURI=2,i._TNAIL_TYPE_MIXED=3,i.createFileNameDiv=function(t){var i=_ce("div"),r;return i.className="FileName",r=_ce("span"),$css.add(r,"TextSizeSmall"),n(r).text(t),i.appendChild(r),u.sutraFileName&&i.setAttribute("sutra",u.sutraFileName),i},t.prototype={},f=t.prototype,f.initialize=function(){var mediaItems,ii,currentItem,_this,renderMediaStrip;for(this.hmlvTitle=this.elt.getAttribute("t"),this.reporter=new o.LiveViewClickReporter,this.behavior=t[this.elt.getAttribute("b")+"Behavior"],this.behavior.rtlMark=this.elt.getAttribute("rtlMark"),this.nonPhotoThumbWidth=parseInt(this.elt.getAttribute("nptw")),this.nonPhotoThumbHeight=parseInt(this.elt.getAttribute("npth")),mediaItems=this.elt.getAttribute("mi"),this.mediaItems=eval(mediaItems),this._tts=(new Date).getTime(),this._tnailLoadCount=0,this._tnailLoadFail=0,this._tnailFirstLoad=1,this._tnailType=t._TNAIL_TYPE_NOT_INITIALIZED,ii=0;ii<this.mediaItems.length;ii++)currentItem=this.mediaItems[ii],currentItem[t._ITEM_MEDIA_STRIP_THUMB_URL]=currentItem[t._ITEM_MEDIA_STRIP_THUMB_URL],currentItem[t._ITEM_SLIDESHOW_MAIN_ASSET_URL]=currentItem[t._ITEM_SLIDESHOW_MAIN_ASSET_URL],currentItem[t._ITEM_SLIDESHOW_THUMB_URL]=currentItem[t._ITEM_SLIDESHOW_THUMB_URL],currentItem.status=t._LOADING_STATE_NOT_LOADED,currentItem.imgLoader=null,currentItem.imgLoaderDelegate=null,currentItem.imgLoaderFailureDelegate=null,currentItem.imgLoaderDelegateCount=0,currentItem.index=ii,this.behavior&&this.behavior.initializeItem&&this.behavior.initializeItem(currentItem,this);if(this.totalItems=this.mediaItems?this.mediaItems.length:0,this.currentItemIndex=0,this.numVisibleItems=0,this.numRemainingItems=-1,this.moreLinkString=this.elt.getAttribute("mls"),this.moreLinkUrl=this.elt.getAttribute("mlu"),this._onClickMoreHandler=$CD(this,function(n){this._onLinkClick("more",n)}),this._downloadAllClickHandler=$CD(this,function(n){return this._onLinkClick("download_all",n),!1}),this._viewSlideShowClickHandler=$CD(this,function(n){return this._onLinkClick("slideshow",n),!1}),this._goToLinkClickHandler=$CD(this,function(n){this._onLinkClick("go_to",n)}),this._reportExternalClickHandler=$CD(this,function(){this.reporter._reportClick("External",this.elt)}),this.downloadAllLinkContainer=_ge(this.elt.id+"_downloadAllLinkContainer"),this.goToLink=_ge(this.elt.id+"_goToLink"),this.cobrandLink=_ge(this.elt.id+"_cobrandLink"),this.downloadAllLinkContainer)n(this.downloadAllLinkContainer).on("click",this._downloadAllClickHandler);if(this.goToLink)n(this.goToLink).on("click",this._goToLinkClickHandler);if(this.cobrandLink)n(this.cobrandLink).on("click",this._reportExternalClickHandler);this._mouseOverHandler=$CD(this,this._onItemMouseOver);n(this.elt).on("mouseover",this._mouseOverHandler);this._mouseOutHandler=$CD(this,this._onItemMouseOut);n(this.elt).on("mouseout",this._mouseOutHandler);_this=this,this.previousButton=_ge(this.elt.id+"_pb");n(this.previousButton).on("click",function(){return _this._onClickPrevious(),!1});n(this.previousButton).on("mouseover",function(){_this._onNavMouseOver("p")});n(this.previousButton).on("mouseout",function(){_this._onNavMouseOut("p")});n(this.previousButton).on("mousedown",function(){_this._onNavMouseDown("p")});n(this.previousButton).on("mouseup",function(){_this._onNavMouseUp("p")});this.nextButton=_ge(this.elt.id+"_nb");n(this.nextButton).on("mouseover",function(){_this._onNavMouseOver("n")});n(this.nextButton).on("mouseout",function(){_this._onNavMouseOut("n")});n(this.nextButton).on("mousedown",function(){_this._onNavMouseDown("n")});n(this.nextButton).on("mouseup",function(){_this._onNavMouseUp("n")});n(this.nextButton).on("click",function(){return _this._onClickNext(),!1});if(this.slideshowAssetList=null,this.mediaItemIndexToSlideshowAssetIndexMap={},renderMediaStrip=!0,this.$attLinkList=n(_ge(this.elt.id+"_attachmentList")),this.$attLinkList){this.$attLinkList.hasClass("DisplayInline")&&(renderMediaStrip=!1);this.$attLinkList.on("click",".AttachmentContainer .DownloadAllLink a, .AttachmentContainer .DownloadAttachment a",function(n){return e.Cmd("clickattachment").bubble(this,{event:n.originalEvent}),!1})}renderMediaStrip&&(this._renderItems(),this._renderViewSlideshowLink())},f.dispose=function(){var t,i;for(n(this.elt).off(),n(this.previousButton).off(),n(this.nextButton).off(),this.downloadAllLinkContainer&&n(this.downloadAllLinkContainer).off(),this.goToLink&&n(this.goToLink).off(),this.slideshowLinkContainer&&n(this.slideshowLinkContainer).off(),this.cobrandLink&&n(this.cobrandLink).off(),this.$attLinkList&&this.$attLinkList.off(),t=0;t<this.mediaItems.length;t++)i=this.mediaItems[t],this.behavior&&this.behavior.disposeItem&&this.behavior.disposeItem(i);this.reporter=null,this.elt=null},f._hasMoreLink=function(){return this.moreLinkString&&this.moreLinkString.length>0&&this.moreLinkUrl&&this.moreLinkUrl.length>0},f._renderViewSlideshowLink=function(){if(a&&(!$B.IE||!($B.V>=10)||l)&&c){this.slideshowLinkContainer=_ge(this.elt.id+"_slideshowLinkContainer");var t=_ge(this.elt.id+"_pipeContainer");if(this.slideshowLinkContainer){n(this.slideshowLinkContainer).on("click",this._viewSlideShowClickHandler);n(this.slideshowLinkContainer).show(),this.viewSlideshowLinkShown=!0}t&&n(t).show()}},f._renderItems=function(i){var l,e,a,y,v,p,w,s,r,h,b,c,f,k,d;if(this.isRendering){this.needsAnotherRender=!0;return}if(l=_ge(this.elt.id+"_ms"),e=0,this.totalItems&&(a=0,y=0,l)){if(y=this._getAvailableSpace(),e=this._computeVisibleItems(y,this.currentItemIndex,!0),v=this.totalItems-this.currentItemIndex,p=v<=Math.ceil(e),i&&Math.floor(e)==this.numVisibleItems&&this.numRemainingItems==v)return;for(this.numVisibleItems=Math.floor(e),this.numRemainingItems=v,this.isRendering=!0,w=p?v:Math.ceil(e),this._tnailFirstLoad===1&&(this._tnailLoadCount=w,this._tnailLoadFail=0,this._tnailFirstLoad=0),l.innerHTML="",s=0;s<w;s++)r=this.mediaItems[s+this.currentItemIndex],this._tnailLoadCount===0&&(r[t._ITEM_MEDIA_STRIP_THUMB_URL].indexOf("data:image")>=0?this._tnailType===t._TNAIL_TYPE_NOT_INITIALIZED?this._tnailType=t._TNAIL_TYPE_ALL_DATAURI:this._tnailType===t._TNAIL_TYPE_ALL_LINK&&(this._tnailType=t._TNAIL_TYPE_MIXED):this._tnailType===t._TNAIL_TYPE_NOT_INITIALIZED?this._tnailType=t._TNAIL_TYPE_ALL_LINK:this._tnailType===t._TNAIL_TYPE_ALL_DATAURI&&(this._tnailType=t._TNAIL_TYPE_MIXED)),h=_ce("div"),h.className="MediaItemContainer",h.setAttribute("index",s+this.currentItemIndex),u.sutraThumbnail&&h.setAttribute("sutra",u.sutraThumbnail),this._renderItem(r,h),l.appendChild(h),h=null,r.status==t._LOADING_STATE_NOT_LOADED&&r.imgLoader==null&&(r.imgLoaderDelegate=$CD(this,function(n){return function(){this._onThumbLoad(n)}}(s+this.currentItemIndex)),r.imgLoaderFailureDelegate=$CD(this,function(n){return function(){this._onThumbFailure(n)}}(s+this.currentItemIndex)),r.imgLoader=o.LiveViews.setupImageFetch(r.imgLoaderDelegate,r.imgLoaderFailureDelegate,null),r.imgLoader.src=r[t._ITEM_MEDIA_STRIP_THUMB_URL]),a+=this._getItemWidth(r)+4,a+=t._DISTANCE_BETWEEN_ITEMS;this._tnailLoadCount===0&&(b=window.$Config.BSI.BICI,this._tnailLoadFail?$Beacon.fire(b.beaconUrl,{"T.TNF":(new Date).getTime()-this._tts,"C.TNTYPE":this._tnailType}):$Beacon.fire(b.beaconUrl,{"T.TNS":(new Date).getTime()-this._tts,"C.TNTYPE":this._tnailType}),this._tnailLoadCount=-1),p&&this._hasMoreLink()&&(c=_ce("div"),$css.add(c,"MoreLinkContainer"),$css.add(c,"FloatLeft"),c.style.paddingTop=Math.floor(t._MAX_THUMB_HEIGHT/2)-5+"px",f=_ce("a"),u.sutraMore&&f.setAttribute("sutra",u.sutraMore),f.href=this.moreLinkUrl,f.target="_blank",n(f).text(this.moreLinkString),f.onclick=this._onClickMoreHandler,c.appendChild(f),l.appendChild(c),c=null,f=null),l.style.width=a+(this._hasMoreLink()?t._MAX_THUMB_WIDTH:0)+"px"}k=this.totalItems>0&&this.currentItemIndex>0,d=this.totalItems-this.currentItemIndex+(this._hasMoreLink()?1:0)>=Math.ceil(e)&&a>y,this._setNavControlEnabled("p",k),this._setNavControlEnabled("n",d),this.isRendering=!1,this.needsAnotherRender&&(this.needsAnotherRender=!1,this._renderItems())},f._renderItem=function(n,i){while(i.childNodes.length)i.removeChild(i.childNodes[0]);var r={continueProcessing:!0};if(this.behavior&&this.behavior._renderItem&&this.behavior._renderItem(n,i,this,r),r.continueProcessing){switch(n[t._ITEM_TYPE]){case t._ITEM_TYPE_PHOTO:case t._ITEM_TYPE_VIDEO:this._renderPhotoOrVideo(n,i)}this.behavior&&this.behavior._postRenderItem&&this.behavior._postRenderItem(n,i,this)}},f._renderPhotoOrVideo=function(n,i){var e=_ce("div"),r,f,h,s;$css.add(e,"MediaItem"),$css.add(e,"Photo"),r=_ce("div"),$css.add(r,"ThumbContainer"),r.onclick=$CD(this,function(n){return function(i){return this._onItemClick(n,t._CLICK_ITEM,i)}}(n.index)),f=_ce("img"),$css.add(f,"Thumb"),f.title=f.alt=this.behavior&&this.behavior._getPhotoAndVideoTooltip?this.behavior._getPhotoAndVideoTooltip(n):n[t._ITEM_NAME],n.status==t._LOADING_STATE_LOADED_SUCCESSFUL?(f.src=n[t._ITEM_MEDIA_STRIP_THUMB_URL],f.style.width=r.style.width=n.thumbWidth+"px",f.style.height=r.style.height=n.thumbHeight+"px",n.thumbWidth<t._MIN_THUMB_WIDTH||n.thumbHeight<t._MIN_THUMB_HEIGHT?(n.thumbWidth<t._MIN_THUMB_WIDTH&&(r.style.paddingLeft=Math.floor((t._MIN_THUMB_WIDTH-n.thumbWidth)/2)+"px",r.style.paddingRight=Math.ceil((t._MIN_THUMB_WIDTH-n.thumbWidth)/2)+"px"),n.thumbHeight<t._MIN_THUMB_HEIGHT&&(r.style.paddingTop=Math.floor((t._MIN_THUMB_HEIGHT-n.thumbHeight)/2)+"px",r.style.paddingBottom=Math.ceil((t._MIN_THUMB_HEIGHT-n.thumbHeight)/2)+"px"),i.style.marginTop=Math.floor((t._MAX_THUMB_HEIGHT-Math.max(n.thumbHeight,t._MIN_THUMB_HEIGHT))/2)+"px"):i.style.marginTop=Math.floor((t._MAX_THUMB_HEIGHT-n.thumbHeight)/2)+"px"):($css.add(e,n.status==t._LOADING_STATE_NOT_LOADED?"ThumbLoading":"ThumbFailed"),f.src=o.LiveViews.clearImgSrc,f.style.width=r.style.width=t._MAX_THUMB_WIDTH+"px",f.style.height=r.style.height=t._MAX_THUMB_HEIGHT+"px"),u.sutraImageTag&&n.status!=t._LOADING_STATE_NOT_LOADED&&f.setAttribute("sutra",u.sutraImageTag),e.appendChild(r),r.appendChild(f),n.status==t._LOADING_STATE_NOT_LOADED&&$f?(h=$f.createLoading(0,$f.loadingType.spinning,"20px","20px"),r.appendChild(h)):n.status==t._LOADING_STATE_LOADED_FAILED&&(s=_ce("div"),$css.add(s,"ErrorBox"),s.style.width=t._MAX_THUMB_WIDTH-2+"px",s.style.height=t._MAX_THUMB_HEIGHT-2+"px",r.appendChild(s)),i.appendChild(e),e=null,r=null,f=null},f._getAvailableSpace=function(){var n=0,t=_ge(this.elt.id+"_ms");return t&&(n=t.parentElement.offsetWidth),n},f._computeVisibleItems=function(n,i,r){for(var f=0,e=n,o=i,s,u;o!=(r?this.totalItems:0);){if(s=this.mediaItems[o],u=this._getItemWidth(s),u&&e<=u){f+=e/u;break}e-=u+t._DISTANCE_BETWEEN_ITEMS,f++,o+=r?1:-1}return f},f._getItemWidth=function(n){var i=0,r={continueProcessing:!0};if(this.behavior&&this.behavior._getItemWidth&&(i=this.behavior._getItemWidth(n,this,r)),r.continueProcessing)switch(n[t._ITEM_TYPE]){case t._ITEM_TYPE_PHOTO:case t._ITEM_TYPE_VIDEO:i=(n.status==t._LOADING_STATE_LOADED_SUCCESSFUL?n.thumbWidth<t._MIN_THUMB_WIDTH?t._MIN_THUMB_WIDTH:n.thumbWidth:t._MAX_THUMB_WIDTH)+t._PHOTO_ADDITIONAL_WIDTH}return i},f._adjustThumbnailDimensions=function(n){n.thumbDimensionsAdjusted||(n.thumbDimensionsAdjusted=!0,n.thumbHeight!=0&&n.thumbHeight!=0&&(n.thumbWidth>t._MAX_THUMB_WIDTH&&(n.thumbHeight=Math.floor(n.thumbHeight*(t._MAX_THUMB_WIDTH/n.thumbWidth)),n.thumbWidth=t._MAX_THUMB_WIDTH),n.thumbHeight>t._MAX_THUMB_HEIGHT&&(n.thumbWidth=Math.floor(n.thumbWidth*(t._MAX_THUMB_HEIGHT/n.thumbHeight)),n.thumbHeight=t._MAX_THUMB_HEIGHT)))},f._onThumbLoad=function(n){this._onThumbLoadImpl(n,!0)},f._onThumbFailure=function(n){this._onThumbLoadImpl(n,!1)},f._onThumbLoadImpl=function(n,i){var r=this.mediaItems[n],f,u,e,o;if(this.elt&&r&&r.imgLoader)if(this._tnailLoadCount--,!i&&this._tnailLoadFail&&(this._tnailLoadFail=1),r.status=i?t._LOADING_STATE_LOADED_SUCCESSFUL:t._LOADING_STATE_LOADED_FAILED,r.thumbWidth=r.imgLoader.width,r.thumbHeight=r.imgLoader.height,this._adjustThumbnailDimensions(r),r.imgLoader=null,n>=this.currentItemIndex&&n<this.currentItemIndex+this.numVisibleItems+1){if(f=n-this.currentItemIndex,u=_ge(this.elt.id+"_ms"),u&&f<u.children.length)for(e=0;e<u.children.length;e++)if(o=u.children[f],o.getAttribute("index")==n){r.imgLoaderDelegate=null,r.imgLoaderFailureDelegate=null,this._renderItems(!1);return}r.imgLoaderDelegateCount++<t._MAX_TRIES?setTimeout(i?r.imgLoaderDelegate:r.imgLoaderFailureDelegate,t._IMG_LOADER_TIMEOUT):r.status=t._LOADING_STATE_LOADED_FAILED}else r.imgLoaderDelegate=null,r.imgLoaderFailureDelegate=null},f._setNavControlEnabled=function(n,t){t?$css.remove(this._getNavButton(n),"Disabled"):$css.add(this._getNavButton(n),"Disabled")},f._getNavButton=function(n){return _ge(this.elt.id+"_"+n+"b")},f._onNavMouseOver=function(n){$css.add(this._getNavButton(n),"Hover")},f._onNavMouseOut=function(n){var t=this._getNavButton(n);$css.remove(t,"Hover"),$css.remove(t,"Down")},f._onNavMouseDown=function(n){$css.add(this._getNavButton(n),"Down")},f._onNavMouseUp=function(n){$css.remove(this._getNavButton(n),"Down")},f._onClickPrevious=function(){if(this.reporter._reportClick("Internal",this.elt),this.currentItemIndex!=0){var t=this._getAvailableSpace(),n=Math.floor(this._computeVisibleItems(t,this.currentItemIndex,!1));this.currentItemIndex-=n?n:1,this.currentItemIndex<0&&(this.currentItemIndex=0),this._renderItems()}},f._onClickNext=function(){(this.reporter._reportClick("Internal",this.elt),this.currentItemIndex>=this.totalItems-this.numVisibleItems+(this._hasMoreLink()?1:0))||(this.currentItemIndex+=this.numVisibleItems?this.numVisibleItems:1,this.currentItemIndex>=this.totalItems+(this._hasMoreLink()?1:0)&&(this.currentItemIndex=this.totalItems-1),this._renderItems())},f.onResize=function(){this._renderItems(!0),SilverlightSlideshow.resize()},f._onItemMouseOver=function(n){for(var i=n||event,t=i.srcElement;t&&!$css.has(t,"MediaItem");)t=t.parentElement;for(t&&!$css.has(t,"NoHover")&&($css.add(t,"Hover"),$css.add(t,"t_brci")),t=i.srcElement;t&&!$css.has(t,"Overlay");)t=t.parentElement;t&&!$css.has(t,"NoHover")&&$css.add(t,"Hover")},f._onItemMouseOut=function(n){for(var i=n||event,t=i.srcElement;t&&!$css.has(t,"MediaItem");)t=t.parentElement;for(t&&!$css.has(t,"NoHover")&&($css.remove(t,"Hover"),$css.remove(t,"t_brci")),t=i.srcElement;t&&!$css.has(t,"Overlay");)t=t.parentElement;t&&!$css.has(t,"NoHover")&&$css.remove(t,"Hover")},f._onItemClick=function(n,i,r){var e=r||event,u=this.mediaItems[n],f={continueProcessing:!1};return(this.behavior&&this.behavior._onItemClick&&this.behavior._onItemClick(n,i,u,this,f,e),!f.continueProcessing)?!1:(i==t._CLICK_ITEM&&(u[t._ITEM_TYPE]==t._ITEM_TYPE_PHOTO||u[t._ITEM_TYPE]==t._ITEM_TYPE_VIDEO)&&(this.reporter._reportClick("Internal",this.elt),this._launchSilverlightSlideshow(i,n)),!1)},f._onLinkClick=function(n,i){var f="Internal",r,u;n==t._CLICK_SLIDESHOW?c&&a?l?this._launchSilverlightSlideshow(n):SilverlightUpsell.showUpsellDialog(HM.ContentId.SlideshowSilverlightUpsell):(r=_ge(this.elt.id+"_linkContainer"),r&&(u=_ge(this.elt.id+"_viewSlideshowLink"),u&&r.removeChild(u.parentElement))):n==t._CLICK_DOWNLOAD_ALL?e.Cmd("clickattachment").bubble(this.elt,{event:i.originalEvent}):(n==t._CLICK_MORE||n==t._CLICK_GO_TO)&&(f="External"),this.reporter._reportClick(f,this.elt)},f.onHmlvSelect=function(){this.updateLayout()},f.updateLayout=function(){this._renderItems()},f._launchSilverlightSlideshow=function(n,i){var s,o,h,c,l,a,y,r;if(this.viewSlideshowLinkShown){if(this.slideshowAssetList==null&&this.mediaItems!=null){var p=[],f=null,v=0;for(s=0;s<this.mediaItems.length;s++)o=this.mediaItems[s],(o[t._ITEM_TYPE]==t._ITEM_TYPE_PHOTO||o[t._ITEM_TYPE]==t._ITEM_TYPE_VIDEO)&&(this.mediaItemIndexToSlideshowAssetIndexMap[s]=v,f={},f.Index=v,f.Name=o[t._ITEM_NAME],f.DataItemType=o[t._ITEM_TYPE]==t._ITEM_TYPE_PHOTO?SilverlightSlideshow._DATAITEM_PHOTO:SilverlightSlideshow._DATAITEM_VIDEO,f.Large={},f.Large.Url=o[t._ITEM_SLIDESHOW_MAIN_ASSET_URL],h=o[t._ITEM_SLIDESHOW_MAIN_ASSET_WIDTH],c=o[t._ITEM_SLIDESHOW_MAIN_ASSET_HEIGHT],h!=undefined&&h!=null&&h!=""&&(f.Large.Width=h),c!=undefined&&c!=null&&c!=""&&(f.Large.Height=c),f.Thumb={},f.Thumb.Url=o[t._ITEM_SLIDESHOW_THUMB_URL],l=o[t._ITEM_SLIDESHOW_THUMB_WIDTH],a=o[t._ITEM_SLIDESHOW_THUMB_HEIGHT],l!=undefined&&l!=null&&l!=""&&(f.Thumb.Width=l),a!=undefined&&a!=null&&a!=""&&(f.Thumb.Height=a),this.behavior&&this.behavior._getAdditionalSlideshowAssetParams&&this.behavior._getAdditionalSlideshowAssetParams(o,f,this),p[v]=f,v++);this.slideshowAssetList=Object.toJSON(p)}y=null,y=n==t._CLICK_SLIDESHOW?0:this.mediaItemIndexToSlideshowAssetIndexMap[i],r={},r.XapFileUrl=e.config.appSettings.SLSlideshowXapFileUrl,r.BackgroundColor="black",r.MinSilverlightVersion="4.0",r.MaxFrameRate=24,r.EnableHtmlAccess="true",r.EnableAutoZoom="true",r.ShowSocialFeatures="false",r.IsBiDi=!e.config.Ltr,r.Target="_blank",r.AppLogoInfo={},r.AppLogoInfo.ShowLogo=!0,r.AppLogoInfo.Text=u.brandingInfoText,r.AppLogoInfo.Link=u.brandingInfoLink,r.AppLogoInfo.ToolTip=u.brandingInfoToolTip,this.behavior&&this.behavior._getAdditionalSlideshowParams&&this.behavior._getAdditionalSlideshowParams(r,this),SilverlightSlideshow.launchSlideshow(this.slideshowAssetList,y,r),this.behavior&&this.behavior._reportSlideshowClick&&this.behavior._reportSlideshowClick(n)}},t.AttachmentBehavior={},r=t.AttachmentBehavior,r._ACTIVE_X_AUDIO_POPOVER_HEIGHT=75,r._HTML_5_AUDIO_POPOVER_HEIGHT=50,r._ACTIVE_X_AUDIO_POPOVER_WIDTH=300,r._HTML_5_AUDIO_POPOVER_WIDTH=400,r._FILE_ITEM_WIDTH=120,r._FILE_ITEM_HEIGHT=160,r._getItemWidth=function(n,i,u){switch(n[t._ITEM_TYPE]){case t._ITEM_TYPE_AUDIO:case t._ITEM_TYPE_OFFICEDOC:case t._ITEM_TYPE_GENERICFILE:return u.continueProcessing=!1,r._FILE_ITEM_WIDTH}},r._renderItem=function(n,i,r){switch(n[t._ITEM_TYPE]){case t._ITEM_TYPE_AUDIO:case t._ITEM_TYPE_OFFICEDOC:case t._ITEM_TYPE_GENERICFILE:t.AttachmentBehavior._renderFile(n,i,r)}},r._renderFile=function(n,f,e){var y=n[t._ITEM_ATTACHMENT_STATE]==t._ATTACHMENT_STATE_BLOCKED,v=y||n[t._ITEM_ATTACHMENT_STATE]==t._ATTACHMENT_STATE_BROWSER_DISPLAY_DISALLOWED,c=_ce("div"),s,h,l,p,a;$css.add(c,"MediaItem"),$css.add(c,"File"),v&&$css.add(c,"NoHover"),s=_ce("div"),$css.add(s,"ThumbContainer"),h=_ce("img"),$css.add(h,"Thumb"),n.status==t._LOADING_STATE_LOADED_SUCCESSFUL?h.src=n[t._ITEM_MEDIA_STRIP_THUMB_URL]:(h.src=o.LiveViews.clearImgSrc,$css.add(c,n.status==t._LOADING_STATE_NOT_LOADED?"ThumbLoading":"ThumbFailed")),s.style.height=r._FILE_ITEM_HEIGHT+"px",s.style.width=r._FILE_ITEM_WIDTH+"px",s.style.backgroundColor=n[t._ITEM_ATTACHMENT_THUMB_COLOR],h.style.paddingTop=Math.floor((r._FILE_ITEM_HEIGHT-e.nonPhotoThumbHeight)/2)+"px",u.sutraFileIcon&&h.setAttribute("sutra",u.sutraFileIcon),l=i.createFileNameDiv(n[t._ITEM_NAME]),v?l.title=h.title=h.alt=r._getFileIconTooltip(n,v,y):(l.title=h.title=h.alt=s.title=r._getDownloadLinkTooltip(n),l.onclick=s.onclick=$CD(e,function(n){return function(i){return this._onItemClick(n,t._CLICK_DOWNLOAD_ITEM,i)}}(n.index)),u.sutraDownloadLink&&s.setAttribute("sutra",u.sutraDownloadLink)),s.appendChild(h),n.status==t._LOADING_STATE_NOT_LOADED&&$f?(p=$f.createLoading(0,$f.loadingType.spinning,"20px","20px"),s.appendChild(p)):n.status==t._LOADING_STATE_LOADED_FAILED&&(a=_ce("div"),$css.add(a,"ErrorBox"),a.style.width=r._FILE_ITEM_WIDTH-2+"px",a.style.height=r._FILE_ITEM_HEIGHT-2+"px",s.appendChild(a)),c.appendChild(s),c.appendChild(l),f.appendChild(c),c=null,s=null,h=null},r._getDownloadSizeString=function(n){return n[t._ITEM_ATTACHMENT_DOWNLOAD_SIZE]?u.downloadSizeTemplate.format(n[t._ITEM_ATTACHMENT_DOWNLOAD_SIZE]):""},r._getPhotoAndVideoTooltip=function(n){return n[t._ITEM_NAME]?v?u.photoAndVideoTooltip.format(n[t._ITEM_NAME]):this._getDownloadLinkTooltip(n):""},r._getFilenameTooltip=function(n){if(n[t._ITEM_NAME]){var i=n[t._ITEM_TYPE]==t._ITEM_TYPE_OFFICEDOC;return i?u.officeDocTooltip.format(n[t._ITEM_NAME]):this._getDownloadLinkTooltip(n)}return""},r._getFileIconTooltip=function(n,i,r){var f=n[t._ITEM_TYPE]==t._ITEM_TYPE_OFFICEDOC;return r?u.blockedAttachmentTooltip:i?u.nonDownloadableAttachmentTooltip:this._getDownloadLinkTooltip(n)},r._getDownloadLinkTooltip=function(n){return n[t._ITEM_NAME]?u.downloadLinkTooltip.format(n[t._ITEM_NAME])+" "+r.rtlMark+r._getDownloadSizeString(n):""},r._canPlayAudio=function(t){var r=$B.IE,u,f;return!r&&t[i._ITEM_ATTACHMENT_AUDIO_TYPE]&&(u=n("<audio><\/audio>")[0],f=u.canPlayType&&u.canPlayType(t[i._ITEM_ATTACHMENT_AUDIO_TYPE]),r=f==="maybe"||f==="probably"),r},r._getAudioPlayerWidth=function(){return!$B.IE||$B.V>8?r._HTML_5_AUDIO_POPOVER_WIDTH:r._ACTIVE_X_AUDIO_POPOVER_WIDTH},r._getAudioPlayerHeight=function(){return!$B.IE||$B.V>8?r._HTML_5_AUDIO_POPOVER_HEIGHT:r._ACTIVE_X_AUDIO_POPOVER_HEIGHT},r._postRenderItem=function(i,f,e){var l=f.childNodes[0],s,a,h,c;if(l){l.style.position="relative";var v=i[t._ITEM_ATTACHMENT_STATE]==t._ATTACHMENT_STATE_BLOCKED,y=v||i[t._ITEM_ATTACHMENT_STATE]==t._ATTACHMENT_STATE_BROWSER_DISPLAY_DISALLOWED,o=_ce("div");o.className="Overlay",s=_ce("span"),$css.add(s,"FloatRight TextSizeSmall"),o.appendChild(s),a=i[t._ITEM_TYPE],a==t._ITEM_TYPE_OFFICEDOC?(o.title=u.officeDocTooltip.format(i[t._ITEM_NAME]),o.onclick=$CD(e,function(n){return function(i){return this._onItemClick(n,t._CLICK_VIEW_DOC,i)}}(i.index)),u.sutraViewOnlineLink&&o.setAttribute("sutra",u.sutraViewOnlineLink),n(s).text(u.officeDocLinkText)):a==t._ITEM_TYPE_AUDIO&&r._canPlayAudio(i)?(o.title=u.audioFileTooltip.format(i[t._ITEM_NAME]),o.onclick=$CD(e,function(n){return function(i){return this._onItemClick(n,t._CLICK_PLAY_AUDIO,i)}}(i.index)),u.sutraPlayAudioLink&&o.setAttribute("sutra",u.sutraPlayAudioLink),n(s).text(u.audioFileLinkText)):y?(o.title=i[t._ITEM_NAME],n(s).text(u.blockedAttachmentLinkText)):(o.title=r._getDownloadLinkTooltip(i),o.onclick=$CD(e,function(n){return function(i){return this._onItemClick(n,t._CLICK_DOWNLOAD_ITEM,i)}}(i.index)),u.sutraDownloadLink&&o.setAttribute("sutra",u.sutraDownloadLink),n(s).text(u.downloadLinkText),h=_ce("a"),h.href="#",$css.add(h,"FloatRight"),c=_ce("img"),c.src=u.downloadImgSrc,h.appendChild(c),o.appendChild(h),c=null,h=null),l.appendChild(o),o=null,s=null}},r._onItemClick=function(i,u,f,o,s,h){var a=h||event,c,y,p,b,w,l;if(s.continueProcessing=!0,u==t._CLICK_ITEM&&(f[t._ITEM_TYPE]==t._ITEM_TYPE_PHOTO||f[t._ITEM_TYPE]==t._ITEM_TYPE_VIDEO)){if(!v){o.reporter._reportClick("Internal",o.elt),c=a.srcElement,y=f[t._ITEM_ATTACHMENT_STATE]==t._ATTACHMENT_STATE_BROWSER_DISPLAY_ALLOWED,c.setAttribute("aIdx",f[t._ITEM_ATTACHMENT_INDEX]),c.setAttribute("aDepth",f[t._ITEM_ATTACHMENT_DEPTH]),c.setAttribute("aBlob",f[t._ITEM_ATTACHMENT_BLOB]),c.setAttribute("entryPt",t._CLICK_THUMBNAIL),y&&c.setAttribute("aNewWin",""),e.Cmd("clickattachment").bubble(o.elt,{event:a}),s.continueProcessing=!1;return}}else if(f[t._ITEM_TYPE]==t._ITEM_TYPE_AUDIO&&u==t._CLICK_PLAY_AUDIO&&r._canPlayAudio(f)){o.reporter._reportClick("Internal",o.elt),p=_ce("div"),b=null,b=e.Attachments.GetDownloadUrlFromParams(o.messageId,-1,f[t._ITEM_ATTACHMENT_INDEX],f[t._ITEM_ATTACHMENT_DEPTH],f[t._ITEM_ATTACHMENT_BLOB],u),w=new WMP.WMPlayer(p,b,null),l=new WebDialog(r._getAudioPlayerHeight(f),r._getAudioPlayerWidth(f),null,!0,!0,!1,null),l.setHeaderTitle(f[t._ITEM_NAME]),l.setContext(w),l.setCallback(r._onCloseAudioPlayer),l.setContents(p),l.setImgPath(e.config.appSettings.gAlertsImagePath),l.addCloseBox(e.GetString("DhtmlAlerts.CloseBox.AltText")),l.addCloseOnEscapeKey();n(w).on("error",function(n,t){WebDialogManager.getInstance().hideVisibleDialog(),r._audioPlayerError(w,t)});gShowDialog(l),p=null,s.continueProcessing=!1;return}if(u==t._CLICK_DOWNLOAD_ITEM||u==t._CLICK_THUMBNAIL||u==t._CLICK_VIEW_DOC){o.reporter._reportClick("Internal",o.elt);var c=a.srcElement,y=f[t._ITEM_ATTACHMENT_STATE]==t._ATTACHMENT_STATE_BROWSER_DISPLAY_ALLOWED,k=f[t._ITEM_TYPE]==t._ITEM_TYPE_OFFICEDOC;c.setAttribute("aIdx",f[t._ITEM_ATTACHMENT_INDEX]),c.setAttribute("aDepth",f[t._ITEM_ATTACHMENT_DEPTH]),c.setAttribute("aBlob",f[t._ITEM_ATTACHMENT_BLOB]),c.setAttribute("entryPt",u),y&&c.setAttribute("aNewWin",""),k&&u==t._CLICK_VIEW_DOC&&c.setAttribute("wacScenario","View"),e.Cmd("clickattachment").bubble(o.elt,{event:a}),s.continueProcessing=!1}},r._onCloseAudioPlayer=function(n){return n&&n.dispose(),!0},r._audioPlayerError=function(n,t){return r._onCloseAudioPlayer(n),wLive.Controls.Notifications.createModalDialog({title:"Audio Player Error",content:t,buttons:{action:"Close"}}).show(),!0},r._getAdditionalSlideshowParams=function(n){n.CobrandInfo={},n.CobrandInfo.ShowLogo=!1,n.CobrandInfo.LogoUrl="",n.CobrandInfo.Link="",n.CobrandInfo.ToolTip="",n.GoToInfo={},n.GoToInfo.ShowText=!0,n.GoToInfo.Text=u.downloadLinkText,n.GoToInfo.ToolTip=""},r._getAdditionalSlideshowAssetParams=function(n,i,r){i.SelfLink=e.Attachments.GetDownloadUrlFromParams(r.messageId,-1,n[t._ITEM_ATTACHMENT_INDEX],n[t._ITEM_ATTACHMENT_DEPTH],n[t._ITEM_ATTACHMENT_BLOB],t._CLICK_FILENAME,!0)},r._reportSlideshowClick=function(n){$BSI.reportEvent("slideshow.click",{permissions:"private",dataSource:"Hotmail",viewMethod:"attachment",ssEntry:n==t._CLICK_SLIDESHOW?"link":"thumbnail"})},t.PhotoGalleryBehavior={},h=t.PhotoGalleryBehavior,h._onItemClick=function(n,i,r,u,f,e){var s=e||event,o;f.continueProcessing=!0,i==t._CLICK_ITEM&&(v&&r[t._ITEM_TYPE]!=t._ITEM_TYPE_VIDEO||(u.reporter._reportClick("External",u.elt),o=_ge(u.elt.id+"_goToLink"),window.open(o.href),f.continueProcessing=!1))},h._getAdditionalSlideshowParams=function(n,t){var u=_ge(t.elt.id+"_cobrandLogo"),i=t.elt.getAttribute("cobrandLogo"),r=_ge(t.elt.id+"_goToLink");r&&u&&(n.CobrandInfo={},n.CobrandInfo.ShowLogo=!0,n.CobrandInfo.LogoUrl=i&&i!=""?i:u.src,n.CobrandInfo.Link=r.href,n.CobrandInfo.ToolTip=r.innerText)},h._reportSlideshowClick=function(n){$BSI.reportEvent("slideshow.click",{permissions:"public",dataSource:"Hotmail",viewMethod:"3rdparty",ssEntry:n==t._CLICK_SLIDESHOW?"link":"thumbnail"})}})(window.originaljQuery||window.jQuery),SilverlightSlideshow={},SilverlightSlideshow._MAX_WIDTH=1600,SilverlightSlideshow._MAX_HEIGHT=1200,SilverlightSlideshow._MIN_WIDTH=640,SilverlightSlideshow._MIN_HEIGHT=480,SilverlightSlideshow._BROWSER_PADDING=75,SilverlightSlideshow._DATAITEM_PHOTO=0,SilverlightSlideshow._DATAITEM_VIDEO=1,SilverlightSlideshow.initialize=function(){SilverlightSlideshow._dialog=null,SilverlightSlideshow._dialogWidth=null,SilverlightSlideshow._dialogHeight=null,SilverlightSlideshow._assetList=null,SilverlightSlideshow._startIndex=null,SilverlightSlideshow._params=null},SilverlightSlideshow.launchSlideshow=function(n,t,i){var u,r;SilverlightSlideshow._assetList=n,SilverlightSlideshow._startIndex=t,SilverlightSlideshow._params=i,SilverlightSlideshow._params.CloseButtonInvokeMethod="_silverlightSlideshowCloseCallback",u=SilverlightSlideshow._getPopupContent(),SilverlightSlideshow._dialog=new WebDialog(null,null,null,!0,!1,!1,"Slideshow"),SilverlightSlideshow._computeSlideshowDimensions(),SilverlightSlideshow._dialog.setCallback(_silverlightSlideshowCloseCallback),SilverlightSlideshow._dialog.setDimensions(SilverlightSlideshow._dialogWidth,SilverlightSlideshow._dialogHeight),SilverlightSlideshow._dialog.setContents(u),SilverlightSlideshow._dialog.setImgPath(ol.config.appSettings.gAlertsImagePath),SilverlightSlideshow._dialog.addCloseOnEscapeKey(),r=window.$WLXIM,r&&r.CW&&r.CW.minimize&&r.CW.minimize(),$css.add(_ge("RadAd_Skyscraper"),"DisplayNone"),gShowDialog(SilverlightSlideshow._dialog)},SilverlightSlideshow.resize=function(){SilverlightSlideshow._dialog!=null&&SilverlightSlideshow._computeSlideshowDimensions()&&(SilverlightSlideshow._dialog.setDimensions(SilverlightSlideshow._dialogWidth,SilverlightSlideshow._dialogHeight),SilverlightSlideshow._dialog.centerModal())},SilverlightSlideshow._computeSlideshowDimensions=function(){var i=!1,r,t,n;if(SilverlightSlideshow._dialog!=null)return r=SilverlightSlideshow._MAX_WIDTH/SilverlightSlideshow._MAX_HEIGHT,t=WebUtilities.getViewportWidth()-2*SilverlightSlideshow._BROWSER_PADDING,t>SilverlightSlideshow._MAX_WIDTH&&(t=SilverlightSlideshow._MAX_WIDTH),n=Math.floor(t/r),n>WebUtilities.getViewportHeight()-2*SilverlightSlideshow._BROWSER_PADDING&&(n=WebUtilities.getViewportHeight()-2*SilverlightSlideshow._BROWSER_PADDING),n<SilverlightSlideshow._MIN_HEIGHT&&(n=SilverlightSlideshow._MIN_HEIGHT),t=Math.floor(n*r),SilverlightSlideshow._dialogWidth==null&&SilverlightSlideshow._dialogHeight==null?i=!0:SilverlightSlideshow._dialogWidth!=null&&SilverlightSlideshow._dialogHeight!=null&&(SilverlightSlideshow._dialogWidth!=t||SilverlightSlideshow._dialogHeight!=n)&&(i=!0),i&&(SilverlightSlideshow._dialogWidth=t,SilverlightSlideshow._dialogHeight=n),i},SilverlightSlideshow._closeSlideshow=function(){$css.remove(_ge("RadAd_Skyscraper"),"DisplayNone"),SilverlightSlideshow._dialog.minimize(),SilverlightSlideshow._dialog.hide(),SilverlightSlideshow._dialog=null},SilverlightSlideshow._getPopupContent=function(){var n="<div class='SlideshowParentContainer'>            <div class='SlideshowContainer'>                <object id='sl_slideshow' data='data:application/x-silverlight,' type='application/x-silverlight-2' width='100%' height='100%'>                    <param name='onLoad' value='_silverlightSlideshowOnLoadCallback'/>                    <param name='source' value='"+SilverlightSlideshow._params.XapFileUrl+"'/>                    <param name='background' value='"+SilverlightSlideshow._params.BackgroundColor+"'/>                    <param name='minRuntimeVersion' value='"+SilverlightSlideshow._params.MinSilverlightVersion+"'/>                    <param name='maxFrameRate' value='"+SilverlightSlideshow._params.MaxFrameRate+"'/>                    <param name='enableHtmlAccess' value='"+SilverlightSlideshow._params.EnableHtmlAccess+"'/>                    <param name='enableautozoom' value='"+SilverlightSlideshow._params.EnableAutoZoom+"'/>                    <param name='initParams' value='isskydrive="+SilverlightSlideshow._params.ShowSocialFeatures+", closebuttoninvokemethod="+SilverlightSlideshow._params.CloseButtonInvokeMethod+",";return SilverlightSlideshow._params.AppLogoInfo!=null&&(n+="showapplogo="+SilverlightSlideshow._params.AppLogoInfo.ShowLogo+",applogourl="+SilverlightSlideshow._params.AppLogoInfo.LogoUrl+",applogolink="+SilverlightSlideshow._params.AppLogoInfo.Link+",applogotext="+SilverlightSlideshow._params.AppLogoInfo.Text+",applogotooltip="+SilverlightSlideshow._params.AppLogoInfo.ToolTip+","),SilverlightSlideshow._params.CobrandInfo!=null&&(n+="showcobrand="+SilverlightSlideshow._params.CobrandInfo.ShowLogo+",cobrandlogourl="+SilverlightSlideshow._params.CobrandInfo.LogoUrl+",cobrandlink="+SilverlightSlideshow._params.CobrandInfo.Link+",cobrandlogotooltip="+SilverlightSlideshow._params.CobrandInfo.ToolTip+","),SilverlightSlideshow._params.GoToInfo!=null&&(n+="showgoto="+SilverlightSlideshow._params.GoToInfo.ShowText+",gototext="+SilverlightSlideshow._params.GoToInfo.Text+",gototooltip="+SilverlightSlideshow._params.GoToInfo.ToolTip+",",SilverlightSlideshow._params.GoToInfo.Link!=null&&(n+="gotolink="+SilverlightSlideshow._params.GoToInfo.Link+",")),n+("isrtl="+SilverlightSlideshow._params.IsBiDi+",target="+SilverlightSlideshow._params.Target+",'/> <\/object> <\/div> <\/div>")},SilverlightSlideshow.initialize(),SilverlightUpsell={},_hasOlderSLVersionInstalled=Silverlight.isInstalled(),SilverlightUpsell.initialize=function(){SilverlightUpsell._dialog=null,SilverlightUpsell._contentId=null},SilverlightUpsell.showUpsellDialog=function(n){SilverlightUpsell._contentId=n;var t=function(){var t=DemandLoadHandler.getContent(n);t&&(SilverlightUpsell._dialog=new WebDialog(null,t.dialogWidth,null,!0,!1,!1),SilverlightUpsell._dialog.setContents(t.dialogContent),SilverlightUpsell._dialog.setImgPath(ol.config.appSettings.gAlertsImagePath),SilverlightUpsell._dialog.addCloseBox(ol.GetString("DhtmlAlerts.CloseBox.AltText")),SilverlightUpsell._dialog.setCallback(SilverlightUpsell._upsellCallback),SilverlightUpsell._dialog.addCloseOnEscapeKey(),gShowDialog(SilverlightUpsell._dialog))};DemandLoadHandler.demandLoadContent([n],[t])},SilverlightUpsell.onInstallSilverlightClick=function(){var n,t;SilverlightUpsell._reportClick("accepted"),n=DemandLoadHandler.getContent(SilverlightUpsell._contentId),n&&(t=wLive.Controls.Notifications,t.createTopBar({content:n.notificationText,dismissalMode:t.BarDismissalMode.Explicit,buttons:{close:n.notificationButtonText}}).show(),window.open(n.installLink),SilverlightUpsell._dialog.hide())},SilverlightUpsell._upsellCallback=function(){SilverlightUpsell._reportClick("cancel"),SilverlightUpsell._dialog.hide()},SilverlightUpsell._reportClick=function(n){var t=null;SilverlightUpsell._contentId==HM.ContentId.SlideshowSilverlightUpsell?t="slideshow":SilverlightUpsell._contentId==HM.ContentId.PhotosSilverlightUpsell?t="photo":SilverlightUpsell._contentId==HM.ContentId.DocsSilverlightUpsell?t="doc":SilverlightUpsell._contentId==HM.ContentId.VideoPlaybackSilverlightUpsell&&(t="videoplayback"),$BSI.reportEvent("rv.photoup",{upsellType:"Silverlight",upsellEntryPoint:t,endState:n})},SilverlightUpsell.initialize(),function(n){var t=window.WMP=window.WMP||{};t.WMPlayer=function(i,r,u){var f=this,h=ol.config.LiveViewsConfig.Providers.Hotmail.typeHandlers.Attachment.WMP,o,s,e;if(t.WMPlayer.m_strings||(t.WMPlayer.m_strings=h),t.WMPlayer.m_pollingInt||(t.WMPlayer.m_pollingInt=Number(h.wmplayer_pollingInt),isNaN(t.WMPlayer.m_pollingInt)&&(t.WMPlayer.m_pollingInt=100)),!$B.IE||$B.V>8)f.m_$audioControl=n("<audio controls='controls' autoplay='autoplay'><\/audio>");else{for(o=!1,s=["WMPlayer.OCX.7","WMPlayer.OCX"],e=0;e<s.length;e++)try{if(window.ActiveXObject){f.m_player=new ActiveXObject(s[e]),o=!0;break}else if(window.GeckoActiveXObject){f.m_player=new GeckoActiveXObject(s[e]),o=!0;break}}catch(c){}if(!o&&(f.m_player=null,window.ActiveXObject||window.GeckoActiveXObject)){i&&!$B.Firefox&&(f.m_$playerElem=n("<div class='media-player'><p class='label-name'><a href='"+decodeURIComponent(t.WMPlayer.m_strings.wmplayer_errorWMPInstallUrl)+"'>"+decodeURIComponent(t.WMPlayer.m_strings.wmplayer_errorWMPNotInstalled)+"<\/a><\/p><\/div>"),n("a",f.m_$playerElem).click(function(n){return $BSI.navigateTo(n.target.href,"_blank"),!1}),n(i).appendChild(f.m_$playerElem));return}f.m_player&&(f.m_player.uiMode="invisible",f.m_player.settings.enableErrorDialogs=!1,u&&u.length>0?(f.m_mediaLabel=u,f.m_showLabel=!0):(f.m_mediaLabel="",f.m_showLabel=!1))}i&&(f.m_$playerElem=n("<div class='media-player'><\/div>"),n(i).append(f.m_$playerElem),r&&(n(f.m_$playerElem).append("<p class='label-name'>"+decodeURIComponent(t.WMPlayer.m_strings.wmplayer_loading)+(f.m_mediaLabel?": "+f.m_mediaLabel:"")+"...<\/p>"),t.WMPlayer.resolveUrl(f,r)))},t.WMPlayer.prototype.dispose=function(){this.m_updateMethod&&(this.m_updateMethod=null),this.m_player&&(this.stop(),this.m_player.close(),this.m_player=null),this.m_$playerElem?(this.m_$playerElem.remove(),this.m_$playerElem=null):this.m_$audioControl&&(this.m_$audioControl.remove(),this.m_$audioControl=null)},t.WMPlayer.m_tabIndex=1e3,t.WMPlayer.attachHandler=function(n,t,i){n.addEventListener?n.addEventListener(t.toLowerCase(),i,!0):n.attachEvent&&n.attachEvent("on"+t.toLowerCase(),i)},t.WMPlayer.detachHandler=function(n,t,i){n.removeEventListener?n.removeEventListener(t.toLowerCase(),i,!0):n.detachEvent&&n.detachEvent("on"+t.toLowerCase(),i)},t.WMPlayer.getXMLHttpRequest=function(){var t,n;if(!window.XMLHttpRequest){for(t=["Msxml2.XMLHTTP","Microsoft.XMLHTTP"],n=0;n<t.length;n++)try{return new ActiveXObject(t[n])}catch(i){}return null}return new XMLHttpRequest},t.WMPlayer.resolveUrl=function(n,i){function u(){if(r&&4==r.readyState){if(n){var t=r.getResponseHeader("Content-Location");t||(t=r.getResponseHeader("Location")),n.openUrl(t?t:i)}r=null}}var r=t.WMPlayer.getXMLHttpRequest();if(r)try{r.onreadystatechange=u,r.open("HEAD",i,!0),r.send(null)}catch(f){r=null,n.openUrl(i)}else n.openUrl(i)},t.WMPlayer.prototype.openUrl=function(n){var t,i;if(this.m_url=n,this.m_$audioControl){t=this;this.m_$audioControl.on("canplay",function(){t.buildUI()});this.m_$audioControl.on("error",function(){t.reportErrors()});this.m_$audioControl.prop("src",n)}else this.m_player&&(t=this,i=window.setInterval(function(){t.m_player?t.m_player.openState==13?(window.clearInterval(i),t.stop(),t.m_player.settings.mute=!1,t.buildUI(),t=null):t.reportErrors():window.clearInterval(i)},200),this.m_player.settings.invokeURLs=!1,this.m_player.settings.autoStart=!0,this.m_player.settings.mute=!0,this.m_player.URL=this.m_url)},t.WMPlayer.prototype.buildUI=function(){var l,a,e,p,w,v,u,c,s,n,i,r,o,b,k,y,f,h;if(this.m_$playerElem)if(this.m_$playerElem.empty(),this.m_$audioControl)this.m_$playerElem.append(this.m_$audioControl);else{if(!this.m_player)return;l=this.m_$playerElem[0],a=document.createElement("p"),a.className="label-name",this.m_showLabel||(a.style.visibility="hidden"),a.appendChild(document.createTextNode(this.m_mediaLabel)),l.appendChild(a),e=document.createElement("div"),e.className="seek-area",e.onmousedown=t.WMPlayer.createHandler(this,"seek_onDragStart"),p=document.createElement("div"),p.className="seek-left",e.appendChild(p),w=document.createElement("div"),w.className="seek-right",e.appendChild(w),v=document.createElement("div"),v.className="seek-fill",v.onUpdateState=t.WMPlayer.seekFill_onUpdateState(this),e.appendChild(v),u=document.createElement("a"),u.className="seek-thumb",u.href="#seek",u.title=decodeURIComponent(t.WMPlayer.m_strings.wmplayer_seek),u.hideFocus=!0,u.tabIndex=t.WMPlayer.m_tabIndex*10+1,u.onkeydown=t.WMPlayer.createHandler(this,"seek_onKeyDown"),u.onmousedown=t.WMPlayer.createHandler(this,"seek_onDragStart"),u.appendChild(document.createTextNode(" ")),e.appendChild(u),l.appendChild(e),c=document.createElement("div"),c.className="label-time",c.onUpdateState=t.WMPlayer.timeLabel_onUpdateState(this),c.appendChild(document.createTextNode(" ")),l.appendChild(c),s=document.createElement("div"),s.className="controls-area",l.appendChild(s),n=document.createElement("a"),n.className="button-play",n.href="#play",n.title="",n.hideFocus=!0,n.tabIndex=t.WMPlayer.m_tabIndex*10+2,n.onclick=t.WMPlayer.createHandler(this,"play"),n.onmousedown=t.WMPlayer.button_onPressChanged(this,!0),n.onmouseup=t.WMPlayer.button_onPressChanged(this,!1),n.onUpdateState=t.WMPlayer.playButton_onUpdateState(this),n.appendChild(document.createTextNode(" ")),s.appendChild(n),i=document.createElement("a"),i.className="button-stop",i.href="#stop",i.title=decodeURIComponent(t.WMPlayer.m_strings.wmplayer_stop),i.hideFocus=!0,i.tabIndex=t.WMPlayer.m_tabIndex*10+3,i.onclick=t.WMPlayer.createHandler(this,"stop"),i.onmousedown=t.WMPlayer.button_onPressChanged(this,!0),i.onmouseup=t.WMPlayer.button_onPressChanged(this,!1),i.onUpdateState=t.WMPlayer.button_onUpdateState(this,"stop"),i.appendChild(document.createTextNode(" ")),s.appendChild(i),r=document.createElement("a"),r.className="button-mute",r.href="#mute",r.title=decodeURIComponent(t.WMPlayer.m_strings.wmplayer_mute),r.hideFocus=!0,r.tabIndex=t.WMPlayer.m_tabIndex*10+4,r.onclick=t.WMPlayer.createHandler(this,"mute"),r.onmousedown=t.WMPlayer.button_onPressChanged(this,!0),r.onmouseup=t.WMPlayer.button_onPressChanged(this,!1),r.onUpdateState=t.WMPlayer.mute_onUpdateState(this),r.appendChild(document.createTextNode(" ")),s.appendChild(r),o=document.createElement("div"),o.className="volume-area",o.onmousedown=t.WMPlayer.createHandler(this,"volume_onDragStart"),b=document.createElement("div"),b.className="volume-left",o.appendChild(b),k=document.createElement("div"),k.className="volume-right",o.appendChild(k),y=document.createElement("div"),y.className="volume-fill",y.onUpdateState=t.WMPlayer.volumeFill_onUpdateState(this),o.appendChild(y),f=document.createElement("a"),f.className="volume-thumb",f.href="#volume",f.title=decodeURIComponent(t.WMPlayer.m_strings.wmplayer_volume),f.hideFocus=!0,f.tabIndex=t.WMPlayer.m_tabIndex*10+5,f.onmousedown=t.WMPlayer.createHandler(this,"volume_onDragStart"),f.onkeydown=t.WMPlayer.createHandler(this,"volume_onKeyDown"),f.appendChild(document.createTextNode(" ")),o.appendChild(f),s.appendChild(o),t.WMPlayer.m_tabIndex++,h=this,this.m_updateMethod=function(){n.onUpdateState(),i.onUpdateState(),r.onUpdateState(),v.onUpdateState(),y.onUpdateState(),c.onUpdateState(),h.reportErrors(),h.m_updateMethod&&h.m_player&&(h.m_player.playState==3||h.m_player.playState==6)&&window.setTimeout(h.m_updateMethod,t.WMPlayer.m_pollingInt)},this.m_updateMethod()}},t.WMPlayer.prototype.setVolume=function(n){this.m_player&&(this.m_player.settings.volume=n*100,this.m_player.settings.mute=!1)},t.WMPlayer.prototype.setPosition=function(n){this.m_player&&(this.m_player.controls.currentPosition=n*this.m_player.controls.currentItem.duration)},t.WMPlayer.prototype.play=function(){this.m_player&&((this.m_player.playState==3||this.m_player.playState==6)&&this.m_player.controls.isAvailable("pause")?this.m_player.controls.pause():this.m_player.controls.isAvailable("play")&&this.m_player.controls.play()),this.m_updateMethod&&window.setTimeout(this.m_updateMethod,t.WMPlayer.m_pollingInt)},t.WMPlayer.prototype.stop=function(){this.m_player&&this.m_player.controls.isAvailable("stop")&&this.m_player.controls.stop(),this.m_updateMethod&&this.m_updateMethod()},t.WMPlayer.prototype.mute=function(){this.m_player&&(this.m_player.settings.mute=!this.m_player.settings.mute),this.m_updateMethod&&this.m_updateMethod()},t.WMPlayer.prototype.reportErrors=function(){var i="",f,e,r;if(this.m_$audioControl){if(i=decodeURIComponent(t.WMPlayer.m_strings.wmplayer_error),f=this.m_$audioControl.prop("error"),f)switch(f.code){case 1:case 2:i=decodeURIComponent(t.WMPlayer.m_strings.wmplayer_errorCannotOpenUrl);break;case 3:case 4:i=decodeURIComponent(t.WMPlayer.m_strings.wmplayer_errorCannotPlay)}}else if(this.m_player&&this.m_player.error&&this.m_player.error.errorCount>0)for(e=this.m_player.error.errorCount,r=0;r<e;r++){switch(this.m_player.error.item(r).errorCode>>>0){case 2147746389:case 2147749890:case 3222080450:case 3222080456:case 3222081444:case 3222079501:case 3222080450:case 3222080456:case 3222081443:case 3222081623:case 3222081642:case 3222081652:case 3222081654:case 3222081680:case 3222081718:case 3222081722:case 3222081745:case 3222081943:case 3222081945:case 3222081946:case 3222081949:case 3222081964:case 3222081974:case 3222081978:case 3222081979:case 3222081981:case 3222081984:case 3222081991:case 3222082001:case 3222082347:case 3222087453:case 3222087499:case 3222087501:i+=decodeURIComponent(t.WMPlayer.m_strings.wmplayer_errorCannotPlay);break;case 2148270088:case 2147942455:case 2147943631:case 2148270093:case 2148270095:case 2148282082:case 3222077471:case 3222079473:case 3222079474:case 3222081940:case 3222081944:case 3222081971:case 3222081988:case 3222081995:case 3222082002:case 3222089445:case 3222089454:i+=decodeURIComponent(t.WMPlayer.m_strings.wmplayer_errorCannotOpenUrl);break;default:i+=decodeURIComponent(t.WMPlayer.m_strings.wmplayer_error)}if(1){for(var o=[],s=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"],u=this.m_player.error.item(r).errorCode>>>0;u>=.9;)o.push(s[u%16]),u=Math.floor(u/16);i+=" (0x"+o.reverse().join("")+': "',i+=this.m_player.error.item(r).errorDescription+'")'}r>0&&(i+="<br/>"),this.m_player.error.clearErrorQueue()}this.dispose(),n(this).trigger("error",[i])},t.WMPlayer.translateOffset=function(n){for(var t=0,i;n;)t+=n.offsetLeft,i=n.tagName.toLowerCase(),i!="body"&&(t-=n.scrollLeft,i!="table"&&n.clientLeft&&(t+=n.clientLeft)),n=n.offsetParent;return t},t.WMPlayer.getEventTarget=function(n){return n?n.srcElement?n.srcElement:n.currentTarget?n.currentTarget:n.originalTarget?n.originalTarget:null:null},t.WMPlayer.prototype.seek_onKeyDown=function(n){var t=this.m_player.controls.currentPosition/this.m_player.controls.currentItem.duration;switch(n.keyCode){case 37:case 40:return t-=.05,this.setPosition(Math.min(Math.max(t,0),1)),this.m_updateMethod&&this.m_updateMethod(),!1;case 39:case 38:return t+=.05,this.setPosition(Math.min(Math.max(t,0),1)),this.m_updateMethod&&this.m_updateMethod(),!1;default:return!0}},t.WMPlayer.prototype.seek_onDragStart=function(n){for(this.m_pSeekDragElem=t.WMPlayer.getEventTarget(n);this.m_pSeekDragElem&&this.m_pSeekDragElem.className.indexOf("seek-area")<0;)this.m_pSeekDragElem=this.m_pSeekDragElem.parentNode;this.m_pSeekDragElem&&(this.m_pSeekDragElem.className.indexOf("seek-drag")<0&&(this.m_pSeekDragElem.className+=" seek-drag"),this.m_seekLeft=t.WMPlayer.translateOffset(this.m_pSeekDragElem),this.m_seekWidth=this.m_pSeekDragElem.offsetWidth,this.m_pSeekDragHandlers={seek_onDrag:t.WMPlayer.createHandler(this,"seek_onDrag"),seek_onDragStop:t.WMPlayer.createHandler(this,"seek_onDragStop")},t.WMPlayer.attachHandler(document,"mousemove",this.m_pSeekDragHandlers.seek_onDrag),t.WMPlayer.attachHandler(document,"mouseup",this.m_pSeekDragHandlers.seek_onDragStop),this.seek_onDrag(n))},t.WMPlayer.prototype.seek_onDrag=function(n){var i,r,t;if(n&&this.m_pSeekDragElem){for(i=null,r=this.m_pSeekDragElem.childNodes.length,t=0;t<r;t++)this.m_pSeekDragElem.childNodes[t].className=="seek-fill"&&(i=this.m_pSeekDragElem.childNodes[t]);i&&(this.m_SeekPos=Math.min(Math.max((n.clientX-this.m_seekLeft)/this.m_seekWidth,0),1),isNaN(this.m_SeekPos)||(i.style.width=""+100*this.m_SeekPos+"%"))}},t.WMPlayer.prototype.seek_onDragStop=function(n){this.m_pSeekDragElem&&(this.seek_onDrag(n),isNaN(this.m_SeekPos)||this.setPosition(this.m_SeekPos),this.m_pSeekDragElem.className.indexOf("seek-drag")>=0&&(this.m_pSeekDragElem.className=this.m_pSeekDragElem.className.replace(/\s*seek-drag/,"")),t.WMPlayer.detachHandler(document,"mousemove",this.m_pSeekDragHandlers.seek_onDrag),t.WMPlayer.detachHandler(document,"mouseup",this.m_pSeekDragHandlers.seek_onDragStop),this.m_pSeekDragHandlers=null,this.m_pSeekDragElem=null,this.m_seekLeft=null,this.m_seekWidth=null,this.m_updateMethod&&this.m_updateMethod())},t.WMPlayer.prototype.volume_onKeyDown=function(n){var t=this.m_player.settings.volume/100;switch(n.keyCode){case 37:case 40:return t-=.1,this.setVolume(Math.min(Math.max(t,0),1)),this.m_updateMethod&&this.m_updateMethod(),!1;case 39:case 38:return t+=.1,this.setVolume(Math.min(Math.max(t,0),1)),this.m_updateMethod&&this.m_updateMethod(),!1;default:return!0}},t.WMPlayer.prototype.volume_onDragStart=function(n){for(this.m_pVolumeDragElem=t.WMPlayer.getEventTarget(n);this.m_pVolumeDragElem&&this.m_pVolumeDragElem.className.indexOf("volume-area")<0;)this.m_pVolumeDragElem=this.m_pVolumeDragElem.parentNode;this.m_pVolumeDragElem&&(this.m_pVolumeDragElem.className.indexOf("volume-drag")<0&&(this.m_pVolumeDragElem.className+=" volume-drag"),this.m_volumeLeft=t.WMPlayer.translateOffset(this.m_pVolumeDragElem),this.m_volumeWidth=this.m_pVolumeDragElem.offsetWidth,this.m_pVolumeDragHandlers={volume_onDrag:t.WMPlayer.createHandler(this,"volume_onDrag"),volume_onDragStop:t.WMPlayer.createHandler(this,"volume_onDragStop")},t.WMPlayer.attachHandler(document,"mousemove",this.m_pVolumeDragHandlers.volume_onDrag),t.WMPlayer.attachHandler(document,"mouseup",this.m_pVolumeDragHandlers.volume_onDragStop),this.volume_onDrag(n))},t.WMPlayer.prototype.volume_onDrag=function(n){var i,r,t;if(n&&this.m_pVolumeDragElem){for(i=null,r=this.m_pVolumeDragElem.childNodes.length,t=0;t<r;t++)this.m_pVolumeDragElem.childNodes[t].className=="volume-fill"&&(i=this.m_pVolumeDragElem.childNodes[t]);i&&(this.m_volumePos=Math.min(Math.max((n.clientX-this.m_volumeLeft)/this.m_volumeWidth,0),1),isNaN(this.m_volumePos)||(i.style.width=""+100*this.m_volumePos+"%",this.setVolume(this.m_volumePos)))}},t.WMPlayer.prototype.volume_onDragStop=function(n){this.m_pVolumeDragElem&&(this.volume_onDrag(n),this.m_pVolumeDragElem.className.indexOf("volume-drag")>=0&&(this.m_pVolumeDragElem.className=this.m_pVolumeDragElem.className.replace(/\s*volume-drag/,"")),t.WMPlayer.detachHandler(document,"mousemove",this.m_pVolumeDragHandlers.volume_onDrag),t.WMPlayer.detachHandler(document,"mouseup",this.m_pVolumeDragHandlers.volume_onDragStop),this.m_pVolumeDragHandlers=null,this.m_pVolumeDragElem=null,this.m_volumeLeft=null,this.m_volumeWidth=null)},t.WMPlayer.button_onUpdateState=function(n,t){return function(){if(n&&n.m_player){var i=this;i.disabled=!n.m_player.controls.isAvailable(t),i.disabled?i.className.indexOf("button-"+t+"-disabled")<0&&(i.className+=" button-"+t+"-disabled"):i.className.indexOf("button-"+t+"-disabled")>=0&&(i.className=i.className.replace(new RegExp("s*button-"+t+"-disabled"),"")),i.m_isPressed?i.className.indexOf("button-"+t+"-press")<0&&(i.className+=" button-"+t+"-press"):i.className.indexOf("button-"+t+"-press")>=0&&(i.className=i.className.replace(new RegExp("s*button-"+t+"-press"),""))}}},t.WMPlayer.button_onPressChanged=function(n,t){return function(){if(n){var i=this;i.m_isPressed=t,n.m_updateMethod&&n.m_updateMethod()}}},t.WMPlayer.playButton_onUpdateState=function(n){return function(){if(n&&n.m_player){var i=this,r="play";(n.m_player.playState==3||n.m_player.playState==6)&&n.m_player.controls.isAvailable("pause")?(i.className="button-pause",i.title=decodeURIComponent(t.WMPlayer.m_strings.wmplayer_pause),i.href="#pause",r="pause"):n.m_player.controls.isAvailable("play")?(i.className="button-play",i.title=decodeURIComponent(t.WMPlayer.m_strings.wmplayer_play),i.href="#play"):(i.className="button-play button-play-disabled",i.title=decodeURIComponent(t.WMPlayer.m_strings.wmplayer_play),i.href="#play"),i.m_isPressed?i.className.indexOf("button-"+r+"-press")<0&&(i.className+=" button-"+r+"-press"):i.className.indexOf("button-"+r+"-press")>=0&&(i.className=i.className.replace(new RegExp("s*button-"+r+"-press"),""))}}},t.WMPlayer.mute_onUpdateState=function(n){return function(){if(n&&n.m_player){var t=this,i="mute";n.m_player.settings.mute?(i="muted",t.className.indexOf("button-muted")<0&&(t.className+=" button-muted")):t.className.indexOf("button-muted")>=0&&(t.className=t.className.replace(/\s*button-muted/,"")),t.m_isPressed?t.className.indexOf("button-"+i+"-press")<0&&(t.className+=" button-"+i+"-press"):(t.className.indexOf("button-mute-press")>=0||t.className.indexOf("button-muted-press")>=0)&&(t.className=t.className.replace(new RegExp("s*button-mute([d]?)-press"),""))}}},t.WMPlayer.seekFill_onUpdateState=function(n){return function(){var i,t;n&&n.m_player&&(i=this,n.m_pSeekDragElem||(t=n.m_player.controls.currentPosition/n.m_player.controls.currentItem.duration,isNaN(t)||(i.style.width=""+100*t+"%")))}},t.WMPlayer.volumeFill_onUpdateState=function(n){return function(){if(n&&n.m_player){var t=this;n.m_pVolumeDragElem||(t.style.width=""+n.m_player.settings.volume+"%")}}},t.WMPlayer.timeLabel_onUpdateState=function(n){return function(){var r,t,u,i;if(n&&n.m_player)for(r=this,t=n.m_player.controls.currentPositionString,t&&(t+=" / "),t+=n.m_player.currentMedia.durationString,u=r.childNodes.length,i=0;i<u;i++)if(r.childNodes[i].nodeType==3){r.childNodes[i].nodeValue=t;return}}},t.WMPlayer.createHandler=function(n,t){return function(i){i=i?i:window.event;var r=n?n[t](i):!1;return r?!0:!1}}}(window.originaljQuery||window.jQuery)