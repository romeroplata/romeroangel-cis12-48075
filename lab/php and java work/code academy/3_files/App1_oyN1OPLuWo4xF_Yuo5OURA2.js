var __WEBUI_LOADED,__WEBUTILS_LOADED,WebDialogManager,gShowDialog;/*@cc_on@*/WebDialog=function(n,t,i,r,u,f,e){function ct(){c==null&&(c=new $Memory,o=new $UI.DialogBase(i,r,!0,e),o.oldAddButtonInternal=o.addButtonInternal,o.addButtonInternal=h._addButtonInternal,o.noNodesBeforeButtons=!0,o.unregisterKeyEvents(),typeof u!="undefined"&&o.setShowHeader(u),typeof f!="undefined"&&o.setShowFooter(f),e&&$css.add(o.getContentElement(),e),s={},s.relocateStyle={top:0,right:0,bottom:0,left:0,enableX:!0,enableY:!0},s.hdock=WebPopupControl.HDock.Screen,s.vdock=WebPopupControl.VDock.Screen,s.hanchor=WebPopupControl.HAnchor.Center,s.vanchor=WebPopupControl.VAnchor.Middle)}function d(n){var t=n.target,i=h.isMinimized()||k&&k.isShown()&&!k.isMinimized();i||WebUtilities.isRelation(h.getRootElt(),t)!=!1||h.callbackAndHide()}function lt(n){return o.handleButton(o.cancelButtonName,!1,n),l=!1,n.returnValue=!1,!1}function at(n){n.srcElement.src=a+"closebox_hover.gif"}function vt(n){n.srcElement.src=a+"closebox_normal.gif"}function yt(){var n=window.originaljQuery||window.jQuery;nt&&n(window).bind("resize",h.centerModal)}var h=this,c=null,s=null,o=null,l=!1,g=!1,y=!1,ut=WebPopupControl.ButtonAlignment.Right,ft=null,nt=r,p=null,w=null,tt=null,a,et=!1,ot=null,st=0,ht=n,it=t,b=null,v=null,rt=!1,k=null;this.autoCalc=!0,this._addButtonInternal=function(n,t,i,r){if(o.oldAddButtonInternal(n,t,i,r),y&&o.buttonElements.length>0){var u=document.createElement("div");u.className="StackedButtonSeperator",o.getButtonBarElement().insertBefore(u,o.buttonElements[n])}/*@if(!@QaModeDisabled)@*/var f=i?"qa.shared.ui.dialog.defaultbutton":r?"qa.shared.ui.dialog.cancelbutton":"qa.shared.ui.dialog.button";WebSetQATagId(o.buttonElements[n],f);/*@end@*/},this.setChildDialog=function(n){k=n},this.stackButtons=function(){y=!0},this.setButtonAlignment=function(n){ut=n},this.dispose=function(){var n=window.originaljQuery||window.jQuery;rt==!0&&(n(document).unbind({mousedown:d,mousewheel:d}),rt=!1),o&&(o.hide(),o=null),c&&(c.dispose(),c=null),n(window).unbind("resize",h.centerModal),s=p=w=v=a=null},this.show=function(n,t){var e=window.originaljQuery||window.jQuery,u,i,r,f;if(!l){if(p||h.setCallback(function(){return!0}),o.show(p,null,t),l=!0,y){for(u=0,i=0,i=0;i<o.buttonElements.length;i++)u=Math.max(o.buttonElements[i].offsetWidth,u);for(i=0;i<o.buttonElements.length;i++)o.buttonElements[i].style.width=u+"px"}r=null,f=document.body.currentStyle?"rtl"===document.body.currentStyle.direction:!ol.config.Ltr;switch(ut){case WebPopupControl.ButtonAlignment.Left:r=f?"right":"left";break;case WebPopupControl.ButtonAlignment.Center:r="center";break;case WebPopupControl.ButtonAlignment.Right:r=f?"left":"right"}r&&(o.getFooterElement().style.textAlign=r),et?this.recalculateWidthToResizeElement():this.getNumButtons()>0&&this.recalculateWidthToButtons(),yt(n),nt||(rt=!0,e(document).bind({mousedown:d,mousewheel:d})),this.centerModal()}},this.hide=function(){l&&(o.hide(),this.dispose(),l=!1)},this.setDock=function(n,t){s.vdock=n||s.vdock,s.hdock=t||s.hdock,h.recalc()},this.setAnchor=function(n,t){s.vanchor=n||s.vanchor,s.hanchor=t||s.hanchor,h.recalc()},this.dockTo=function(n,t,i){n.getElementsByTagName&&(b=n),s.elOffset=t,s.blnRelocate=i,h.recalc()},this.getDockPosition=function(){var i,o,f;if(!b&&s.hdock!=WebPopupControl.HDock.Screen&&s.vdock!=WebPopupControl.VDock.Screen)return $UI.Dialog.Rect(0,0,0,0);var r=null,c=h.getContents(),u=h.getSize(),e=window.event||window.e;(s.hdock!=WebPopupControl.HDock.Screen||s.vdock!=WebPopupControl.VDock.Screen)&&(r=$UI.Dialog.getLocation(b));var t=new WebUtilities.Point,n=new WebUtilities.Point,i=WebUtilities.getLayoutRoot();switch(s.hdock){case WebPopupControl.HDock.Left:t.x=r.x;break;case WebPopupControl.HDock.Center:t.x=r.x+r.width/2;break;case WebPopupControl.HDock.Right:t.x=r.x+r.width;break;case WebPopupControl.HDock.Screen:t.x=WebUtilities.getLayoutRoot().scrollLeft+WebUtilities.getLayoutRoot().clientWidth/2;break;case WebPopupControl.HDock.Cursor:t.x=i.scrollLeft+e.clientX}switch(s.vdock){case WebPopupControl.VDock.Top:t.y=r.y;break;case WebPopupControl.VDock.Middle:t.y=r.y+r.height/2;break;case WebPopupControl.VDock.Bottom:t.y=r.y+r.height;break;case WebPopupControl.VDock.Screen:t.y=WebUtilities.getLayoutRoot().scrollTop+WebUtilities.getLayoutRoot().clientHeight/2;break;case WebPopupControl.VDock.Cursor:t.y=WebUtilities.getLayoutRoot().scrollTop+e.clientY}switch(s.hanchor){case WebPopupControl.HAnchor.Left:n.x=t.x;break;case WebPopupControl.HAnchor.Center:n.x=t.x-u.width/2;break;case WebPopupControl.HAnchor.Right:n.x=t.x-u.width}switch(s.vanchor){case WebPopupControl.VAnchor.Top:n.y=t.y;break;case WebPopupControl.VAnchor.Middle:n.y=t.y-u.height/2;break;case WebPopupControl.VAnchor.Bottom:n.y=t.y-u.height}return s.blnRelocate&&(i=WebUtilities.getLayoutRoot(),s.relocateStyle.enableX&&n.x+u.width+s.relocateStyle.right>i.scrollLeft+i.clientWidth&&(n.x=i.scrollLeft+i.clientWidth-u.width-s.relocateStyle.right),s.relocateStyle.enableY&&n.y+u.height+s.relocateStyle.bottom>i.scrollTop+i.clientHeight&&(n.y=i.scrollTop+i.clientHeight-u.height-s.relocateStyle.bottom),o=document.body.currentStyle?"rtl"===document.body.currentStyle.direction:!ol.config.Ltr,!o&&s.relocateStyle.enableX&&n.x-s.relocateStyle.left<i.scrollLeft&&(n.x=i.scrollLeft+s.relocateStyle.left),s.relocateStyle.enableY&&n.y-s.relocateStyle.top<i.scrollTop&&(n.y=i.scrollTop+s.relocateStyle.top)),s.elOffset&&(f=$UI.Dialog.getLocation(s.elOffset),n.x-=f.x,n.y-=f.y),n.left=n.x,n.top=n.y,n},this.setContents=function(n,t){o.body=n,o.render();var i=o.getBodyElement();i.className.indexOf("Web_UI_Popup")==-1&&(i.className+=" Web_UI_Popup");/*@if(!@QaModeDisabled)@*/t&&WebSetQATagId(i,t);/*@end@*/return this.setDimensions(it,ht),i},this.setDimensions=function(n,t){var i=o.getBodyElement();i&&(t&&(i.style.height=t+"px"),n&&this.setWidth(n))},this.setPosition=function(n){var t=o.getInnerDialog();t.dock.x=n.x,t.dock.y=n.y,t.recalc(!0)},this.setWidth=function(n){it=n,o.setWidth(n),o.recalc()},this.getBounds=this.getSize=function(){var n=o.getBodyElement().parentElement,t=$UI.Dialog.getLocation(n),i;return(!t||t.isEmpty())&&(i={visibility:n.currentStyle&&n.currentStyle.visibility||n.style&&n.style.visibility||"visible",display:n.currentStyle&&n.currentStyle.display||n.style&&n.style.display||"auto"},n.style.visibility="hidden",n.style.display="block",t=$UI.Dialog.getLocation(n),n.style.display=i.display,n.style.visibility=i.visibility),t},this.getContents=function(){return o.getBodyElement()},this.recalc=function(n){var t=n||h.autoCalc;t=t&&!(!b&&s.hdock!=WebPopupControl.HDock.Screen&&s.vdock!=WebPopupControl.VDock.Screen),t&&h.setPosition(h.getDockPosition())},this.addButton=function(n,t,i,r){o.addButton(t,n,i,r)},this.disableButton=function(n){o.disableButton(n)},this.enableButton=function(n){o.enableButton(n)},this.getNumButtons=function(){return o.getButtonCount()},this.getWidthOfButtons=function(){var t=0,i,n,r;if(o.buttonElements){for(i=8,n=0;n<o.buttonElements.length;n++)if(y){t=Math.max(t,o.buttonElements[n].offsetWidth);break}else t+=o.buttonElements[n].offsetWidth+(n>0?i:0);r=48,t+=r}return t},this.addCloseBox=function(n){var i,t,u,r;v=document.createElement("div"),v.className="closeBoxContainer",o.cancelButtonName=o.cancelButtonName?o.cancelButtonName:"Cancel",i=document.createElement("a"),i.href="#",i.title=n,t=document.createElement("img"),t.style.height="10px",t.style.width="10px",t.src=a+"closebox_normal.gif",t.alt=n,i.appendChild(t),u=v.appendChild(i);/*@if(!@QaModeDisabled)@*/WebSetQATagId(u,"qa.shared.webdialog.closebox");/*@end@*/r=o.getBodyElement(),r.parentElement.insertBefore(v,r),c.Events.register(i,{onclick:lt}),c.Events.register(t,{onmouseenter:at}),c.Events.register(t,{onmouseleave:vt})},this.getCancelButtonValue=function(){return o.cancelButtonName},this.setFocus=function(){o.getInnerDialog().setFocus()},this.getIdentifier=function(){return ft},this.setIdentifier=function(n){ft=n},this.centerModal=function(){var n=o.getContentElement();if(nt&&n){var t=WebUtilities.getViewportWidth(i)/2-n.offsetWidth/2,r=WebUtilities.getLayoutRoot().scrollTop+WebUtilities.getViewportHeight(i)/2-n.offsetHeight/2,u=new WebUtilities.Point(t>=0?t:0,r>=0?r:0);h.setPosition(u),tt&&tt(u)}},this.getSelectedRadioValue=function(n){for(var i=document.getElementsByName(n),t=0;t<i.length;t++)if(i[t].checked==!0)return i[t].value;return null},this.getSelectValue=function(n){var t=document.getElementById(n);return t&&t.tagName=="SELECT"&&t.options.length?t.options[t.selectedIndex].value:null},this.getInputText=function(n){var t=document.getElementById(n);return t&&(t.tagName=="INPUT"||t.tagName=="TEXTAREA")?t.value:null},this.setContext=function(n){w=n},this.getContext=function(){return w},this.setCallback=function(n){p=function(t,i){var r=n(w,i);return r&&h.hide(),r}},this.setShowFooter=function(n){o.setShowFooter(n)},this.setOnModalSetPositionCallBack=function(n){tt=n},this.setImgPath=function(n){a=n},this.setAutoResizeToFitElement=function(n,t){et=!0,ot=n,st=t?t:0},this.addCloseOnEscapeKey=function(){o.registerKeyEvents()},this.recalculateWidthToResizeElement=function(){var n=document.getElementById(ot),t;n&&(t=Math.max(n.offsetWidth+st,o.getBodyElement().offsetWidth),this.setWidth(t)),this.centerModal()},this.recalculateWidthToButtons=function(){var i=this.getWidthOfButtons(),n=this.getContents().offsetWidth;if(i>n){var t=parseInt(it),r=n/t,u=Math.ceil((i-n)/r);t+=u,this.setWidth(t+(r>1?"em":"")),this.centerModal()}},this.callbackAndHide=function(){o.handleButton("none",!0)},this.minimize=function(){l&&(o.minimize(),g=!0)},this.restore=function(){l&&(o.restore(),g=!1)},this.isShown=function(){return l},this.isMinimized=function(){return g},this.setHeaderTitle=function(n){o.setShowHeader(!0),o.header=n},this.getRootElt=function(){return o.getContentElement()},this.getHeaderElt=function(){return o.getHeaderElement()},this.getHeaderTitleElt=function(){return o.getHeaderTitleElement()},this.getFooterElt=function(){return o.getFooterElement()},ct()},WebPopupControl={},WebPopupControl.VAnchor=new $Enum("Top","Middle","Bottom","None"),WebPopupControl.HAnchor=new $Enum("Left","Center","Right","None"),WebPopupControl.VDock=new $Enum("Top","Middle","Bottom","Cursor","Screen"),WebPopupControl.HDock=new $Enum("Left","Center","Right","Cursor","Screen"),WebPopupControl.ButtonAlignment=new $Enum("Left","Center","Right");/*@if(!@QaModeDisabled)@*/WebSetQATagId=function(n,t){t&&n.setAttribute("qatagid",t)},WebGenerateQATagIdString=function(n){return' qatagid="'+n+'" '};/*@end@*/__WEBUI_LOADED=!0,"undefined"==typeof WebUtilities&&(WebUtilities={}),WebUtilities.Rect=function(n,t,i,r){return{left:n,x:n,top:t,y:t,width:i,height:r,right:n+i,bottom:t+r,toString:function(){return"{x:{0},y:{1},width:{2},height:{3}}".format(this.x,this.y,this.width,this.height)},equals:function(n){return this.x==n.x&&this.y==n.y&&this.width==n.width&&this.height==n.height},inflate:function(n,t){this.width+=n,this.height+=t,this.right=this.x+this.width,this.bottom=this.y+this.height},offset:function(n,t){this.x+=n,this.left=this.x,this.y+=t,this.top=this.y,this.right+=n,this.bottom+=t},isEmpty:function(){return this.width<=0||this.height<=0},contains:function(n){return n.x>=this.left&&n.x<=this.width+this.left&&n.y>=this.top&&n.y<=this.height+this.top}}},WebUtilities.Rect.Empty=new WebUtilities.Rect(0,0,0,0),WebUtilities.getLocation=function(n,t){var i,u,e,f,r,o;if(!n)return WebUtilities.Rect.Empty;for(i=new WebUtilities.Rect,i.source=n,u=n.currentStyle,e=["Top","Left","Right","Bottom"],f=0;f<e.length;f++)r=e[f],i["margin"+r]=WebUtilities.Conversion.coerceInt(u["margin"+r]),i["border"+r]=WebUtilities.Conversion.coerceInt(u["border"+r+"Width"]),i["padding"+r]=WebUtilities.Conversion.coerceInt(u["padding"+r]);for(i.height=n.offsetHeight,i.width=n.offsetWidth,i.left=n.offsetLeft,i.top=n.offsetTop,n=n.offsetParent,o=WebUtilities.getLayoutRoot();n&&(!t||n!=t);)i.left+=n.offsetLeft-(o!=n?WebUtilities.Conversion.coerceInt(n.scrollLeft):0),i.top+=n.offsetTop-(o!=n?WebUtilities.Conversion.coerceInt(n.scrollTop):0),n=n.offsetParent;return document.compatMode=="CSS1Compat"?(i.contentWidth=i.source.offsetWidth-i.borderLeft-i.borderRight-i.paddingLeft-i.paddingRight-i.marginLeft-i.marginRight,i.contentHeight=i.source.offsetHeight-i.borderTop-i.borderBottom-i.paddingTop-i.paddingBottom-i.marginTop-i.marginBottom):(i.contentWidth=i.source.offsetWidth,i.contentHeight=i.source.offsetHeight),i.x=i.left,i.y=i.top,i.bottom=i.top+i.height-i.marginBottom,i.right=i.left+i.width-i.marginRight,i},WebUtilities.Conversion={coerceInt:function(n){return n=parseInt(n),isNaN(n)?0:n}},WebUtilities.getLayoutRoot=function(){return document.compatMode=="CSS1Compat"&&!$B.Safari?document.documentElement:document.body},WebUtilities.getViewportWidth=function(n){var t=n?n:window;return t.innerWidth!=t.undefined?t.innerWidth:t.document.compatMode=="CSS1Compat"?t.document.documentElement.clientWidth:t.document.body?t.document.body.clientWidth:void 0},WebUtilities.getViewportHeight=function(n){var t=n?n:window;return t.innerHeight!=t.undefined?t.innerHeight:t.document.compatMode=="CSS1Compat"?t.document.documentElement.clientHeight:t.document.body?t.document.body.clientHeight:void 0},WebUtilities.Point=function(n,t){return{left:n,x:n,top:t,y:t,offset:function(n,t){return this.top+=t,this.y=this.top,this.left+=n,this.x=this.left,this},add:function(n,t){return this.offset(n,t)},subtract:function(n,t){return this.offset(-n,-t)}}},WebUtilities.getContainer=function(){if(WebUtilities._container==null){WebUtilities._container=document.createElement("span");var n=document.body;n.insertBefore(WebUtilities._container,n.firstChild)}return WebUtilities._container},WebUtilities.findFocusableElement=function(n,t,i){function r(n){if(!n)return null;for(var t=i?n.nextSibling:n.previousSibling;t&&t.nodeType!=1;)t=i?t.nextSibling:t.previousSibling;return t?t:r(n.parentNode)}function u(n,t){var u=t;if(u&&n.contains(u))while(u!=null){if(WebUtilities.isFocusable(u))return u;u=i&&u.firstChild?u.firstChild:!i&&u.lastChild?u.lastChild:r(u)}return null}t=t?r(t):n;var f=u(n,t);return!f&&t&&t!=n?u(n,n):f},WebUtilities.isFocusable=function(n){return n.tagName&&!n.disabled&&("BUTTON|TEXTAREA|FIELDSET|IFRAME|SELECT|".indexOf(n.tagName+"|")>-1||n.tagName=="A"&&n.href||n.tagName=="INPUT"&&n.type!="hidden")},typeof WebEnum=="undefined"&&(WebEnum={}),WebEnum.create=function(){for(var t=[null],i=arguments.length,n=0;n<i;n++)t.push(arguments[n],arguments[n]);return WebEnum.createEnum.apply(this,t)},WebEnum.createEnum=function(name){var enumeration={},iCount,i;for(name&&eval("enumeration="+name+"={};"),enumeration.getValues=function(){var t,n;if(!enumeration._values){t={};for(n in enumeration)typeof enumeration[n]!="function"&&(t[n]=enumeration[n]);enumeration._values=t}return enumeration._values},enumeration.parse=function(n){if(n)for(var t in enumeration)if(t.toLowerCase()===n.toLowerCase())return enumeration[t];return null},enumeration.toString=function(n){for(var t in enumeration)if(enumeration[t]===n)return t;throw new Error("Error: Invalid Enumeration Value.");},enumeration.getName=function(){return name},enumeration.isEnum=function(){return!0},iCount=arguments.length,i=1;i<iCount;i+=2)enumeration[arguments[i]]=arguments[i+1];return enumeration},WebUtilities.StringBuilder=function(n){var t=[];typeof n=="string"&&n.length!=0&&t.push(n),this.append=function(n){n!=null&&typeof n!="undefined"&&(typeof n!="string"||n.length!=0)&&t.push(n)},this.appendLine=function(n){this.append(n),t.push("\r\n")},this.clear=function(){t.clear()},this.isEmpty=function(){return t.length==0},this.toString=function(n){return t.join(n||"")}},WebUtilities.eventHelper=function(n,t){function i(){return typeof t=="boolean"&&(event.cancelBubble=t),n!=null&&(event.returnValue=n,typeof n=="boolean")?n:void 0}return i},WebUtilities.KillEvent=WebUtilities.eventHelper(!1,!0),WebUtilities.CancelBubble=WebUtilities.eventHelper(null,!0),WebUtilities.CancelDefault=WebUtilities.eventHelper(!1),WebUtilities.isRelation=function(n,t){for(var i=t;i;){if(i==n)return!0;i=i.parentElement}return!1},WebUtilities.strictParseInt=function(n,t){try{return WebUtilities.s_hasAlphas||(WebUtilities.s_hasAlphas=new RegExp("[^0-9]+")),!n||WebUtilities.s_hasAlphas.test(n)?t:parseInt(n)}catch(i){return t}},__WEBUTILS_LOADED=!0,registerNamespace("$UI"),$UI.DialogBase=function(n,t,i,r){function it(){try{b.focus()}catch(n){}}function k(n){var t=n||event,i=!1;switch(t.keyCode){case 27:u.handleButton(u.cancelButtonName?u.cancelButtonName:"$cancel",!1,t),i=!0}if(i)return!1}this.header=null,this.body=null,this.footerText=null,this.width=300,this.bodyPadding=!0,this.addButton=function(n,t,i,r){o.push({name:n,value:t,isDefault:i,isCancel:r}),this.setShowFooter(!0)},this.getButtonCount=function(){return o.length},this.show=function(n,t,i){var e,r;if(!s){for(w=n,b=t,u.initializeDialog(),nt=null,e=null,r=0;r<o.length;r++)u.addButtonInternal(o[r].name,o[r].value,o[r].isDefault,o[r].isCancel),!e&&o[r].isDefault&&(e=u.buttonElements[o[r].name]);o.length==0&&u.setShowFooter(!1),f.show(e,i),s=!0}},this.setWidth=function(n){e.style.width=parseInt(n,10)==n?n+"px":n},this.setShowHeader=function(n){d=n,h&&(h.style.display=d?"block":"none")},this.setShowFooter=function(n){g=n,c&&(c.style.display=g?"block":"none")},this.initializeDialog=function(){var s,o;f||(f=new $UI.Dialog(t,null,i,r,n),s=n?n.document:window.document,e=s.createElement("div"),e.style.display="none",e.innerHTML="<div><h3><\/h3><\/div><div><\/div><div><nobr><\/nobr><\/div>",f.setContents(e),u.registerKeyEvents(),e.className="UI_Popover",o=e.childNodes,h=o[1],l=o[2],c=o[3],v=h.firstChild,a=c.firstChild,h.className=" Header",l.className=" Body",c.className=" Footer",u.setWidth(u.width),u.render())},this.hide=function(){if(s){b&&setTimeout(it,10);try{p.dispose(),y.dispose(),f.hide(),f.dispose()}catch(n){}s=!1,e=h=c=l=v=a=u.buttonElements=null}},this.enableButton=function(n){u.buttonElements[n].disabled=!1},this.disableButton=function(n){u.buttonElements[n].disabled=!0},this.registerKeyEvents=function(){p.Events.register(t?document.body:e,$B.RE_WebKit?{onkeydown:k}:{onkeypress:k})},this.unregisterKeyEvents=function(){p.Events.dispose()},this.addButtonInternal=function(t,i,r,f){var s,o,e,h;u.noNodesBeforeButtons||a.appendChild(document.createTextNode(" ")),s=n?n.document:window.document,o=s.createElement("div"),o.innerHTML='<button id="popover_btn_{0}" type="{1}" />'.format(t,r?"submit":"button"),e=o.firstChild,y.Nodes.register(e),r?(e.className+="Default",nt=t):f&&(u.cancelButtonName=t),u.buttonElements[t]=u.buttonElements[u.buttonElements.length]=e,e.innerHTML="<nobr>"+i+"<\/nobr>",h=function(n){u.handleButton(t,!1,n),n.returnValue=!1},y.Events.register(e,{onclick:$CD(u,h)}),a.appendChild(e)},this.handleButton=function(n,t,i){var r=!0;w&&(r=w(u,n)),r&&u.hide(),t||(i.returnValue=!1)},this.render=function(){function n(n,t){n&&(typeof n=="string"?t.innerHTML=n:(t.innerHTML="",t.appendChild(n)))}u.bodyPadding||(l.style.padding="0"),n(u.header,v),n(u.body,l)},this.recalc=function(){f&&s&&f.recalc(!1)},this.minimize=function(){f&&s&&(f.minimize(),u.unregisterKeyEvents())},this.restore=function(){f&&s&&(f.restore(),u.registerKeyEvents())},this.getContentElement=function(){return e},this.getHeaderElement=function(){return h},this.getHeaderTitleElement=function(){return v},this.getBodyElement=function(){return l},this.getFooterElement=function(){return c},this.getButtonBarElement=function(){return a},this.getInnerDialog=function(){return f};var s=!1,f,u=this,h,l,c,d=!0,g=!0,v,a,nt;u.cancelButtonName=null;var tt=new $Memory.Groups,y=tt.create("show"),p=tt.create("showHide");u.buttonElements=[];var e,o=[],w=null,b=null;u.noNodesBeforeButtons=!1,u.initializeDialog()},registerNamespace("$SB"),function(n){var r;$SB=$SB||{},$SB.sbs=$SB.sbs||{};var u=$SB.renderModes=new $Enum("HOTMAIL","NOWORDWHEEL"),i="c_search_i",f="c_ms",t=!1;$SB.logEvent=function(n,i){$BSI.reportEvent("search.general",{SearchType:n+(i?"_"+i:""),SearchMethod:t?"enter":"click"}),t=!1},$SB.SearchBox=function(t,i,r,u,f,e,o){var s=this,y=n(o),tt=u+"f",a=y.find("."+tt),it=a[0],rt=u+"box",h=y.find("."+rt),c=h[0],ut=u+"go",v=y.find("."+ut),ft=v[0],et;var k=!($B.IE&&$B.V<=11),p="c_search_a",d="c_search_f",g=i?new Function("t","f","sub","searchBox",i):null,w=f,l=h.hasClass(p),b=!1,nt=!1;this.$menuDock=a,this.$inputBox=h,et=s.renderMode=t,this.searchBoxParams=null,this.searchEmailFunc=r?function(n,t){s.closeWordWheelMenu(),new Function("searchBoxParamsChanges","searchOrigin","targetEl",r)(n,t,c)}:null,this.searchFunc=function(n){n&&(s.searchEmailFunc&&s.searchEmailFunc({keywords:n},$SBC.searchOrigin?$SBC.searchOrigin.SearchBox:0),s.closeWordWheelMenu())},this.usesForm=e,this.statusId=u+"status",this.idPrefix=u,this.init=function(){if(s.usesForm)a.on("submit",s.onSubmit);else{h.on("keyup",s.onKeyUp);v.on("click",s.onSubmitButtonClick)}h.on("focus",s.onFocus);h.on("blur",s.onBlur)},this.dispose=function(){s.usesForm?a.off("submit"):(h.off("keyup",s.onKeyUp),v.off("click",s.onSubmitButtonClick)),h.off("focus"),h.off("blur")},this.onSubmit=function(n){if(l||h.val(""),s.getValue().trim()==="")return!1;if(typeof g=="function")try{return g(c,it,ft,s)}catch(t){}return typeof s.searchFunc=="function"?(s.searchFunc(s.getValue(),n),!1):!0},this.onKeyUp=function(n){if(n.keyCode===13)return s.searchFunc(s.getValue(),n),!1},this.onSubmitButtonClick=function(n){s.searchFunc(s.getValue(),n),n.preventDefault()},this.onFocus=function(){h.addClass(d);try{nt||$BSI.reportEvent("search.general",{SearchMethod:"focus"}),nt=!0}catch(n){}l||($B.IE&&setTimeout(function(){b&&c.select()},1),c.defaultValue="",s.setValue("",!0)),b=!0},this.onBlur=function(){h.removeClass(d),c.value===""&&s.resetDefault(),b=!1},this.setValue=function(n,t){c.value=n,t&&(h.addClass(p),l=!0)},this.getValue=function(){return l?c.value:""},this.setDisabled=function(n){h.prop("disabled",n),a.toggleClass("disabled",n)},this.setSearchBoxParams=function(n){s.searchBoxParams=n,s.resetWordWheelMenuCachedSuggestions()},this.resetDefault=function(){c.value=k?"":w,h.removeClass(p),l=!1},this.setDefaultText=function(n){w=n,h.attr("aria-label",n),k&&h.attr("placeholder",n),l||s.resetDefault()},this.getDefaultText=function(){return w},this.findAllFromSender=function(n){s.WordWheelMenu&&s.WordWheelMenu.provider&&typeof s.WordWheelMenu.provider.findAllFromSender=="function"&&s.WordWheelMenu.provider.findAllFromSender(n)||this.searchFunc(n)},this.updateMenuData=function(n,t){s.WordWheelMenu&&s.WordWheelMenu.provider&&typeof s.WordWheelMenu.provider.updateMenuData=="function"&&(s.WordWheelMenu.provider.updateMenuData(n,t),s.resetWordWheelMenuCachedSuggestions())},this.closeWordWheelMenu=function(){s.WordWheelMenu&&typeof s.WordWheelMenu.closeMenu=="function"&&s.WordWheelMenu.closeMenu()},this.resetWordWheelMenuCachedSuggestions=function(){s.WordWheelMenu&&typeof s.WordWheelMenu.resetCachedSuggestions=="function"&&s.WordWheelMenu.resetCachedSuggestions()},$Do.when("$f",0,function(){if($Utility.isHighContrast()){var t=document.createElement("img"),i=$B.rtl?"/sb/search_rtl.png":"/sb/search.png";t.src=$Config.imgsBase+i,t.className="c_search_go",v.hide().before(t),n(t).bind("click",s.onSubmit)}}),this.init()},r=function(r,u){function g(){c.bind("focus",y),c.bind("keyup",y),c.bind("input",y),n(window).bind("unload",h.dispose)}function nt(){b||s.initialize(ft),b=!0}function tt(i){var r;if(!w){w=!0;var u=$SBC.advSearch?!0:!1,f={offset:{x:-1,y:4},nofocus:1,eventType:"click",dockEl:o.$menuDock[0],parentEl:o.$menuDock[0],showOnEmptyInput:!0,allowClickOnEmptyInput:u};$menu.create(i,0,f),r=e.binding,r&&n(r).bind("EnterEvent",function(i,r){t=!0,r&&$BSI.navigateTo(n(r).attr("href"))})}}function it(){var t=_ce("ul"),r,i,u,n,f,e;for(t.className="c_m t_hovl c_search_menu",t.setAttribute("id",o.idPrefix+"menu"),t.setAttribute("sutra","searchboxdropdown"),r=s.getMenuSectionsConfig(),this.menuSectionHeaders=[],i=0,u=r.length;i<u;i++)n=r[i].header,f=rt(t,n.additionalClass,n.title,n.isVisibleWithoutMatches,n.onClickFunction,n.sutraTag),this.menuSectionHeaders.push(f),n.isVisibleWithoutMatches&&i<u-1&&(e=k(),p(e,f));return o.$menuDock.append(t),t}function rt(t,i,r,u,f,e){var s=_ce("li");return e&&s.setAttribute("sutra",e),s.innerHTML='<a href="javascript:;" class="'+(i?i+" ":"")+'c_search_heading" >'+r.encodeHtml()+"<\/a>",t.appendChild(s),n(s).bind("click",function(n){return typeof f=="function"&&(f(n,o.getValue(),o),h.closeMenu(),n.preventDefault()),!1}),u||n(s).hide(),s}function k(){var n=_ce("span");return n.className=f,n}function y(n){tt(n),nt(),ut()}function ut(){v===null?(v=setTimeout(function(){a!==null&&(d(a),a=null),v=null},$SBC.queryInterval),d(o.getValue())):a=o.getValue()}function d(n){n!==l&&(l=n,s.getMatches(n))}function ft(t,i){var h,v,r,e,a;if(l===i){for(ot(),h=s.getMenuSectionsConfig(),v=!1,r=0;r<t.length;r++){var u=t[r],o=this.menuSectionHeaders[r],c=h[r].header,f=o;for(e=0;e<u.length;e++)f=p(u[e],f,!0);u.length>0&&r<t.length-1&&(a=k(),f=p(a,f)),c.isVisibleWithoutMatches||c.isVisibleWithMatches&&u.length>0?n(o).show():n(o).hide()}et()}}function et(){e.binding.update()}function ot(){for(var r=0,u=e.childNodes,f=null,t;u.length>r;)t=u[r],f=t.className,f.indexOf(i)>-1?(n(t.firstChild).unbind(),e.removeChild(t),u=e.childNodes):r++}function p(n,t,r){var u=_ce("LI"),f;return r&&u.setAttribute("sutra","searchboxitem"),u.className=i,u.appendChild(n),f=t.nextSibling,f?e.insertBefore(u,t.nextSibling):e.appendChild(u),u}var h=this,o=r,c=r.$inputBox,w=!1,l=null,s=u,b=!1,v=null,a=null,e=it();this.provider=s,this.dispose=function(){for(var r=this.menuSectionHeaders?this.menuSectionHeaders.length:0,i,t=0;t<r;t++)n(this.menuSectionHeaders[t]).unbind();this.menuSectionHeaders=[],c.unbind(),i=e.binding,i&&(n(i).unbind(),i.dispose()),s&&(s.dispose(),s=null,h.provider=null),n(window).unbind("unload",h.dispose)},this.closeMenu=function(){var n=e.binding;n&&n.isOpen()&&n.hide()},this.resetCachedSuggestions=function(){l=null},g()},$SB.bindAllSearchBoxes=function(n,t){for(var i in $SBC.initConfigs)$SB.bindSearchBox(n,i,t)},$SB.bindSearchBox=function(n,t,i){var f=$SBC.initConfigs[t],e,o;if(f){if($SB.sbs[t]||($SB.sbs[t]=new $SB.SearchBox(f.renderMode,f.submitOverride,f.searchEmailFunc,f.idPrefix,f.defaultText,f.usesForm,i)),e=$SB.sbs[t],e.renderMode!==u.NOWORDWHEEL){if(!window.$SBC)return;e.WordWheelMenu=new r(e,new n(e))}$Config.isINT&&(o=_ge(e.statusId),o&&o.setAttribute("status","Ready"))}},$SB.setAllSearchBoxesEnabled=function(n){var t,i;for(t in $SB.sbs)i=$SB.sbs[t],i.setDisabled(!n)},$SB.setAllSearchBoxesParams=function(n){var t,i;for(t in $SB.sbs)i=$SB.sbs[t],i.setSearchBoxParams(n)},$SB.setAllSearchBoxesValue=function(n){for(var t in $SB.sbs)$SB.setSearchBoxValue(n,t)},$SB.setSearchBoxValue=function(n,t){var i=$SB.sbs[t];i&&(n?i.setValue(n,!0):i.resetDefault())},$SB.getSearchBoxValue=function(n){var t=$SB.sbs[n];return t?t.getValue():null},$SB.setAllSearchBoxesDefaultText=function(n){for(var t in $SB.sbs)$SB.setSearchBoxDefaultText(t,n)},$SB.setSearchBoxDefaultText=function(n,t){var i=$SB.sbs[n];i&&i.setDefaultText(t)},$SB.getSearchBoxDefaultText=function(n){var t=$SB.sbs[n];return t?t.getDefaultText():null},$SB.findAllFromSender=function(n,t){var i=$SB.sbs[n];return i?i.findAllFromSender(t):null},$SB.updateMenuData=function(n,t,i){var r=$SB.sbs[n];r&&r.updateMenuData(t,i)},$SB.disposeAllSearchBoxes=function(){for(var n in $SB.sbs)$SB.disposeSearchBox(n)},$SB.disposeSearchBox=function(n){var t=$SB.sbs[n];t&&(t.WordWheelMenu&&t.WordWheelMenu.dispose(),t.dispose(),delete $SB.sbs[n])},$Do.register("$SB")}(window.originaljQuery||jQuery),function(n){function g(n,t,i){var u={},f=[t,{canary:$SBC.canary,bicild:""}],r,e;switch(n){case y.documents:u.scope="documentsearch"}for(u.callback="$SB."+i,r=0;r<f.length;r++)for(e in f[r])u[e]=f[r][e];return $SBC.ufs+"?"+$Utility.serialize(u)}function f(n){return n?n.toLowerCase():""}function tt(n){var i=[],t=null,r=null;if(n)for(i.push(t=n.lTrim());(r=t.search(nt))!=-1;)i.push(t=t.substring(r+1).lTrim());return i}function h(t,i,r,f,e,o,s,h,c,l){var a=_ce("A");return o&&(a.className=o),a[u]("target",s?"_blank":"_top"),a[u]("href",i),n(a).bind("click",function(n){var t=r(n);return $menu.closeCurrent(),$SB.logEvent(h,a.sbindex||""),t}),f&&a.appendChild(f),a.appendChild(e),a.sbbinding=c,l&&(a.sbindex=l),a}function w(t,i,r,f,e){var o=new Image,s=ut(t,o,f);return n(o).bind("load",rt(o)),o.className="c_search_imgpad c_search_img"+(e?" "+e:""),o[u]("alt",i),o[u]("src",$ssl.ensureSSLImageUrl(it(t,r,f))),s&&n(o).bind("error",s),o}function it(n,t,i){return n.defaultImage?i:t||i}function rt(t){return function i(){t.style.visibility="inherit",n(t).unbind("load",i)}}function ut(t,i,r){function f(){n(i).unbind("error",f),t.defaultImage||(t.defaultImage=!0,i[u]("src",$ssl.ensureSSLImageUrl(r)))}return t.defaultImage?null:f}function c(n){var t=_ce("SPAN");return t.className="c_search_txt",t.innerHTML=n,t}function l(n){var t=_ce("SPAN");return t.className="c_search_sub_heading c-InformationRow",t.innerHTML=n,t}function k(n){n=n.toLowerCase();for(var t in b)n=n.replace(b[t],t);return n}function r(n,r,u){var f=a.match(n)?a.highlight(n,r):d(n,r,u);return f.encodeHtml().replace(new RegExp(e.encodeHtml(),"g"),t).replace(new RegExp(o.encodeHtml(),"g"),i)}function d(n,t,i){for(var a=[t].concat(t.split(" ")),u=new Array(n.length+2),w="(^|\\s"+(i?"|@":"")+(i?"":"|["+p.escapeRegex()+"]")+")",s,h,c,r=0;r<u.length;r++)u[r]=0;for(r=0;r<a.length;r++)for(var b=a[r],v=k(n).replace(new RegExp(w+"("+k(b).escapeRegex()+")","ig"),"$1"+e+"$2"+o),y=0,f=0,l=0;(y=v.indexOf(e,f))!=-1;)for(f=v.indexOf(o,f+1),l+=2,s=y-l+2;s<f-l+1;s++)u[s+1]=1;for(h=[],r=1;r<u.length;r++)u[r]!=u[r-1]&&h.push(r-1);for(c=0,r=0;r<h.length;r++)c=h[r]+r,n=n.substr(0,c)+(r%2?o:e)+n.substr(c);return n}var t='<strong class="t_rc">',i="<\/strong>",y=new $Enum("documents","picw"),u="setAttribute",s="javascript:;",p=" !\"#$%&'()*+,-./:;<=>?@[\\]^_`{|}~",nt=new RegExp("["+p.escapeRegex()+"]","ig"),b={a:/[\xE0-\xE4]/ig,e:/[\xE8-\xEB]/ig,i:/[\xED-\xEF]/ig,o:/[\xF3-\xF5]/ig,u:/[\xF9-\xFC]/ig,n:/\xF1/ig,y:/\xFF/ig,c:/\xE7/ig},e="",o="",a,ft,et,v;if($SB.MailQueryHelper=function(){var n={FROM:"from:",TO:"to:",SUBJECT:"subject:",FOLDER:"folder:",CATEGORY:"category:",HASATTACHMENTS:"hasattachments:",DATE:"date:"},t={FROM:$SBC.keywords.from,TO:$SBC.keywords.to,SUBJECT:$SBC.keywords.subject,FOLDER:$SBC.keywords.folder,CATEGORY:$SBC.keywords.category,HASATTACHMENTS:$SBC.keywords.hasattachments,DATE:$SBC.keywords.date},i=/^([a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?)$/i,r=/([a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?)/i,u=/^\[([^[]*?)\]$/gi,e=/\[([^[]*?)\]/gi;this.keywords=n,this.extractStartingKeywordCommand=function(n){for(var a=f(n),c=this.getKeywordCommandsInQuery(a),u,l,r=0;r<c.length;r++)if(u=c[r],u.keywordIndex===0){var v=u.keywordText,h=u.keywordCommand,t,i,e=n.substring(v.length).trim(),o=/^\((.*?)\)(.*)/i.exec(e),s=/^(\[.*?\])(.*)/i.exec(e);return o&&o.length>1?(t=o[1].trim(),i=o[2].trim(),{keywordCommand:h,keywordParams:t,remainingQuery:i}):s&&s.length>1?(t=s[1].trim(),i=s[2].trim(),{keywordCommand:h,keywordParams:t,remainingQuery:i}):(l=e.split(" "),t=l[0].trim(),i=e.substring(t.length).trim(),{keywordCommand:h,keywordParams:t,remainingQuery:i})}return null},this.getKeywordCommandsInQuery=function(i){var o=[],c=f(i),r,s,h;for(r in n){var u="",e="",l=c.indexOf(f(n[r]));l>=0?(u=n[r],e=n[r],o.push({keywordText:u,keywordCommand:e,keywordIndex:l})):(s=f(t[r]),s&&(h=c.indexOf(s),h>=0&&(u=t[r],e=n[r],o.push({keywordText:u,keywordCommand:e,keywordIndex:h}))))}return o},this.queryContainsContacts=function(n){return r.lastIndex=0,e.lastIndex=0,r.test(n)||e.test(n)},this.doesMatchSingleContactFormat=function(n){var f=n.trim(),t,r;return(i.lastIndex=0,t=i.exec(f),u.lastIndex=0,r=u.exec(f),t&&t.length>1)?t[1]:r&&r.length>1?r[1]:null}},a=new function(){function i(n){return String.fromCharCode(n)}function y(){var n=["(["],t;for(t in r)n.push(t);return n.push("])"),new RegExp(n.join(""),"g")}var n=this,u=new RegExp("([\\uAC00-\\uD7AF])","g"),c=44032,f=4352,s=4449,h=4519,p=e,t=o,r={"ㄱ":"ᄀ","ㄲ":"ᄁ","ㄴ":"ᄂ","ㄷ":"ᄃ","ㄸ":"ᄄ","ㄹ":"ᄅ","ㅁ":"ᄆ","ㅂ":"ᄇ","ㅃ":"ᄈ","ㅅ":"ᄉ","ㅆ":"ᄊ","ㅇ":"ᄋ","ㅈ":"ᄌ","ㅉ":"ᄍ","ㅊ":"ᄎ","ㅋ":"ᄏ","ㅌ":"ᄐ","ㅍ":"ᄑ","ㅎ":"ᄒ"},l=y(r),a=new RegExp("([\\u1100-\\u1112][\\u1161-\\u1175][\\u11A8-\\u11C2]{0,1})","g"),v=new RegExp("([\\u1100-\\u1112]"+t+"{0,1}[\\u1161-\\u1175]"+t+"{0,1}[\\u11A8-\\u11C2]{0,1})","g");n.expand=function(n){return n=n.replace(l,function(n){return r[n]}),n.replace(u,function(n){var t=n.charCodeAt(0)-c,r=Math.floor(t/588),e=Math.floor((t-r*588)/28),u=t%28;return i(r+f)+i(e+s)+(u?i(u+h):"")})},n.highlight=function(r,u){var e=d(n.expand(r),n.expand(u),0);return e.replace(v,function(n){return n.replace(t,"")+(n.match(t)?t:"")}).replace(a,function(n){var t=n.charCodeAt(0)-f,r=n.charCodeAt(1)-s,u=n.length>2?n.charCodeAt(2)-h:0;return i(t*588+r*28+u+44032)})},n.match=function(n){return n.match(u)}},ft=function(n,t,i){var r=this;r.key=n,r.weight=t,r.order=i},$SB.SmartSuggestionsMenu=function(n){function f(){return l($SBC.suggestions.header)}function e(n,t,i){return h(n.title,s,function(t){return o(n,t)},null,c(n.htmlText),null,!1,n.type,n,i)}function o(n,t){return u.searchEmailFunc(n.searchBoxParamsChanges,n.searchOrigin),t.preventDefault(),!0}var a=this,u=n,r=new $SB.MailQueryHelper;this.getMatches=function(n){var h=[],p,w,b;if(n){var e=n.trim(),o=r.extractStartingKeywordCommand(e),c=o?o.keywordCommand:"",s=o?o.keywordParams:"",k=o?o.remainingQuery:"",f=o?r.doesMatchSingleContactFormat(s):r.doesMatchSingleContactFormat(e),v=r.getKeywordCommandsInQuery(e).length>0,d=r.queryContainsContacts(e);if(u.searchBoxParams&&!u.searchBoxParams.mustHaveAttachments){var g=$SBC.suggestions.attach,l=e.encodeHtml(),a=t+e.encodeHtml()+i,y={mustHaveAttachments:!0,keywords:e};o&&o.remainingQuery===""?c==="subject:"?(l=$SBC.suggestions.subject.format(s.encodeHtml()),a=$SBC.suggestions.subject.format(t+s.encodeHtml()+i),y={mustHaveAttachments:!0,subject:s}):f&&(c==="from:"?(l=$SBC.suggestions.from.format(f.encodeHtml()),a=$SBC.suggestions.from.format(t+f.encodeHtml()+i),y={mustHaveAttachments:!0,from:s}):c==="to:"&&(l=$SBC.suggestions.to.format(f.encodeHtml()),a=$SBC.suggestions.to.format(t+f.encodeHtml()+i),y={mustHaveAttachments:!0,to:s})):!v&&f&&(l=f.encodeHtml(),a=t+f.encodeHtml()+i),h.push({title:$SBC.suggestions.attach.format(l),type:"HM_attachment",searchOrigin:$SBC.searchOrigin.SuggestionSmartAttachment,htmlText:$SBC.suggestions.attach.format(a),searchBoxParamsChanges:y})}f&&!k&&(v&&c!=="to:"||(p=$SBC.suggestions.from,h.push({title:p.format(f.encodeHtml()),type:"HM_from",searchOrigin:$SBC.searchOrigin.SuggestionSmartFrom,htmlText:p.format(t+f.encodeHtml()+i),searchBoxParamsChanges:{from:o?s:e,keywords:""}})),v&&c!=="from:"||(w=$SBC.suggestions.to,h.push({title:w.format(f.encodeHtml()),type:"HM_to",searchOrigin:$SBC.searchOrigin.SuggestionSmartSentTo,htmlText:w.format(t+f.encodeHtml()+i),searchBoxParamsChanges:{to:o?s:e,keywords:""}}))),v||d||(b=$SBC.suggestions.subject,h.push({title:b.format(e.encodeHtml()),type:"HM_subject",searchOrigin:$SBC.searchOrigin.SuggestionSmartSubject,htmlText:b.format(t+e.encodeHtml()+i),searchBoxParamsChanges:{subject:e,keywords:""}}))}return h},this.getHtml=function(n,t){var r=[],i;if(n.length>0)for(r.push(f()),i=0;i<n.length;i++)r.push(e(n[i],t,i));return r}},$SB.CategoriesMenu=function(n){function v(n){return n?l($SBC.categories.header):l($SBC.suggestedSearches.header)}function y(n,t,i){return h(n.title,s,function(t){return p(n,t)},null,c(n.htmlText),null,!1,n.type,n,i)}function p(n,i){return t.searchEmailFunc(n.searchBoxParamsChanges,n.searchOrigin),i.preventDefault(),!0}function w(){function i(n){return wLive.Search.Helpers.getSuffixStringsFor(n)}function r(n,t,r,u){for(var e=i(t),s=r.length-1,f=0,o=e.length;f<o;f++)n.push(new wLive.Search.RankSearchKeyWeight(e[f],r[Math.min(f,s)],u)),u++;return u}var n=this,t=[1,.75];n.matchField=function(n){return n.Name},n.getKeysAndWeights=function(n){var i=[],u=1;return u=r(i,n.Name,t,u),i},n.autoComplete=function(n){return n.Name},n.isValid=function(){return!0},n.compareParents=null,n.comparer=function(n,t){var r=n.Name.toLowerCase(),u=t.Name.toLowerCase(),i=0;return r>u?i=1:r<u&&(i=-1),i},n.finalSortFunction=function(n,t){var r=n.obj.Name.toLowerCase(),u=t.obj.Name.toLowerCase(),i=0;return r>u?i=1:r<u&&(i=-1),i}}var b=this,t=n,k=new $SB.MailQueryHelper,i=null,u=[],a=new w,e=null,o=!1;this.updateMenuData=function(n){var r,f,t,s;for(u=n.suggestedCategoryIds?n.suggestedCategoryIds:u,i=n.categoryList?n.categoryList:i,r=[],f=i.RootContainer.Items,t=0;t<f.length;t++)s=f[t],s.isSearchable()&&r.push(s);e=new wLive.Search.Indexer(a),e.initialize(r,!1,function(){o=!0})},this.getMatches=function(n){var v=[],c,l,a,s,h;if(o&&t.searchBoxParams&&(!t.searchBoxParams.categories||t.searchBoxParams.categories.length===0))if(c=n.trim(),c){var p=f(c),w=e.getMatches(p,$SBC.categories.max),y=w.result;for(l=0;l<y.length;l++)s=y[l],h=s.Name,v.push({title:h,type:"HM_category",searchOrigin:$SBC.searchOrigin.SuggestionCategory,htmlText:r(h,c),searchBoxParamsChanges:{categories:[s.Id]}})}else for(a=0;a<u.length;a++)s=i.getContainerById(u[a]),s&&(h=s.Name,v.push({title:h,type:"HM_suggestedsearch",searchOrigin:$SBC.searchOrigin.SuggestionPinnedCategory,htmlText:h.encodeHtml(),searchBoxParamsChanges:{categories:[s.Id]}}));return v},this.getHtml=function(n,t){var r=[],i;if(n.length>0)for(r.push(v(t)),i=0;i<n.length;i++)r.push(y(n[i],t,i));return r}},et=1,$SB.ContactsMenu=function(n){function rt(){$SB[a]=ut;var n=g(y.picw,{},a);$Network.fetchScript(n,function(){},null)}function ut(n){var i=ft(n);u=new wLive.ContactList.ViewModels.FlatContactsDataModel({picwEmails:i,includeGroups:!1,includeCategories:!1}),$Do.when("$pwc",0,function(){$pwc.callWhenReady(function(){t=new wLive.Search.Indexer(k),t.initialize(u.getMergedContacts(),!1,function(){f=!0})})})}function ft(n){for(var r=[],u=n&&n.SearchResponse&&n.SearchResponse.People?n.SearchResponse.People:[],f=u.length,i,t=0;t<f;t++)i=u[t],i.e&&r.push(i.e);return r}function et(n,i){for(var b=t.normalizeTerm(i),u,v,f,o,y,s,e,p,w,r=0,h=l.length;r<h;r++){var c=l[r],a=c.properties||[],k=c.type;if(k!==d.email)for(u=0,v=a.length;u<v;u++)if(f=a[u],o=n[f](),o&&f!=="sortName")for(y=t.normalizeTerm(o),s=tt(y),e=0,p=s.length;e<p;e++)if(w=s[e],w.startsWith(b))return f}return null}function v(n,t,i,r){return h(p(n),s,function(t){return st(n,r,t)},ht(n),lt(n,t,r),null,!1,"WW_contacts",n,i)}function p(n){var i=n.displayName(),t=n.email();return(i||t||"")+(i&&t?ot(t):"")}function ot(n){return $B.rtl?" - "+n:" ("+n+")"}function st(n,t){var r=e.extractStartingKeywordCommand(i.getValue()),u=r?r.keywordCommand:"",f=b(n,!!t,u);i.searchEmailFunc(f,$SBC.searchOrigin.SuggestionContact)}function b(n,t,i){var f=n.email(),e={},r,o;t&&(r=n.displayName(),r&&n.type()!==wLive.ContactList.ViewModels.ContactType.PicwEmail&&(f="["+r+"]",o=u.getEmailsOfPerson(n.id()),e[r]=o?o.join(" OR "):r));switch(i){case"to:":return{to:f,contactMappings:e};case"from:":return{from:f,contactMappings:e};default:return{keywords:f,contactMappings:e}}}function ht(n){return w(n,p(n),ct(n),o,"c_search_contact_img")}function ct(n){return n.userTile()||o}function lt(n,t,i){var f=n.displayName()||"",u=n.email(),s,e;return i&&(u="",i!=="firstName"&&i!=="lastName"&&i!=="displayName"&&i!=="name"&&i!=="sortName"&&(u=n[i]())),!f&&u&&(f=u,u=""),s=n.userTile()||o,e='<div class="c_search_contact">'+(f?' <div class="c_search_main_text">'+r(f,t)+"<\/div>":"")+(u?' <div class="c_search_sub_text">'+r(u,t,!0)+"<\/div>":"")+"<\/div>",c(e)}var at=this,f=!1,i=n,e=new $SB.MailQueryHelper,k=new wLive.ContactList.ViewModels.ContactsHelper,t=null,u=null,d=wLive.ContactList.ViewModels.SearchablePropertyTypes,l=wLive.ContactList.ViewModels.SearchableProperties,nt=10,o=$SBC.utfb,it=0,a="picwResultsCallback"+it++;this.getMatches=function(n){var r=[],i,u,o;return n&&(i=e.extractStartingKeywordCommand(n),u=i?i.remainingQuery?n:i.keywordParams:n,f&&(o=t.getMatches(u,$SBC.contacts.max*nt),r=o.result)),r},this.getHtml=function(n,t){for(var f=[],c={},o=0,l=$SBC.contacts.max,s=e.extractStartingKeywordCommand(t),h=s?s.remainingQuery?t:s.keywordParams:t,r,u,i=0;i<n.length&&o<l;i++)r=n[i],u=et(r,h),u?c[r.id()]||(f.push(v(r,h,i+1,u)),c[r.id()]=!0,o++):(f.push(v(r,h,i+1,u)),o++);return f},this.isInitialized=function(){return f},this.findAllFromSender=function(n){var t=u.getContactByEmail(n),r;t?(r=b(t,!0,"from:"),i.searchEmailFunc(r,$SBC.searchOrigin.FindAllFromSender)):i.searchEmailFunc({from:n},$SBC.searchOrigin.FindAllFromSender)},rt()},$SB.PeoplePickerMenu=function(n,t){function b(){o=new wLive.ContactList.ViewModels.FlatContactsDataModel({includeGroups:!1,includeCategories:!1,includePeopleWithoutEmails:!0}),$Do.when("$pwc",0,function(){$pwc.callWhenReady(function(){u=o.getMergedContacts(),i=new wLive.Search.Indexer(p),i.initialize(u,!1,function(){f=!0,a&&a()})})})}function k(n,t,i){return h(y(n),s,function(t){return g(n,t)},nt(n),it(n,t),null,!1,"WW_contacts",n,i)}function y(n){var i=n.displayName(),t=n.email();return(i||t||"")+(i&&t?d(t):"")}function d(n){return $B.rtl?" - "+n:" ("+n+")"}function g(n){e.contactOverride&&e.contactOverride(n)}function nt(n){return w(n,y(n),tt(n),l,"c_search_lg")}function tt(n){return n.userTile()||l}function it(n,t){var i=n.displayName()||"",e=n.email(),u="",f;return i&&(u=e),f=i?r(i,t):r(e,t,!0),f+=u&&!$B.rtl?' <span class="c_search_e">('+r(u,t,!0)+")<\/span>":"",c(f)}var rt=this,f=!1,e=n,p=new wLive.ContactList.ViewModels.ContactsHelper,i=null,o=null,l=$SBC.utfb,a=t,u=null,v=9999;this.getMatches=function(n){var t=[],r;return f&&(n?(r=i.getMatches(n,v),t=r.result):t=u),t},this.getHtml=function(n,t){for(var u=[],f={},e=0,r,i=0;i<n.length&&e<v;i++)r=n[i],f[r.id()]||(u.push(k(r,t,i+1)),f[r.id()]=!0,e++);return u},b()},v=function(n){var r=this,f=null,e=n,u=null,o=!1,s=$SB.renderModes,t={},i,h,c;e.renderMode===s.HOTMAIL&&(t.CONTACTS=new $SB.ContactsMenu(n),t.SMARTSUGGESTIONS=new $SB.SmartSuggestionsMenu(n),t.CATEGORIES=new $SB.CategoriesMenu(n)),i=[],e.renderMode===s.HOTMAIL&&(h={header:{title:"",sutraTag:"",isVisibleWithoutMatches:!1,isVisibleWithMatches:!1},subMenus:[t.CONTACTS,t.CATEGORIES,t.SMARTSUGGESTIONS]},i.push(h),c={header:{title:$SBC.advSearchText,sutraTag:"searchboxitem",isVisibleWithoutMatches:!0,isVisibleWithMatches:!0,onClickFunction:new Function("evt","query","searchBox",$SBC.advSearch)},subMenus:[]},i.push(c)),r.dispose=function(){},r.getMenuSectionsConfig=function(){return i},r.getMatches=function(n){var s,t,r,h,e;if(!o)return u=n,!1;for(s=[],t=0;t<i.length;t++){for(r=[],h=i[t],e=0;e<h.subMenus.length;e++){var c=h.subMenus[e],l=c.getMatches(n),a=c.getHtml(l,n);r=r.concat(a)}s.push(r)}return f(s,n),!0},r.initialize=function(n){f=n,o=!0,u&&(r.getMatches(u),u=null)},this.findAllFromSender=function(n){return t.CONTACTS&&typeof t.CONTACTS.findAllFromSender=="function"?(t.CONTACTS.findAllFromSender(n),!0):!1},this.updateMenuData=function(n,i){t[n]&&typeof t[n].updateMenuData=="function"&&t[n].updateMenuData(i)}},$SB.WindowsLiveProvider=v,$SB.bindAllSearchBoxes&&window.$SBC&&$SBC.autoBindSearchBoxes)try{$SB.bindAllSearchBoxes(v,document)}catch(ot){}}(window.originaljQuery||jQuery),WebDialogManager=function(){function n(){if(typeof n.caller!="undefined"&&n.caller!=n.getInstance)throw new Error("Error: There is no public constructor for TooltipManager. Use TooltipManager.getInstance().");this.m_visibleDialog=null}var t=null;return n.getInstance=function(){return t==null&&(t=new n),t},n.prototype.show=function(n){this.hideVisibleDialog(),this.m_visibleDialog=n,n.show()},n.prototype.hideVisibleDialog=function(){this.m_visibleDialog!=null&&(this.m_visibleDialog.hide(),this.m_visibleDialog=null)},n.prototype.isDialogVisible=function(){return this.m_visibleDialog!=null&&this.m_visibleDialog.isShown()},n}(),gShowDialog=function(n){WebDialogManager.getInstance().show(n)},function(n){"use strict";function u(){return{unseen:0,messageList:null}}var t=window.ol=window.ol||{},i=t.vm=t.vm||{},r=wLive.Controls.Notifications,e=t.Accessor,f=i.AutoRefresh=function(i){function h(){t.config&&t.config.autoRefresh&&t.config.autoRefresh.enabled&&window.$Do&&$Do.when("wlxim",0,c),t.Cmd.registerExecutionStrategy(function(n){n.name==="autorefresh"||n.args&&n.args.isAutorefreshing||v()}),t.Cmd("nav.inbox").subscribe(o)}function c(){$WLXIM.addStateListener(e),e()}function e(){if($WLXIM.hasNotify()&&!f){n($WLXIM.user.get_mailbox()).on("emailReceived",l);f=!0}}function l(n,i,r){t.config&&t.config.autoRefresh&&t.config.autoRefresh.enabled&&r&&(u.shouldAutoRefresh()&&a(),r.get_folder()==MC.MailNotificationFolderType.inbox&&u.unseen(u.unseen()+1))}function a(){t.Dispatcher.fireCmd("autorefresh"),o()}function o(){t.inboxFlow&&t.inboxFlow.importProgressIndicator&&t.inboxFlow.importProgressIndicator.getAndUpdateImportProgress()}function v(){u.unseen(0)}var u=this,f,s;u.initAccessorValues(i),f=!1,s=0,u.isShowingNotifications=function(){var n=r.getQueue();return n.getNotificationBars().length>0||n.getModalDialogs().length>0||n.getToasts().length>0||n.getFlyouts().length>0},u.shouldAutoRefresh=function(){return t.pages.pageManager.getCurrentView()===t.config.pageManager.manifests.Inbox.name&&!u.messageList().bulkSelected()&&!WebDialogManager.getInstance().isDialogVisible()&&!u.messageList().queryContainer().isQuickview()&&!u.isShowingNotifications()},h()};t.AddOptionsAccessorAndInitFunctions(f.prototype,u)}(window.originaljQuery||window.jQuery),function(){"use strict";var n=window,u=n.ol=n.ol||{},i=n.ol.lv=n.ol.lv||{},r=i.LiveViewClickReporter=function(){this._hasClickBeenReported={Internal:!1,External:!1}},t;r.prototype={},t=r.prototype,t.dispose=function(){},t._reportClick=function(n,t){if(!this._hasClickBeenReported[n]){this._hasClickBeenReported[n]=!0;var u=i.LiveViews.getHmlvDataElem(t),r=u?u._hmlvData:null;r&&$BSI.reportEvent("lv.click",{LiveViewProvider:r.provider,LiveViewType:r.type,LiveViewTarget:n})}}}(),function(n){var i=window,u=i.ol=i.ol||{},r=i.ol.lv=i.ol.lv||{},t=r.LiveViews;t.hiPriTimeout||(t.hiPriTimeout=50),t.defaultTimeout||(t.defaultTimeout=5e3),t.maxRequestsPending||(t.maxRequestsPending=10),t._queues=[],t._inProgressCount=0,t._hiPriQueueCreated=!1,t._uniqueId=0,t._Queue=function(n){this.onSendRequests=function(n,i,r){this.state=t.QueueState.Done,t.Providers[this.kind].bindCallback(n,i,r);var u=t._queues,f=u.indexOf(this);f>=0&&u.splice(f,1)},this.onSendRequestError=function(n,t){var i=[];t.forEach(function(n){var t=new HM.HMLiveViewResponseObject;t.Id=n.request.Id,t.StatusCode=HM.HMLiveViewResultCode.Failure,this.push(t)},i);this.onSendRequests(i,t)},this.onTimeout=function(){var i,n;i=[],this._items.forEach(function(n){this.push(n.request)},i),this.state=t.QueueState.Waiting,n=this,HM.LFPP=function(){t.Providers[n.kind].fppRequestSender.call(null,i,$CD(n,n.onSendRequests),n._items,$CD(n,n.onSendRequestError),t.fppTimeout)},HM.LFPP()},this.add=function(n){var i=this._items;i.push(n),i.length==t.maxRequestsPending&&(clearTimeout(this.timeout),this.timeout=0,this.onTimeout())},this.kind=n,this.state=t.QueueState.NotSent,this._items=[];var i;t._hiPriQueueCreated?i=t.defaultTimeout:(i=t.hiPriTimeout,t._hiPriQueueCreated=!0),this.timeout=setTimeout($CD(this,this.onTimeout),i)},t._findQueue=function(n,i){for(var f=t._queues,r,u=f.length-1;u>=0;u--)if(r=f[u],r.kind==n&&r.state==i&&r._items.length<t.maxRequestsPending)return r;return r=new t._Queue(n),t._queues.push(r),r},t.processPendingRequests=function(){var n=t._pendingRegistration;t._pendingRegistration=[],n.forEach(function(n){for(var r=n.length,i=0;i<r;i++)t.Providers[n.kind].registerCallback.apply(t,n[i])},null)},t.setupImageFetch=function(n,t,i){var r=document.createElement("IMG");return r.onload=n,r.onerror=t||n,r.onabort=i,r},t.initialize=function(){t._timer&&(clearTimeout(t._timer),t._timer=null);var n=t.Providers[t.Kind.Hotmail];n.bindCallback=t.bindHmlvs,n.registerCallback=t.registerHmlv,n.fppRequestSender=HM.GetHMLiveViews,t.processPendingRequests()},t.registerHmlv=function(n,i){var r=_ge(n.Id),e;if(r!=null){e=n.Id+t._uniqueId++,r.id=n.Id=e,t._setupData(r,"hmlv",i);var s=t.Kind.Hotmail,f=n.Type,h=t.Providers[s],c=h.typeHandlers[f],o=c.resourceSetName;o&&u.init.Load(o).then(function(){if(f=="Attachment"){if(i.binding=t._getHmlvBindingObject(f,r.lastChild,i),i.containerControl&&i.containerControl.onHmlvLoaded)i.containerControl.onHmlvLoaded(i)}else{var u=t._findQueue(t.Kind.Hotmail,t.QueueState.NotSent);u.add({request:n,context:i})}})}},t.bindHmlvs=function(i,r){i.forEach(function(i){for(var e,o,u=null,f=this.length-1;f>=0;f--)if(this[f].request.Id==i.Id){u=r[f].context;break}if(e=_ge(i.Id),e)if(i.StatusCode==HM.HMLiveViewResultCode.Success){if(e.innerHTML=i.Html,o=e.firstChild,t._setupData(o,"hmlv",u),u.binding=t._getHmlvBindingObject(u.type,o,u),u.containerControl&&u.containerControl.onHmlvLoaded)u.containerControl.onHmlvLoaded(u)}else n(e.lastChild).removeClass("Progress").addClass("Error")},r)},t._setupData=function(t,i,r){var u=n(t).closest("["+i+"]").get(0);u["_"+i+"Data"]=r},t._getHmlvBindingObject=function(n,i,u){var f=t.Providers[t.Kind.Hotmail].typeHandlers[n].bindingClassName;return new r[f](i,u.messageId,u.codePage)},t.initialize()}(window.originaljQuery||window.jQuery),function(){"use strict";var t=window,i=t.wLive||{},u=i.Hotmail||{},n=window.ol=window.ol||{},r=n.controlHelpers=n.controlHelpers||{};r.PersistedData=function(n){var t,u,i,r;t=this,t.applicationName=n,t.storeKeyPrefix=n+".PersistedData.",i=window;try{u=i!=i.parent&&i.parent.location.hostname}catch(f){}r=u?i.parent:i,t.dispose=function(){},t.store=function(n,i){var u=t.storeKeyPrefix+n;r[u]=i},t.get=function(n){var i=t.storeKeyPrefix+n;return r[i]}}}(),function(n){"use strict";var t=window.ol=window.ol||{},i=t.controlHelpers=t.controlHelpers||{},r=i.SocialInbox=i.SocialInbox||{};r.SocialInboxActivities=function(r){function o(n){var u,f,i,t;if(u=[],r.isReady())for(f=r.getIfReady(),i=0;i<n.length;i++)t=n[i],f.isFriend(t.SocialNetworkId,t.UserId)&&f.isUserConnected(t.SocialNetworkId)&&u.push(t);return u}function c(t){var i,u,f,r,o,e;if(i=t.Activities,f=[],i)for(r=0;r<i.length;r++)i[r].ActionableError?(o=i[r].SocialNetworkId,n.inArray(o,f)==-1&&f.push(o)):i[r].ResultCode&&i[r].ActivityData&&i[r].ActivityData.Activities&&i[r].ActivityData.Activities[0]&&(e=i[r].ActivityData.Activities[0],u?u.Updated<e.Updated&&(u=e):u=e);return{date:new Date,activity:u,errorNetworks:f}}function l(n,t){var i=f.get(e);i||(i={},f.store(e,i)),i[n]=t}function s(n,t,i){var r=c(n);return r.activity?l(t,r):r=i&&i[t]?i[t]:{date:new Date,activity:null,errorNetworks:r.errorNetworks},r}var u=this;var e="ActivityCache",f=new i.PersistedData("Hotmail"),h=t.config.socialInbox.maxCacheRefreshTime;u.dispose=function(){f&&f.dispose()},u.isFreshActivityAvailable=function(n,t){var i=f.get(e),s=!1;return r.isReady()&&o(t).length===0?s=!0:i&&i[n]&&u.isCachedActivityFresh(i[n])&&(s=!0),s},u.isCachedActivityFresh=function(n){var t,i,r;return t=!1,i=n.date,i&&(r=new Date,t=r.getTime()-i.getTime()<=h),t},u.getActivity=function(n,t,i){var h,c,l;h=f.get(e),u.isFreshActivityAvailable(n,t)?o(t).length==0?i(null):(c=h?h[n]:null,i(c)):r.isReady()?(l=o(t),HM.GetSocialInboxData(l,!1,n,function(t){var r=s(t,n,h);i(r)})):HM.GetSocialInboxData(t,!0,n,function(t){r.buildCache(t);var u=s(t,n,h);i(u)})}}}(window.originaljQuery||window.jQuery),function(n){"use strict";var i=window.ol=window.ol||{},r=i.controlHelpers=i.controlHelpers||{},t=r.SocialInbox=r.SocialInbox||{};t.SocialInboxFriendship=function(n){function e(n){HM.GetSocialInboxData(null,!0,null,function(i){var r=new t.FriendshipCache(i);u.store(f,r),n(r)})}var i=this,f="FriendshipCache",u=new r.PersistedData("Hotmail");i.userAliases=n,i.dispose=function(){u&&u.dispose()},i.clearCache=function(){u.store(f,null)},i.isReady=function(){var n=u.get(f);return!!n},i.getIfReady=function(){var n=null;return i.isReady()&&(n=u.get(f)),n},i.get=function(n){var t=u.get(f);t?n(t):e(n)},i.buildCache=function(n){var i=new t.FriendshipCache(n);u.store(f,i)}},t.FriendshipCache=function(t){var u,r,f;u=this,r=t,u.dispose=function(){},u.isFriend=function(n,t){var i,u,f;return i=!1,u=r?r.Friends:null,u&&(f=u[n],f&&f[t]&&(i=!0)),i},u.isPendingFriend=function(t,i){var f=!1,u=r?r.PendingFriends:null;return u&&u[t]&&n.inArray(i,u[t])!=-1&&(f=!0),f},u.addPendingFriend=function(n,t){r.PendingFriends?r.PendingFriends[n]?r.PendingFriends[n].push(t):r.PendingFriends[n]=[t]:(r.PendingFriends={},r.PendingFriends[n]=[t])},u.isUserSignedUp=function(n){var i=!1,u=r?r.UserConnectionStatus:null,t;return u&&(t=u[n],t&&(t===1||t===2)&&(i=!0)),i},u.isUserConnected=function(n){var i=!1,u=r?r.UserConnectionStatus:null,t;return u&&(t=u[n],t&&t===2&&(i=!0)),i},u.userHasMemberID=function(n,t){var u=!1,f=r?r.UserNetworkMemberIDs:null,i;return f&&(i=f[n],i&&i===t&&(u=!0)),u},f=i.config.socialInbox.pendingAddFriend,f&&f.length>0&&u.addPendingFriend(f[0],f[1])}}(window.originaljQuery||window.jQuery),function(){"use strict";var t=window.ol=window.ol||{},i=t.controlHelpers=t.controlHelpers||{},n=i.SocialInbox=i.SocialInbox||{};n.PeoplePaneManager=function(i){function h(n,t){r._rightRailManager.setPeoplePane(),f.render(n,t)}var r=this;r._rightRailManager=i;var f=null,e=null,u=null,o=null,s=t.config.socialInbox;t.Cmd("loadpeoplepaneresources").subscribe(function(){this.deferred.resolve()}),r.isPeoplePaneEnabled=function(){return s.peoplePaneEnabled},r.isFriendshipCacheReady=function(){return u&&u.isReady()},r.loadFriendshipCache=function(t){u||(u=new n.SocialInboxFriendship([])),u.buildCache({Friends:t.FriendshipCache,UserConnectionStatus:t.UserConnectionStatus,UserNetworkMemberIDs:t.UserNetworkMemberIDs})},r.friendshipCache=function(){return u},r.loadPeoplePaneResources=function(n){if(r.isPeoplePaneEnabled()){var i=t.Cmd("loadpeoplepaneresources").fire().deferred;i.then(function(){n&&n()})}},r.getSelectedMessageThread=function(){return this.currentMessageThread},r.updatePeoplePane=function(i,e,s){this.currentMessageThread=i,r.loadPeoplePaneResources(function(){if(n.PeoplePaneControl){u||(u=new n.SocialInboxFriendship([])),o||(o=new n.SocialInboxActivities(u)),f||(f=new n.PeoplePaneControl(o,u,r._rightRailManager,r));var c=s&&s.socialInboxMemberships;c||t.config.userInformation.isPremiumUser?(e.membershipInfo=c?c[e.senderId.toLowerCase()]:null,h(i.id(),e)):(r._rightRailManager.isRightRailShowing()&&$BSI.reportEvent("Log.PplPn",{PPV:"NoPP"}),r.hide())}})},r.isSentMailUpsellControlAvailable=function(){return n.SentMailUpsellControl!=null},r.showSentMailUpsells=function(t,i){r.isSentMailUpsellControlAvailable()&&(e||(e=new n.SentMailUpsellControl(u,r)),e.render(t,i))},r.hideSentMailUpsells=function(){e&&e.reset()},r.hide=function(){r._rightRailManager.setAdControl(),f&&f.reset()},r.dispose=function(){f&&f.dispose(),f=null,e&&e.dispose(),e=null,o&&o.dispose(),o=null,u&&u.dispose(),u=null}}}(window.originaljQuery||window.jQuery),function(n,t){"use strict";var i={init:function(n){var i=this;i.data=n.ctx.autoRefresh,t.observable.simpleOn(i.data,"propertyChange",function(n,t){if(t.path==="Unseen")i.onUnseenCountChange(t.value)})},render:function(){return this.tagCtx.render(this.data)},onUnseenCountChange:function(t){this._titleTmpl||(this._titleTmpl=n.config.autoRefresh.titleTmpl),this._titleDefault||(this._titleDefault=n.config.autoRefresh.titleDefault);var i=t===0?this._titleDefault:this._titleTmpl.format(t);document.title!=i&&(document.title=i),t===0?this.clearOverlayIcon():this.setOverlayIcon([App.config.imgSvrUrl,"OLNewmail_",t>9?"x":t,".ico"].join(""),i)},setOverlayIcon:function(n,t){try{typeof window.external.msIsSiteMode!="undefined"&&window.external.msIsSiteMode()&&window.external.msSiteModeSetIconOverlay(n,t)}catch(i){}},clearOverlayIcon:function(){try{typeof window.external.msIsSiteMode!="undefined"&&window.external.msIsSiteMode()&&window.external.msSiteModeClearIconOverlay()}catch(n){}}};t.views.tags({newMailNotificationControl:i})}(window.ol,window.originaljQuery||window.jQuery),function(n,t){"use strict";var u=n.vm,i="printMessageTemplate",r={templateId:i,template:t.templates("#"+i),attr:"html",render:function(){return this.tagCtx.render(this.data)}};t.views.tags({printMessageControl:r}),n.markControlAsLoaded("printMessageControl")}(window.ol,window.originaljQuery||window.jQuery),function(n){"use strict";var t=window.ol=window.ol||{},i=t.vm=t.vm||{},r=i.DemandPrefetch=function(i){function r(){t.Dispatcher.unregister(r,e),f=!1}function s(n){for(var v=!1,i,h,y,l,a,s,p,w,c=0;c<u.Items.length;c++){for(i=u.Items[c],h=0;h<i.Items.length;h++)if(y=i.Items[h],n.Id===y.Id){for(l=[],a=h+1,f&&r(),s=a;s<a+o&&s<i.Items.length;s++)p=i.Items[s].Id,w=i.viewId()&&t.data.isFolderId(i.viewId())?i.viewId():null,l.push(new HM.createItemListQuery({containerId:p,containerType:HM.ItemListQueryContainerType.Conversation,folderId:i.Items[s].folderId()||w||t.config.sysFldrs.inboxFid,prefetch:!0}));l.length>0&&(f=!0,t.Dispatcher.register(l,r,e,r),setTimeout(function(){t.Dispatcher.fireCmd("get")},10)),v=!0;break}if(v)break}}function h(n,t){if(t.path==="Thread"){var i=t.value;i&&s(i)}}function c(){u=i.messageList,n.observable.simpleOn(i.readMessage,"propertyChange",h)}var e=this,o=t.config.appSettings.numberOfMessagesToDemandPrefetch,u=null,f=!1;c()}}(window.originaljQuery||window.jQuery),function(){"use strict";var u=window.ol=window.ol||{},n=ol.data=ol.data||{},t=n.fpp=n.fpp||{},i=t.FppEngine,f=window.ActionQueue,r=window.ActionQueueTypes.ActionType;i.registerFppConfig("prefetchmessages",{fppMethod:"PrefetchMessages",tokenConfig:{friendlyName:"PrefetchMessages",actionType:r.prefetch,getTokenKeys:function(t,i){for(var u=[],f=n.FppUtils.getMessageAndConversationQueries(i.itemListQueries),r=0;r<f.length;r++)u.push(f[r].containerId);return u}},cmdArgs:[]})}(),function(n){"use strict";function r(n){return{queries:[],numberOfMessagesToPrefetch:n?null:t.config.appSettings.numberOfMessagesToPrefetch}}var t=window.ol=window.ol||{},i=t.vm=t.vm||{},f=t.Accessor,u=i.Prefetch=function(i){function u(){t.Dispatcher.unregister(r.apply,r),t.Dispatcher.unregister(u,r)}function f(){i.messageListQueries&&r.setQueries(i.messageListQueries)}var r=this;r.initAccessorValues(i),r.apply=function(i,f){var a=!0,v,s,c,l,e;for(v in f)if(f[v].status===HM.Status.IncompleteNone){a=!1;break}var o=[],h={},y={};if(a){for(e=0;e<r.Queries.length;e++)for(s=f[r.Queries[e].key()],o=n.merge(o,s.itemIds),h=n.extend(h,s.itemsTable),c=0;c<s.itemIds.length;c++)y[s.itemIds[c]]=s.query.containerId||t.config.sysFldrs.inboxFid;for(o.sort(function(n,t){var i=h[n],r=h[t],u=new Date(i.timestamp),f=new Date(r.timestamp);return f-u}),l=[],e=0;e<r.NumberOfMessagesToPrefetch&&e<o.length;e++)l.push(new HM.createItemListQuery({containerId:o[e],containerType:HM.ItemListQueryContainerType.Conversation,folderId:y[o[e]],prefetch:!0}));l.length>0?(t.Dispatcher.register(l,u,r,u),t.Dispatcher.fireCmd("get")):u()}},r.setQueries=function(n){var i,f,e;for(r.Queries&&t.Dispatcher.unregister(r.apply,r),i=[],f=0;f<n.length;f++)n[f].sortType===HM.SortBy.Date&&(e=HM.createMessageGroupQuery(n[f],!0),e.dataHash="",i.push(e));return r.queries(i),i.length>0&&(t.Dispatcher.register(i,r.apply,r,u),t.Dispatcher.fireCmd("get")),null},f()};t.AddOptionsAccessorAndInitFunctions(u.prototype,r)}(window.originaljQuery||window.jQuery),function(n){"use strict";function u(){return{silentReauthUrl:null,reauthBounceUrl:null}}var t=window.ol=window.ol||{},r=t.vm=t.vm||{},e=t.data=t.data||{},i=wLive.Controls.Notifications,o=t.Accessor,f=r.ServerMessages=function(r){function h(n,t,r,u,f){i.createTopBar({content:n,dismissalMode:f,buttons:{alternate:t&&t.text,action:r&&r.text,close:u}}).show().then(function(state){state.buttonClicked==="alternate"?($BSI.navigateTo(t.url,t.openInNewWindow?"_blank":null),t.onClick&&eval(t.onClick)):state.buttonClicked==="action"&&($BSI.navigateTo(r.url,r.openInNewWindow?"_blank":null),r.onClick&&eval(r.onClick))})}function c(){f=HM.createServerMessagesQuery({serverMessageType:HM.ServerMessageType.FppErrorUi}),e=HM.createServerMessagesQuery({serverMessageType:HM.ServerMessageType.ServerErrorMessage}),o=HM.createServerMessagesQuery({serverMessageType:HM.ServerMessageType.NotificationInfo}),s=HM.createServerMessagesQuery({serverMessageType:HM.ServerMessageType.UnsatisfiedQueryError});var n=[f,e,o];t.Dispatcher.register(n,u.apply,u),t.Dispatcher.register([s],u.apply,u),t.config.pageManager.manifests.Inbox!=null&&t.pages.pageManager.getCurrentView()===t.config.pageManager.manifests.Inbox.name&&setTimeout(function(){t.Dispatcher.fireCmd("get")},0)}var u=this,f,e,o,s;u.initAccessorValues(r),u.apply=function(r,c){var y=c[f.key()]&&c[f.key()].fppErrorUi,a=c[e.key()]&&c[e.key()].serverErrorMessage,l=c[o.key()]&&c[o.key()].notificationInfo,d=c[s.key()]&&c[s.key()].unsatisfiedQueryError,p,v,k;if(d)p=HM.createServerErrorMessageLink({text:t.GetString("Error.Server.UnsatisfiedQuery.RefreshButton"),url:t.baseMailUrl()}),h(t.GetString("Error.Server.UnsatisfiedQuery.ErrorMessage"),p,null,t.GetString("DhtmlAlerts.CloseBox.AltText"),i.BarDismissalMode.Explicit);else if(y)y.errorCode&&parseInt(y.errorCode,16)===HM.ServiceError.Authentication_PassportFailure?(u.silentReauthUrl(null),u.silentReauthUrl(t.GetAppConfig("silentReauthUrl")),u.reauthBounceUrl(null),u.reauthBounceUrl(t.GetAppConfig("reauthBounceUrl"))):h(y.errorMessage,null,null,t.GetString("DhtmlAlerts.CloseBox.AltText"),i.BarDismissalMode.Explicit);else if(a&&a.serverErrorMessageString){var w=i.getQueue().getNotificationBars(),g=w[0]?n(w[0].content()).find(".UserContent").html():null,b=a.serverErrorMessageString;b!==g&&(v=a.link1,k=a.link2,h(b,v,k,v&&t.GetString("DhtmlAlerts.CloseBox.AltText"),v&&v.text?i.BarDismissalMode.Explicit:i.BarDismissalMode.Timeout))}else l&&i.createBottomBar(l.NotificationJsonArgs).show().then(function(n){n.buttonClicked==="action"&&(t.data.dataCommands.indexOf(l.CommandName)!==-1?t.Dispatcher.fireCmd(l.CommandName,l.CommandJsonArgs):t.Cmd(l.CommandName).fire(l.CommandJsonArgs))})},c()};t.AddOptionsAccessorAndInitFunctions(f.prototype,u)}(window.originaljQuery||window.jQuery),function(){"use strict";var n=window.ol=window.ol||{},i=n.vm=n.vm||{},r=n.data=n.data||{},t=wLive.Controls.Notifications,u=i.ServerQueryInvalidation=function(){function u(){n.Dispatcher.register([r],i.apply,i,null)}var i=this,r=HM.createServerInvalidationQuery();i.apply=function(i,u){var s=u[r.key()],e=s.serverInvalidQueryType,o=!0,f;e&HM.ServerInvalidQueryType.ConversationNotFound||e&HM.ServerInvalidQueryType.MessageNotFound?f=n.GetString("Multibrowser.MessageMoved"):e&HM.ServerInvalidQueryType.QueryMessagesFolderNotFound?f=n.GetString("Multibrowser.FolderMoved"):e&HM.ServerInvalidQueryType.QueryMessagesAnchorMessageNotFound?f=n.GetString("Multibrowser.AnchorMoved"):o=!1,f&&t.createTopBar({content:f,dismissalMode:t.BarDismissalMode.Explicit,buttons:{close:n.GetString("DhtmlAlerts.CloseBox.AltText")}}).show(),o&&setTimeout(function(){n.Dispatcher.fireCmd("refresh")},0)},u()}}(),function(n,t){"use strict";var i="reauthenticationTemplate",r=t.templates(null,{markup:"#"+i}),u={templateId:i,template:r,attr:"html",init:function(n){this.data=n.ctx.serverMessages},render:function(){return this.tagCtx.render(this.data)},onImageLoadError:function(){var t=this;t.data.SilentReauthUrl&&(n.auth.silentReauthCompleted(this,t.data.SilentReauthUrl,t.data.ReauthBounceUrl,!0,n.GetString("Error.Global.PassportSessionTimedOut"),n.GetString("Error.Button.Login"),n.GetAppConfig("refreshAuthUrl")),t.data.silentReauthUrl(null),t.data.reauthBounceUrl(null))}};t.views.tags({reauthenticationControl:u}),n.markControlAsLoaded("reauthenticationControl")}(window.ol,window.originaljQuery||window.jQuery),function(n){"use strict";function r(n,i,r,u,f){var e=new Image;e.onload=e.onerror=function(){t.auth.silentReauthCompleted(e,n,i,!1,r,u,f)},e.src=n}var t=window.ol=window.ol||{},i=window.wLive||{};t.auth={silentReauthCompleted:function(t,u,f,e,o,s,h){var l=n("#bounceIfr"),c;t.width===1&&l[0]?l.attr("src",f):e?r(u,f,o,s,h):(c=i.Controls.Notifications.createModalDialog({content:o,buttons:{action:s}}),n(c).bind({"aftershow.dialog":function(){n(c.getButton({buttonName:"action"})).click(function(){n(c).unbind(".dialog"),$BSI.navigateTo(h,"_blank")})}}),c.show())}}}(window.originaljQuery||window.jQuery),function(n,t){"use strict";function h(n,t){var i=t.folderList.getArchiveFolder();i.showCount(!1),n.data.moveMessagesToArchiveFolder({archiveFolder:i,selectedThreads:t.selectedThreads,unflag:t.unflag,isBulkSelected:t.isBulkSelected,entryPoint:t.entryPoint,isMessagePartAction:t.isMessagePartAction})}function c(){}function u(){var n=_ge("archiveDialogUpdateFolderId"),i=n&&(n.checked||n.value==="do"),t=_ge("archiveDialogAddFolderId"),r=t&&(t.checked||t.value==="do");return i||!r}function i(n,t){t.prop("disabled",u()?!n.data.SelectedFolder:!1)}function f(n,t){n.dismiss(),t.selectedFolder(null)}function l(t){var i=t.getNumberOfCustomFolders()<n.GetAppConfig("maximumCustomFolderCount"),r=t.getTopLevelContainerByName(n.GetString("Archive.ArchiveFolder.Name"),!0);return i&&!r}function a(n,r){var o,e,s;return o=r.folderList.getArchiveFolder(),e=t.Deferred(),o?e.resolve():(n.showingArchiveDialog=!0,s=function(){var o=DemandLoadHandler.getContent(HM.ContentId.ArchiveDialog),h=r.folderList.topLevelCustomFolders().length>0,c=l(r.folderList),a={desc:o.dialogDescription,optionUpdate:o.dialogOptionUpdate,optionAdd:o.dialogOptionAdd,showUseExisting:h,showCreateNew:c},v=t("<div><\/div>").link(t.templates("#archiveDialogTmpl"),a,n.ctx),s=wLive.Controls.Notifications.createModalDialog({title:o.dialogTitle,content:v,buttons:{action:o.dialogButtonOk,close:o.dialogButtonCancel},options:{dismissOnButtonClick:!1}});t(s).on("beforeshow.dialog",function(){var r=s.getButton({buttonName:"action"});i(n,r),t.observable.simpleOn(n.data,"propertyChange",function(t,u){u.path==="SelectedFolder"&&(n.createOrUpdateFolderSelector(),i(n,r))})}).on("aftershow.dialog",function(){t("#archiveDialogAddFolderId, #archiveDialogUpdateFolderId").click(function(){var t=s.getButton({buttonName:"action"});i(n,t)})}).on("buttonclick.dialog",function(t,i,r){var o=n.data,h,c;if(r==="close")f(s,o);else if(r==="action"){var v=o.folderList(),y=u(),l=function(){e.resolve(),f(s,o)},a=function(){e.reject()};y?(h=o.selectedFolder(),h&&(c=o.folderList().getContainerById(h),c.editEntryPoint(HM.InstrumentationEntryPoint.Notification),o.updateFolderContainerToArchive({folderContainer:c}).then(l,a))):o.addArchiveFolderContainer({containerList:v,containerOptions:{editEntryPoint:HM.InstrumentationEntryPoint.Notification,isEditing:!1}}).then(l,a)}}).on("afterdismiss.dialog",function(){n.showingArchiveDialog=!1});s.show()},DemandLoadHandler.demandLoadContent([HM.ContentId.ArchiveDialog],[s],[],!1)),e.promise()}var e=n.vm,r="archiveModalDialog",o=t.templates(null,{markup:"#"+r}),s={templateId:r,template:o,attr:"html",init:function(n){var t=this;t.data=n.ctx.archive,t.createOrUpdateFolderSelector()},render:function(){var n=this;return n.tagCtx.render(n.data)},folderSelector:function(t){return n.Accessor(this,"FolderSelector",t)},getFolderSelectorTitle:function(){var t=this.data,i=n.GetString("FolderList.DefaultNoSelection"),r=t.selectedFolder();return r&&(i=t.folderList().getContainerById(r).name()),i},createOrUpdateFolderSelector:function(){var t=this,i=t.folderSelector();i?i.title(t.getFolderSelectorTitle()):t.folderSelector(new e.ContainerSelector({key:"folder",containerList:t.data.folderList(),title:t.getFolderSelectorTitle(),isMultiSelect:!1,menuType:n.ContainerPickerEnums.MenuType.MoveTo,menuTag:"InboxToolbarMoveToItem",filterFn:function(n){return n.isTopLevelCustomFolder()||n.IsEditing},showSelectionState:!1,entryPoint:HM.InstrumentationEntryPoint.Notification}))},beginArchiveFlow:function(t){var i=this;i.showingArchiveDialog||a(i,t).then(function(){h(i,t)},c)},onCmdBubble:function(n,t,i){i&&i.key==="folder"&&t.name==="cs.select"&&this.data.selectedFolder(i.selection)}};t.views.tags({archiveControl:s})}(window.ol,window.originaljQuery||window.jQuery),function(){"use strict";function u(){return{folderList:null,selectedFolder:null}}var n=window.ol=window.ol||{},e=n.data=n.data||{},i=n.vm=n.vm||{},r=n.Accessor,f=i.Archive=function(t){var i=this;i.initAccessorValues(t),i.moveMessagesToArchiveFolder=function(t){var i=t.archiveFolder&&t.archiveFolder.id();return i&&(t.isBulkSelected?n.Cmd("bulkactionbycontainer").fire({action:"archive",destId:i,entryPoint:t.entryPoint}):n.vm.MessageThread.performActionOnThreads("movetoarchive",t.selectedThreads,{folderId:i,unflag:t.unflag,entryPoint:t.entryPoint},t.isMessagePartAction)),i},i.addArchiveFolderContainer=function(t){var i=t.containerList.RootContainer.newItem(t.containerOptions);return i.addUpdateFolder({newName:t&&t.folderName||n.GetString("Archive.ArchiveFolder.Name"),isArchive:!0})},i.updateFolderContainerToArchive=function(n){return n.folderContainer.addUpdateFolder({isArchive:!0})}},t=f.prototype;n.AddOptionsAccessorAndInitFunctions(t,u),t.folderList=function(t){var i=this;return r(this,"FolderList",t,function(){return i.FolderList||i.folderList(new n.vm.ContainerList({newItemLabel:null,title:null,type:HM.ContainerType.Folders,rootContainer:new n.vm.Container({id:n.config.sysFldrs.noneFid,depth:0})})),i.FolderList})}}(),function(n){var r=window,t,i;t=window.ol=window.ol||{},i=t.controlHelpers=t.controlHelpers||{},function(){i.AdbarEventMgr=function(){var i=this,r={contextChange:"1"},t={};i.addEventListener=function(n,i){n&&i&&typeof i=="function"&&r[n]&&(t[n]||(t[n]=[]),t[n].push(i))},i.removeEventListener=function(n,i){n&&i&&typeof i=="function"&&t[n]&&t[n].remove(i)},i.fire=function(i){if(i&&r[i]&&t[i]){var u=Array.prototype.slice.call(arguments,1);n.each(t[i],function(){try{this.apply(window,u)}catch(n){}})}}}}(),function(){var n=window;i.AdbarPublisher=function(i){var r=this;r._adBar=i,r.sendMail=function(n,i,r){i&&r&&t.Cmd("begincomposesession").fire({action:"newmessage",composeData:{Subject:i,MessageBody:r,To:n},entryPoint:HM.InstrumentationEntryPoint.Canvas,curView:t.Instrumentation.currentView(),numParticipants:0,priority:HM.InstrumentationPriority.Normal,composeLoaded:t.Instrumentation.composeLoaded(),isFullCompose:!0})},r.loadDependencies=function(t,i,r,u){t=t||[],i=i||[],(t.length>0||i.length>0)&&Loader.load({js:i,css:t},function(){if(r)try{r.apply(n)}catch(t){}},function(){if(u)try{u.apply(n)}catch(t){}})},r.stateChangeListener=function(n){n&&r._adBar.updateState(n)},r.adLoaded=function(){r._adBar._onAdLoaded()}}}(),function(){var y=window,u=window.ol=window.ol||{},c=u.controlHelpers=u.controlHelpers||{},f,r=!1,e,i,l,o,p=!0,w,t,b,a,s,v=!1,h,g=600,k=160,nt=10,d="DisplayNone";c.Adbar=function(tt){function rt(t){if(!b){h||(h=n("#RightRailContainer"));var i="adbaroverride";t==="expanded"?h.addClass(i):h.removeClass(i)}}function et(){it.adbarEventMgr=new c.AdbarEventMgr,it.adbarPublisher=new c.AdbarPublisher(it),u.config&&u.config.adbar&&_ge(u.config.adbar.divId)&&(f=!0,t=u.config.adbar,b=y.Page&&Page.getLayout().indexOf("Unmanaged")>=0,a=n("#RightRailContainer"),o=ut(),e=!1,i=n("#"+t.divId),i.attr("ht",o),l={Width:k,Height:o,Market:t.mkt,Environment:t.env,ContainerID:t.divId,EventManager:it.adbarEventMgr,PublisherObject:it.adbarPublisher,BaseUrl:t.baseurl,ProductType:t.prodtype},t.init&&($CSIPerf.addTTxEvent("adC",(new Date).getTime()),it.adbarPublisher.loadDependencies(null,[t.baseurl+t.defscr],function(){ot(),$Do.register("$Adbar.TriedDependencies")},function(){$Do.register("$Adbar.TriedDependencies")}),ft("initialized")),$Flextag.load())}function ot(){y.wLive&&wLive.adbar&&(e=!0,window.GETADR=n.noop,wLive.adbar.init(l),setTimeout(function(){$Do.when("$RightRailManager.Loaded",0,function(){it._rightRailManager.isAdControlShowing()?(wLive.adbar.show(),s=new Date):(p=!1,r=!0)})},t.initDelay))}function st(){if(f&&e&&!r){var n=ut();n>0&&Math.abs(n-o)>nt&&(o=n,wLive.adbar.resize(k,n),i.attr("ht",n))}}function ut(){var n=-1;return a.get(0)&&(n=a.outerHeight()),n>0?n:g}function ft(n){$BSI.reportEvent("AdBar.View",{AdBarAction:n})}var it=this;it._rightRailManager=tt,it.show=function(){i&&r&&(i.removeClass(d),r=!1,e&&(wLive.adbar.show(),it.resize()))},it.hide=function(){i&&!r&&(i.addClass(d),r=!0,e&&wLive.adbar.suspend())},it.refresh=function(i,u){var o,h;if(f&&e&&i&&!r&&(o=new Date,!s||!(o.getTime()-s.getTime()<t.refmsec))){s=o,h={SDN:"",SCT:""};try{u&&(h=n.parseJSON(u))}catch(c){}l.EventManager.fire("contextChange",i,h)}},it.dispose=function(){f&&(f=!1)},it.updateState=function(n){f&&n&&(n==="default"?rt(n):n==="expanded"&&rt(n))},it.resize=function(){v||(v=!0,setTimeout(function(){try{st()}finally{v=!1}},50))},it._onAdLoaded=function(){w||(w=!0,$Do.register("$Adbar.Loaded"),p&&$CSIPerf.addTTxEvent("adR",(new Date).getTime()),ft("loaded"),i.attr("loaded","success"))},setTimeout(et,0)}}()}(window.originaljQuery||window.jQuery),function(){"use strict";var t=window.ol=window.ol||{},n=t.WLDate=function(n,t,i,r,u,f){var o,e;this._isEndOfDay=!1,o=arguments.length;switch(o){case 0:e=new Date,this.JSDate=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));break;case 1:this.JSDate=new Date(n);break;case 3:this.JSDate=new Date(Date.UTC(n,t,i));break;case 4:this.JSDate=new Date(Date.UTC(n,t,i,r));break;case 5:this.JSDate=new Date(Date.UTC(n,t,i,r,u));break;case 6:this.JSDate=new Date(Date.UTC(n,t,i,r,u,f))}};n.prototype.valueOf=function(){return this.JSDate.valueOf()},n.prototype.toRRUDateString=function(){var n=this.getMonth(),t=this.getDate(),i=this.getHours(),r=this.getMinutes(),u=this.getSeconds();return n++,n<10&&(n="0"+n),t<10&&(t="0"+t),i<10&&(i="0"+i),r<10&&(r="0"+r),u<10&&(u="0"+u),"{0}{1}{2}T{3}{4}{5}Z".format(this.getFullYear(),n,t,i,r,u)},n.prototype.setHours=function(n,t,i,r){return arguments.length==1?this.JSDate.setUTCHours(n):arguments.length==2?this.JSDate.setUTCHours(n,t):arguments.length==3?this.JSDate.setUTCHours(n,t,i):arguments.length==4&&this.JSDate.setUTCHours(n,t,i,r),this},n.prototype.setTime=function(n){this.JSDate.setTime(n)},n.prototype.setMinutes=function(n){this.JSDate.setUTCMinutes(n)},n.prototype.setDate=function(n,t,i){arguments.length==1?this.JSDate.setUTCDate(n):arguments.length==3&&(this.JSDate.setUTCDate(1),this.JSDate.setUTCFullYear(n),this.JSDate.setUTCMonth(t),this.JSDate.setUTCDate(i))},n.prototype.setMonth=function(n){this.JSDate.setUTCMonth(n)},n.prototype.setYear=function(n){this.JSDate.setUTCFullYear(n)},n.prototype.getTime=function(){return this.JSDate.getTime()},n.prototype.getHours=function(){return this.JSDate.getUTCHours()},n.prototype.getMinutes=function(){return this.JSDate.getUTCMinutes()},n.prototype.getDay=function(){return this.JSDate.getUTCDay()},n.prototype.getMonth=function(){return this.JSDate.getUTCMonth()},n.prototype.getDate=function(){return this.JSDate.getUTCDate()},n.prototype.getSeconds=function(){return this.JSDate.getUTCSeconds()},n.prototype.getYear=function(){return this.JSDate.getUTCFullYear()},n.prototype.getFullYear=function(){return this.JSDate.getUTCFullYear()},n.prototype.moveToStartOfDay=function(){if(this.isEndOfDay()){var t=this.JSDate.getTime();this.setTime(t-1*n.MillesecondsInADay),this._isEndOfDay=!1}return this.JSDate.setUTCHours(0,0,0,0),this},n.prototype.moveToEndOfDay=function(){if(!this.isEndOfDay()){this.moveToStartOfDay();var t=this.JSDate.getTime();this.setTime(t+1*n.MillesecondsInADay),this._isEndOfDay=!0}return this},n.prototype.isStartOfDay=function(){return this.getHours()==0&&this.getMinutes()==0&&this.getSeconds()==0},n.prototype.isEndOfDay=function(){return this._isEndOfDay},n.prototype.moveToStartOfWeek=function(){this.moveToStartOfDay();var t=this.getDay()-n.FirstDayOfWeek;t<0&&(t+=n.NumberOfDaysInWeek),this.setTime(this.getTime()-t*n.MillesecondsInADay)},n.prototype.addMinutes=function(t){var r=this.JSDate.getTime(),i=this.clone();return i.setTime(r+t*n.MillesecondsInAMinute),i},n.prototype.addDays=function(t){var r=this.JSDate.getTime(),i=this.clone();return i.setTime(r+t*n.MillesecondsInADay),i},n.prototype.addMonths=function(n){var i=this.getMonth()+n,t=this.clone();return t.setMonth(i),t},n.prototype.addTime=function(n){var i=this.getHours()+n.getHours(),r=this.getMinutes()+n.getMinutes(),u=this.getSeconds()+n.getSeconds(),t=this.clone();return t.setHours(i,r,u),t},n.prototype.clone=function(){var t=new n(this.JSDate.valueOf());return t._isEndOfDay=this._isEndOfDay,t},n.prototype.isBetween=function(n,t){return this.JSDate.valueOf()>=n.valueOf()&&this.JSDate.valueOf()<=t.valueOf()?!0:!1},n.parseDate=function(t){var c=n,p="[\\s"+c.DateSeparator+"]+",l=new RegExp(p),u=t.split(l),o=c.ShortDatePattern.toLowerCase().split(l),i,a,r,s,h,e;if(u.length!=o.length)return null;if(i=c.parseDate.componentIndexes,a=0,!i)for(i={},r=0;r<o.length;r++)switch(o[r].charAt(0)){case"y":for(i.year=r,s=1;o[r].charAt(s)=="y";)s++;a=s;break;case"m":i.month=r;break;case"d":i.day=r}if(isNaN(parseInt(u[i.year]))||isNaN(parseInt(u[i.month]))||isNaN(parseInt(u[i.day])))return null;var v=u[i.month]-1,y=new Number(u[i.day]),f=parseInt(u[i.year],10);return f<0?null:(f<100&&(h=2029,f+=h-h%100,f>h&&(f-=100)),e=new n(f,v,y),f!=e.getYear()||v!=e.getMonth()||y!=e.getDate())?null:e},n.parseTime=function(t){var s=n,i=t.toLowerCase(),v=s.AMDesignator.toLowerCase(),y=s.PMDesignator.toLowerCase(),u="a",f="p",e,o,h=s.TimeSeparator,c=function(t,i,r){var h=new n,s=Number(t[1]),c=0;return t.length-1==r&&t[r]&&(e=t[r]==u,o=t[r]==f),s<12&&o?s+=12:s==12&&e&&(s=0),i&&(c=Number(t[2])),h.setHours(s,c,0,0),h},l=[{pat:"(\\d{1,2})"+h+"(\\d{1,2})"+h+"(\\d{1,2})\\s*(["+u+f+"])*",handler:function(n){return c(n,!0,4)}},{pat:"(\\d{1,2})"+h+"(\\d{1,2})\\s*(["+u+f+"])*",handler:function(n){return c(n,!0,3)}},{pat:"(\\d{1,2})\\s*(["+u+f+"])*",handler:function(n){return c(n,!1,2)}}],r,a;for(e=i.indexOf(v)>=0,o=i.indexOf(y)>=0,e&&(i=i.replace(v,"")),o&&(i=i.replace(y,"")),r=0;r<l.length;r++)if(a=new RegExp(l[r].pat).exec(i),a)return l[r].handler(a);return null},n.getDayDifference=function(t,i){return Math.floor((i.getTime()-t.getTime())/n.MillesecondsInADay)},n.getMinuteDifference=function(n,t){return(t.getTime()-n.getTime())/6e4},n.getTotalDaySpan=function(t,i){var f=new n(t),r=new n(i),e=r.isStartOfDay()?0:1,u;return f.moveToStartOfDay(),r.moveToStartOfDay(),u=n.getDayDifference(f,r)+e,u==0?1:u},n.NumberOfDaysInWeek=7,n.MillesecondsInADay=864e5,n.MinutesInADay=1440,n.SecondsInADay=86400,n.MillesecondsInAMinute=6e4,n.FirstDayOfWeek=0,$Do.register("$DCReady")}(),function(n){"use strict";var t=window.ol=window.ol||{},i=t.controlHelpers=t.controlHelpers||{};i.DatePickerController=function(i){function o(n,t,i){i!="0"&&r._delegate.initiateJumptoNavigation(t)}function s(){var t=function(){return r.doCommand("ShowNext"),!1},i=function(){return r.doCommand("ShowPrevious"),!1},u=function(){return r.doCommand("ShowCurrent"),!1};n("#PrevMonthContainer").click(i),n("#NextMonthContainer").click(t),n("#TodayContainer").click(u)}var r=this,f=null;r.$=function(){return f||(f=n(r))};var u=null,e=null;r._delegate=i,r.init=function(n,t){e=t,u=n,u.$().bind("monthgriddayclicked",o),s()},r.dispose=function(){u.$().unbind(),n("#PrevMonthContainer").unbind(),n("#NextMonthContainer").unbind(),n("#TodayContainer").unbind()},r.doCommand=function(n){switch(n){case"ShowPrevious":u.showPreviousDate();break;case"ShowNext":var i=u.getDate(),r=new t.WLDate;i.getMonth()==r.getMonth()&&i.getFullYear()==r.getFullYear()||u.showNextDate();break;case"ShowCurrent":u.showDate((new t.WLDate).moveToStartOfDay())}}}}(window.originaljQuery||window.jQuery),function(n){"use strict";var t=window.ol=window.ol||{},i=t.controlHelpers=t.controlHelpers||{};i.DatePickerView=function(){function e(r,f){_ge("PrevMonthLink").innerText=f.PrevMonthString,_ge("CurrMonthLink").innerText=f.DateString,_ge("NextMonthLink").innerText=f.NextMonthString,_ge("TodayLink").innerText=f.TodayString;var e=i.getDate(),o=new t.WLDate;e.getMonth()==o.getMonth()&&e.getFullYear()==o.getFullYear()?n("#NextMonthLink").removeClass("MonthLinkEnabled").addClass("MonthLinkDisabled"):n("#NextMonthLink").removeClass("MonthLinkDisabled").addClass("MonthLinkEnabled"),u.highlightSelectedCell()}var r=this,f=null,i,u;r.$=function(){return f||(f=n(r))},i=null,u=null,r.init=function(n,t){i=n,u=t,i.$().bind("viewchanged",e)},r.dispose=function(){i.$().unbind(),i=null,u=null}}}(window.originaljQuery||window.jQuery),function(n){"use strict";var i=window.ol=window.ol||{},t=i.controlHelpers=i.controlHelpers||{};t.MessageListGotoPickerHelper=function(r,u){function et(){rt(d,st)}function ot(){rt(g,ht)}function rt(n,t){DemandLoadHandler.demandLoadContent([n],[t])}function st(){var u=DemandLoadHandler.getContent(d),n,r;n="datePickerParentContainer",ut(u,n),y=_ge(n),e=null,l=null,a=null,r={cacheType:t.MiniCalendarModelCache.CacheType.Month,containerElement:_ge("GotoDatePickerMonthGridContainer"),monthcache:_ge("GotoDatePickerCacheContainer"),uniqueidentifier:"DTDP"},e=new t.MiniCalendarViewControl,e.init(r),e.setFetchAdditionalContent(!0),e.setMonthGridEndDate(new i.WLDate),l=new t.DatePickerView,l.init(e,f),a=new t.DatePickerController(f),a.init(e,l),nt=!0,k(b)}function ht(){var i=DemandLoadHandler.getContent(g),t;t="alphaPickerParentContainer",ut(i,t),p=_ge(t),w=n("#AlphaGrid").click(ct),tt=!0,k(b)}function ut(t,i){n("<div><\/div>").attr("id",i).addClass("c_mcp").html(t).insertAfter(".gotoDockContainer")}function ct(t){var i=n(t.target),r;return i&&i.is("a")&&(r=i.html(),i.parent().attr("id",r),r&&f.initiateJumptoNavigation(r)),!1}function k(t){s==o.DatePicker?h=y:s==o.AlphaPicker&&(h=p),f.highlightSelectedCell(),f._$dockElt||(f._$dockElt=n("<div><\/div>").appendTo(".gotoDockContainer").css({"z-index":"-1",position:"absolute"}));var i=n(t.target);f._$dockElt.height(i.outerHeight()).width(i.outerWidth()).offset(i.offset());try{$menu.create(it,3,{forceDispose:1,parentEl:h,dockEl:f._$dockElt[0]})}catch(r){}return!1}var f=this;f.delegate=r;var ft=u,d=HM.ContentId.GotoDatePicker,g=HM.ContentId.GotoAlphaPicker,s=null,nt=!1,tt=!1,h=null,y=null,p=null,c=null,v=null,l=null,a=null,e=null,w=null,b=null,it=null,o=t.MessageListGotoPickerHelper;o.DatePicker="datePicker",o.AlphaPicker="alphaPicker",f.launchGotoPicker=function(t,i){s=t,b=i,it=n.extend({},i.originalEvent),n(".gotoDockContainer").get(0)||n("<div><\/div>").addClass("gotoDockContainer").insertAfter(ft),s!=o.DatePicker||nt?s!=o.AlphaPicker||tt?k(i):ot():et()},f.initiateJumptoNavigation=function(n){var t=null;v=c,s==o.DatePicker?(c=n.getTime(),t="{0}/{1}/{2}".format(n.getMonth()+1,n.getDate(),n.getFullYear())):s==o.AlphaPicker&&(c=n,t=c),$menu.closeCurrent(),t&&f.delegate.initiateJumptoNavigation(t)},f.highlightSelectedCell=function(){var t="";s==o.DatePicker?t="ds":s==o.AlphaPicker&&(t="id"),v&&n(h).find("td["+t+'="'+v+'"]').removeClass("t_sel"),c&&n(h).find("td["+t+'="'+c+'"]').addClass("t_sel")},f.resetGotoPickerValues=function(t){v=null,c=null,h&&n(h).find("td").removeClass("t_sel"),t==HM.SortBy.Date&&e&&e.showDate((new i.WLDate).moveToStartOfDay())},f.disposeGotoPicker=function(){a&&a.dispose(),l&&l.dispose(),e&&e.dispose(),w&&w.unbind()}}}(window.originaljQuery||window.jQuery),function(n){"use strict";var i=window.ol=window.ol||{},t=i.controlHelpers=i.controlHelpers||{};t.MiniCalendarModelCache=function(){function v(){var n=null,i;o==t.MiniCalendarModelCache.CacheType.Month&&(n=f);for(i in n)if(n[i].IsVisible)return n[i];return null}function y(){if(u){u.innerHTML="";for(var n in f)delete f[n]}}function d(n,t,i){var r=s+n+i.valueOf(),u=_ge(r);return!u||!t||!t[r]?!1:p(t[r].CacheTimeStamp)}function p(n){var t=new Date;return!n||n&&t.valueOf()-n<l}function g(n){return it(f,s+h+n.valueOf())}function nt(t,i,r){i||(t.innerHTML="",r.Type==HM.MiniCalendarUiType.Month&&(i=f={})),tt(r),w(i,r.CacheID),r.IsVisible&&b(i);var u=document.createElement("DIV");u.innerHTML=r.HTML,n(t).prepend(u.firstChild),r.Element=_ge(r.CacheID),i[r.CacheID]=r}function tt(n){n.TargetDate=new i.WLDate(n.TargetDate.valueOf()),n.CacheDate=null,n.CacheID=null,n.Type==HM.MiniCalendarUiType.Month&&(n.CacheDate=new i.WLDate(n.TargetDate.getYear(),n.TargetDate.getMonth(),1),n.CacheDate.moveToStartOfDay(),n.CacheID=s+h+n.CacheDate.valueOf()),n.CacheTimeStamp=(new Date).valueOf()}function w(n,t){var i=n[t];i&&(i.Element.removeNode(!0),delete n[t])}function b(n){var i,t;for(i in n)t=n[i],t.IsVisible&&(t.IsVisible=!1,$css.add(t.Element,"DisplayNone"))}function it(n,t){var i=n[t];return i&&!i.IsVisible&&(b(n),i.IsVisible=!0,$css.remove(i.Element,"DisplayNone")),i}function rt(n){u&&k(t.MiniCalendarModelCache.CacheType.Month,f,n)}function k(n,i,r){var o,f,u;for(o in i)f=!1,u=i[o],n==t.MiniCalendarModelCache.CacheType.Month&&(u.CacheDate.isBetween(r.addMonths(-e),r.addMonths(e))||(f=!0)),(f||!p(u.CacheTimeStamp))&&w(i,u.CacheID)}var r=this,c=null,l=0,e=0,o=null,a=null,s="MCMC",u=null,f=null,h="month";r.init=function(n){c=n.cacheType||t.MiniCalendarModelCache.CacheType.Month,l=n.cacheagelimit||3e5,e=n.cachemonthmax||3,s=n.uniqueidentifier||s,a=n.containerElement,c==t.MiniCalendarModelCache.CacheType.Month&&(n.monthcache?u=n.monthcache:(u=document.createElement("DIV"),u=a.appendChild(u)))},r.getUniqueIdentifier=function(){return s},r.getActiveCache=function(){return o},r.showCache=function(){$css.remove(u,"DisplayNone")},r.hideCache=function(){$css.add(u,"DisplayNone")},r.setActiveCache=function(n){var i=!1;if(n!=o)switch(n){case t.MiniCalendarModelCache.CacheType.Month:u&&($css.remove(u,"DisplayNone"),i=!0,o=t.MiniCalendarModelCache.CacheType.Month);break;default:$css.add(u,"DisplayNone"),o=null,i=!0}return i},r.displayCacheEntry=function(n){var r=null;switch(o){case t.MiniCalendarModelCache.CacheType.Month:r=g(new i.WLDate(n.getYear(),n.getMonth(),1))}return r},r.getVisibleView=function(){return v()},r.addObjectsToCache=function(n){for(var u=n[0].Type,i=0;i<n.length;i++)r.addCacheEntry(n[i],!0);u==HM.MiniCalendarUiType.Month&&k(t.MiniCalendarModelCache.CacheType.Month,f,v().CacheDate)},r.addCacheEntry=function(n,t){switch(n.Type){case HM.MiniCalendarUiType.Month:nt(u,f,n)}t||rt(n.CacheDate)},r.isCacheValid=function(n,r){switch(r){case t.MiniCalendarModelCache.CacheType.Month:return d(h,f,new i.WLDate(n.getYear(),n.getMonth(),1));default:return!1}},r.clear=function(){y()},r.getNumberOfFutureMonthsToCache=function(n){if(!e)return 0;for(var i=e;i>0;i--)if(!r.isCacheValid(n.addMonths(i),t.MiniCalendarModelCache.CacheType.Month))return i;return 0},r.getNumberOfPastMonthsToCache=function(n){if(!e)return 0;for(var i=-e;i<0;i++)if(!r.isCacheValid(n.addMonths(i),t.MiniCalendarModelCache.CacheType.Month))return Math.abs(i);return 0},r.dispose=function(){y(),u&&u.removeNode(!0),u=f=null}},t.MiniCalendarModelCache.CacheType=new $Enum("Month")}(window.originaljQuery||window.jQuery),function(n){"use strict";var i=window.ol=window.ol||{},t=i.controlHelpers=i.controlHelpers||{};t.MiniCalendarModel=function(){function p(){e&&(window.clearTimeout(e),e=null),u.hideCache(),o.removeClass("DisplayNone")}function d(){o&&(e&&(window.clearTimeout(e),e=null),o.addClass("DisplayNone"),u.showCache())}function g(n){h||(r.displayMessage(i.GetString("MiniCalendarControl.Loading"),n),r.$().trigger("loadingstarted"),h=!0)}function w(){h&&(d(),r.$().trigger("loadingended"),h=!1)}function b(n){var t=r.getTargetDate(),i;g(n),u.isCacheValid(t,u.getActiveCache())?(i=u.displayCacheEntry(t),r.$().trigger("viewchanged",i),w()):(nt(),tt(u.getActiveCache()))}function nt(){s=new HM.MiniCalendarOptions,s.NumberOfPastObjects=u.getNumberOfPastMonthsToCache(f),s.NumberOfFutureObjects=u.getNumberOfFutureMonthsToCache(f),s.NeedAdditionalDateStrings=v,c&&(s.DateStart=c.moveToStartOfDay().valueOf()),l&&(s.DateEnd=l.moveToStartOfDay().valueOf())}function tt(n){var i={targetDate:f.clone(),viewType:n};n==t.MiniCalendarModelCache.CacheType.Month&&it(i)}function it(n){var t=k||HM;HM.LFPP=function(){t.GetMiniCalendarUiObjects(t.MiniCalendarUiType.Month,f,s,u.getUniqueIdentifier(),rt,n)},HM.LFPP()}function rt(n){w(),n&&n.length&&(u.addObjectsToCache(n),r.$().trigger("viewchanged",u.getVisibleView()))}var r=this,a=null;r.$=function(){return a||(a=n(r))};var u=null,f=null,v=!1,c=null,l=null,s=null,y=null,o=null,e=null,h=!1,k=null;r.init=function(n){y=n.containerElement,f=new i.WLDate,f.moveToStartOfDay(),u=new t.MiniCalendarModelCache,u.init(n),u.setActiveCache(t.MiniCalendarModelCache.CacheType.Month)},r.dispose=function(){u.dispose()},r.showNextPreviousDate=function(n){switch(u.getActiveCache()){case t.MiniCalendarModelCache.CacheType.Month:r.setTargetDate(f.addMonths(n?-1:1))}},r.syncDisplay=function(){b(!0)},r.showDate=function(n){r.setTargetDate(n)},r.setFetchAdditionalContent=function(n){v=n},r.setMonthGridStartDate=function(n){c=n},r.setMonthGridEndDate=function(n){l=n},r.getTargetDate=function(){return f.clone()},r.setTargetDate=function(n){n.moveToStartOfDay(),f.valueOf()!=n.valueOf()&&(f=n,r.$().trigger("targetdatechanged",n),b(!0))},r.addCacheEntry=function(n){u.addCacheEntry(n,!1),n.IsVisible&&r.$().trigger("viewchanged",u.getVisibleView())},r.displayMessage=function(t,i){o||(o=n(_ce("div")).addClass("msgText DisplayNone"),o.append(_ce("span")),n(y).append(o)),o.first().text(t),i?(e&&window.clearTimeout(e),e=window.setTimeout(p,500)):p()}}}(window.originaljQuery||window.jQuery),function(n){"use strict";var t=window.ol=window.ol||{},i=t.controlHelpers=t.controlHelpers||{};i.MiniCalendarViewControl=function(){function s(n){var i,u,f;return n&&n.target&&(i=n.target.parentNode,i&&(u=i.getAttributeNode("ds"),f=i.getAttributeNode("st"),u&&r.$().trigger("monthgriddayclicked",[new t.WLDate(parseInt(u.value)),f?f.value:null]))),!1}function h(n,t){r.$().trigger("datechanged",t)}function c(t,i){i&&i.Type==HM.MiniCalendarUiType.Month&&(f&&(f.unbind(),f=null),i.Element&&(f=n(i.Element).click(s))),r.$().trigger("viewchanged",i)}function l(){r.$().trigger("loadingstarted")}function a(){r.$().trigger("loadingended")}function v(n,t){r.$().trigger("fpperrormessage",t)}var r=this,o=null;r.$=function(){return o||(o=n(r))};var u=null,f=null,e=null;r.init=function(t){if(u=new i.MiniCalendarModel,u.init(t),u.$().bind({"targetdatechanged.minicalcontrol":h,"viewchanged.minicalcontrol":c,"loadingstarted.minicalcontrol":l,"loadingended.minicalcontrol":a,"fpperrormessage.minicalcontrol":v}),t.monthcache){var r=n(t.monthcache);r.first()&&(f=r.first().click(s))}},r.syncDisplay=function(){u.syncDisplay()},r.isCalendarUser=function(){return e!=null},r.setUserCalendars=function(n){e=n},r.getUserCalendars=function(){return e},r.dispose=function(){u.$().unbind(".minicalcontrol"),f.unbind(),u.dispose(),f=u=null},r.setFetchAdditionalContent=function(n){u.setFetchAdditionalContent(n)},r.setMonthGridStartDate=function(n){u.setMonthGridStartDate(n)},r.setMonthGridEndDate=function(n){u.setMonthGridEndDate(n)},r.showNextDate=function(){u.showNextPreviousDate(!1)},r.showPreviousDate=function(){u.showNextPreviousDate(!0)},r.showDate=function(n){u.showDate(n)},r.getDate=function(){return u.getTargetDate()},r.addCacheEntry=function(n){u.addCacheEntry(n)}}}(window.originaljQuery||window.jQuery),function(){"use strict";var f=window.ol=window.ol||{},i=ol.data=ol.data||{},u=i.fpp=i.fpp||{},n=u.FppEngine,e=window.ActionQueue,r=window.ActionQueueTypes.ActionType,t={fppMethod:"BulkActions",tokenConfig:{friendlyName:"BulkActionsFromMessage",actionType:r.async,getTokenKeys:function(){return null}},cmdArgs:[{name:"actions",type:Object},{name:"messageListParam",type:Array},{name:"messageAuxData",type:Array},{name:"viewInfos",type:Array},{name:"suppressListTransition",type:Boolean},{name:"getAffectedHeaders",type:Boolean},{name:"restrictActionToView",type:Boolean}],bulkActionsConfig:{tokenConfig:{friendlyName:"BulkActionsLoop",actionType:r.blocking,getTokenKeys:function(){return null}},cmdArgsToNull:["msgs","mads"]}};n.registerFppConfig("undocategorizeitems",jQuery.extend({},t,{suppressServerErrors:!0})),n.registerFppConfig("bulkactions",t),n.registerFppConfig("categorizeitems",t)}(),function(){"use strict";function e(){return{bulkActionCountUpdate:null,selectedFolder:null,folderList:null,sweepCategory:"email",sweepType:"delete"}}function i(){n.Dispatcher.fireCmd("get")}var n=window.ol=window.ol||{},u=n.data=n.data||{},r=n.vm=n.vm||{},o=ol.Accessor,t=r.BulkActions=function(n){function r(){i=HM.createServerMessagesQuery({serverMessageType:HM.ServerMessageType.BulkActionCountUpdate}),ol.Dispatcher.register([i],t.apply,t)}var t=this,i;t.initAccessorValues(n),t.apply=function(n,r){var u=r[i.key()].bulkActionCountUpdate;u&&t.bulkActionCountUpdate(u)},t.getFinalProcessedCount=function(){return t.bulkActionCountUpdate().progressCount||0},r()},f=t.prototype;ol.AddOptionsAccessorAndInitFunctions(f,e),f.folderList=function(t){var i=this;return ol.Accessor(i,"FolderList",t,function(){return i.FolderList||i.folderList(new n.vm.ContainerList({newItemLabel:n.GetString("MoveTo.Folder.NewFolder"),title:null,type:HM.ContainerType.Folders,rootContainer:new n.vm.Container({id:n.config.sysFldrs.noneFid,depth:0})})),i.FolderList})},t.MoveOption=new $Enum("MoveAll","MoveAndKeepNMsgs","MoveAndKeepNDays"),t.bulkMoveMessages=function(r){var f,e,o;return f=null,e=null,r.moveOption===t.MoveOption.MoveAll?(f={interruptCallback:r.interruptCallback,destId:r.destId,items:[],unFlag:!!r.unFlag,markRead:!!r.markRead,blockIfDelete:!!r.blockSenders,isBulk:!0,batchInfo:HM.createBatchInfo({Timestamp:r.timestamp,SenderSearch:r.senderIds?r.senderIds.join():"",FolderId:r.fromFid,FilterId:r.categoryFilterId||0,QuickViewId:r.quickViewId||0,SortKey:r.sortKey,AdvancedSearch:r.advancedSearch||null}),entryPoint:r.entryPoint},e=n.Dispatcher.fireCmd("batchmoveitems",f).deferred.promise()):(o=HM.createMoveAction({Type:HM.MailActionType.Move,FolderID:r.destId,DeferredActionType:r.moveOption===t.MoveOption.MoveAndKeepNMsgs?HM.DeferredMailActionType.Count:HM.DeferredMailActionType.Date,DeferredActionAge:r.timeOption}),f={interruptCallback:r.interruptCallback,actions:[o],msgs:[],mads:[],suppressListTransition:!1,restrictActionToView:!1,isBulk:!0,batchInfo:HM.createBatchInfo({Timestamp:r.timestamp,SenderSearch:r.senderIds.join(),FilterId:r.categoryFilterId||0,QuickViewId:r.quickViewId||0,SortKey:r.sortKey,AdvancedSearch:r.advancedSearch||null})},e=n.Dispatcher.fireCmd("bulkactions",f).deferred.promise()),e.then(i),e},t.bulkBlockSenders=function(n){var t=r.Rules.blockSenders(n.senderIds);return t.then(i),t},t.bulkCategorize=function(t){var u,h,o;var s=t.categoryChanges,f=s.apply||[],e=s.remove||[];if(f.length||e.length)return u=[],f&&f.length&&u.push(HM.createCategorizeAction({Type:HM.MailActionType.AssignCategory,CategoryIDs:f})),e&&e.length&&u.push(HM.createCategorizeAction({Type:HM.MailActionType.RemoveCategory,CategoryIDs:e})),h={interruptCallback:t.interruptCallback,actions:u,msgs:[],mads:[],suppressListTransition:!1,restrictActionToView:!t.senderIds,isBulk:!0,batchInfo:HM.createBatchInfo({Timestamp:t.timestamp,SenderSearch:t.senderIds?t.senderIds.join():"",FolderId:t.fromFid||"",QuickViewId:t.quickViewId||0,SortKey:t.sortKey,AdvancedSearch:t.advancedSearch||null,FilterId:t.categoryFilterId||0})},o=n.Dispatcher.fireCmd("bulkactions",h).deferred.promise(),o.then(i),t.createRule&&o.then(function(){r.Rules.createRulesForSendersFromActionsAndConditions(t.senderIds,u)}),o},t.bulkMarkMessages=function(t){var r=n.Dispatcher.fireCmd("batchmarkitems",{interruptCallback:t.interruptCallback,readState:!!t.readState,isBulk:!0,batchInfo:HM.createBatchInfo({Timestamp:t.timestamp,FolderId:t.fromFid,QuickViewId:t.quickViewId||0,SortKey:t.sortKey,AdvancedSearch:t.advancedSearch||null,FilterId:t.categoryFilterId||0}),entryPoint:t.entryPoint}).deferred.promise();return r.always(i),r},t.bulkFlagMessages=function(t){var r=n.Dispatcher.fireCmd("batchflagitems",{interruptCallback:t.interruptCallback,flagState:!!t.flagState,isBulk:!0,batchInfo:HM.createBatchInfo({Timestamp:t.timestamp,FolderId:t.fromFid,QuickViewId:t.quickViewId||0,SortKey:t.sortKey,AdvancedSearch:t.advancedSearch||null,FilterId:t.categoryFilterId||0})}).deferred.promise();return r.always(i),r},t.bulkJunkMessages=function(t){var u=t.jmrType===HM.JmrType.Junk?"batchjunkitems":"batchunjunkitems",r=n.Dispatcher.fireCmd(u,{interruptCallback:t.interruptCallback,enableJmrReporting:t.enableJmrReporting,isBulk:!0,fid:t.fromFid,batchInfo:HM.createBatchInfo({Timestamp:t.timestamp,FolderId:t.fromFid,QuickViewId:t.quickViewId||0,SortKey:t.sortKey,AdvancedSearch:t.advancedSearch||null,FilterId:t.categoryFilterId||0})}).deferred.promise();return r.always(i),r}}(),function(n,t){"use strict";function p(t,r){var f;var h=r.selection,e=r.selectedContainer,l=r.timestamp,a=r.sortKey,o=r.actionOverride,s=e.isQuickview(),v=s?i.noneFid:e.id();t.data.sweepType(o?o:"delete"),t.data.sweepCategory("email"),f={senderIds:n.SelectionUtil.getSenderIds(h,!1,!1),fromFid:v,destId:i.trashFid,destFolderName:t.getFolderName(i.trashFid),moveOption:u.MoveAll,blockSenders:!1,timestamp:l,action:t.data.sweepType(),quickViewId:s?e.id():0,sortKey:a,entryPoint:r.entryPoint},f.bsi={},f.bsi.actionId="a.swconf",f.bsi.bat=1,f.bsi.bao=t.data.sweepType()==="unsubscribe"?5:0,c(t,f)}function w(f,e){var s,tt,p,w,b;var o=e.selection,h=e.selectedContainer,d=e.folderList.getArchiveFolder(),ut=e.timestamp,ft=e.sortKey,l=n.SelectionUtil.getFriendlySenders(o,!1);if(l.length===0){rt(n.GetString("BulkAction.Sweep.NoSenderError"));return}var g=h.name(),nt=h.isQuickview(),et=nt?i.noneFid:h.id(),y=!0;for(s=0;s<o.length;s++)if(tt=o[s].data||o[s],!tt.hasCategory(n.config.sysCats.newslettersFltid)){y=!1;break}p=null,w=null,y&&(p="<span class='sweepCategoryMenu'><\/span>"),b=n.GetAppConfig("IsArchiveEnabled")&&d,b&&(w="<span class='sweepTypeMenu' {0}><\/span>".format(n.getSutra("SweepTypeMenu")));var it=p||n.GetString("BulkAction.Sweep.Flyout.Category.Email"),a=w||n.GetString("BulkAction.Sweep.Flyout.Delete"),ot=t("<div><\/div>").link(t.templates("#sweepTemplate"),{isSingleSender:l.length===1,singleSenderDesc:n.GetString("BulkAction.Sweep.Flyout.SingleSender.Title").format(it,l[0]),multiSenderDesc:n.GetString("BulkAction.Sweep.Flyout.MultiSender.Title").format(it),FriendlySenders:l,optionSweepAll:n.GetString("BulkAction.Sweep.Flyout.Option.SweepAll").format(a,g),optionSweepAllCreateRule:n.GetString("BulkAction.Sweep.Flyout.Option.SweepAllCreateRule").format(a,g),optionSweepKeepLatest:n.GetString("BulkAction.Sweep.Flyout.Option.SweepAllExceptMostRecent").format(a),optionSweepKeepLatest10Days:n.GetString("BulkAction.Sweep.Flyout.Option.SweepAllOlderThan10Days").format(a),bulkactions:f.data},f.ctx),st=wLive.Controls.Notifications,k=st.createFlyout({content:ot,anchor:t("#Sweep")[0],buttons:{action:n.GetString("BulkAction.Sweep.Flyout.Button.Sweep")},options:{moreCss:"BulkActionsFlyout"}}),v=null;t(k).on("beforeshow.flyout",function(){t.observable.simpleOn(f.data,"propertyChange.flyout",function(n,t){t.path==="SweepCategory"?f.createSweepCategoryMenu():t.path==="SweepType"&&f.createSweepTypeMenu()}),y?(t(".sweepCategoryMenu",this.content()).link(t.templates("{^{menuControl ~tag.SweepCategoryMenu /}}"),f,f.ctx),f.data.sweepCategory("newsletter")):f.data.sweepCategory("email"),b&&t(".sweepTypeMenu",this.content()).link(t.templates("{^{menuControl ~tag.SweepTypeMenu /}}"),f,f.ctx),f.data.sweepType("delete")}).on("beforedismiss.flyout",function(){return $menu.closeAll(),v=t("input[@name=sweepAction]:checked",this.content()).attr("id"),!0});k.show().then(function(s){if(t(k).off(".flyout"),t.observable.simpleOff(f.data,"propertyChange.flyout"),s.buttonClicked){var a=f.data.sweepType()==="delete"?i.trashFid:d.id(),y=v==="sweepOption_allAndCreateRule",l={senderIds:n.SelectionUtil.getSenderIds(o,!1,!1),ruleSenderIds:n.SelectionUtil.getSenderIds(o,y,!0),destId:a,destFolderName:f.getFolderName(a),timestamp:ut,action:f.data.sweepType(),quickViewId:nt?h.id():0,sortKey:ft,blockSenders:y,entryPoint:e.entryPoint};l.bsi={},l.bsi.actionId="a.swconf",l.bsi.bat=l.action==="delete"?1:2;switch(v){case"sweepOption_all":case"sweepOption_allAndCreateRule":l.fromFid=et,l.moveOption=u.MoveAll,l.bsi.bao=v==="sweepOption_all"?0:1;break;case"sweepOption_keepLatest":l.moveOption=u.MoveAndKeepNMsgs,l.createRule=!0,l.timeOption=1,l.deferredOption=r.Rules.DeferredRuleOption.KeepLatest,l.bsi.bao=3;break;case"sweepOption_keepLatest10Days":l.moveOption=u.MoveAndKeepNDays,l.createRule=!0,l.timeOption=10,l.deferredOption=r.Rules.DeferredRuleOption.MoveAfterNDays,l.bsi.bao=4}f.data.sweepCategory()==="newsletter"&&(l.categoryFilterId=n.config.sysCats.newslettersFltid),c(f,l)}})}function b(f,e){var l=e.selection,o=e.selectedContainer,v=e.folderList.getArchiveFolder(),w=e.timestamp,b=e.sortKey,y=o.name(),p=o.isQuickview(),k=p?i.noneFid:o.id(),d=t("<div><\/div>").link(t.templates("#moveAllFromTemplate"),t.extend({optionMoveAll:n.GetString("BulkAction.MoveAllFromSender.Flyout.Option.MoveAll").format(y),optionMoveAllCreateRule:n.GetString("BulkAction.MoveAllFromSender.Flyout.Option.MoveAllCreateRule").format(y),bulkactions:f.data},a(l)),f.ctx),g=wLive.Controls.Notifications,s=g.createFlyout({content:d,anchor:t("#MoveTo")[0],buttons:{action:n.GetString("BulkAction.MoveAllFromSender.Flyout.Button.MoveAll")},options:{moreCss:"BulkActionsFlyout"}}),h=null;t(s).on("beforeshow.flyout",function(){this.getButton({buttonName:"action"}).prop("disabled",!0),f.data.selectedFolder(null),f.createFolderSelector(),t.observable.simpleOn(f.data,"propertyChange.flyout",function(n,t){t.path==="SelectedFolder"&&(f.createFolderSelector(),s.getButton({buttonName:"action"}).prop("disabled",!1))})}).on("beforedismiss.flyout",function(){return $menu.closeAll(),h=t("input[@name=moveAction]:checked",this.content()).attr("id"),!0});s.show().then(function(a){var g,y,d;if(t(s).off(".flyout"),t.observable.simpleOff(f.data,"propertyChange.flyout"),g=f.data.selectedFolder(),a.buttonClicked&&g){if(y={senderIds:n.SelectionUtil.getSenderIds(l,!1,!1),ruleSenderIds:n.SelectionUtil.getSenderIds(l,!1,!0),destId:g,destFolderName:f.getFolderName(g),timestamp:w,action:"move",quickViewId:p?o.id():0,sortKey:b,entryPoint:e.entryPoint},y.bsi={},y.bsi.actionId="a.bmvconf",y.bsi.bat=3,d=7,v&&y.destId===v.id())d=2;else switch(y.destId){case i.inboxFid:d=1;break;case i.junkFid:d=3;break;case i.draftsFid:d=4;break;case i.sentFid:d=5;break;case i.trashFid:d=6}y.bsi.df=d;switch(h){case"moveAllOption_move":case"moveAllOption_moveAndCreateRule":y.fromFid=k,y.moveOption=u.MoveAll,y.createRule=h==="moveAllOption_moveAndCreateRule",y.bsi.bao=h==="moveAllOption_move"?0:2;break;case"moveAllOption_keepLatest":y.moveOption=u.MoveAndKeepNMsgs,y.createRule=!0,y.timeOption=1,y.deferredOption=r.Rules.DeferredRuleOption.KeepLatest,y.bsi.bao=3;break;case"moveAllOption_keepLatest10Days":y.moveOption=u.MoveAndKeepNDays,y.createRule=!0,y.timeOption=10,y.deferredOption=r.Rules.DeferredRuleOption.MoveAfterNDays,y.bsi.bao=4}c(f,y)}})}function k(r,f){var e=f.selection,o=a(e,!0,"EnhancedRules.BlockAllFromSender.Flyout.SingleSender.Title","EnhancedRules.BlockAllFromSender.Flyout.MultiSenders.Title"),s;o.FriendlySenders.length?(s=wLive.Controls.Notifications.createFlyout({content:t.templates("#bulkActionsSenderTemplate").render(o,r.ctx),anchor:t("#BlockAllFromSender")[0],buttons:{action:n.GetString("EnhancedRules.BlockAllFromSender.Flyout.Button.BlockAll")},options:{moreCss:"BulkActionsFlyout"}}),s.show().then(function(t){t.buttonClicked&&(f.senderIds=n.SelectionUtil.getSenderIds(e,!0,!0),f.moveOption=u.MoveAll,f.fromFid=i.junkFid,f.destId=i.permDelFid,f.blockSenders=!0,it(r,f))})):wLive.Controls.Notifications.createTopBar({content:n.GetString("Error.Options.Error.CannotBlockSelf"),dismissalMode:wLive.Controls.Notifications.BarDismissalMode.Timeout}).show()}function d(t,i){t.maybeShowProgress(),i.interruptCallback=function(){return t.shouldStopExecution()},n.vm.BulkActions.bulkJunkMessages(i).always(function(){t.hideProgress()}).then(function(){i.jmrType===HM.JmrType.NotJunk&&s(n.GetString("Inbox.Safety.Notifications.NotJunk.Message.Multiple"),!1,{action:n.GetString("Inbox.Safety.Notifications.NotJunk.Multiple.ButtonText")})}).fail(function(){t.handleFailure()})}function g(t,i){t.maybeShowProgress(),i.interruptCallback=function(){return t.shouldStopExecution()},n.vm.BulkActions.bulkFlagMessages(i).always(function(){t.hideProgress()}).fail(function(){t.handleFailure()})}function nt(t,i){t.maybeShowProgress(),i.interruptCallback=function(){return t.shouldStopExecution()},n.vm.BulkActions.bulkMarkMessages(i).always(function(){t.hideProgress()}).fail(function(){t.handleFailure()})}function tt(i,r){var s=r.selection,f=r.categoryChanges,h=r.timestamp,c=r.sortKey,o={isAddingCategories:f.apply.length!==0,addedCategories:n.GetString("EnhancedRules.CategorizeAll.OptionDialog.AddCategoriesMessage").format(f.applyNames.join(", ")),isRemovingCategories:f.remove.length!==0,removedCategories:n.GetString("EnhancedRules.CategorizeAll.OptionDialog.RemoveCategoriesMessage").format(f.removeNames.join(", "))},e,u;o=t.extend(a(s),o),e=wLive.Controls.Notifications.createFlyout({content:t.templates("#categorizeAllTemplate").render(o,i.ctx),anchor:r.sourceEl||t("#Categorize")[0],buttons:{action:n.GetString("EnhancedRules.CategorizeAll.OptionDialog.Action")},options:{moreCss:"BulkActionsFlyout"}}),u={categoryChanges:f,senderIds:n.SelectionUtil.getSenderIds(s,!1,!1),timestamp:h,sortKey:c};t(e).on("beforedismiss.flyout",function(){$menu.closeAll(),u.createRule=t("#categorizeAllOption_futureMessages",this.content()).is(":checked")});e.show().then(function(n){t(this).off(".flyout"),e=null,n.buttonClicked&&(u.bsi={},u.bsi.actionId="a.bcatconf",u.bsi.bat=4,u.bsi.ca=f.applyNames.length,u.bsi.cr=f.removeNames.length,u.bsi.bao=u.createRule?2:0,y(i,u))})}function it(t,i){t.ctx&&t.ctx.layout&&t.ctx.layout.isFullView()&&n.Cmd("closeview").bubble(t,{thread:t.ctx.readMessage.thread()}),t.maybeShowProgress(),i.interruptCallback=function(){return t.shouldStopExecution()},n.vm.BulkActions.bulkMoveMessages(i).always(function(){t.hideProgress()}).then(function(){var r=t.data.getFinalProcessedCount(),f=r===1?".single.":".plural.",u=n.GetString("BulkAction.Completed.Generic"+f+"delete").format(r),e=i.senderIds.length>1?n.GetString("BulkAction.Completed.MultipleSendersBlocked").format(u):n.GetString("BulkAction.Completed.SingleSenderBlocked").format(u);s(e)},function(){t.handleFailure()}),$BSI.reportEvent("a.blkconf")}function y(t,i){t.maybeShowProgress("BulkAction.Progress.categorize"),i.interruptCallback=function(){return t.shouldStopExecution()},n.vm.BulkActions.bulkCategorize(i).always(function(){t.hideProgress()}).then(function(){var e=t.data.getFinalProcessedCount(),o=e===1?".single.":".plural.",u=n.GetString("BulkAction.Completed.Generic"+o+"categorize").format(e),r,f;i.createRule&&(u=n.GetString("BulkAction.Completed.CategorizeRuleCreated").format(u)),s(u,i.createRule),i.bsi&&(r=i.bsi,f={"d.bat":r.bat,"d.bao":r.bao,"d.ca":r.ca,"d.cr":r.cr},i.senderIds&&(f["d.senc"]=i.senderIds.length),$BSI.reportEvent(r.actionId,f))},function(){t.handleFailure()})}function c(t,i){t.ctx&&t.ctx.layout&&t.ctx.layout.isFullView()&&n.Cmd("closeview").bubble(t,{thread:t.ctx.readMessage.thread()});var f="BulkAction.Progress."+i.action;i.moveOption!==u.MoveAll&&(f=i.deferredOption===r.Rules.DeferredRuleOption.KeepLatest?"BulkAction.Progress.GenericWithSender":"BulkAction.Progress.Generic"),t.maybeShowProgress(f),i.interruptCallback=function(){return t.shouldStopExecution()},n.vm.BulkActions.bulkMoveMessages(i).then(function(){var l=t.data.getFinalProcessedCount(),v=l===1?".single.":".plural.",f="",e="",y=i.destFolderName||"",h=i.action,a=n.GetString("BulkAction.Completed.Generic"+v+h),o,c;switch(h){case"move":e=a.format(l,y);break;case"delete":case"archive":case"unsubscribe":e=a.format(l)}i.createRule?i.moveOption!==u.MoveAll?r.Rules.createDeferredMailActionRuleForSenders(i.ruleSenderIds,i).always(function(){t.hideProgress()}).then(function(){i.deferredOption===r.Rules.DeferredRuleOption.KeepLatest?f=n.GetString("BulkAction.Completed.MostRecentMessage."+h):i.deferredOption===r.Rules.DeferredRuleOption.MoveAfterNDays&&(f=n.GetString("BulkAction.Completed.10DayOldMessages."+h)),s(f,!0)}):r.Rules.createMoveRuleForSenders(i.ruleSenderIds,i).always(function(){t.hideProgress()}).then(function(){f=n.GetString("BulkAction.Completed.MoveRuleCreated."+h).format(e),s(f,!0)}):i.blockSenders?(t.hideProgress(),f=i.senderIds.length>1?n.GetString("BulkAction.Completed.MultipleSendersBlocked").format(e):n.GetString("BulkAction.Completed.SingleSenderBlocked").format(e),s(f)):(t.hideProgress(),s(e)),i.bsi&&(o=i.bsi,c={"d.bat":o.bat,"d.bao":o.bao},i.senderIds&&(c["d.senc"]=i.senderIds.length),o.bat===3&&(c["d.df"]=o.df),$BSI.reportEvent(o.actionId,c))},function(){t.handleFailure()})}function s(t,i,r){var o;var u=null,f=null,e={};i?(e.action=n.GetString("FolderList.Actions.ManageRules"),o=n.GetAppConfig("IsAdvancedRulesEnabled"),u=o?"nav.managerules":"nav.managerulesold",o&&(f={entryPoint:HM.InstrumentationEntryPoint.Notification})):r&&(e=r,u="selectcontainer",f={id:n.config.sysFldrs.inboxFid,entryPoint:HM.InstrumentationEntryPoint.Notification}),wLive.Controls.Notifications.createBottomBar({content:t,buttons:e,dismissalMode:wLive.Controls.Notifications.BarDismissalMode.Timeout}).show().then(function(t){t.buttonClicked==="action"&&n.Cmd(u).fire(f)})}function rt(t){wLive.Controls.Notifications.createTopBar({content:t||n.GetString("BulkAction.GenericError"),dismissalMode:wLive.Controls.Notifications.BarDismissalMode.Timeout}).show()}function a(t,i,r,u){var f=n.SelectionUtil.getFriendlySenders(t,!!i);return r=r||"BulkAction.AllFromSender.Flyout.SingleSender.Title",u=u||"BulkAction.AllFromSender.Flyout.MultiSenderSender.Title",{isSingleSender:f.length===1,singleSenderDesc:n.GetString(r).format(f.length?f[0]:""),FriendlySenders:f,multiSenderDesc:n.GetString(u)}}var r=n.vm,i=n.config.sysFldrs,u=n.vm.BulkActions.MoveOption,h=null,f=null,l=null,o=[{text:"Email",value:"email"},{text:"Newsletter",value:"newsletter"}],e=[{text:"Delete",value:"delete"},{text:"Archive",value:"archive"}],v;n.c=window.ol.c||{},v={template:"<div><\/div>",attr:"html",stopExecution:!1,init:function(t){var i=this;n.c.BulkActionsControl||(n.c.BulkActionsControl={},n.c.BulkActionsControl.isBusy=!1),i.data=t.ctx.bulkactions,i.createFolderSelector(),i.createSweepCategoryMenu(),i.createSweepTypeMenu()},render:function(){return this.tagCtx.render(this.data)},folderSelector:function(t){return n.Accessor(this,"FolderSelector",t)},sweepCategoryMenu:function(t){return n.Accessor(this,"SweepCategoryMenu",t)},sweepTypeMenu:function(t){return n.Accessor(this,"SweepTypeMenu",t)},onCmdBubble:function(n,t,i){var r=this;t.name==="cs.select"&&i.key==="folder"?r.data.selectedFolder(i.selection):t.name==="menu.click"&&(i.key==="sweepCategory"?r.data.sweepCategory(i.sweepCategory):i.key==="sweepType"&&r.data.sweepType(i.sweepType))},createFolderSelector:function(){var t=this;t.folderSelector()?t.folderSelector().title(t.getFolderSelectorTitle()):t.folderSelector(new r.ContainerSelector({key:"folder",containerList:t.data.folderList(),title:t.getFolderSelectorTitle(),isMultiSelect:!1,menuType:n.ContainerPickerEnums.MenuType.MoveTo,filterFn:function(n){return n.isValidMoveToFolder()},showSelectionState:!1,entryPoint:HM.InstrumentationEntryPoint.Notification}))},getFolderSelectorTitle:function(){var t=n.GetString("BulkAction.MoveAllFromSender.Flyout.FolderPicker.NoneSelected"),i=this.data.selectedFolder();return i&&(t=this.getFolderName(i)),t},getFolderName:function(n){var t=this.data.folderList().getContainerById(n);return t?t.name():""},createSweepCategoryMenu:function(t){var u,i,f;if(this.sweepCategoryMenu())this.sweepCategoryMenu().title(this.getSweepCategoryMenuTitle(t));else{for(u=[],i=0;i<o.length;i++)f=n.GetString("BulkAction.Sweep.Flyout.Category."+o[i].text),u.push(new r.MenuItem({text:f,key:"sweepCategory",sutraTag:"sweeptypemenu"+e[i].text,eventData:{sweepCategory:o[i].value}}));this.sweepCategoryMenu(new r.Menu({title:this.getSweepCategoryMenuTitle(),loc:0,sutraTag:"SweepFlyoutCategoryDropdownMenu",items:u}))}},getSweepCategoryMenuTitle:function(){for(var i=n.GetString("BulkAction.Sweep.Flyout.Category."+o[0].text)||"",t=0;t<o.length;t++)this.data.sweepCategory()===o[t].value&&(i=n.GetString("BulkAction.Sweep.Flyout.Category."+o[t].text));return i},createSweepTypeMenu:function(){var i,t,u;if(this.sweepTypeMenu())this.sweepTypeMenu().title(this.getSweepTypeMenuTitle());else{for(i=[],t=0;t<e.length;t++)u=n.GetString("BulkAction.Sweep.Flyout."+e[t].text),i.push(new r.MenuItem({text:u,key:"sweepType",sutraTag:"sweeptypemenu"+e[t].text,eventData:{sweepType:e[t].value}}));this.sweepTypeMenu(new r.Menu({title:this.getSweepTypeMenuTitle(),loc:0,sutraTag:"SweepFlyoutTypeDropdownMenu",items:i}))}},getSweepTypeMenuTitle:function(){for(var i=n.GetString("BulkAction.Sweep.Flyout."+e[0].text)||"",t=0;t<e.length;t++)this.data.sweepType()===e[t].value&&(i=n.GetString("BulkAction.Sweep.Flyout."+e[t].text));return i},beginBulkActionByContainerUi:function(t){var r=this,f=t.action;if(!n.c.BulkActionsControl.isBusy){r.stopExecution=!1;switch(f){case"move":case"delete":case"archive":t.moveOption=u.MoveAll,t.destFolderName=r.getFolderName(t.destId),c(r,t);break;case"categorize":y(r,t);break;case"mark":nt(r,t);break;case"flag":g(r,t);break;case"junk":d(r,t)}}},beginBulkActionBySenderUi:function(t){var i=this,r=null;if(!n.c.BulkActionsControl.isBusy){i.stopExecution=!1;switch(t.action){case"unsubscribe":p(i,t);break;case"sweep":r="a.sw",w(i,t);break;case"move":r="a.bmv",b(i,t);break;case"block":r="a.blk",k(i,t);break;case"categorize":r="a.bcat",tt(i,t)}r&&$BSI.reportEvent(r)}},maybeShowProgress:function(i){var r=this,u;r.progressFormatString=n.GetString(i||"BulkAction.Progress.Generic"),u=r.progressFormatString.format(i==="BulkAction.Progress.GenericWithSender"?"":"0"),t.observable.simpleOn(r.data,"propertyChange.progress",function(n,u){if(u.path==="BulkActionCountUpdate"&&f){var e=i==="BulkAction.Progress.GenericWithSender"?r.progressFormatString.format(u.value.sender):r.progressFormatString.format(u.value.progressCount);t(".UserContent",f.content()).text(e)}}),n.c.BulkActionsControl.isBusy=!0,h||(h=setTimeout(function(){r._showProgress(u)},n.config.appSettings.BulkActionsProgressDelay))},_showProgress:function(i){var r=this;if(l||(l=$f.createLoading(!0,$f.loadingType.spinning,"25px","25px")),!f){f=wLive.Controls.Notifications.createModalDialog({title:l+n.GetString("BulkAction.Progress.Title"),content:i,buttons:{action:n.GetString("BulkAction.Progress.StopButton")},options:{moreCss:"BulkActionsProgressDialog",dismissOnButtonClick:!1}});t(f).on("buttonclick",function(n,t,i){i==="action"&&(r.stopExecution=!0,t.getButton({buttonName:i}).prop("disabled",!0))});f.show().then(function(){t(f).off()})}},hideProgress:function(){var i=this;i.progressFormatString=null,t.observable.simpleOff(i.data,"propertyChange.progress"),h&&(clearTimeout(h),h=null),f&&(f.dismiss(),f=null),n.c.BulkActionsControl.isBusy=!1},shouldStopExecution:function(){return this.stopExecution},handleFailure:function(){var n=this;n.hideProgress()}},t.views.tags({bulkActionsControl:v})}(window.ol,window.originaljQuery||window.jQuery),function(n){"use strict";function u(){return{loading:!0,busy:!1,rules:[]}}var i=window.ol=window.ol||{},r=i.vm=i.vm||{},t=r.Rules=function(t){function s(){f=HM.createRulesQuery(),i.Dispatcher.register([f],u.apply,u),i.Dispatcher.fireCmd("get")}var u=this,f=null,e=null,o=ol.config.rules.reorderRuleDelay;u.initAccessorValues(t),u.apply=function(t,i){var o=i[f.key()],s,e;if(o&&o.status==HM.Status.Complete){for(s=o.rules,e=0;e<s.length;e++)u.Rules[e]=r.Rule.createRule(s[e]);u.loading(!1),n.observable(u.Rules).refresh(u.Rules)}},u.getRuleById=function(n){var t=null,i=u.getRuleIndex(n);return i>-1&&(t=u.Rules[i]),t},u.getRuleIndex=function(n){var i,r,t;for(i=u.Rules,r=-1,t=0;t<i.length;t++)if(i[t].id()===n){r=t;break}return r},u.canReorderRule=function(n,t){return!(u.isFirstEnabledRule(n)&&t||u.isLastEnabledRule(n)&&!t)},u.reorderRule=function(t,r){var s,h;var f=u.getRuleIndex(t.id()),l=u.Rules.length-1,c=u.canReorderRule(t,r);c&&f>-1&&(s=u.getPreviousEnabledIndex(t),h=u.getNextEnabledIndex(t),n.observable(u.Rules).remove(f,1),n.observable(u.Rules).insert(r?s:h,t),u.refreshRowByIndex(f),e&&clearTimeout(e),e=setTimeout(function(){for(var t=u.rules(),r=[],n=0;n<t.length;n++)r[n]=t[n].id();u.busy(!0),i.Dispatcher.fireCmd("reorderrules",{ruleIds:r}).deferred.always(function(){u.busy(!1),i.Cmd("rules.reordercomplete").fire()})},o))},u.refreshRowByIndex=function(t){var i=u.rules(),r;i.length&&(r=i[t],n.observable(i).remove(t,1),n.observable(i).insert(t,r))},u.deleteRule=function(t){var r=u.getRuleIndex(t.id()),f=u.Rules.length-1,o,s,e;if(r>-1)return n.observable(u.Rules).remove(r,1),(r===0||r===f&&f>0)&&(o=r===0?0:f-1,u.refreshRowByIndex(o)),s={rulesToAdd:[],rulesToEdit:[],ruleIdsToDelete:[t.id()]},u.busy(!0),e=i.Dispatcher.fireCmd("addupdatedeleterules",s).deferred.promise(),e.always(function(){u.busy(!1)}),e},u.deleteRuleById=function(n){var t=u.getRuleById(n);t&&u.deleteRule(t)},u.getPreviousEnabledIndex=function(n){var t;var f=u.rules(),i=u.getRuleIndex(n.id()),r=i-1;for(t=r;t>=0;t--)if(u.Rules[t].enabled()){i=t;break}return i},u.getNextEnabledIndex=function(n){var t;var r=u.rules(),i=u.getRuleIndex(n.id()),f=r.length-1,e=i+1;for(t=e;t<=f;t++)if(r[t].enabled()){i=t;break}return i},u.isFirstEnabledRule=function(n){for(var r,i=!1,t=0;t<u.Rules.length;t++)if(r=u.Rules[t],r.Enabled){r.Id===n.Id&&(i=!0);break}return i},u.isLastEnabledRule=function(n){for(var r,i=!1,t=u.Rules.length-1;t>=0;t--)if(r=u.Rules[t],r.Enabled){r.Id===n.Id&&(i=!0);break}return i},u.enabledRuleCount=function(){var t=u.Rules,i=0,n;if(t.length)for(n=0;n<t.length;n++)t[n].enabled()&&i++;return i},s()};i.AddOptionsAccessorAndInitFunctions(t.prototype,u),t.createRulesForSendersFromActionsAndConditions=function(t,r,u){for(var e,c,o=[],f=t.length-1;f>=0;f--)for(e=r.length-1;e>=0;e--){var h=HM.createSenderAddressCondition({SenderAddress:t[f]}),l=!u?[h]:n.merge([h],u),s=HM.createMailRule();s.Conditions=l,s.Actions=[r[e]],o.push(s)}return c={rulesToAdd:o,rulesToEdit:[],ruleIdsToDelete:[]},i.Dispatcher.fireCmd("addupdatedeleterules",c).deferred.promise()},t.createMoveRuleForSenders=function(n,i){var r,u;return r=HM.createMoveAction({FolderID:i.destId}),i.categoryFilterId&&(u=[HM.createCategoryCondition({Type:HM.FilterConditionType.HasCategory,CategoryIDs:[i.categoryFilterId]})]),t.createRulesForSendersFromActionsAndConditions(n,[r],u)},t.DeferredRuleOption=new $Enum("KeepLatest","DeleteAfterNDays","MoveAfterNDays"),t.createDeferredMailActionRuleForSenders=function(n,r){var s,e;var o=r.destId,u=null,f=null;switch(r.deferredOption){case t.DeferredRuleOption.KeepLatest:f=HM.DeferredMailActionType.Count,u=1;break;case t.DeferredRuleOption.DeleteAfterNDays:o=i.config.sysFldrs.trashFid,f=HM.DeferredMailActionType.Date,u=r.timeOption;break;case t.DeferredRuleOption.MoveAfterNDays:f=HM.DeferredMailActionType.Date,u=r.timeOption}return s=HM.createMoveAction({FolderID:o,DeferredActionType:f,DeferredActionAge:u}),e=[],r.categoryFilterId&&e.push(HM.createCategoryCondition({Type:HM.FilterConditionType.HasCategory,CategoryIDs:[r.categoryFilterId]})),t.createRulesForSendersFromActionsAndConditions(n,[s],e)},t.createCategoryRulesForSendersFromCategoryIds=function(n,i,r){var u=[];return i&&i.length&&u.push(HM.createCategorizeAction({Type:HM.MailActionType.AssignCategory,CategoryIDs:i})),r&&r.length&&u.push(HM.createCategorizeAction({Type:HM.MailActionType.RemoveCategory,CategoryIDs:r})),t.createRulesForSendersFromActionsAndConditions(n,u)},t.blockSenders=function(n){return i.Dispatcher.fireCmd("blocksenders",{senders:n}).deferred.promise()}}(window.originaljQuery||window.jQuery),function(){"use strict";var u=window.ol=window.ol||{},n=ol.data=ol.data||{},t=n.fpp=n.fpp||{},i=t.FppEngine,f=window.ActionQueue,r=window.ActionQueueTypes.ActionType;i.registerFppConfig("addupdatedeleterules",{fppMethod:"AddUpdateDeleteRules",tokenConfig:{friendlyName:"AddUpdateDeleteRules",actionType:r.async,getTokenKeys:function(){return[null]}},cmdArgs:[{name:"rulesToAdd",type:Array},{name:"rulesToEdit",type:Array},{name:"ruleIdsToDelete",type:Array}],suppressServerErrors:!0})}(),function(){"use strict";var u=window.ol=window.ol||{},n=ol.data=ol.data||{},t=n.fpp=n.fpp||{},i=t.FppEngine,f=window.ActionQueue,r=window.ActionQueueTypes.ActionType;i.registerFppConfig("createsendersmoverules",{fppMethod:"CreateSendersMoveRules",tokenConfig:{friendlyName:"CreateSendersMoveRules",actionType:r.async,getTokenKeys:function(){return[null]}},cmdArgs:[{name:"emails",type:Array},{name:"folder",type:String}]})}(),function(){"use strict";var u=window.ol=window.ol||{},n=ol.data=ol.data||{},t=n.fpp=n.fpp||{},i=t.FppEngine,f=window.ActionQueue,r=window.ActionQueueTypes.ActionType;i.registerFppConfig("reorderrules",{fppMethod:"ReorderRules",tokenConfig:{friendlyName:"ReorderRules",actionType:r.async,getTokenKeys:function(){return[null]}},cmdArgs:[{name:"ruleIds",type:Array}]})}(),function(){"use strict";var i,r,t,n;if(window.glassInstr){for(ol.Cmd.register({"instrument.glassclick":{args:[{name:"clickId",type:Number}]}}),r=21,t=[],n=-1;n<r;n++)t.push(n);ol.data.InstrumentationModel.instance.registerAction("A.Pttfc",HM.createInstrumentationAction({conditions:[HM.createInstrumentationCondition({command:"instrument.glassclick"})],datapoints:[HM.createInstrumentationDatapoint({ref:"Common"}),HM.createInstrumentationDatapoint({name:"dpttfcr",values:t,src:function(n){return n.cmd.args.clickId}})]})),glassInstr.length?i=setInterval(function(){var n;try{n=glassInstr.shift(),n!==undefined?ol.Cmd("instrument.glassclick").fire({clickId:n}):clearInterval(i)}catch(t){}},1e3):ol.Cmd("instrument.glassclick").fire({clickId:-1})}}()