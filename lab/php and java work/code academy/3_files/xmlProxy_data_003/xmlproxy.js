/* Copyright (C) 2009 Microsoft Corporation */var xmlProxyVersion="0.070207.0";String.prototype.endsWith=function(a){return this.substr(this.length-a.length)==a};var strSearch=document.location.search.toLowerCase(),idx=strSearch.indexOf("domain="),strDomain=strSearch.substring(idx+7);if(strDomain.endsWith("live.com")||strDomain.endsWith("msn.com")||strDomain.endsWith("microsoft.com")||strDomain.endsWith("live.net")||strDomain.endsWith("live-int.com")||strDomain.endsWith("msn-int.com")||strDomain.endsWith("live-func.net")||strDomain.endsWith("live-tst.net")||strDomain.endsWith("msn-ppe.com")){if(document.location.hostname.toLowerCase().endsWith(strDomain))document.domain=strDomain;else alert("You can't proxy across different primary domains");if(!window.XMLHttpRequest)window.XMLHttpRequest=function(){var a;try{a=new ActiveXObject("MSXML2.XMLHTTP");return a}catch(b){}try{a=new ActiveXObject("Microsoft.XMLHTTP");return a}catch(b){}return null};window.fetchXML=function(a,c,n,g,d){var e=parent.Web&&parent.Web.Network,f="POST",m=e?parent.Web.Browser.isIE():parent.$Browser?parent.$Browser._isIE:parent.$B.IE,l=a.v?a.v==f:a.type==(e?parent.Web.Network.Type.XMLPost:parent.$Network.Type.XMLPost),b=new XMLHttpRequest;if(a.timeout)a.timer=setTimeout(k,a.timeout);if(d&&b.upload)try{b.upload.onprogress=d}catch(h){}b.onreadystatechange=j;if(c&&c.oninvoke)c.oninvoke.fire(a);if(l){b.open(f,a.url,true);if(m)b.setRequestHeader("Accept-Encoding","gzip, deflate")}else b.open(a.verb||"GET",a.url,true);if(a.headers)for(var i in a.headers)b.setRequestHeader(i,a.headers[i]);if(a.canary)b.setRequestHeader(a.canary.n,a.canary.v);try{b.send(a.postString)}catch(h){c.onhttperror.fire(b)}function j(){if(4==b.readyState){if(d&&b.upload)try{b.upload.onprogress=null}catch(c){b.upload.onprogress=function(){}}try{b.onreadystatechange=null}catch(e){b.onreadystatechange=function(){}}if(a.timer)clearTimeout(a.timer);g(b,a.c?a.c:a);b=a=null}}function k(){try{b.onreadystatechange=null}catch(c){b.onreadystatechange=function(){}}b.abort();g(null,a.c?a.c:a);b=a=null}return b};window.onload=function(){try{if(parent&&parent.Web&&parent.Web.Network)parent.Web.Network.registerProxy(window);else parent.$Network.Proxy._registerProxy(window)}catch(a){throw new Error("Missing Framework")}}}else throw new Error("Invalid Domain")